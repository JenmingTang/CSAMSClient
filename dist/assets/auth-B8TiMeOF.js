import{r as Gn,ax as Rt,ay as dn,O as fn,a as Qn,i as Yn,az as st,n as An,aA as Xn,$ as hn}from"./index-D6W6_zXP.js";const Tt="undefined",G=Promise,kt=e=>G.resolve(e),It=e=>G.reject(e),Pe=Object,Bt=RegExp,p=void 0,zt=null,T=!0,E=!1,Re=(e,t,n)=>e.then(t,n),ze=(e,t)=>e.catch(t),Dn=(e,t)=>e.finally(t),jt=(e,t,n)=>JSON.stringify(e,t,n),Jn=e=>JSON.parse(e),ut=(e,t=0)=>setTimeout(e,t),Mt=e=>clearTimeout(e),me=e=>Pe.keys(e),At=e=>Pe.values(e),ae=(e,t)=>e.forEach(t),ee=(e,...t)=>e.push(...t),ie=(e,t)=>e.map(t),ge=(e,t)=>e.filter(t),Zn=e=>e.shift(),Oe=(e,t,n=0,...s)=>e.splice(t,n,...s),$=e=>e.length,fe=e=>Array.isArray(e),Le=(e,t)=>delete e[t],dt=e=>typeof e,ot=(e,t)=>e.includes(t),es=typeof window===Tt&&(typeof process!==Tt?typeof process.cwd=="function":typeof Deno!==Tt),Ge="memory",Fe="restore",X=()=>{},Qe=e=>e,K=e=>dt(e)==="function",de=e=>dt(e)==="number"&&!Number.isNaN(e),Ye=e=>dt(e)==="string",Dt=e=>e!==zt&&dt(e)==="object",Wt=e=>Pe.prototype.toString.call(e),ve=e=>Wt(e)==="[object Object]",se=(e,t)=>e instanceof t,xe=e=>e?e.getTime():Date.now(),Ce=e=>e.context,qe=e=>e.config,Un=e=>e.options,ts=e=>Un(Ce(e)),ns=e=>{const{params:t,headers:n}=qe(e);return jt([e.type,e.url,t,e.data,n])},le=e=>e.key,On=(e,t,n=[])=>{const s=K(e)?e(...n):e;return t(!!s.key,"hook handler must be a method instance or a function that returns method instance"),s},Gt=e=>{const t=Wt(e);return/^\[object (Blob|FormData|ReadableStream|URLSearchParams)\]$/i.test(t)||se(e,ArrayBuffer)},Xe=(e,...t)=>Pe.assign(e,...t),ss=(e,...t)=>{const n={};for(const s in e)t.includes(s)||(n[s]=e[s]);return n};function Ln(){let e,t;return{promise:new Promise((s,o)=>{e=s,t=o}),resolve:e,reject:t}}const Je=e=>{const{cacheFor:t}=qe(e),n=u=>de(u)?xe()+u:xe(u||p);let s=Ge,o=()=>0,a=E,r=p;const l=K(t);if(!l){let u=t;if(ve(t)){const{mode:h=Ge,expire:c,tag:i}=t||{};s=h,a=h===Fe,r=i?i.toString():p,u=c}o=h=>n(K(u)?u({method:e,mode:h}):u)}return{f:t,c:l,e:o,m:s,s:a,t:r}},O=(e,...t)=>new e(...t),Qt=(e,t=[])=>K(e)?e(...t):e,os=(e,t)=>K(e)?e:[E,zt].includes(e)?X:t,rs=(e=0)=>{let t=p;return n=>{t&&clearTimeout(t),t=ut(n,e)}},as=(e=E)=>{const t=[];let n=p,s=!1;const o=async()=>{for(s=!0;$(t)>0;){const l=Zn(t);l&&await l()}n&&n(),s=!1};return{addQueue:l=>O(G,(u,h)=>{ee(t,()=>Re(l(),u,i=>{e?u(p):h(i)})),s||o()}),onComplete:l=>{n=l}}},rt=(e,t,n=T,s,o)=>{const a=()=>{o&&s&&(e=t(e,s,o),e!==o[s]&&(o[s]=e))};if(n&&a(),Dt(e))for(const r in e)se(e,String)||rt(e[r],t,n,r,e);return!n&&a(),e},cs="$a.",ft=(e,t)=>cs+e+t,is=(e,t,n)=>{e=e.endsWith("/")?e.slice(0,-1):e,t!==""&&(t=t.match(/^(\/|https?:\/\/)/)?t:`/${t}`);const s=e+t,o=ie(ge(me(n),a=>n[a]!==p),a=>`${a}=${n[a]}`).join("&");return o?+s.includes("?")?`${s}&${o}`:`${s}?${o}`:s},Ut=e=>{if(fe(e))return ie(e,Ut);if(ve(e)&&e.constructor===Pe){const t={};return ae(me(e),n=>{t[n]=Ut(e[n])}),t}return e};class Fn extends Error{constructor(t,n,s){super(n+(s?`

For detailed: https://alova.js.org/error#${s}`:"")),this.name=`[alova${t?`/${t}`:""}]`}}const Ke=(e="")=>(t,n,s)=>{if(!t)throw O(Fn,e,n,s)},ht=()=>{const e={};return{eventMap:e,on(t,n){const s=e[t]=e[t]||[];return ee(s,n),()=>{e[t]=ge(s,o=>o!==n)}},off(t,n){const s=e[t];if(s)if(n){const o=s.indexOf(n);o>-1&&s.splice(o,1)}else delete e[t]},emit(t,n){const s=e[t]||[];return ie(s,o=>o(n))}}};class Be{constructor(t,n,s,o){this.s=t,this.k=n,this.$dhy=s,this.$exp=o}get v(){return this.$dhy(this.s)}get e(){return this.$exp(this.s)}}class pn extends Be{constructor(t,n,s,o,a){super(t,n,s,o),this.$upd=a}set v(t){this.$upd(this.s,t)}get v(){return super.v}}let pt={autoHitCache:"global",ssr:es};const et="color: black; font-size: 12px; font-weight: bolder";var ls=(e,t,n,s)=>{const o=console,a=(...d)=>console.log(...d),{url:r}=t,l=n===Fe,u="\x1B[42m%s\x1B[49m",h="\x1B[32m%s\x1B[39m",c=` [HitCache]${r} `,i=()=>Array($(c)+1).join("^");pt.ssr?(a(u,c),a(h," Cache ",e),a(h," Mode  ",n),l&&a(h," Tag   ",s),a(h,i())):(o.groupCollapsed?o.groupCollapsed("%cHitCache","padding: 2px 6px; background: #c4fcd3; color: #53b56d;",r):a(u,c),a("%c[Cache]",et,e),a("%c[Mode]",et,n),l&&a("%c[Tag]",et,s),a("%c[Method]",et,t),o.groupEnd?o.groupEnd():a(h,i()))};const Ot=e=>`hss.${e}`,qn="hsr.",Lt=e=>qn+e,at="$$hsrs",Vn="__$<>$__",Ft=(e,t)=>{e[t]=0},je=async(e,t,n,s,o,a,r)=>{if(s>xe()&&n){const l=ft(e,t);if(await o.set(l,ge([n,s===1/0?p:s,r],Boolean)),a){const u={},h=[];ae(a,d=>{const f=se(d,Bt),C=f?d.source+(d.flags?Vn+d.flags:""):d;C&&(f&&!u[C]&&ee(h,C),Ft(u,f?Lt(C):Ot(C)))});const c=ie(me(u),async d=>{const f=await o.get(d)||{};Ft(f,l),await o.set(d,f)}),i=async()=>{if($(h)){const d=await o.get(at)||[];ee(d,...h),await o.set(at,d)}};await G.all([...c,i()])}}},qt=async(e,t,n)=>{const s=ft(e,t);await n.remove(s)},Nn=async(e,t,n,s)=>{const o=await n.get(ft(e,t));if(o){const[a,r,l]=o;if(l===s&&(!r||r>xe()))return o;await qt(e,t,n)}},ke=async(e,t,n,s)=>{const o=await Nn(e,t,n,s);return o?o[0]:p},mn=async e=>G.all(e.map(t=>t.clear())),us=async(e,t,n)=>{const s=`${t}`,o={},a=Ot(e);o[a]=await n.get(a);let r;if(t){const c=Ot(s);o[c]=await n.get(c),r=await n.get(at);const i=[];r&&$(r)&&(ae(r,d=>{const[f,C]=d.split(Vn);O(Bt,f,C).test(s)&&ee(i,d)}),await G.all(ie(i,async d=>{const f=Lt(d);o[f]=await n.get(f)})))}const l=async c=>{try{await n.remove(c);for(const i in o){const d=o[i];d&&Le(d,c)}}catch{}},u={};await G.all(ie(me(o),async c=>{const i=o[c];if(i){const d=[];for(const f in i)u[f]||(Ft(u,f),ee(d,l(f)));await G.all(d)}}));const h=$(r||[]);await G.all(ie(me(o),async c=>{const i=o[c];i&&($(me(i))?await n.set(c,i):(await n.remove(c),c.includes(qn)&&r&&(r=ge(r,d=>Lt(d)!==c))))})),h!==$(r||[])&&await n.set(at,r)};var ds=e=>{const{data:t,config:n}=e,s={...n},{headers:o={},params:a={}}=s,r=Ce(e);s.headers={...o},s.params={...a};const l=O(ue,e.type,r,e.url,s,t);return Xe(l,{...e,config:s})};const Vt=async(e,{policy:t="all"}={})=>{if(e&&e.key){const{id:n,l1Cache:s,l2Cache:o}=Ce(e),a=le(e),{f:r,c:l,s:u,e:h,t:c}=Je(e);if(l)return r();let i=t!=="l2"?await ke(n,a,s):p;return t==="l2"?i=await ke(n,a,o,c):t==="all"&&!i&&u&&h(Fe)>xe()&&(i=await ke(n,a,o,c)),i}},_t=async(e,t,{policy:n="all"}={})=>{const o=(fe(e)?e:[e]).map(async a=>{const{hitSource:r}=a,{id:l,l1Cache:u,l2Cache:h}=Ce(a),c=le(a),{e:i,s:d,t:f,c:C}=Je(a);if(C)return;let _=t;if(K(t)){let P=n!=="l2"?await ke(l,c,u):p;if((n==="l2"||n==="all"&&!P&&d&&i(Fe)>xe())&&(P=await ke(l,c,h,f)),_=t(P),_===p)return}return G.all([n!=="l2"&&je(l,c,_,i(Ge),u,r),n==="l2"||n==="all"&&d?je(l,c,_,i(Fe),h,r,f):p])});return G.all(o)},fs=async e=>{if(!e){await G.all([mn(ct),mn(it)]);return}const n=(fe(e)?e:[e]).map(s=>{const{id:o,l1Cache:a,l2Cache:r}=Ce(s),{c:l}=Je(s);if(l)return;const u=le(s);return G.all([qt(o,u,a),qt(o,u,r)])});await G.all(n)},hs=async e=>{const{autoHitCache:t}=pt,{l1Cache:n,l2Cache:s}=Ce(e),o=le(e),{name:a}=qe(e),r={global:[...ct,...it],self:[n,s],close:[]}[t];r&&$(r)&&await G.all(ie(r,l=>us(o,a,l)))},gn={};function ps(e,t){let n=T,s;const o=O(G,r=>{s=r});return{abort:()=>{Re(o,r=>r&&r.abort())},onDownload:r=>{Re(o,l=>l&&l.onDownload&&l.onDownload(r))},onUpload:r=>{Re(o,l=>l&&l.onUpload&&l.onUpload(r))},response:async()=>{const{beforeRequest:r=X,responded:l,requestAdapter:u,cacheLogger:h}=ts(e),c=le(e),{s:i,t:d,m:f,e:C}=Je(e),{id:_,l1Cache:P,l2Cache:y,snapshots:M}=Ce(e),{cacheFor:L}=qe(e),{hitSource:F}=e;let z=await(K(L)?L():t?p:ke(_,c,P));if(f===Fe&&!z&&!t){const I=await Nn(_,c,y,d);if(I){const[re,ce]=I;await je(_,c,re,ce,P,F),z=re}}const q=ds(e);await r(q);const{baseURL:j,url:b,type:U,data:x}=q,{params:S={},headers:W={},transform:D=Qe,shareRequest:Q}=qe(q),V=gn[_]=gn[_]||{},H=q.data,w=Gt(H);let R=w?p:V[c],B=Qe,N=p,te=X;if(K(l))B=l;else if(ve(l)){const{onSuccess:I,onError:re,onComplete:ce}=l;B=K(I)?I:B,N=K(re)?re:N,te=K(ce)?ce:te}if(z!==p)return s(),q.fromCache=T,os(h,ls)(z,q,f,d),te(q),z;if(n=E,!Q||!R){const I=u({url:is(j,b,S),type:U,data:x,headers:W},q);R=V[c]=I}s(R);const oe=async(I,re,ce=T)=>{const ye=await I,Se=await D(ye,re||{});M.save(e);try{await hs(q)}catch{}if((!H||!w)&&ce)try{await G.all([je(_,c,Se,C(Ge),P,F),i&&je(_,c,Se,C(Fe),y,F,d)])}catch{}return Ut(Se)};return Dn(Re(G.all([R.response(),R.headers()]),([I,re])=>(Le(V,c),oe(B(I,q),re)),I=>(Le(V,c),K(N)?oe(N(I,q),p,E):It(I))),()=>{te(q)})},fromCache:()=>n}}const Sn=(e,t)=>()=>{const n=t.indexOf(e);n>=0&&t.splice(n,1)};class ue{constructor(t,n,s,o,a){this.dhs=[],this.uhs=[],this.fromCache=p;const r=()=>{r.a()};r.a=X;const l=this,u=Un(n);l.abort=r,l.baseURL=u.baseURL||"",l.url=s,l.type=t,l.context=n;const h={},c="cacheFor",i=ve(u[c])?u[c][t]:p,d=o&&o.hitSource;ae(["timeout","shareRequest"],f=>{u[f]!==p&&(h[f]=u[f])}),i!==p&&(h[c]=i),d&&(l.hitSource=ie(fe(d)?d:[d],f=>se(f,ue)?le(f):f),Le(o,"hitSource")),l.config={...h,headers:{},params:{},...o||{}},l.data=a,l.meta=o?o.meta:l.meta,l.key=l.generateKey()}onDownload(t){return ee(this.dhs,t),Sn(t,this.dhs)}onUpload(t){return ee(this.uhs,t),Sn(t,this.uhs)}send(t=E){const n=this,{response:s,onDownload:o,onUpload:a,abort:r,fromCache:l}=ps(n,t);return $(n.dhs)>0&&o((u,h)=>ae(n.dhs,c=>c({loaded:u,total:h}))),$(n.uhs)>0&&a((u,h)=>ae(n.uhs,c=>c({loaded:u,total:h}))),n.abort.a=r,n.fromCache=p,n.promise=Re(s(),u=>(n.fromCache=l(),u)),n.promise}setName(t){qe(this).name=t}generateKey(){return ns(this)}then(t,n){return Re(this.send(),t,n)}catch(t){return ze(this.send(),t)}finally(t){return Dn(this.send(),t)}}const mt=Ke(),Te="success",ms=()=>{let e={};const t=ht();return{set(s,o){e[s]=o,t.emit(Te,{type:"set",key:s,value:o,container:e})},get:s=>{const o=e[s];return t.emit(Te,{type:"get",key:s,value:o,container:e}),o},remove(s){Le(e,s),t.emit(Te,{type:"remove",key:s,container:e})},clear:()=>{e={},t.emit(Te,{type:"clear",key:"",container:e})},emitter:t}},we=()=>(mt(typeof localStorage<"u","l2Cache is not defined."),localStorage),gs=()=>{const e=ht();return{set:(n,s)=>{we().setItem(n,jt(s)),e.emit(Te,{type:"set",key:n,value:s,container:we()})},get:n=>{const s=we().getItem(n),o=s&&Jn(s);return e.emit(Te,{type:"get",key:n,value:o,container:we()}),o},remove:n=>{we().removeItem(n),e.emit(Te,{type:"remove",key:n,container:we()})},clear:()=>{we().clear(),e.emit(Te,{type:"clear",key:"",container:we()})},emitter:e}},En=Set;class Ss{constructor(t){this.records={},this.occupy=0,mt(t>=0,"expected snapshots limit to be >= 0"),this.capacity=t}save(t){const{name:n}=qe(t),{records:s,occupy:o,capacity:a}=this;n&&o<a&&((s[n]=s[n]||O(En)).add(t),this.occupy+=1)}match(t,n=!0){let s,o,a,r=t;ve(t)&&(r=t.name,a=t.filter),se(r,Bt)?o=r:Ye(r)&&(s=r);const{records:l}=this;let u=O(En);s?u=l[s]||u:o&&ae(ge(me(l),c=>o.test(c)),c=>{l[c].forEach(i=>u.add(i))});const h=K(a)?ge([...u],a):[...u];return n?h:h[0]}}const Kn="GET",Es="HEAD",vs="POST",Cs="PUT",ys="PATCH",ws="DELETE",Rs="OPTIONS",vn={cacheFor:{[Kn]:3e5},shareRequest:T,snapshots:1e3};let Ts=0;class _s{constructor(t){var n,s;const o=this;o.id=(t.id||(Ts+=1)).toString(),o.l1Cache=t.l1Cache||ms(),o.l2Cache=t.l2Cache||gs(),o.options={...vn,...t},o.snapshots=O(Ss,(s=(n=t.snapshots)!==null&&n!==void 0?n:vn.snapshots)!==null&&s!==void 0?s:0)}Get(t,n){return O(ue,Kn,this,t,n)}Post(t,n,s){return O(ue,vs,this,t,s,n)}Delete(t,n,s){return O(ue,ws,this,t,s,n)}Put(t,n,s){return O(ue,Cs,this,t,s,n)}Head(t,n){return O(ue,Es,this,t,n)}Patch(t,n,s){return O(ue,ys,this,t,s,n)}Options(t,n){return O(ue,Rs,this,t,n)}}let We=p;const ct=[],it=[],bs=e=>{const t=O(_s,e),n=t.options.statesHook;We&&mt(We===n,"expected to use the same `statesHook`"),We=n;const{l1Cache:s,l2Cache:o}=t;return!ct.includes(s)&&ee(ct,s),!it.includes(o)&&ee(it,o),t},Ve=()=>(mt(!!We,"`statesHook` is not set in alova instance"),We);var xs={name:"Vue",create:e=>Gn(e),dehydrate:e=>e.value,update:(e,t)=>{t.value=e},effectRequest({handler:e,removeStates:t,immediate:n,watchingStates:s}){Rt()&&dn(t),n&&e(),ae(s||[],(o,a)=>{fn(o,()=>{e(a)},{deep:T})})},computed:e=>Qn(e),watch:(e,t)=>{fn(e,t,{deep:T})},onMounted:e=>{Rt()?Yn(e):ut(e,10)},onUnmounted:e=>{Rt()&&dn(e)}};const Ps=e=>Ye(e)||Gt(e);function Yt(){return(e,t)=>{const n=t.config,s=n.timeout||0,o=new AbortController,{data:a,headers:r}=e,l=/content-type/i.test(Pe.keys(r).join()),u=a&&a.toString()==="[object FormData]";!l&&!u&&(r["Content-Type"]="application/json;charset=UTF-8");const h=fetch(e.url,{...n,method:e.type,signal:o.signal,body:Ps(a)?a:jt(a)});let c,i=E;return s>0&&(c=ut(()=>{i=T,o.abort()},s)),{response:()=>h.then(d=>(Mt(c),d.clone()),d=>It(i?O(Error,"fetchError: network timeout"):d)),headers:()=>h.then(({headers:d})=>d,()=>({})),onDownload:async d=>{let f=E;const C=await h.catch(()=>{f=T});if(!C)return;const{headers:_,body:P}=C.clone(),y=P?P.getReader():p,M=Number(_.get("Content-Length")||_.get("content-length")||0);if(M<=0)return;let L=0;if(y){const F=()=>y.read().then(({done:z,value:q=new Uint8Array})=>{if(z||f)f&&d(M,0);else return L+=q.byteLength,d(M,L),F()});F()}},onUpload(){console.error("fetch API does'nt support uploading progress. please consider to change `@alova/adapter-xhr` or `@alova/adapter-axios`")},abort:()=>{o.abort(),Mt(c)}}}}const bt={authRole:null},tt={authRole:"login"},Ms={authRole:"logout"},nt={authRole:"refreshToken"},pe=({meta:e},t)=>{if(ve(e)){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const s=t[n];if(se(s,RegExp)?s.test(e[n]):e[n]===s)return T}}return E},$n=(e,t)=>O(G,n=>{ee(t,{method:e,resolve:n})}),Cn=(e,t,n,s)=>{if(pe(e,(t==null?void 0:t.metaMatches)||n))return(K(t)?t:ve(t)&&K(t.handler)?t.handler:X)(s,e)},yn=async(e,t,n,s,o,a)=>{const r=$(s)>=2;let l=o==null?void 0:o.isExpired(...s);if(se(l,G)&&(l=await l),l)try{let u=T;if(r&&a&&(u=E,await $n(e,t)),u&&(n(T),await(o==null?void 0:o.handler(...s)),n(E),ae(t,({resolve:h})=>h())),r){const{config:h}=e,c=h.transform;h.transform=p;const i=await e;return h.transform=c,i}}finally{n(E),Oe(t,0,$(t))}},As=e=>{let t=p,n=p,s=p;if(K(e))t=e;else if(ve(e)){const{onSuccess:o,onError:a,onComplete:r}=e;t=K(o)?o:t,n=K(a)?a:n,s=K(r)?r:s}return{onSuccess:t,onError:n,onComplete:s}},Ds=({visitorMeta:e,login:t,logout:n,refreshTokenOnSuccess:s,refreshTokenOnError:o,assignToken:a=X})=>{let r=E;const l=[];return{waitingList:l,onAuthRequired:c=>async i=>{const d=pe(i,e||bt),f=pe(i,(t==null?void 0:t.metaMatches)||tt);return!d&&!f&&!pe(i,(s==null?void 0:s.metaMatches)||nt)&&!pe(i,(o==null?void 0:o.metaMatches)||nt)&&r&&await $n(i,l),!d&&!f&&await a(i),c==null?void 0:c(i)},onResponseRefreshToken:c=>{const i=As(c);return{...i,onSuccess:async(d,f)=>{if(!pe(f,e||bt)&&!pe(f,(t==null?void 0:t.metaMatches)||tt)&&!pe(f,(s==null?void 0:s.metaMatches)||nt)){const C=await yn(f,l,_=>{r=_},[d,f],s,r);if(C)return C}return await Cn(f,t,tt,d),await Cn(f,n,Ms,d),(i.onSuccess||Qe)(d,f)},onError:async(d,f)=>{if(!pe(f,e||bt)&&!pe(f,(t==null?void 0:t.metaMatches)||tt)&&!pe(f,(o==null?void 0:o.metaMatches)||nt)){const C=await yn(f,l,_=>{r=_},[d,f],o,r);if(C)return C}return(i.onError||X)(d,f)}}}}},Us=(e,t)=>{let n=zt;return function(...o){const a=e.bind(this,...o),r=de(t)?t:t(...o);n&&Mt(n),r>0?n=ut(a,r):a()}},Os=(e,t)=>{const n={};for(const s in e)n[s]=t(e[s],s,e);return n};var Ee;(function(e){e[e.USE_REQUEST=1]="USE_REQUEST",e[e.USE_WATCHER=2]="USE_WATCHER",e[e.USE_FETCHER=3]="USE_FETCHER"})(Ee||(Ee={}));function Ie(e,t={trackedKeys:{},bindError:E}){const n=c=>e.ref?e.ref(c):{current:c};t=n(t).current;const s=c=>(e.export||Qe)(c,t),o=c=>{if(!K(e.memorize))return c;const i=e.memorize(c);return i.memorized=!0,i},{dehydrate:a}=e,r=(c,i,d)=>c!==a(i,d,t)&&t.trackedKeys[d]&&e.update(c,i,d,t),l=c=>ie(c,i=>se(i,Be)?i.e:i),u=[],h={};return{create:(c,i)=>(ee(u,i),O(pn,e.create(c,i,t),i,d=>a(d,i,t),s,(d,f)=>r(f,d,i))),computed:(c,i,d)=>(ae(i,f=>{f.k&&(h[f.k]=!0)}),O(Be,e.computed(c,l(i),d,t),d,f=>a(f,d,t),s)),effectRequest:c=>e.effectRequest(c,t),ref:n,watch:(c,i)=>e.watch(l(c),i,t),onMounted:c=>e.onMounted(c,t),onUnmounted:c=>e.onUnmounted(c,t),memorize:o,__referingObj:t,exposeProvider:c=>{const i={},d={};for(const y in c){const M=c[y];if(K(M)&&!t.trackedKeys[y])i[y]=y.startsWith("on")?(...F)=>(M(...F),P):M.memorized?M:o(M);else{const F=se(M,Be);F&&(d[y]=M.s),Pe.defineProperty(i,y,{get:()=>(t.trackedKeys[y]=T,F?M.e:M),set:X,enumerable:T,configurable:T})}}const{update:f,__proxyState:C}=i;t.trackedKeys={...h},t.bindError=E;const _={__referingObj:t,update:o(y=>{me(y).forEach(M=>{ot(u,M)?r(y[M],d[M],M):M in i&&K(f)&&f({[M]:y[M]})})}),__proxyState:o(y=>ot(u,y)&&se(c[y],Be)?(t.trackedKeys[y]=T,c[y]):C(y))},P=Xe(i,_);return P},objectify:(c,i)=>c.reduce((d,f)=>(d[f.k]=i?f[i]:f,d),{}),transformState2Proxy:(c,i)=>O(pn,c,i,d=>a(d,i,t),s,(d,f)=>r(f,d,i))}}const Ls=Ke("useRequest"),Hn=Ke("useWatcher"),kn=Ke("useFetcher"),In=e=>({[Ee.USE_REQUEST]:Ls,[Ee.USE_WATCHER]:Hn,[Ee.USE_FETCHER]:kn})[e],Bn=(e,t)=>e(se(t,ue),"expected a method instance."),Nt="success",Kt="error",$t="complete";var Fs=(e,t,n,s)=>({m:p,sf:[],rf:[],fs:{},em:n,ht:e,c:t,ro:s,ms:{}});class Ne{constructor(t,n){this.method=t,this.args=n}clone(){return{...this}}static spawn(t,n){return new Ne(t,n)}}class qs extends Ne{constructor(t,n,s){super(t.method,t.args),this.data=n,this.fromCache=s}}class Vs extends Ne{constructor(t,n){super(t.method,t.args),this.error=n}}class wn extends Ne{constructor(t,n,s,o,a){super(t.method,t.args),this.status=n,this.data=s,this.fromCache=n==="error"?!1:o,this.error=a}}const Ns=(e,t)=>t(),lt={},Ks=(e,t)=>(lt[e]||{})[t]||{},$s=(e,t,n,s)=>{const o=lt[e]=lt[e]||{};o[t]={s:n,h:s}},Hs=(e,t)=>{const n=lt[e];n&&Le(n,t)};function Ht(e,t,n=[]){const s=In(e.ht);let o=On(t,s,n);const{fs:a,ht:r,c:l,ms:u}=e,{loading:h,data:c,error:i}=a,d=r===Ee.USE_FETCHER,{force:f=E,middleware:C=Ns}=l,_=Ce(o),{id:P}=_,y=le(o),{abortLast:M=T}=l,L=!e.m;return e.m=o,(async()=>{let F=X,z=X,q=E,j=kt(p),b=X,U=X;const x=await Vt(o);let S=()=>!!x,W=E;d||(z=N=>$s(P,y,N,e),z({...a,...u}),F=()=>Hs(P,y));const D=N=>{q=T;const{force:te=f,method:oe=o}=N||{},I=Qt(te,[O(Ne,o,n)]),re=Se=>({loaded:Me,total:Ae})=>{a[Se].v={loaded:Me,total:Ae}};o=oe,ee(e.sf,z),ee(e.rf,F),W||(h.v=!!I||!x);const{downloading:ce,uploading:ye}=e.ro.trackedKeys;return b=ce?o.onDownload(re("downloading")):b,U=ye?o.onUpload(re("uploading")):U,j=o.send(I),S=()=>o.fromCache||E,j},Q={method:o,cachedResponse:x,config:l,abort:()=>o.abort()},V=()=>r!==Ee.USE_WATCHER||!M||e.m===o,H=(N=T)=>{N&&L&&(h.v=E),W=N},w=C(d?{...Q,args:n,fetch:(N,...te)=>(Bn(s,N),Ht(e,N,te)),proxyStates:ss(a,"data"),controlLoading:H}:{...Q,args:n,send:(...N)=>Ht(e,t,N),proxyStates:a,controlLoading:H},D);let R=p;const B=Ne.spawn(o,n);try{const N=await w,te=oe=>{if(!d)V()&&(c.v=oe);else if(e.c.updateState!==E){const I=Ks(P,y).s;I&&(I.data.v=oe)}return V()&&(i.v=p,!W&&(h.v=E),e.em.emit(Nt,O(qs,B,oe,S())),e.em.emit($t,O(wn,B,Nt,oe,S(),p))),oe};R=N!==p?te(N):q?await Re(j,te,()=>te(p)):p,!q&&!W&&(h.v=E)}catch(N){throw V()&&(i.v=N,!W&&(h.v=E),e.em.emit(Kt,O(Vs,B,N)),e.em.emit($t,O(wn,B,Kt,p,S(),N))),N}return b(),U(),R})()}const Rn=e=>e.current;function Xt(e,t,n,s,o=E,a,r=0){var l;n={...n};const{__referingObj:u={trackedKeys:{},bindError:E}}=n;let h=!!o,c=p;if(o)try{const w=On(t,In(e)),R=Ce(w),B=R.l1Cache.get(ft(R.id,le(w)));if(B&&!se(B,G)){const[te,oe]=B;(!oe||oe>xe())&&(c=te)}h=!!Qt((l=n.force)!==null&&l!==void 0?l:E)||!c}catch{}const{create:i,effectRequest:d,ref:f,objectify:C,exposeProvider:_,transformState2Proxy:P}=Ie(Ve(),u),y={total:0,loaded:0},{managedStates:M={}}=n,L=Os(M,(w,R)=>P(w,R)),F=i(c??(K(s)?s():s),"data"),z=i(h,"loading"),q=i(p,"error"),j=i({...y},"downloading"),b=i({...y},"uploading"),U=C([F,z,q,j,b]),x=ht(),S=Rn(f(Fs(e,n,x,u)));S.fs=U,S.em=x,S.c=n,S.ms=L;const W=a!==p,D=(w=t,R)=>Ht(S,w,R),Q=Rn(f(rs())),V=(w=u,R)=>{Q(()=>{ze(D(R),B=>{if(!w.bindError&&!w.trackedKeys.error)throw B})})},H=f(Us((w,R,B)=>V(R,B),w=>de(w)?fe(r)?r[w]:r:0));return pt.ssr||d({handler:W?w=>H.current(w,u,t):()=>V(u),removeStates:()=>ae(S.rf,w=>w()),saveStates:w=>ae(S.sf,R=>R(w)),frontStates:{...U,...L},watchingStates:a,immediate:o??T}),_({...C([F,z,q,j,b]),abort:()=>S.m&&S.m.abort(),send:(w,R)=>D(R,w),onSuccess(w){x.on(Nt,w)},onError(w){u.bindError=T,x.on(Kt,w)},onComplete(w){x.on($t,w)}})}function ks(e={}){const t=Xt(Ee.USE_FETCHER,X,e),{send:n}=t;return Le(t,"send"),Xe(t,{fetch:(s,...o)=>(Bn(kn,s),n(o,s))})}function Jt(e,t={}){const{immediate:n=T,initialData:s}=t,o=Xt(Ee.USE_REQUEST,e,t,s,!!n),{send:a}=o;return Xe(o,{send:(...r)=>a(r)})}function Is(e,t,n={}){Hn(t&&$(t)>0,"expected at least one watching state");const{immediate:s,debounce:o=0,initialData:a}=n,r=Xt(Ee.USE_WATCHER,e,n,a,!!s,t,o),{send:l}=r;return Xe(r,{send:(...u)=>l(u)})}var Bs=e=>{let t={};return{snapshots:()=>t,save(n,s=E){const o=le(n);(!t[o]||s)&&(t[o]={entity:n})},get:n=>t[le(se(n,ue)?n:e(n))],remove(n){n?delete t[n]:t={}}}};const He=Ke("usePagination"),Tn=(e,t)=>He(de(e)&&e<$(t),"index must be a number that less than list length"),_n=e=>[e[e.length-2],e[e.length-1],e.slice(0,e.length-2)];var Ro=(e,t={})=>{const{create:n,computed:s,ref:o,watch:a,exposeProvider:r,objectify:l,__referingObj:u}=Ie(Ve()),{preloadPreviousPage:h=T,preloadNextPage:c=T,total:i=m=>m.total,data:d=m=>m.data,append:f=E,initialPage:C=1,initialPageSize:_=10,watchingStates:P=[],initialData:y,immediate:M=T,middleware:L,force:F=X,...z}=t,q=o(e),j=o(E),b=n(C,"page"),U=n(_,"pageSize"),x=n(y?d(y)||[]:[],"data"),S=n(y?i(y):p,"total"),{snapshots:W,get:D,save:Q,remove:V}=o(Bs(m=>q.current(m,U.v))).current,H=m=>d(m)||m,w=ks({__referingObj:u,updateState:E,force:({args:m})=>m[$(m)-1]}),{loading:R,fetch:B,abort:N,onSuccess:te}=w,oe=o(R),I=(m=b.v,g=[])=>{const v=e(m,U.v,...g);return Q(v),v};a(P,()=>{b.v=C,j.current=T});const re=o({}),ce=s(()=>{const m=S.v;return m!==p?Math.ceil(m/U.v):p},[U,S],"pageCount"),ye=m=>(...g)=>re.current[m](...g),Se=Is((...m)=>{const[g,,v]=_n(m);return I(g,v)},[...P,b.e,U.e],{__referingObj:u,immediate:M,initialData:y,managedStates:l([x,b,U,S],"s"),middleware(m,g){return L?L({...m,delegatingActions:{refresh:ye("refresh"),insert:ye("insert"),remove:ye("remove"),replace:ye("replace"),reload:ye("reload"),getState:v=>({page:b,pageSize:U,data:x,pageCount:ce,total:S,isLastPage:St})[v].v}},g):g()},force:m=>m.args[1]||(K(F)?F(m):F),...z}),{send:Me}=Se,Ae=Se.__proxyState("data"),en=async m=>{const{rawData:g=Ae.v,preloadPage:v,fetchMethod:A,forceRequest:k=E,isNextPage:Y=E}=m,J=ce.v,ne=J?v>J:Y?$(H(g))<U.v:E;if(!(v>0&&!ne))return E;const{e:Z}=Je(A),he=await Vt(A);return Z(Ge)<=xe()?E:k||!he},tn=async(m,g,v=[])=>{const A=b.v+1,k=I(A,v);c&&await en({rawData:m,preloadPage:A,fetchMethod:k,isNextPage:T,forceRequest:g})&&ze(B(k,...v,g),X)},jn=async(m,g=[])=>{const v=b.v-1,A=I(v,g);h&&await en({rawData:m,preloadPage:v,fetchMethod:A})&&ze(B(A,...g,p),X)},St=s(()=>{const m=Ae.v;if(!m)return T;const g=H(m),v=b.v,A=ce.v,k=fe(g)?$(g):0;return A?v>=A:k<U.v},[b,ce,Ae,U],"isLastPage"),Et=async()=>{const m=D(b.v);m&&await _t(m.entity,g=>{if(g){const v=H(g)||[];return Oe(v,0,$(v),...x.v),g}})};te(({method:m,data:g})=>{const v=D(b.v);if(v&&le(v.entity)===le(m)){const A=H(g);if(f){const k=x.v,Y=U.v,J=$(k)%Y;if(J>0){const ne=[...x.v];Oe(ne,(b.v-1)*Y,J,...A),x.v=ne}}else x.v=A}});const vt=o(p),Ct=o(p);Se.onSuccess(({data:m,args:g,method:v})=>{const[A,k,Y]=_n(g),{total:J}=D(v)||{},ne=m;S.v=J!==p?J:i(ne),k||(jn(ne,Y),tn(ne,E,Y));const De=U.v,Z=H(ne);if(He(fe(Z),"Got wrong array, did you return the correct array of list in `data` function"),f){if(j.current&&(x.v=[]),A===p)x.v=[...x.v,...Z];else if(A){const he=[...x.v];Oe(he,(A-1)*De,De,...Z),x.v=he}}else x.v=Z}).onSuccess(({data:m})=>{var g;(g=vt.current)===null||g===void 0||g.call(vt,m)}).onError(({error:m})=>{var g;(g=Ct.current)===null||g===void 0||g.call(Ct,m)}).onComplete(()=>{j.current=E});const Ze=m=>{const g=x.v.indexOf(m);return He(g>=0,"item is not found in list"),g},{addQueue:yt,onComplete:nn}=o(as()).current,wt=async(m=b.v)=>{let g=m,v=kt();if(f){if(!de(m)){const A=Ze(m);g=Math.floor(A/U.v)+1}He(g<=b.v,"refresh page can't greater than page"),v=Me(g,T)}else He(de(g),"unable to calculate refresh page by item in pagination mode"),v=g===b.v?Me(p,T):B(e(g,U.v),T);return v},sn=async(m=E)=>{const g=b.v,v=W();let A=At(v);if(m)V();else{const k=ie(ge([D(g-1),D(g),D(g+1)],Boolean),({entity:Y})=>le(Y));A=ie(ge(me(v),Y=>!ot(k,Y)),Y=>{const J=v[Y];return delete v[Y],J})}await fs(ie(A,({entity:k})=>k))},on=async()=>{oe.current&&N(),await sn();const m=D(b.v+1);if(m){const g=H(await Vt(m.entity)||{})||[];tn(p,$(g)<U.v)}},rn=m=>{if(m===0)return;const g=S.v;if(de(g)){const v=Math.max(g+m,0);S.v=v;const A=b.v;ae([D(A-1),D(A),D(A+1)],k=>{k&&(k.total=v)})}},an=(m,g=0)=>(nn(on),yt(async()=>{const v=de(g)?g:Ze(g)+1;let A=p;const k=[...x.v];if($(k)%U.v===0&&(A=k.pop()),Oe(k,v,0,m),x.v=k,rn(1),await Et(),A){const Y=D(b.v+1);Y&&await _t(Y.entity,J=>{if(J){const ne=H(J)||[];return ne.unshift(A),ne.pop(),J}})}})),cn=(...m)=>(nn(on),yt(async()=>{const g=ie(m,Z=>{const he=de(Z)?Z:Ze(Z);return Tn(he,x.v),he}),v=b.v,A=v+1,k=D(A),Y=[];k&&await _t(k.entity,Z=>{if(Z){const he=H(Z);return fe(he)&&ee(Y,...Oe(he,0,$(g))),Z}});const J=St.v,ne=$(Y);let De=!1;if(ne>0||J){const Z=ge(x.v,(he,Wn)=>!ot(g,Wn));De=!f&&J&&$(Z)<=0,!De&&ne>0&&ee(Z,...Y),x.v=Z}else ne<=0&&!J&&wt(v);return rn(-$(g)),Et().then(()=>{De&&(b.v=v-1)})})),ln=(m,g)=>yt(async()=>{He(g!==p,"expect specify the replace position");const v=de(g)?g:Ze(g);Tn(v,x.v);const A=[...x.v];Oe(A,v,1,m),x.v=A,await Et()}),un=async()=>{await sn(T),j.current=T,b.v===C?ze(Me(),X):b.v=C;const{resolve:m,reject:g,promise:v}=Ln();return vt.current=m,Ct.current=g,v};return re.current={refresh:wt,insert:an,remove:cn,replace:ln,reload:un},r({...Se,...l([x,b,ce,U,S,St]),send:(...m)=>Me(...m,p,p),fetching:w.loading,onFetchSuccess:w.onSuccess,onFetchError:w.onError,onFetchComplete:w.onComplete,refresh:wt,insert:an,remove:cn,replace:ln,reload:un})},zs={forward:e=>se(e,Date)?e.getTime():p,backward:e=>O(Date,e)},js={forward:e=>se(e,RegExp)?e.source:void 0,backward:e=>O(RegExp,e)};const Ws=(e={})=>{const t={date:zs,regexp:js,...e};return{serialize:o=>(Dt(o)&&(o=rt(fe(o)?[...o]:{...o},a=>{let r=p;const l=me(t).reduce((h,c)=>{if(!r){const i=t[c].forward(h);i!==p&&(r=c,h=i)}return h},a);return Pe.prototype.toString.call(a)==="[object Object]"?a={...a}:fe(a)&&(a=[...a]),r!==p?[r,l]:a})),o),deserialize:o=>Dt(o)?rt(o,a=>{if(fe(a)&&$(a)===2){const r=t[a[0]];a=r?r.backward(a[1]):a}return a},E):o}},_e=(e,t={})=>{let n=T;const{enableFocus:s=T,enableVisibility:o=T,enableNetwork:a=T,pollingTime:r=0,throttle:l=1e3}=t,{onMounted:u,onUnmounted:h,__referingObj:c}=Ie(Ve()),i=Jt(e,{...t,__referingObj:c}),d=()=>{n&&(i.send(),l>0&&(n=E,setTimeout(()=>{n=T},l)))};let f=X,C=X,_=X,P=X;return u(()=>{pt.ssr||(f=a?_e.onNetwork(d,t):f,C=s?_e.onFocus(d,t):C,_=o?_e.onVisibility(d,t):_,P=r>0?_e.onPolling(d,t):P)}),h(()=>{f(),C(),_(),P()}),i},Zt=(e,t)=>(window.addEventListener(e,t),()=>window.removeEventListener(e,t));_e.onNetwork=e=>Zt("online",e);_e.onFocus=e=>Zt("focus",e);_e.onVisibility=e=>Zt("visibilitychange",()=>document.visibilityState==="visible"&&e());_e.onPolling=(e,t)=>{const n=setInterval(e,t.pollingTime);return()=>clearInterval(n)};const zn="useCaptcha",Gs=Ke(zn);var To=(e,t={})=>{const{initialCountdown:n,middleware:s}=t;Gs(n===p||n>0,"initialCountdown must be greater than 0");const{create:o,ref:a,objectify:r,exposeProvider:l,__referingObj:u}=Ie(Ve()),h=o(0,"countdown"),c=Jt(e,{...t,__referingObj:u,immediate:E,managedStates:r([h],"s"),middleware:s?(f,C)=>s({...f,send:d},C):p}),i=a(p),d=(...f)=>O(G,(C,_)=>{h.v<=0?c.send(...f).then(P=>{h.v=t.initialCountdown||60,i.current=setInterval(()=>{h.v-=1,h.v<=0&&clearInterval(i.current)},1e3),C(P)}).catch(P=>_(P)):_(O(Fn,zn,"the countdown is not over yet"))});return l({...c,send:d,...r([h])})};const bn=Symbol("FormRestore"),Qs=(e,t)=>`alova/form-${t||le(e)}`,Ys={},xn=e=>{const t=n=>fe(n)?[...n]:ve(n)?{...n}:n;return rt(t(e),t)};var _o=(e,t={})=>{const n=Ys,{id:s,initialForm:o,store:a,resetAfterSubmiting:r,immediate:l=E,middleware:u}=t;Ve();const{create:h,ref:c,onMounted:i,watch:d,objectify:f,exposeProvider:C,__referingObj:_}=Ie(Ve()),P=ve(a),y=P?a.enable:a,M=s?n[s]:p,L=h(xn(o),"form"),F=e,z=ht(),q=c(Qt(F,[L.v])),j=Ce(q.current).l2Cache,b=Qs(q.current,s),U=c(E),x=c(Ws(P?a.serializers:p)),S=c(!1),W=Jt((...R)=>F(L.v,...R),{...t,__referingObj:_,middleware:u?(R,B)=>u({...R,delegatingActions:{updateForm:Q,reset:D}},B):p,immediate:y||M?E:l}),D=()=>{U.current=T;const R=xn(o);R&&(L.v=R),y&&j.remove(b)},Q=R=>{L.v={...L.v,...R}},V=C({...W,...f([L]),updateForm:Q,reset:D,onRestore(R){z.on(bn,R)}});s&&(M||(S.current=T),S.current&&(n[s]={hookProvider:V,config:t}));const{send:H,onSuccess:w}=V;return i(()=>{if(y&&!M){const R=x.current.deserialize(j.get(b));R&&(L.v=R,z.emit(bn,p)),y&&l&&H()}}),d([L],()=>{if(U.current||!y){U.current=E;return}j.set(b,x.current.serialize(L.v))}),w(()=>{r&&D()}),M&&!S.current?M.hookProvider:V},Pn;(function(e){e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSED=2]="CLOSED"})(Pn||(Pn={}));let xt=0;const be={},Xs=e=>!!e.send,Js=Ke("subscriber"),bo=e=>{const{ref:t,onUnmounted:n}=Ie(Ve()),s=t(xt+1);return s.current>xt&&(xt+=1),n(()=>{var o;!((o=be[e])===null||o===void 0)&&o[s.current]&&delete be[e][s.current]}),(o,a)=>{const{abort:r,proxyStates:l,delegatingActions:u={}}=o,h=d=>{for(const f in d)l[f]&&(l[f].v=d[f])},c=be[e]=be[e]||[],i=Xs(o)?{...u,send:o.send,abort:r,update:h}:{...u,fetch:o.fetch,abort:r,update:h};return c[s.current]=i,a()}},xo=(e,t,n=!1)=>{const s=[];typeof e=="symbol"||Ye(e)||de(e)?be[e]&&ee(s,...At(be[e])):se(e,RegExp)&&ae(ge(me(be),o=>e.test(o)),o=>{ee(s,...At(be[o]))}),s.length===0&&!n&&Js(!1,`no handler can be matched by using \`${e.toString()}\``),ae(ge(s,Qe),t)},Zs="BACKEND_ERROR",eo=(e,t)=>{const{tokenRefresher:n}=t,{onAuthRequired:s,onResponseRefreshToken:o}=Ds({refreshTokenOnSuccess:{isExpired:(r,l)=>(n==null?void 0:n.isExpired(r,l))||!1,handler:async(r,l)=>n==null?void 0:n.handler(r,l)},refreshTokenOnError:{isExpired:(r,l)=>(n==null?void 0:n.isExpired(r,l))||!1,handler:async(r,l)=>n==null?void 0:n.handler(r,l)}});return bs({...e,timeout:e.timeout??10*1e3,requestAdapter:e.requestAdapter??Yt(),statesHook:xs,beforeRequest:s(t.onRequest),responded:o({onSuccess:async(r,l)=>{var c;let u=null,h=null;try{await t.isBackendSuccess(r)?h=await t.transformBackendResponse(r):(u=new Error("the backend request error"),u.code=Zs)}catch(i){u=i}if(u)throw await((c=t.onError)==null?void 0:c.call(t,u,r,l)),u;return h},onComplete:t.onComplete,onError:(r,l)=>{var u;return(u=t.onError)==null?void 0:u.call(t,r,null,l)}})})},to="mock",no="#64bde8",so="#ccefff",oo="Realtime",ro="#999999",ao="#ededed",co=(e,t)=>`padding: 2px 6px; background: ${e}; color: ${t};`,$e="color: black; font-size: 12px; font-weight: bolder",Pt=e=>{const t={};for(const n in e)t[n]={value:e[n]};return t},io=({isMock:e,url:t,method:n,headers:s,query:o,data:a,responseHeaders:r,response:l})=>{const u=console;u.groupCollapsed(`%c${e?to:oo}`,co(e?so:ao,e?no:ro),t),u.log("%c[Method]",$e,n.toUpperCase()),u.log("%c[Request Headers]",$e),u.table(Pt(s)),u.log("%c[Query String Parameters]",$e),u.table(Pt(o)),u.log("%c[Request Body]",$e,a||""),e&&(Object.keys(r).length>0&&(u.log("%c[Response Headers]",$e),u.table(Pt(r))),u.log("%c[Response Body]",$e,l||"")),u.groupEnd()},lo=({status:e=200,responseHeaders:t,statusText:n="ok",body:s})=>({response:new Response(Gt(s)?s:JSON.stringify(s),{status:e,statusText:n}),headers:new Headers(t)}),uo=e=>e,fo=e=>{e=/^[^/]*\/\//.test(e)?e:`//${e}`;const t=e.split("/").slice(3),n={};let s=t.pop(),o="",a="";return s&&(s=s.replace(/\?[^?#]+/,r=>(r.substring(1).split("&").forEach(l=>{const[u,h]=l.split("=");u&&(n[u]=h)}),"")),s=s.replace(/#[^#]*/,r=>(a=r,"")),t.push(s),o=`/${t.join("/")}`),{pathname:o,query:n,hash:a}};function ho({enable:e=T,delay:t=2e3,httpAdapter:n,mockRequestLogger:s=io,mock:o,onMockResponse:a=lo,onMockError:r=uo,matchMode:l="pathname"}={mock:{}}){return(u,h)=>{o=e&&o||{};const{url:c,data:i,type:d,headers:f}=u;let C=h.url,_=h.config.params||{};if(l==="pathname"){const S=fo(c);C=S.pathname,_=S.query}const P={},y=C.split("/"),M=Object.keys(o).filter(S=>{if(S.startsWith("-"))return E;let W="GET";if(S=S.replace(/^\[(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS|TRACE|CONNECT)\]/i,(Q,V)=>(W=V.toUpperCase(),"")),W!==d.toUpperCase())return E;const D=S.split("/");if(D.length!==y.length)return E;for(const Q in D){const V=D[Q],H=(V.match(/^\{(.*)\}$/)||["",""])[1];if(H)P[H]=y[Q];else if(V!==y[Q])return E}return T});let L=M.find(S=>!/\{.*\}/.test(S));L=L||M.shift();const F=L?o[L]:p;if(F===p){if(n)return K(s)&&s({isMock:E,url:c,method:d,params:P,headers:f,query:_,data:{},responseHeaders:{}}),n(u,h);throw new Error(`cannot find the httpAdapter.
[url]${c}`)}const z=Ln(),{resolve:q}=z;let{promise:j,reject:b}=z;const U=h.config.timeout||0;U>0&&setTimeout(()=>{b(new Error("request timeout"))},U);const x=setTimeout(()=>{try{const S=K(F)?F({query:_,params:P,data:Ye(i)||!i?{}:i,headers:f}):F;q(O(Promise,(W,D)=>{b=D,kt(S).then(W).catch(D)}))}catch(S){b(S)}},t);return j=j.then(S=>{let W=200,D="ok",Q={},V=p;return S===p?(W=404,D="api not found"):S&&de(S.status)&&Ye(S.statusText)?(W=S.status,D=S.statusText,Q=S.responseHeaders||Q,V=S.body):V=S,O(Promise,(H,w)=>{try{const R=a({status:W,statusText:D,responseHeaders:Q,body:V},{headers:f,query:_,params:P,data:i||{}},h);H(R)}catch(R){w(R)}}).then(H=>(K(s)&&s({isMock:T,url:c,method:d,params:P,headers:f,query:_,data:i||{},responseHeaders:Q,response:V}),H))}).catch(S=>It(r(S,h))),{response:()=>j.then(({response:S})=>S&&Wt(S)==="[object Response]"?S.clone():S),headers:()=>j.then(({headers:S})=>S),abort:()=>{clearTimeout(x),b(new Error("The user abort request"))}}}}function po(e,t={enable:!0}){let n={};return e.filter(({enable:s})=>s).forEach(({data:s})=>{n={...s,...n}}),ho({...t,mock:n})}var mo=(e,t=!0)=>({enable:t,data:e});const go=mo({"[POST]/systemManage/addUser":()=>({code:"0000",msg:"success",data:null}),"[POST]/systemManage/updateUser":()=>({code:"0000",msg:"success",data:null}),"[DELETE]/systemManage/deleteUser":()=>({code:"0000",msg:"success",data:null}),"[DELETE]/systemManage/batchDeleteUser":()=>({code:"0000",msg:"success",data:null}),"[POST]/auth/sendCaptcha":()=>({code:"0000",msg:"success",data:null}),"[POST]/auth/verifyCaptcha":()=>({code:"0000",msg:"success",data:null}),"/mock/getLastTime":()=>({code:"0000",msg:"success",data:{time:new Date().toLocaleTimeString()}})});function So(){const e=st.get("token");return e?`Bearer ${e}`:null}async function Eo(){const{resetStore:e}=An(),t=st.get("refreshToken")||"",n=yo(t);n.meta.authRole="refreshToken";try{const s=await n;st.set("token",s.token),st.set("refreshToken",s.refreshToken)}catch(s){throw e(),s}}function Mn(e,t){var s,o;(s=e.errMsgStack)!=null&&s.length||(e.errMsgStack=[]),e.errMsgStack.includes(t)||(e.errMsgStack.push(t),(o=window.$message)==null||o.error(t,{onLeave:()=>{e.errMsgStack=e.errMsgStack.filter(a=>a!==t),setTimeout(()=>{e.errMsgStack=[]},5e3)}}))}const vo={BASE_URL:"/",DEV:!1,MODE:"prod",PROD:!0,SSR:!1,VITE_APP_DESC:"高校社团信息管理系统是一个清新优雅、高颜值且功能强大的后台管理系统",VITE_APP_TITLE:"高校社团信息管理系统",VITE_AUTH_ROUTE_MODE:"static",VITE_AUTOMATICALLY_DETECT_UPDATE:"Y",VITE_BASE_URL:"/",VITE_HTTP_PROXY:"N",VITE_ICON_LOCAL_PREFIX:"icon-local",VITE_ICON_PREFIX:"icon",VITE_MENU_ICON:"mdi:menu",VITE_OTHER_SERVICE_BASE_URL:`{
  "demo": "http://localhost:9529"
}`,VITE_ROUTER_HISTORY_MODE:"history",VITE_ROUTE_HOME:"home",VITE_SERVICE_BASE_URL:"http://localhost:8080",VITE_SERVICE_EXPIRED_TOKEN_CODES:"9999,9998,3333",VITE_SERVICE_LOGOUT_CODES:"8888,8889",VITE_SERVICE_MODAL_LOGOUT_CODES:"7777,7778",VITE_SERVICE_SUCCESS_CODE:"200",VITE_SOURCE_MAP:"N",VITE_STATIC_SUPER_ROLE:"SUPER_ADMIN",VITE_STORAGE_PREFIX:"SOY_"},{baseURL:Co}=Xn(vo),Ue={errMsgStack:[]};po([go],{httpAdapter:Yt(),delay:1e3,enable:!0,matchMode:"methodurl"});const gt=eo({baseURL:Co,requestAdapter:Yt()},{onRequest({config:e}){const t=So();e.headers.Authorization=t,e.headers.apifoxToken="XL299LiMEDZ0H5h3A29PxwQXdMJqWyY2"},tokenRefresher:{async isExpired(e){const t="9999,9998,3333".split(",")||[],{code:n}=await e.clone().json();return t.includes(String(n))},async handler(){await Eo()}},async isBackendSuccess(e){const n=await e.clone().json();return String(n.code)==="200"},async transformBackendResponse(e){return(await e.clone().json()).data},async onError(e,t){var h,c;const n=An();let s=e.message,o="";if(t){const i=await(t==null?void 0:t.clone().json());s=i.msg,o=String(i.code)}function a(){Mn(Ue,s),n.resetStore()}function r(){a(),window.removeEventListener("beforeunload",a),Ue.errMsgStack=Ue.errMsgStack.filter(i=>i!==s)}throw("8888,8889".split(",")||[]).includes(o)?(a(),e):("7777,7778".split(",")||[]).includes(o)&&!((h=Ue.errMsgStack)!=null&&h.includes(s))?(Ue.errMsgStack=[...Ue.errMsgStack||[],s],window.addEventListener("beforeunload",a),(c=window.$dialog)==null||c.error({title:hn("common.error"),content:s,positiveText:hn("common.confirm"),maskClosable:!1,closeOnEsc:!1,onPositiveClick(){r()},onClose(){r()}}),e):(Mn(Ue,s),e)}});function Po(e){return gt.Post("/auth/sendCaptcha",{phone:e})}function Mo(e,t){return gt.Post("/auth/verifyCaptcha",{phone:e,code:t})}function yo(e){return gt.Post("/auth/refreshToken",{refreshToken:e},{meta:{authRole:"refreshToken"}})}function Ao(e,t){return gt.Get("/auth/error",{params:{code:e,msg:t},shareRequest:!1})}export{bo as a,_o as b,gt as c,_e as d,xo as e,Ao as f,Is as g,Ro as h,Po as s,To as u,Mo as v};
