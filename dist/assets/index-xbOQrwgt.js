import{_ as wn}from"./web-site-link.vue_vue_type_script_setup_true_lang-C0lz5MG1.js";import{V as Hn}from"./vchart-all-CRQWzAE0.js";import{d as lt,r as Fe,bD as It,a as Ae,i as Gt,aN as Tn,O as xt,o as xe,b as ze,E as rt,d0 as Rt,f as K,ad as Dt,c7 as Ft,L as et,A as Pn,w as we,h as V,K as ft,J as Sn,c as gt}from"./index-D6W6_zXP.js";import{l as Oe,t as Ct,m as bn,n as vn,o as ce,p as st,H as Ye,q as In,r as Xe,F as Ee,s as Rn,u as Dn,w as Fn,x as An,y as Kn,z as Ln,A as xn,E as Mt,J as Et,K as yt,M as Z,R as Mn,N as En,O as On,Q as Nn,U as Bn,V as zn,W as Vn,X as kn,Y as jn,Z as He,_ as pt,$ as Wn,a0 as Un,a1 as Qt,a2 as Ht,a3 as at,a4 as Ot,a5 as Me,a6 as Le,a7 as qn,a8 as dt,a9 as mt,aa as tt,ab as Jt,ac as Gn,ad as Nt,ae as Bt,af as zt,ag as $t,ah as Yt,ai as Xt,aj as Zt,ak as en,al as tn,am as nn,an as rn,ao as sn,ap as ln,aq as on,ar as dn,as as an,at as un,au as Qn,av as $e,aw as ot,ax as Vt,ay as Jn,az as $n,I as Yn,T as Xn,aA as Zn,G as ei,aB as ti,aC as ni,h as Tt,aD as ii,k as nt,D as it}from"./index-Jz1qfeca.js";import{j as Ne,e as ge,i as L,I as ut,B as ri}from"./linear-scale-1S1endck.js";import{_ as si}from"./Space-zKntJrGG.js";import"./index-BSN0U_uv.js";import"./get-CQkwdf_k.js";import"./isSymbol-BLe3SAcv.js";import"./get-slot-Bk_rJcZu.js";function li(D,e,t,n,i,r){const l=r.columnHeaderLevelCount,s=[],o=[];for(let c=0;c<t.length;c++)n.includes(t[c])||o.push(i[c]);for(let c=0;c<n.length;c++)if(!t.includes(n[c])){const u={col:D,row:l+c};s.push(u)}let a=r.getParentCellId(D,e),d=r.getRowHeaderCellAddressByCellId(a);const h=[];for(d&&h.push(d);a;)a=r.getParentCellId(d.col,d.row),a&&(d=r.getRowHeaderCellAddressByCellId(a),h.push(d));return{addCellPositions:s,removeCellPositions:o,updateCellPositions:h}}const kt={startInTotal:0,level:0};class Be{constructor(e,t,n,i){var r,l,s,o,a,d,h,c,u,f,g,m,y,w,S,b,_;this.colIndex=0,this._showHeader=!0,this.columnHeaderObjs=[],this.rowHeaderObjs=[],this._cornerHeaderCellFullPathIds=[],this._columnHeaderCellFullPathIds=[],this._rowHeaderCellFullPathIds=[],this._rowHeaderCellFullPathIds_FULL=[],this._cornerHeaderCellIds=[],this._columnHeaderCellIds=[],this._rowHeaderCellIds=[],this._rowHeaderCellIds_FULL=[],this._columnWidths=[],this.columnPaths=[],this._headerObjects=[],this._headerObjectMap={},this._indicators=[],this.indicatorsAsCol=!0,this.hideIndicatorName=!1,this._showRowHeader=!0,this._showColumnHeader=!0,this._indicatorShowType="column",this.rowHierarchyTextStartAlignment=!1,this.rowDimensionKeys=[],this.colDimensionKeys=[],this.indicatorKeys=[],this.indicatorDimensionKey=Oe,this._rowHeaderExtensionTree={},this._extensionRowDimensionKeys=[],this.fullRowDimensionKeys=[],this.leftRowSeriesNumberColumnCount=0,this.rightRowSeriesNumberColumnCount=0,this._useGetBodyCache=!1,this._getBodyCache=new Map,this._useHeaderPathCache=!1,this._colHeaderPathCache=new Map,this._rowHeaderPathCache=new Map,this.sharedVar=e.layoutNodeId,this._table=e,e.options.rowHierarchyType==="tree"&&(this.extensionRows=e.options.extensionRows),this.dataset=t,this._largeCellRangeCache=[],this._CellHeaderPathMap=new Map,this.rowTree=e.internalProps.rowTree,this.columnTree=e.internalProps.columnTree,this.rowsDefine=(r=e.internalProps.rows)!==null&&r!==void 0?r:[],this.columnsDefine=(l=e.internalProps.columns)!==null&&l!==void 0?l:[],this.indicatorsDefine=(s=e.internalProps.indicators)!==null&&s!==void 0?s:[],this.indicatorTitle=e.options.indicatorTitle,this.indicatorsAsCol=(o=e.options.indicatorsAsCol)===null||o===void 0||o,this.hideIndicatorName=(a=e.options.hideIndicatorName)!==null&&a!==void 0&&a,this.showRowHeader=(d=e.options.showRowHeader)===null||d===void 0||d,this.showColumnHeader=(h=e.options.showColumnHeader)===null||h===void 0||h,this.rowHeaderTitle=e.options.rowHeaderTitle,this.columnHeaderTitle=e.options.columnHeaderTitle,this.rowHierarchyType=(c=e.options.rowHierarchyType)!==null&&c!==void 0?c:"grid",this.rowExpandLevel=(u=e.options.rowExpandLevel)!==null&&u!==void 0?u:1,this.rowHierarchyIndent=(f=e.options.rowHierarchyIndent)!==null&&f!==void 0?f:20,this.rowHierarchyTextStartAlignment=e.options.rowHierarchyTextStartAlignment,this.cornerSetting=Object.assign({titleOnDimension:"column",forceShowHeader:!1},e.options.corner),t&&(this.rowTree=t.rowHeaderTree,this.columnTree=t.colHeaderTree),(g=this.indicatorsDefine)===null||g===void 0||g.forEach(C=>{typeof C=="string"?this.indicatorKeys.push(C):this.indicatorKeys.push(C.indicatorKey)}),this.columnDimensionTree=n,this.rowDimensionTree=i,this.colDimensionKeys=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.rowDimensionKeys=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(this.rowDimensionKeys),this.resetRowHeaderLevelCount(),this._table.isPivotChart()&&(this.hasTwoIndicatorAxes=this.indicatorsDefine.some(C=>{var P,T;if(C.chartSpec&&C.chartSpec.series&&C.chartSpec.series.length>1){const v=(T=(P=C.chartSpec.axes)!==null&&P!==void 0?P:this._table.pivotChartAxes)!==null&&T!==void 0?T:[];if(!v.length||v.every(A=>A.orient!==(this.indicatorsAsCol?"top":"right")||A.visible!==!1))return!0}return!1})),this.resetColumnHeaderLevelCount(),this._generateColHeaderIds(),this.colIndex=0,this._generateRowHeaderIds(),this._rowHeaderCellFullPathIds_FULL=Ct(this._rowHeaderCellFullPathIds_FULL),e.options.rowHierarchyType==="tree"&&((m=this.extensionRows)===null||m===void 0?void 0:m.length)>=1&&(this.generateExtensionRowTree(),this.extensionRows.forEach(C=>{const P=[];C.rows.forEach(T=>{typeof T=="string"?P.push(T):P.push(T.dimensionKey)}),this._extensionRowDimensionKeys.push(P),this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(P)})),this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length);let p,I=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr();!this.dataset||this._table.isPivotChart()||((w=(y=this.dataset.records)===null||y===void 0?void 0:y.length)!==null&&w!==void 0?w:0)!==0||this.dataset.customColTree||(I=this.columnsDefine.map(C=>typeof C=="string"?C:C.dimensionKey),this.indicatorsAsCol&&I.push(this.indicatorDimensionKey)),I=this.columnHeaderTitle?[""].concat(I):I;let H=[];if(this.rowHierarchyType==="tree"&&((S=this.extensionRows)===null||S===void 0?void 0:S.length)>=1){const C=[];C.push(this.rowDimensionKeys[0]),this._extensionRowDimensionKeys.forEach(P=>{C.push(P[0])}),H=this.extensionRows.reduce((P,T)=>P.concat(T.rows),[]),p=this.rowHeaderTitle?[""].concat(C):C}else p=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),!this.dataset||this._table.isPivotChart()||((_=(b=this.dataset.records)===null||b===void 0?void 0:b.length)!==null&&_!==void 0?_:0)!==0||this.dataset.customRowTree||(p=this.rowsDefine.map(C=>typeof C=="string"?C:C.dimensionKey),this.indicatorsAsCol||p.push(this.indicatorDimensionKey)),p=this.rowHeaderTitle?[""].concat(p):p;this.cornerHeaderObjs=this._addCornerHeaders(I,p,this.columnsDefine.concat(...this.rowsDefine,...H)),this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((C,P)=>(C[P.id]=P,C),{}),this.indicatorsAsCol&&!this.hideIndicatorName?this._indicatorShowType="column":this.indicatorsAsCol||this.hideIndicatorName?this._indicatorShowType="none":this._indicatorShowType="row",this.generateCellIdsConsiderHideHeader(),this.setPagination(e.options.pagination),this._table.isPivotChart()&&(this._chartItemSpanSize=0,this._chartItemBandSize=0,this._indicators.find(C=>{var P,T,v,A,F,B,Q,J;!((P=C==null?void 0:C.style)===null||P===void 0)&&P.padding&&(this._chartPadding=C.style.padding),!((T=C.chartSpec)===null||T===void 0)&&T.barWidth&&typeof C.chartSpec.barWidth=="number"&&(this._chartItemSpanSize=(v=C.chartSpec)===null||v===void 0?void 0:v.barWidth);const U=(F=(A=C.chartSpec)===null||A===void 0?void 0:A.axes)===null||F===void 0?void 0:F.find($=>$.type==="band");return U!=null&&U.bandSize&&(this._chartItemBandSize=U==null?void 0:U.bandSize,this._chartPaddingInner=(B=Ne(U.paddingInner)?U.paddingInner[0]:U.paddingInner)!==null&&B!==void 0?B:0,this._chartPaddingOuter=(Q=Ne(U.paddingOuter)?U.paddingOuter[0]:U.paddingOuter)!==null&&Q!==void 0?Q:0),this._chartItemSpanSize>0||((J=C.chartSpec.series)===null||J===void 0||J.find($=>($.barWidth&&typeof $.barWidth=="number"&&(this._chartItemSpanSize=$.barWidth),this._chartItemSpanSize>0)),!1)})),this.handleRowSeriesNumber(e.internalProps.rowSeriesNumber),this.setColumnWidths()}handleRowSeriesNumber(e){var t,n;e&&(Array.isArray(e)?this.rowSeriesNumberColumn=e.map(i=>{var r,l;return{id:"",title:i.title,define:i,cellType:(r=i.cellType)!==null&&r!==void 0?r:"text",headerType:(l=i.cellType)!==null&&l!==void 0?l:"text",width:i.width,style:i.style,format:i.format,field:i.field,icon:i.icon}}):this.rowSeriesNumberColumn=[{id:"",title:e.title,define:e,cellType:(t=e.cellType)!==null&&t!==void 0?t:"text",headerType:(n=e.cellType)!==null&&n!==void 0?n:"text",style:e.style,width:e.width,format:e.format,field:"",icon:e.icon,isChildNode:!1}],this.leftRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(i=>!0),this.rightRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(i=>!1),this.leftRowSeriesNumberColumnCount=this.leftRowSeriesNumberColumn.length,this.rightRowSeriesNumberColumnCount=this.rightRowSeriesNumberColumn.length)}_generateColHeaderIds(){var e,t,n,i,r,l,s,o;if(((e=this.columnDimensionTree.tree.children)===null||e===void 0?void 0:e.length)>=1){let a=0;if(this.dataset&&!this._table.isPivotChart()&&((n=(t=this.dataset.records)===null||t===void 0?void 0:t.length)!==null&&n!==void 0?n:0)===0&&!this.dataset.customColTree&&!this.dataset.customRowTree&&this.indicatorsAsCol&&this.columnDimensionTree.totalLevel<this.columnHeaderLevelCount){a=this.columnHeaderLevelCount-this.columnDimensionTree.totalLevel;for(let d=0;d<a;d++)this._columnHeaderCellFullPathIds.unshift([])}this._addHeaders(this._columnHeaderCellFullPathIds,a,this.columnDimensionTree.tree.children,[],this.columnHeaderObjs)}if(this.columnHeaderTitle){this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length);const a=++this.sharedVar.seqId,d=Array(this.colCount-this.rowHeaderLevelCount-this.rightFrozenColCount).fill(a);this._columnHeaderCellFullPathIds.unshift(d);const h={id:a,title:typeof this.columnHeaderTitle.title=="string"?this.columnHeaderTitle.title:this.columnsDefine.reduce((c,u)=>typeof u=="string"?c:c+(c?`/${u.title}`:`${u.title}`),""),field:void 0,headerType:(r=(i=this.columnHeaderTitle)===null||i===void 0?void 0:i.headerType)!==null&&r!==void 0?r:"text",style:(l=this.columnHeaderTitle)===null||l===void 0?void 0:l.headerStyle,define:{id:a,disableHeaderHover:!!(!((s=this.columnHeaderTitle)===null||s===void 0)&&s.disableHeaderHover),disableHeaderSelect:!!(!((o=this.columnHeaderTitle)===null||o===void 0)&&o.disableHeaderSelect)}};this.columnHeaderObjs.push(h),this._headerObjects[a]=h}}_generateRowHeaderIds(){var e,t,n,i,r,l,s,o,a,d;if(((e=this.rowDimensionTree.tree.children)===null||e===void 0?void 0:e.length)>=1)if(this.rowHierarchyType==="tree")this._addHeadersForTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,!0,this.rowsDefine,this.rowHeaderObjs);else{let h=0;if(this.dataset&&!this._table.isPivotChart()&&((n=(t=this.dataset.records)===null||t===void 0?void 0:t.length)!==null&&n!==void 0?n:0)===0&&!this.dataset.customColTree&&!this.dataset.customRowTree&&!this.indicatorsAsCol&&this.rowDimensionTree.totalLevel<this.rowHeaderLevelCount){h=this.rowHeaderLevelCount-this.rowDimensionTree.totalLevel;for(let c=0;c<h;c++)this._rowHeaderCellFullPathIds_FULL.unshift([])}this._addHeaders(this._rowHeaderCellFullPathIds_FULL,h,this.rowDimensionTree.tree.children,[],this.rowHeaderObjs)}if(this.rowHeaderTitle){this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length);const h=++this.sharedVar.seqId,c=Array((r=(i=this._rowHeaderCellFullPathIds_FULL[0])===null||i===void 0?void 0:i.length)!==null&&r!==void 0?r:this.rowDimensionTree.tree.size).fill(h);this._rowHeaderCellFullPathIds_FULL.unshift(c);const u={id:h,title:typeof this.rowHeaderTitle.title=="string"?this.rowHeaderTitle.title:this.rowsDefine.reduce((f,g)=>typeof g=="string"?f:f+(f?`/${g.title}`:`${g.title}`),""),field:void 0,headerType:(s=(l=this.rowHeaderTitle)===null||l===void 0?void 0:l.headerType)!==null&&s!==void 0?s:"text",style:(o=this.rowHeaderTitle)===null||o===void 0?void 0:o.headerStyle,define:{id:h,disableHeaderHover:!!(!((a=this.rowHeaderTitle)===null||a===void 0)&&a.disableHeaderHover),disableHeaderSelect:!!(!((d=this.rowHeaderTitle)===null||d===void 0)&&d.disableHeaderSelect)}};this.rowHeaderObjs.push(u),this._headerObjects[h]=u}}_addHeaders(e,t,n,i,r){const l=this;e[t]||function(s){const o=e[s]=[];if(l.colIndex===0)return o;const a=e[s-1];for(let d=0;d<(a==null?void 0:a.length);d++)o[d]=a[d]}(t);for(let s=0;s<n.length;s++){const o=n[s];bn(o,e,r,i,t,this)}}_addHeadersForTreeMode(e,t,n,i,r,l,s,o){const a=this;e[t]||function(d){const h=e[d]=[];if(a.colIndex===0)return h;const c=e[d-1];for(let u=0;u<(c==null?void 0:c.length);u++)h[u]=c[u]}(t);for(let d=0;d<n.length;d++){const h=n[d];vn(h,e,o,i,t,r,l,s,this)}}_addCornerHeaders(e,t,n){var i,r;const l=[];if(this.cornerSetting.titleOnDimension==="all")if(this.indicatorsAsCol){let s=-1;e&&e.forEach((o,a)=>{var d,h;o===this.indicatorDimensionKey&&(s=a);const c=++this.sharedVar.seqId,u=n.find(g=>typeof g!="string"&&g.dimensionKey===o),f={id:c,title:o===this.indicatorDimensionKey?this.indicatorTitle:u?u.title:o==="axis"?"":o,field:o,style:this.cornerSetting.headerStyle,headerType:(d=this.cornerSetting.headerType)!==null&&d!==void 0?d:"text",showSort:u==null?void 0:u.showSortInCorner,sort:u==null?void 0:u.sort,define:{showSort:u==null?void 0:u.showSortInCorner,sort:u==null?void 0:u.sort,dimensionKey:o,id:c,value:o,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:u==null?void 0:u.cornerDropDownMenu,headerIcon:u==null?void 0:u.cornerHeaderIcon,pivotInfo:{value:(h=u==null?void 0:u.title)!==null&&h!==void 0?h:"",dimensionKey:o,isPivotCorner:!0},description:u==null?void 0:u.cornerDescription};l[c]=f,this._headerObjects[c]=f,this._cornerHeaderCellFullPathIds[a]||(this._cornerHeaderCellFullPathIds[a]=[]);for(let g=0;g<this.rowHeaderLevelCount;g++)this._cornerHeaderCellFullPathIds[a][g]=c}),t&&t.forEach((o,a)=>{var d,h;const c=++this.sharedVar.seqId,u=n.find(g=>typeof g!="string"&&g.dimensionKey===o),f={id:c,title:o===this.indicatorDimensionKey?this.indicatorTitle:u?u.title:o==="axis"?"":o,field:o,style:this.cornerSetting.headerStyle,headerType:(d=this.cornerSetting.headerType)!==null&&d!==void 0?d:"text",showSort:u==null?void 0:u.showSortInCorner,sort:u==null?void 0:u.sort,define:{showSort:u==null?void 0:u.showSortInCorner,sort:u==null?void 0:u.sort,dimensionKey:o,id:c,value:o,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:u==null?void 0:u.cornerDropDownMenu,headerIcon:u==null?void 0:u.cornerHeaderIcon,pivotInfo:{value:(h=u==null?void 0:u.title)!==null&&h!==void 0?h:"",dimensionKey:o,isPivotCorner:!0},description:u==null?void 0:u.cornerDescription};l[c]=f,this._headerObjects[c]=f,this._cornerHeaderCellFullPathIds[s]||(this._cornerHeaderCellFullPathIds[s]=[]),this._cornerHeaderCellFullPathIds[s][a]=c})}else{let s=-1;t&&t.forEach((o,a)=>{var d,h;o===this.indicatorDimensionKey&&(s=a);const c=++this.sharedVar.seqId,u=n.find(g=>typeof g!="string"&&g.dimensionKey===o),f={id:c,title:o===this.indicatorDimensionKey?this.indicatorTitle:u?u.title:o==="axis"?"":o,field:o,style:this.cornerSetting.headerStyle,headerType:(d=this.cornerSetting.headerType)!==null&&d!==void 0?d:"text",showSort:u==null?void 0:u.showSortInCorner,sort:u==null?void 0:u.sort,define:{showSort:u==null?void 0:u.showSortInCorner,sort:u==null?void 0:u.sort,dimensionKey:o,id:c,value:o,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:u==null?void 0:u.cornerDropDownMenu,headerIcon:u==null?void 0:u.cornerHeaderIcon,pivotInfo:{value:(h=u==null?void 0:u.title)!==null&&h!==void 0?h:"",dimensionKey:o,isPivotCorner:!0},description:u==null?void 0:u.cornerDescription};l[c]=f,this._headerObjects[c]=f;for(let g=0;g<this.columnHeaderLevelCount;g++)this._cornerHeaderCellFullPathIds[g]||(this._cornerHeaderCellFullPathIds[g]=[]),this._cornerHeaderCellFullPathIds[g][a]=c}),e&&e.forEach((o,a)=>{var d,h;const c=++this.sharedVar.seqId,u=n.find(g=>typeof g!="string"&&g.dimensionKey===o),f={id:c,title:o===this.indicatorDimensionKey?this.indicatorTitle:u?u.title:o==="axis"?"":o,field:o,style:this.cornerSetting.headerStyle,headerType:(d=this.cornerSetting.headerType)!==null&&d!==void 0?d:"text",showSort:u==null?void 0:u.showSortInCorner,sort:u==null?void 0:u.sort,define:{showSort:u==null?void 0:u.showSortInCorner,sort:u==null?void 0:u.sort,dimensionKey:o,id:c,value:o,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:u==null?void 0:u.cornerDropDownMenu,headerIcon:u==null?void 0:u.cornerHeaderIcon,pivotInfo:{value:(h=u==null?void 0:u.title)!==null&&h!==void 0?h:"",dimensionKey:o,isPivotCorner:!0},description:u==null?void 0:u.cornerDescription};l[c]=f,this._headerObjects[c]=f,this._cornerHeaderCellFullPathIds[a][s]=c})}else if(this.cornerSetting.titleOnDimension==="row"||this.cornerSetting.titleOnDimension==="column"){const s=((i=this.cornerSetting)===null||i===void 0?void 0:i.titleOnDimension)==="row"?t:e;s&&s.forEach((o,a)=>{var d,h;const c=++this.sharedVar.seqId,u=n.find(g=>typeof g!="string"&&g.dimensionKey===o),f={id:c,title:o===this.indicatorDimensionKey?this.indicatorTitle:u?u.title:o==="axis"?"":o,field:o,style:this.cornerSetting.headerStyle,headerType:(d=this.cornerSetting.headerType)!==null&&d!==void 0?d:"text",showSort:u==null?void 0:u.showSortInCorner,sort:u==null?void 0:u.sort,define:{showSort:u==null?void 0:u.showSortInCorner,sort:u==null?void 0:u.sort,dimensionKey:o,id:c,value:o,headerCustomRender:this.cornerSetting.customRender,headerCustomLayout:this.cornerSetting.customLayout,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:u==null?void 0:u.cornerDropDownMenu,headerIcon:u==null?void 0:u.cornerHeaderIcon,pivotInfo:{value:(h=u==null?void 0:u.title)!==null&&h!==void 0?h:"",dimensionKey:o,isPivotCorner:!0},description:u==null?void 0:u.cornerDescription};if(l[c]=f,this._headerObjects[c]=f,this.cornerSetting.titleOnDimension==="column"){this._cornerHeaderCellFullPathIds[a]||(this._cornerHeaderCellFullPathIds[a]=[]);for(let g=0;g<this.rowHeaderLevelCount;g++)this._cornerHeaderCellFullPathIds[a][g]=c}else if(this.cornerSetting.titleOnDimension==="row")for(let g=0;g<this.columnHeaderLevelCount;g++)this._cornerHeaderCellFullPathIds[g]||(this._cornerHeaderCellFullPathIds[g]=[]),this._cornerHeaderCellFullPathIds[g][a]=c})}else{const s=++this.sharedVar.seqId,o={id:s,title:"",field:"维度名称",style:this.cornerSetting.headerStyle,headerType:(r=this.cornerSetting.headerType)!==null&&r!==void 0?r:"text",define:{dimensionKey:"维度名称",id:s,headerCustomRender:this.cornerSetting.customRender,headerCustomLayout:this.cornerSetting.customLayout,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect}};l[s]=o,this._headerObjects[s]=o;for(let a=0;a<this.columnHeaderLevelCount;a++)for(let d=0;d<this.rowHeaderLevelCount;d++)this._cornerHeaderCellFullPathIds[a]||(this._cornerHeaderCellFullPathIds[a]=[]),this._cornerHeaderCellFullPathIds[a][d]=s}return l}generateExtensionRowTree(){this.extensionRows.forEach((e,t)=>{const n=this._rowHeaderCellFullPathIds_FULL;this._rowHeaderCellFullPathIds_FULL=[],n.forEach((i,r)=>{const l=i[i.length-1];let s,o;if(this.colIndex=0,typeof e.rowTree=="function"){const d=this.findFullCellIds(i);s=e.rowTree(d.map(h=>({dimensionKey:this._headerObjects[h].field,value:this._headerObjects[h].title})))}else s=ge(e.rowTree);this._rowHeaderExtensionTree[l]?(this._rowHeaderExtensionTree[l].reset(this._rowHeaderExtensionTree[l].tree.children),o=this._rowHeaderExtensionTree[l]):(o=new ce(s??[],this.sharedVar,this.rowHierarchyType,void 0),this._rowHeaderExtensionTree[l]=o);const a=[];this._addHeadersForTreeMode(a,0,o.tree.children,[],o.totalLevel,!0,e.rows,this.rowHeaderObjs);for(let d=0;d<a[0].length;d++)this._rowHeaderCellFullPathIds_FULL.push(i.concat(a[0][d]))})})}setColumnWidths(){var e,t,n;const i=new Array(this.colCount).fill(void 0);if(this.leftRowSeriesNumberColumnCount&&(i[0]=this.leftRowSeriesNumberColumn[0]),this.showHeader&&this.showRowHeader)if(this.rowHeaderTitle&&(i[0+this.leftRowSeriesNumberColumnCount]={}),this.rowHierarchyType==="tree"){const r=this.rowDimensionKeys[0];if(r){const l=(e=this.rowsDefine)===null||e===void 0?void 0:e.find(s=>typeof s!="string"&&s.dimensionKey===r);l&&(i[0+(this.rowHeaderTitle?1:0)+this.leftRowSeriesNumberColumnCount]={width:l.width,minWidth:l.minWidth,maxWidth:l.maxWidth})}(t=this._extensionRowDimensionKeys)===null||t===void 0||t.forEach((l,s)=>{var o;const a=l[0];if(a){const d=(o=this.extensionRows[s].rows)===null||o===void 0?void 0:o.find(h=>typeof h!="string"&&h.dimensionKey===a);d&&(i[s+1+(this.rowHeaderTitle?1:0)+this.leftRowSeriesNumberColumnCount]={width:d.width,minWidth:d.minWidth,maxWidth:d.maxWidth})}})}else(this.rowDimensionTree.totalLevel>0?this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr():this.rowsDefine.map(r=>typeof r=="string"?r:r.dimensionKey)).forEach((r,l)=>{var s;const o=(s=this.rowsDefine)===null||s===void 0?void 0:s.find(a=>typeof a!="string"&&a.dimensionKey===r);o&&(i[l+(this.rowHeaderTitle?1:0)+this.leftRowSeriesNumberColumnCount]={width:o.width,minWidth:o.minWidth,maxWidth:o.maxWidth})});if(this.indicatorsAsCol)for(let r=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount;r<this.colCount;r++){const l=this.getBody(r,this.columnHeaderLevelCount);i[r]={width:l==null?void 0:l.width,minWidth:l==null?void 0:l.minWidth,maxWidth:l==null?void 0:l.maxWidth}}else{let r,l,s,o=0;(n=this._indicators)===null||n===void 0||n.forEach((a,d)=>{var h,c;typeof a.width=="number"?o=Math.max(a.width,o):a.width==="auto"&&(s=!0),typeof a.minWidth=="number"&&(l=Math.max(a.minWidth,(h=l)!==null&&h!==void 0?h:0)),typeof a.maxWidth=="number"&&(r=Math.min(a.maxWidth,(c=r)!==null&&c!==void 0?c:Number.MAX_VALUE))}),o=o>0?o:s?"auto":void 0,i.fill({width:o,minWidth:l,maxWidth:r},this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount,this.colCount-this.rightFrozenColCount)}this._columnWidths=i}get columnWidths(){return this._columnWidths}getColumnWidthDefined(e){return this._columnWidths[e]}get showHeader(){return this._showHeader}set showHeader(e){this._showHeader=e}get showColumnHeader(){return this._showColumnHeader}set showColumnHeader(e){this._showColumnHeader=e}get showRowHeader(){return this._showRowHeader}set showRowHeader(e){this._showRowHeader=e}get columnHeaderTitle(){return this._columnHeaderTitle}set columnHeaderTitle(e){this._columnHeaderTitle=e}get rowHeaderTitle(){return this._rowHeaderTitle}set rowHeaderTitle(e){this._rowHeaderTitle=e}getHeaderFieldKey(e,t){}getCellLocation(e,t){return this.isCornerHeader(e,t)?"cornerHeader":this.isColumnHeader(e,t)?"columnHeader":this.isRowHeader(e,t)?"rowHeader":"body"}isHeader(e,t){return e>=this.leftRowSeriesNumberColumnCount&&e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount||t>=0&&t<this.columnHeaderLevelCount||e>=this.colCount-this.rightHeaderColCount||t>=this.rowCount-this.bottomHeaderRowCount}isCornerHeader(e,t){return e>=0&&e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&t>=0&&t<this.columnHeaderLevelCount}isColumnHeader(e,t){return e>=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&t>=0&&t<this.columnHeaderLevelCount}isRowHeader(e,t){return e>=this.leftRowSeriesNumberColumnCount&&e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&t>=this.columnHeaderLevelCount}isFrozen(e,t){return this.isFrozenColumn(e)||this.isRightFrozenColumn(e)||this.isBottomFrozenRow(t)||this.isFrozenRow(t)||this.isSeriesNumberInBody(e,t)||this.isSeriesNumberInHeader(e,t)}isFrozenColumn(e,t){if(L(t)){if(e>=0&&e<this.frozenColCount&&t>=this.frozenRowCount&&t<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.frozenColCount>0&&e>=0&&e<this.frozenColCount)return!0;return!1}isRightFrozenColumn(e,t){if(L(t)){if(e>=this.colCount-this.rightFrozenColCount&&t>=this.frozenRowCount&&t<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.rightFrozenColCount>0&&e>=this.colCount-this.rightFrozenColCount)return!0;return!1}isFrozenRow(e,t){if(L(t)){if(t>=0&&t<this.frozenRowCount&&e>=this.frozenColCount&&e<this.colCount-this.rightFrozenColCount)return!0}else if(t=e,this.frozenRowCount>0&&t>=0&&t<this.frozenRowCount)return!0;return!1}isBottomFrozenRow(e,t){if(L(t)){if(t>=this.rowCount-this.bottomFrozenRowCount&&e>=this.frozenColCount&&e<this.colCount-this.rightFrozenColCount)return!0}else if(t=e,this.bottomFrozenRowCount>0&&t>=this.rowCount-this.bottomFrozenRowCount)return!0;return!1}isLeftTopCorner(e,t){return e>=0&&e<this.frozenColCount&&t>=0&&t<this.frozenRowCount}isLeftBottomCorner(e,t){return e>=0&&e<this.frozenColCount&&t>=this.rowCount-this.bottomFrozenRowCount}isRightTopCorner(e,t){return e>=this.colCount-this.rightFrozenColCount&&t>=0&&t<this.frozenRowCount}isRightBottomCorner(e,t){return e>=this.colCount-this.rightFrozenColCount&&t>=this.rowCount-this.bottomFrozenRowCount}getColumnHeaderRange(){return{start:{col:this.rowHeaderLevelCount,row:0},end:{col:this.colCount-1,row:this.columnHeaderLevelCount-1}}}getRowHeaderRange(){return{start:{col:0,row:this.columnHeaderLevelCount},end:{col:this.rowHeaderLevelCount-1,row:this.rowCount-1}}}getCornerHeaderRange(){return{start:{col:0,row:0},end:{col:this.rowHeaderLevelCount-1,row:this.columnHeaderLevelCount-1}}}getBodyRange(){return{start:{col:this.rowHeaderLevelCount,row:this.columnHeaderLevelCount},end:{col:this.colCount-1,row:this.rowCount-1}}}resetCellIds(){}get frozenColCount(){return this._table.internalProps.frozenColCount?this.colCount>this._table.internalProps.frozenColCount?this._table.internalProps.frozenColCount:this.colCount:0}get frozenRowCount(){return this._table.internalProps.frozenRowCount?this.rowCount>=this._table.internalProps.frozenRowCount?this._table.internalProps.frozenRowCount:this.rowCount:0}get headerLevelCount(){return this.columnHeaderLevelCount}resetColumnHeaderLevelCount(){var e,t,n,i,r,l,s,o,a,d,h;if(this.showHeader&&this.showColumnHeader){if(this._table.isPivotChart()&&this.indicatorsAsCol&&!(!((t=(e=this.dataset)===null||e===void 0?void 0:e.colKeys)===null||t===void 0)&&t.length)&&((i=(n=this.columnDimensionTree)===null||n===void 0?void 0:n.tree)===null||i===void 0?void 0:i.level)===0&&!this.hasTwoIndicatorAxes)return void(this.columnHeaderLevelCount=0);let c=this.indicatorsAsCol&&this.hideIndicatorName&&this.colDimensionKeys[this.colDimensionKeys.length-1]===this.indicatorDimensionKey?this.columnDimensionTree.totalLevel-1:this.columnDimensionTree.totalLevel;return c===0&&this.dataset&&!(!((r=this.dataset.customColTree)===null||r===void 0)&&r.length)?this.cornerSetting.titleOnDimension==="row"&&this.cornerSetting.forceShowHeader?c=1:this._table.isPivotChart()||((s=(l=this.dataset.records)===null||l===void 0?void 0:l.length)!==null&&s!==void 0?s:0)!==0||this.cornerSetting.titleOnDimension!=="column"&&this.cornerSetting.titleOnDimension!=="all"||(c=(o=this.columnsDefine.length)!==null&&o!==void 0?o:0):!this.dataset||this._table.isPivotChart()||((d=(a=this.dataset.records)===null||a===void 0?void 0:a.length)!==null&&d!==void 0?d:0)!==0||this.dataset.customColTree||this.cornerSetting.titleOnDimension!=="column"&&this.cornerSetting.titleOnDimension!=="all"||(c=(h=this.columnsDefine.length)!==null&&h!==void 0?h:0,!this.hideIndicatorName&&this.indicatorsAsCol&&c++),this.columnHeaderTitle&&(c+=1),this._table.isPivotChart()&&this.indicatorsAsCol&&!this.hasTwoIndicatorAxes&&st(this.indicatorsDefine)&&(c-=1),void(this.columnHeaderLevelCount=c)}this.columnHeaderLevelCount=this.indicatorsAsCol?this.hideIndicatorName?0:1:0}resetRowHeaderLevelCount(){var e,t,n,i,r,l,s,o;if(this.showHeader&&this.showRowHeader){if(this.rowHierarchyType==="tree"){const h=(t=(e=this.extensionRows)===null||e===void 0?void 0:e.length)!==null&&t!==void 0?t:0;return this.rowHeaderTitle?void(this.rowHeaderLevelCount=2+h):void(this.rowHeaderLevelCount=1+h)}const a=this.rowDimensionTree.totalLevel;let d=a;return d===0&&this.dataset&&!(!((n=this.dataset.customRowTree)===null||n===void 0)&&n.length)?this.cornerSetting.titleOnDimension==="column"&&this.cornerSetting.forceShowHeader?d=1:this._table.isPivotChart()||((r=(i=this.dataset.records)===null||i===void 0?void 0:i.length)!==null&&r!==void 0?r:0)!==0||this.cornerSetting.titleOnDimension!=="row"&&this.cornerSetting.titleOnDimension!=="all"||(d=(l=this.rowsDefine.length)!==null&&l!==void 0?l:0):!this.dataset||this._table.isPivotChart()||((o=(s=this.dataset.records)===null||s===void 0?void 0:s.length)!==null&&o!==void 0?o:0)!==0||this.dataset.customRowTree||this.cornerSetting.titleOnDimension!=="row"&&this.cornerSetting.titleOnDimension!=="all"||(d=this.rowsDefine.length,this.hideIndicatorName||this.indicatorsAsCol||d++),!this.indicatorsAsCol&&this.hideIndicatorName&&this.rowDimensionKeys[this.rowDimensionKeys.length-1]===this.indicatorDimensionKey&&(d=a-1),this.rowHeaderTitle&&(d+=1),void(this.rowHeaderLevelCount=d)}this.rowHeaderLevelCount=this.indicatorsAsCol||this.hideIndicatorName?0:1}get columnHeaderLevelCount(){return this._columnHeaderLevelCount}set columnHeaderLevelCount(e){this._columnHeaderLevelCount=e}get rowHeaderLevelCount(){return this._rowHeaderLevelCount}set rowHeaderLevelCount(e){this._rowHeaderLevelCount=e}get colCount(){var e,t,n;return(this.columnDimensionTree.totalLevel>0||this._table.isPivotChart()||((e=this.dataset.records)===null||e===void 0?void 0:e.length)>0||this.dataset.records&&!Array.isArray(this.dataset.records)?(n=(t=this._columnHeaderCellIds[0])===null||t===void 0?void 0:t.length)!==null&&n!==void 0?n:this.columnDimensionTree.tree.size:0)+this.rowHeaderLevelCount+this.rightHeaderColCount+this.leftRowSeriesNumberColumnCount}get rowCount(){var e,t,n,i;return((this._table.records||this.dataset.records)&&(!Array.isArray(this._table.records)||this._table.records.length>0)&&((e=this._indicators)===null||e===void 0?void 0:e.length)>0&&!(!((t=this._rowHeaderCellIds)===null||t===void 0)&&t.length)?1:(i=(n=this._rowHeaderCellIds)===null||n===void 0?void 0:n.length)!==null&&i!==void 0?i:0)+this.columnHeaderLevelCount+this.bottomHeaderRowCount}get bodyRowSpanCount(){return this.rowDimensionTree.tree.size}get bottomFrozenRowCount(){if(!this._table.isPivotChart())return this._table.internalProps.bottomFrozenRowCount?this.rowCount-this.headerLevelCount>=this._table.internalProps.bottomFrozenRowCount?this._table.internalProps.bottomFrozenRowCount:this.rowCount-this.headerLevelCount:0;if(this.indicatorKeys.length>=1&&st(this.indicatorsDefine)){const e=this._table.pivotChartAxes.find(t=>t.orient==="bottom");return(e==null?void 0:e.visible)===!1?0:(this.indicatorsAsCol,1)}return 0}get rightFrozenColCount(){if(!this._table.isPivotChart())return this._table.internalProps.rightFrozenColCount?this.colCount-this.rowHeaderLevelCount>=this._table.internalProps.rightFrozenColCount?this._table.internalProps.rightFrozenColCount:this.colCount-this.rowHeaderLevelCount:0;const e=this._table.pivotChartAxes.find(t=>t.orient==="right");return(e==null?void 0:e.visible)===!1||this.indicatorsAsCol?0:this.hasTwoIndicatorAxes?1:0}get bodyRowCount(){return this.rowCount-this.bottomFrozenRowCount-this.headerLevelCount}get bodyColCount(){return this.colCount-this.rightFrozenColCount-this.rowHeaderLevelCount}get headerObjects(){return this._headerObjects}get columnObjects(){return this._indicators}getCellId(e,t){var n,i,r,l,s;if(t>=0&&e>=0){if(this.isSeriesNumber(e,t))return"";if(this.isCornerHeader(e,t))return(n=this._cornerHeaderCellIds[t])===null||n===void 0?void 0:n[e-this.leftRowSeriesNumberColumnCount];if(this.isColumnHeader(e,t))return(i=this._columnHeaderCellIds[t])===null||i===void 0?void 0:i[e-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount];if(this.isRowHeader(e,t))return(r=this._rowHeaderCellIds[t-this.columnHeaderLevelCount])===null||r===void 0?void 0:r[e-this.leftRowSeriesNumberColumnCount];if(this.isRightFrozenColumn(e,t))return(l=this._rowHeaderCellIds[t-this.columnHeaderLevelCount])===null||l===void 0?void 0:l[this.rowHeaderLevelCount-1];if(this.isBottomFrozenRow(e,t))return(s=this._columnHeaderCellIds[this.columnHeaderLevelCount-1])===null||s===void 0?void 0:s[e-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount]}}getHeader(e,t){var n;if(this.isSeriesNumberInHeader(e,t))return this.getSeriesNumberHeader(e,t);const i=this.getCellId(e,t);return(n=this._headerObjectMap[i])!==null&&n!==void 0?n:{id:void 0,field:"",headerType:"text",define:void 0}}getHeaderField(e,t){var n,i;const r=this.getCellId(e,t);return((n=this._headerObjectMap[r])===null||n===void 0?void 0:n.field)||((i=this.getBody(e,t))===null||i===void 0?void 0:i.field)}getHeaderCellAdressById(e){for(let t=0;t<this._columnHeaderCellIds.length;t++){const n=this._columnHeaderCellIds[t];for(let i=0;i<n.length;i++)if(n[i]===e)return{col:i+this._table.frozenColCount,row:t}}for(let t=0;t<this._rowHeaderCellIds.length;t++){const n=this._rowHeaderCellIds[t];for(let i=0;i<n.length;i++)if(n[i]===e)return{col:i,row:t+this._table.frozenRowCount}}for(let t=0;t<this._cornerHeaderCellIds.length;t++){const n=this._cornerHeaderCellIds[t];for(let i=0;i<n.length;i++)if(n[i]===e)return{col:i,row:t}}}getHeaderCellAddressByField(e){const t=this.headerObjects.find(n=>n&&n.field===e);return t&&this.getHeaderCellAdressById(t.id)}getBody(e,t){var n,i,r,l,s,o,a,d,h,c;const u=this.getBodyWidthCache(e,t);if(u)return u;if(this.isSeriesNumber(e,t)){const y=this.getSeriesNumberBody(e,t);return this.setBodyWidthCache(e,t,y),y}const f=this.getCellHeaderPaths(e,t);if(this.indicatorsAsCol){const y=(i=(n=f.colHeaderPaths)===null||n===void 0?void 0:n.find(S=>S.indicatorKey))===null||i===void 0?void 0:i.indicatorKey,w=L(y)&&(s=(l=(r=this._indicators)===null||r===void 0?void 0:r.find(S=>S.indicatorKey===y))!==null&&l!==void 0?l:this._indicators[0])!==null&&s!==void 0?s:{id:"",field:void 0,indicatorKey:void 0,cellType:"text",define:void 0};return this.setBodyWidthCache(e,t,w),w}const g=(a=(o=f.rowHeaderPaths)===null||o===void 0?void 0:o.find(y=>y.indicatorKey))===null||a===void 0?void 0:a.indicatorKey,m=L(g)&&(c=(h=(d=this._indicators)===null||d===void 0?void 0:d.find(y=>y.indicatorKey===g))!==null&&h!==void 0?h:this._indicators[0])!==null&&c!==void 0?c:{id:"",field:void 0,indicatorKey:void 0,cellType:"text",define:void 0};return this.setBodyWidthCache(e,t,m),m}getCellRange(e,t){var n,i;const r={start:{col:e,row:t},end:{col:e,row:t}};if(!this.isHeader(e,t)||e===-1||t===-1||this.isRightFrozenColumn(e,t)||this.isBottomFrozenRow(e,t))return r;if(this._table.isPivotChart()){if(this.isLeftBottomCorner(e,t))return{start:{col:0,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.frozenColCount-1,row:this.rowCount-1}};if(this.isRightTopCorner(e,t))return{start:{col:this.colCount-this.rightFrozenColCount,row:0},end:{col:this.colCount-1,row:this.frozenRowCount-1}};if(this.isRightBottomCorner(e,t))return{start:{col:this.colCount-this.rightFrozenColCount,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.colCount-1,row:this.rowCount-1}}}for(let l=0;l<this._largeCellRangeCache.length;l++){const s=this._largeCellRangeCache[l];if(e>=s.start.col&&e<=s.end.col&&t>=s.start.row&&t<=s.end.row)return s}if(this.isHeader(e,t)&&e!==-1&&t!==-1){const l=this.getCellId(e,t);for(let s=e-1;s>=0&&l===this.getCellId(s,t);s--)r.start.col=s;for(let s=e+1;s<((n=this.colCount)!==null&&n!==void 0?n:0)&&l===this.getCellId(s,t);s++)r.end.col=s;for(let s=t-1;s>=0&&l===this.getCellId(e,s);s--)r.start.row=s;for(let s=t+1;s<((i=this.rowCount)!==null&&i!==void 0?i:0)&&!(l!==this.getCellId(e,s)||this.isSeriesNumberInHeader(e,t)&&s>=this.columnHeaderLevelCount);s++)r.end.row=s}return(r.end.col-r.start.col>100||r.end.row-r.start.row>100)&&this._largeCellRangeCache.push(r),r}isCellRangeEqual(e,t,n,i){const r=this.getCellRange(e,t),l=this.getCellRange(n,i);return r.start.col===l.start.col&&r.end.col===l.end.col&&r.start.row===l.start.row&&r.end.row===l.end.row}getBodyIndexByRow(e){return e<this.columnHeaderLevelCount||e>=this.rowCount-this.bottomHeaderRowCount?-1:e-this.columnHeaderLevelCount}get bottomHeaderRowCount(){return this._table.isPivotChart()?this.bottomFrozenRowCount:0}get rightHeaderColCount(){return this._table.isPivotChart()?this.rightFrozenColCount:0}getBodyIndexByCol(e){return e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount||e>=this.colCount-this.rightHeaderColCount?-1:e-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount}getRecordStartRowByRecordIndex(e){return this.columnHeaderLevelCount+e}getRecordShowIndexByCell(e,t){}getCellHeaderPathsWithTreeNode(e,t){for(let s=0;s<this._largeCellRangeCache.length;s++){const o=this._largeCellRangeCache[s];if(e>=o.start.col&&e<=o.end.col&&t>=o.start.row&&t<=o.end.row)break}let n=this.getColHeaderPathCache(e,t),i=this.getRowHeaderPathCache(e,t);const r=this.getBodyIndexByCol(e),l=this.getBodyIndexByRow(t)+this.currentPageStartIndex;if(!n&&t>=0&&r>=0&&(n=this.columnDimensionTree.getTreePath(r,this.showHeader&&this.showColumnHeader?t-(this.columnHeaderTitle?1:0):this.columnDimensionTree.totalLevel),this.setColHeaderPathCache(e,t,n)),!i&&e>=0&&l>=0){if(i=[],this.rowHierarchyType==="tree"){const s=this._rowHeaderCellFullPathIds[l];let o=this.rowDimensionTree,a=0;for(;o;){const d=[];let h=s[a];for(d.push(h);;){const u=this._headerObjectMap[h];if(!(u!=null&&u.parentCellId))break;d.unshift(u.parentCellId),h=u.parentCellId}const c=o.getTreePathByCellIds(d);i.push(...c),o=this._rowHeaderExtensionTree[s[a]],a++}}else i=this.rowDimensionTree.getTreePath(l,this.showHeader&&this.showRowHeader?e-(this.rowHeaderTitle?1:0)-this.leftRowSeriesNumberColumnCount:this.rowDimensionTree.totalLevel);this.setRowHeaderPathCache(e,t,i)}return{colHeaderPaths:n,rowHeaderPaths:i,cellLocation:this.getCellLocation(e,t)}}getCellHeaderPaths(e,t){var n,i;const r=this.getCellHeaderPathsWithTreeNode(e,t),l={colHeaderPaths:[],rowHeaderPaths:[],cellLocation:r.cellLocation};return(n=r.colHeaderPaths)===null||n===void 0||n.forEach(s=>{var o,a,d;const h={};h.dimensionKey=s.dimensionKey,h.indicatorKey=s.indicatorKey,h.value=(d=(o=s.value)!==null&&o!==void 0?o:(a=this.getIndicatorInfoByIndicatorKey(s.indicatorKey))===null||a===void 0?void 0:a.title)!==null&&d!==void 0?d:"",h.virtual=s.virtual,l.colHeaderPaths.push(h)}),(i=r.rowHeaderPaths)===null||i===void 0||i.forEach(s=>{var o,a,d;if(s.dimensionKey!=="axis"){const h={};h.dimensionKey=s.dimensionKey,h.indicatorKey=s.indicatorKey,h.value=(d=(o=s.value)!==null&&o!==void 0?o:(a=this.getIndicatorInfoByIndicatorKey(s.indicatorKey))===null||a===void 0?void 0:a.title)!==null&&d!==void 0?d:"",h.virtual=s.virtual,l.rowHeaderPaths.push(h)}}),l}getIndicatorInfoByIndicatorKey(e){var t;return(t=this.indicatorsDefine)===null||t===void 0?void 0:t.find(n=>typeof n!="string"&&!!e&&n.indicatorKey===e)}findFullCellIds(e){const t=[];for(let n=0;n<e.length;n++){let i=e[n];for(t.push(i);;){const r=this._headerObjectMap[i];if(!(r!=null&&r.parentCellId))break;t.unshift(r.parentCellId),i=r.parentCellId}}return t}getHeaderDimension(e,t){var n,i,r;if(this.isHeader(e,t)){const l=this.getHeader(e,t);return(i=(n=this.rowsDefine)===null||n===void 0?void 0:n.find(s=>typeof s!="string"&&s.dimensionKey===l.field))!==null&&i!==void 0?i:(r=this.columnsDefine)===null||r===void 0?void 0:r.find(s=>typeof s!="string"&&s.dimensionKey===l.field)}}isColumnIndicatorHeader(e,t){return this._indicatorShowType==="column"&&t===this.columnHeaderLevelCount-1&&e>=this.rowHeaderLevelCount}isRowIndicatorHeader(e,t){return this._indicatorShowType==="row"&&e===this.rowHeaderLevelCount-1&&t>=this.columnHeaderLevelCount}isIndicatorHeader(e,t){return this.isColumnIndicatorHeader(e,t)||this.isRowIndicatorHeader(e,t)}toggleHierarchyState(e,t){var n,i,r,l,s,o;this.colIndex=0;const a=this._rowHeaderCellFullPathIds_FULL.slice(0),d=a.map((u,f)=>({col:e,row:f+this.columnHeaderLevelCount})),h=this.getHeader(e,t);if(h.define.hierarchyState=h.define.hierarchyState===Ye.collapse?Ye.expand:Ye.collapse,this.rowDimensionTree.reset(this.rowDimensionTree.tree.children),this._rowHeaderCellFullPathIds_FULL=[],this.rowDimensionKeys=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.fullRowDimensionKeys=[],this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(this.rowDimensionKeys),this._addHeadersForTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,!0,this.rowsDefine,this.rowHeaderObjs),this.rowHeaderTitle){const u=++this.sharedVar.seqId,f=Array(this.rowCount-this.columnHeaderLevelCount).fill(u);this._rowHeaderCellFullPathIds_FULL.unshift(f);const g={id:u,title:typeof this.rowHeaderTitle.title=="string"?this.rowHeaderTitle.title:this.rowsDefine.reduce((m,y)=>typeof y=="string"?m:m+(m?`/${y.title}`:`${y.title}`),""),field:void 0,headerType:(i=(n=this.rowHeaderTitle)===null||n===void 0?void 0:n.headerType)!==null&&i!==void 0?i:"text",style:(r=this.rowHeaderTitle)===null||r===void 0?void 0:r.headerStyle,define:{field:"",headerType:"text",cellType:"text",disableHeaderHover:!!(!((l=this.rowHeaderTitle)===null||l===void 0)&&l.disableHeaderHover),disableHeaderSelect:!!(!((s=this.rowHeaderTitle)===null||s===void 0)&&s.disableHeaderSelect)}};this.rowHeaderObjs.push(g),this._headerObjects[u]=g}this._rowHeaderCellFullPathIds_FULL=Ct(this._rowHeaderCellFullPathIds_FULL),this.rowHierarchyType==="tree"&&((o=this.extensionRows)===null||o===void 0?void 0:o.length)>=1&&this.generateExtensionRowTree(),this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((u,f)=>(u[f.id]=f,u),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0;const c=li(e,t,a.map(u=>u[e-this.leftRowSeriesNumberColumnCount]),this._rowHeaderCellFullPathIds_FULL.map(u=>u[e-this.leftRowSeriesNumberColumnCount]),d,this);return this.generateCellIdsConsiderHideHeader(),this.setPagination(this.pagination),c}isHeaderForColWidth(e,t){return this.isHeader(e,t)}getHeaderForColWidth(e,t){return this.getHeader(e,t)}getPivotCellAdress(e){var t;if(!Array.isArray(e))return;let n,i,r=this.rowTree,l=this.columnTree;for(let a=0;a<e.length;a++){const d=e[a];if((d.isPivotCorner||!L(d.value))&&a===e.length-1){if(((t=this==null?void 0:this.cornerSetting)===null||t===void 0?void 0:t.titleOnDimension)==="row"){let u=0;return this.rowHierarchyType==="grid"&&(u=this.rowDimensionKeys.indexOf(d.dimensionKey)),u===-1?void 0:{col:(this.rowHeaderTitle?u+1:u)+this.leftRowSeriesNumberColumnCount,row:0}}const c=this.colDimensionKeys.indexOf(d.dimensionKey);return c===-1?void 0:{col:0+this.leftRowSeriesNumberColumnCount,row:this.columnHeaderTitle?c+1:c}}let h=!1;for(let c=0;c<l.length;c++){const u=l[c];if((L(d.dimensionKey)&&u.dimensionKey===d.dimensionKey||L(d.indicatorKey)&&u.indicatorKey===d.indicatorKey)&&u.value===d.value){l=u.children,i=u,h=!0;break}}if(!h)for(let c=0;c<r.length;c++){const u=r[c];if((L(d.dimensionKey)&&u.dimensionKey===d.dimensionKey||L(d.indicatorKey)&&u.indicatorKey===d.indicatorKey)&&u.value===d.value){r=u.children,n=u;break}}}let s=0,o=0;if(n){o=this.columnHeaderLevelCount;const{startInTotal:a,level:d}=n;return o+=a,s=this.rowHierarchyType==="grid"?(this.rowHeaderTitle?d+1:d)+this.leftRowSeriesNumberColumnCount:0+this.leftRowSeriesNumberColumnCount,{col:s,row:o}}if(i){s=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount;const{startInTotal:a,level:d}=i;return s+=a,o=this.columnHeaderTitle?d+1:d,{col:s,row:o}}}getPivotDimensionInfo(e,t){var n;const{colHeaderPaths:i,rowHeaderPaths:r}=this.getCellHeaderPaths(e,t),l=[];return i.length?i.forEach((s,o)=>{l.push({dimensionKey:s.dimensionKey,value:s.value,isPivotCorner:!1,indicatorKey:s.indicatorKey})}):r.length?r.forEach((s,o)=>{l.push({dimensionKey:s.dimensionKey,value:s.value,isPivotCorner:!1,indicatorKey:s.indicatorKey})}):this.isCornerHeader(e,t)&&(((n=this==null?void 0:this.cornerSetting)===null||n===void 0?void 0:n.titleOnDimension)==="row"?l.push({dimensionKey:this.rowDimensionKeys[(this.rowHeaderTitle?e-1:e)-this.leftRowSeriesNumberColumnCount],isPivotCorner:!0}):l.push({dimensionKey:this.colDimensionKeys[this.columnHeaderTitle?t-1:t],isPivotCorner:!0})),l}getIndicatorKey(e,t){var n;return(n=this.getBody(e,t))===null||n===void 0?void 0:n.indicatorKey}getParentCellId(e,t){if(t!==0)return this.isColumnHeader(e,t)?this.getCellId(e,t-1):this.isRowHeader(e,t)?this.getCellId(e-1,t):void 0}getRowHeaderCellAddressByCellId(e){let t,n;if(this._rowHeaderCellIds.find((i,r)=>!!i.find((l,s)=>l===e&&(t=s,!0))&&(n=r,!0)),L(t)&&L(n))return{col:t,row:n+this.columnHeaderLevelCount}}canMoveHeaderPosition(e,t){if(this.isSeriesNumberInHeader(t.col,t.row)||this.isSeriesNumberInHeader(e.col,e.row)||this.isCornerHeader(t.col,t.row)||e.col<0||e.row<0||t.col<0||t.row<0)return!1;this.isSeriesNumberInBody(t.col,t.row)&&this.isSeriesNumberInBody(e.col,e.row)&&(e.col=e.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1,t.col=t.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1);const n=this.getCellRange(e.col,e.row);if(this.isColumnHeader(e.col,e.row))return this.getParentCellId(e.col,n.start.row)===this.getParentCellId(t.col,n.start.row);if(this.isRowHeader(e.col,e.row)){if(this.rowHierarchyType!=="tree")return this.getParentCellId(n.start.col,e.row)===this.getParentCellId(n.start.col,t.row);{const i=ge(this.getCellHeaderPathsWithTreeNode(e.col,e.row).rowHeaderPaths),r=ge(this.getCellHeaderPathsWithTreeNode(t.col,t.row).rowHeaderPaths);if(i.pop(),r.pop(),i.length<=r.length){if(i.length===r.length)return!i.find((l,s)=>l.dimensionKey!==r[s].dimensionKey||l.value!==r[s].value);if(i.length>0){for(let l=0;l<i.length;l++)if(i[l].startInTotal!==r[l].startInTotal)return!1}return!0}}}return!1}moveHeaderPosition(e,t){if(this.canMoveHeaderPosition(e,t)&&!this.isCellRangeEqual(e.col,e.row,t.col,t.row)){const n=this.getCellRange(e.col,e.row);if(this.isColumnHeader(e.col,e.row)){const i=n.end.col-n.start.col+1;let r;const l=this.getCellRange(t.col,n.start.row);if(r=t.col>=e.col?l.end.col-i+1:l.start.col,r===n.start.col)return null;for(let o=0;o<this._columnHeaderCellFullPathIds.length;o++){const a=this._columnHeaderCellFullPathIds[o].splice(n.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,i);a.unshift(r-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._columnHeaderCellFullPathIds[o],a)}const s=this._columnWidths.splice(n.start.col-this.leftRowSeriesNumberColumnCount,i);return s.unshift(r-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._columnWidths,s),this.columnDimensionTree.movePosition(this.getCellHeaderPathsWithTreeNode(e.col,e.row).colHeaderPaths.length-1,n.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,l.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount),this.columnDimensionTree.reset(this.columnDimensionTree.tree.children),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,{sourceIndex:n.start.col,targetIndex:r,sourceSize:i,targetSize:l.end.col-l.start.col+1,moveType:"column"}}if(this.isRowHeader(e.col,e.row)){let i;const r=this.getCellHeaderPathsWithTreeNode(e.col,e.row).rowHeaderPaths,l=this.getCellHeaderPathsWithTreeNode(t.col,t.row).rowHeaderPaths,s=r[r.length-1],o=l[r.length-1],a=s.size;if(i=t.row>=e.row?o.startInTotal+o.size-a:o.startInTotal,i===n.start.row-this.columnHeaderLevelCount)return null;const d=this._rowHeaderCellIds.splice(n.start.row-this.columnHeaderLevelCount,a);d.unshift(i-this.currentPageStartIndex,0),Array.prototype.splice.apply(this._rowHeaderCellIds,d);const h=this._rowHeaderCellFullPathIds.splice(n.start.row-this.columnHeaderLevelCount,a);h.unshift(i-this.currentPageStartIndex,0),Array.prototype.splice.apply(this._rowHeaderCellFullPathIds,h);const c=this._rowHeaderCellIds_FULL.splice(n.start.row-this.columnHeaderLevelCount+this.currentPageStartIndex,a);c.unshift(i,0),Array.prototype.splice.apply(this._rowHeaderCellIds_FULL,c);const u=this._rowHeaderCellFullPathIds_FULL.splice(n.start.row-this.columnHeaderLevelCount+this.currentPageStartIndex,a);return u.unshift(i,0),Array.prototype.splice.apply(this._rowHeaderCellFullPathIds_FULL,u),this.rowDimensionTree.movePosition(r.length-1,n.start.row-this.columnHeaderLevelCount,i+(t.row>e.row?s.size-1:0)),this.rowDimensionTree.reset(this.rowDimensionTree.tree.children),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,{sourceIndex:n.start.row,targetIndex:i+this.columnHeaderLevelCount,sourceSize:a,targetSize:o.size,moveType:"row"}}}return null}getCellAdressByHeaderPath(e){var t,n,i,r,l,s;let o,a,d=!1,h=!1;if(Array.isArray(e)){if(e.length>this.rowDimensionKeys.length+this.colDimensionKeys.length)return;o=e.filter(_=>this.colDimensionKeys.indexOf(_.dimensionKey)>=0||this.colDimensionKeys.indexOf(this.indicatorDimensionKey)>=0&&_.indicatorKey),a=e.filter(_=>this.rowDimensionKeys.indexOf(_.dimensionKey)>=0||this.rowDimensionKeys.indexOf(this.indicatorDimensionKey)>=0&&_.indicatorKey)}else o=e.colHeaderPaths,a=e.rowHeaderPaths,(e==null?void 0:e.cellLocation)==="body"&&this._table.isPivotTable()&&(h=!0);if(!Array.isArray(o)&&!Array.isArray(a))return;if(o==null||o.sort((_,p)=>{var I,H;return this.colDimensionKeys.indexOf((I=_.dimensionKey)!==null&&I!==void 0?I:this.indicatorDimensionKey)-this.colDimensionKeys.indexOf((H=p.dimensionKey)!==null&&H!==void 0?H:this.indicatorDimensionKey)}),a==null||a.sort((_,p)=>{var I,H;return this.fullRowDimensionKeys.indexOf((I=_.dimensionKey)!==null&&I!==void 0?I:this.indicatorDimensionKey)-this.fullRowDimensionKeys.indexOf((H=p.dimensionKey)!==null&&H!==void 0?H:this.indicatorDimensionKey)}),o==null||o.forEach(_=>{_.isPivotCorner&&(d=!0)}),a==null||a.forEach(_=>{_.isPivotCorner&&(d=!0)}),d){if(this.cornerSetting.titleOnDimension==="all"&&this.indicatorsAsCol&&o.length===0){for(let _=0;_<this.rowDimensionKeys.length;_++)if(((t=a[0])===null||t===void 0?void 0:t.dimensionKey)===this.rowDimensionKeys[_])return{col:_+this.leftRowSeriesNumberColumnCount,row:this.columnHeaderLevelCount-1}}else if(this.cornerSetting.titleOnDimension!=="all"||this.indicatorsAsCol||a.length!==0){if(this.cornerSetting.titleOnDimension==="row"||this.cornerSetting.titleOnDimension==="all"&&!this.indicatorsAsCol){for(let _=0;_<this.rowDimensionKeys.length;_++)if(((i=a[0])===null||i===void 0?void 0:i.dimensionKey)===this.rowDimensionKeys[_])return{col:_+this.leftRowSeriesNumberColumnCount,row:0}}else for(let _=0;_<this.colDimensionKeys.length;_++)if(((r=o[0])===null||r===void 0?void 0:r.dimensionKey)===this.colDimensionKeys[_])return{col:0,row:_}}else for(let _=0;_<this.colDimensionKeys.length;_++)if(((n=o[0])===null||n===void 0?void 0:n.dimensionKey)===this.colDimensionKeys[_])return{col:this.rowHeaderLevelCount-1,row:_}}let c,u,f,g,m=!1;(o==null?void 0:o.length)>=1&&(a==null?void 0:a.length)>=1&&(m=!0);let y,w,S=this.rowTree,b=this.columnTree;if(o)for(let _=0;_<o.length;_++){const p=o[_];for(let I=0;I<b.length;I++){const H=b[I];if(!L(p.indicatorKey)&&H.dimensionKey===p.dimensionKey&&H.value===p.value||L(p.indicatorKey)&&H.indicatorKey===p.indicatorKey&&(L(H.value)&&L(p.value)&&p.value===H.value||!L(H.value)||!L(p.value))){b=H.children,m&&!b?w=H:m||(w=H);break}}}if((a==null?void 0:a.length)>=1)if(this.rowHierarchyType==="tree"){const _=a[a.length-1],p=this.headerObjects.filter(H=>((H==null?void 0:H.field)===_.dimensionKey||(H==null?void 0:H.field)===_.indicatorKey)&&(H==null?void 0:H.title)===_.value).map(H=>H.id),I=this._rowHeaderCellIds.filter(H=>p.indexOf(H[H.length-1])>=0).find(H=>{const C=this.findFullCellIds(H);return C.length===a.length&&C.every(P=>{const T=this._headerObjectMap[P];return a.find(v=>v.dimensionKey===T.field&&v.value===T.title)})});u=this._rowHeaderCellIds.indexOf(I)+this.columnHeaderLevelCount}else for(let _=0;_<a.length;_++){const p=a[_];for(let I=0;I<S.length;I++){const H=S[I];if(!L(p.indicatorKey)&&H.dimensionKey===p.dimensionKey&&H.value===p.value||L(p.indicatorKey)&&H.indicatorKey===p.indicatorKey&&(!L(p.value)||H.value===p.value)){S=H.children,(!m||S&&!S.some(C=>C.dimensionKey==="axis"))&&m||(y=H);break}}}if(h||!m||(y||L(u))&&w){if(y||h){u=this.columnHeaderLevelCount;const{startInTotal:_,level:p}=(l=y)!==null&&l!==void 0?l:kt;u+=_??0,f=this.rowHierarchyType==="grid"?(this.rowHeaderTitle?p+1:p)+this.leftRowSeriesNumberColumnCount:0}if(w||h){c=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount;const{startInTotal:_,level:p}=(s=w)!==null&&s!==void 0?s:kt;c+=_??0,g=this.columnHeaderTitle?p+1:p}return L(c)||L(u)?{col:c??f,row:u??g}:void 0}}setChartInstance(e,t,n){var i,r,l,s;const o=this.getCellHeaderPaths(e,t);let a;if(this.indicatorsAsCol){const d=(i=o.colHeaderPaths.find(h=>h.indicatorKey))===null||i===void 0?void 0:i.indicatorKey;a=(r=this._indicators)===null||r===void 0?void 0:r.find(h=>h.indicatorKey===d)}else{const d=(l=o.rowHeaderPaths.find(h=>h.indicatorKey))===null||l===void 0?void 0:l.indicatorKey;a=(s=this._indicators)===null||s===void 0?void 0:s.find(h=>h.indicatorKey===d)}typeof(a==null?void 0:a.chartSpec)!="function"&&a&&(a.chartInstance=n)}getChartInstance(e,t){var n,i,r,l;const s=this.getCellHeaderPaths(e,t);let o;if(this.indicatorsAsCol){const a=(n=s.colHeaderPaths.find(d=>d.indicatorKey))===null||n===void 0?void 0:n.indicatorKey;o=(i=this._indicators)===null||i===void 0?void 0:i.find(d=>d.indicatorKey===a)}else{const a=(r=s.rowHeaderPaths.find(d=>d.indicatorKey))===null||r===void 0?void 0:r.indicatorKey;o=(l=this._indicators)===null||l===void 0?void 0:l.find(d=>d.indicatorKey===a)}return o==null?void 0:o.chartInstance}checkHasChart(){return In(this)}getDimension(e,t){var n,i;return t==="column"?(n=this.columnsDefine)===null||n===void 0?void 0:n.find(r=>typeof r!="string"&&r.dimensionKey===e):t==="row"?(i=this.rowsDefine)===null||i===void 0?void 0:i.find(r=>typeof r!="string"&&r.dimensionKey===e):void 0}getAxisConfigInPivotChart(e,t){if((this.isFrozenColumn(e,t)||this.isRightFrozenColumn(e,t))&&Xe(e,t,"row",this)||(this.isFrozenRow(e,t)||this.isBottomFrozenRow(e,t))&&Xe(e,t,"col",this)){const n=Ee.getFunction("getAxisConfigInPivotChart")(e,t,this);return(n==null?void 0:n.visible)===!1?void 0:n}}isEmpty(e,t){return!!this._table.isPivotChart()&&(!!this.isLeftBottomCorner(e,t)||!!this.isRightBottomCorner(e,t)||!!this.isRightTopCorner(e,t))}isAxisCell(e,t){return this._table.isPivotChart()?!!(this.indicatorKeys.length>=1&&st(this.indicatorsDefine)&&(this.isBottomFrozenRow(e,t)&&Xe(e,t,"col",this)||this.isRightFrozenColumn(e,t)&&Xe(e,t,"row",this)||this.isRowHeader(e,t)&&e===this.rowHeaderLevelCount-1&&Xe(e,t,"row",this)||this.hasTwoIndicatorAxes&&this.indicatorsAsCol&&t===this.columnHeaderLevelCount-1&&Xe(e,t,"col",this))):!1}getChartAxes(e,t){if(Rn(e,t,this)||this.isAxisCell(e,t))return Dn(e,t,this)}getRawChartSpec(e,t){return Fn(e,t,this)}getChartSpec(e,t){return An(e,t,this)}isShareChartSpec(e,t){return Kn(e,t,this)}getChartDataId(e,t){return Ln(e,t,this)}isNoChartDataRenderNothing(e,t){return xn(e,t,this)}setPagination(e){var t,n,i,r,l,s,o;if(this.clearCellRangeMap(),this._table.internalProps.useOneRowHeightFillAll=!1,this.pagination=e,this.rowHierarchyType==="grid"&&L((t=this.pagination)===null||t===void 0?void 0:t.perPageCount)&&L((n=this.pagination)===null||n===void 0?void 0:n.currentPage)){this.indicatorsAsCol===!1&&(this.pagination.perPageCount=Math.ceil(this.pagination.perPageCount/this.indicatorKeys.length)*this.indicatorKeys.length);const{perPageCount:a,currentPage:d}=this.pagination;this.currentPageStartIndex=a*(d||0),this.currentPageEndIndex=this.currentPageStartIndex+a,this._rowHeaderCellIds=(i=this._rowHeaderCellIds_FULL)===null||i===void 0?void 0:i.slice(this.currentPageStartIndex,this.currentPageEndIndex),this._rowHeaderCellFullPathIds=(r=this._rowHeaderCellFullPathIds_FULL)===null||r===void 0?void 0:r.slice(this.currentPageStartIndex,this.currentPageEndIndex)}else this.currentPageStartIndex=0,this.currentPageEndIndex=this._rowHeaderCellIds_FULL.length,this._rowHeaderCellIds=(l=this._rowHeaderCellIds_FULL)===null||l===void 0?void 0:l.slice(this.currentPageStartIndex,this.currentPageEndIndex),this._rowHeaderCellFullPathIds=(s=this._rowHeaderCellFullPathIds_FULL)===null||s===void 0?void 0:s.slice(this.currentPageStartIndex,this.currentPageEndIndex);this.pagination&&(this.pagination.totalCount=(o=this._rowHeaderCellIds_FULL)===null||o===void 0?void 0:o.length)}release(){var e;const t=this._table._getActiveChartInstance();t==null||t.release(),(e=this._indicators)===null||e===void 0||e.forEach(n=>{var i;(i=n.chartInstance)===null||i===void 0||i.release()})}getHeadNode(e,t){var n,i,r;let l;const s=this.getCellHeaderPaths(e,t);return s.rowHeaderPaths&&((i=(n=s.rowHeaderPaths)===null||n===void 0?void 0:n.length)!==null&&i!==void 0?i:0)>0?l=(r=s.rowHeaderPaths)===null||r===void 0?void 0:r.slice(0,s.rowHeaderPaths.length):s.colHeaderPaths&&s.colHeaderPaths.length>0&&(l=s.colHeaderPaths.slice(0,s.colHeaderPaths.length)),this.getHeadNodeByRowOrColDimensions(l,e,t)}getHeadNodeByRowOrColDimensions(e,t,n){var i;if(!Array.isArray(e))return;let r,l,s=this.rowTree,o=this.columnTree;if(L(n)&&L(t)&&this.rowHierarchyType==="tree"&&this.extensionRows&&t>=1+this.leftRowSeriesNumberColumnCount){const a=this.getCellId(t-1,n);s=this._rowHeaderExtensionTree[a].tree.children}for(let a=0;a<e.length;a++){const d=e[a];if((d.isPivotCorner||!L(d.value))&&a===e.length-1)return;let h=!1;for(let c=0;c<o.length;c++){const u=o[c];if(L(d.dimensionKey)&&u.dimensionKey===d.dimensionKey&&u.value===d.value||L(d.indicatorKey)&&u.indicatorKey===d.indicatorKey&&(u.value===d.value||!L(d.value)||!L(u.value))){o=u.children,l=u,h=!0;break}}if(!h)for(let c=0;(i=c<(s==null?void 0:s.length))!==null&&i!==void 0&&i;c++){const u=s[c];if(L(d.dimensionKey)&&u.dimensionKey===d.dimensionKey&&u.value===d.value||L(d.indicatorKey)&&u.indicatorKey===d.indicatorKey&&(u.value===d.value||!L(d.value)||!L(u.value))){s=u.children,r=u;break}}}return r||l||void 0}clearCellRangeMap(){this._largeCellRangeCache.length=0,this._CellHeaderPathMap=new Map}getDimensionKeyInChartSpec(e,t){var n,i,r,l,s,o;let a;if(this.indicatorsAsCol===!1)for(let d=0;d<this.indicatorsDefine.length;d++){const h=this.indicatorsDefine[d].chartSpec;if(h&&(a=(n=h.xField)!==null&&n!==void 0?n:(r=(i=h==null?void 0:h.series)===null||i===void 0?void 0:i[0])===null||r===void 0?void 0:r.xField,a))return a}else for(let d=0;d<this.indicatorsDefine.length;d++){const h=this.indicatorsDefine[d].chartSpec;if(h&&(a=(l=h.yField)!==null&&l!==void 0?l:(o=(s=h==null?void 0:h.series)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.yField,a))return a}return null}_generateChartState(){return{vtable_selected:{filter:e=>{var t;return this._table._selectedDataItemsInChart.length>=1?!!this._table._selectedDataItemsInChart.find(n=>{for(const i in n)if(typeof n[i]!="object"&&n[i]!==e[i])return!1;return!0}):!((t=this._table._selectedDimensionInChart)===null||t===void 0)&&t.length?!!this._table._selectedDimensionInChart.every(n=>typeof n.value=="object"||e[n.key]===n.value):!1}},vtable_selected_reverse:{filter:e=>{var t;return this._table._selectedDataItemsInChart.length>=1?!this._table._selectedDataItemsInChart.find(n=>{for(const i in n)if(typeof n[i]!="object"&&n[i]!==e[i])return!1;return!0}):!((t=this._table._selectedDimensionInChart)===null||t===void 0)&&t.length?!this._table._selectedDimensionInChart.every(n=>typeof n.value=="object"||e[n.key]===n.value):!1}}}}updateDataStateToChartInstance(e){var t;if(((t=e==null?void 0:e.getSpec().select)===null||t===void 0?void 0:t.enable)!==!1){e||(e=this._table._getActiveChartInstance());const n=this._generateChartState();this._indicators.forEach(i=>{var r;const l=i.chartInstance;((r=i.chartSpec.select)===null||r===void 0?void 0:r.enable)!==!1&&l.updateState(n)}),e==null||e.updateState(n)}}updateDataStateToActiveChartInstance(e){var t;if(((t=e==null?void 0:e.getSpec().select)===null||t===void 0?void 0:t.enable)!==!1){e||(e=this._table._getActiveChartInstance());const n=this._generateChartState();e==null||e.updateState(n)}}getIndicatorKeyInChartSpec(e,t){const n=this.getRawChartSpec(e,t),i=[];if(n){if(n.series||n.xField||n.yField)return this.indicatorsAsCol===!1?n.series?n.series.forEach(r=>{const l=r.yField;i.push(l)}):i.push(n.yField):n.series?n.series.forEach(r=>{const l=r.xField;i.push(l)}):i.push(n.xField),i;if(n.valueField&&i.push(n.valueField),i.length>=1)return i}return null}getOptimunHeightForChart(e){var t,n,i,r,l;const s=this.getCellHeaderPaths(this.rowHeaderLevelCount,e).rowHeaderPaths;let o,a;for(const h in this.dataset.collectValuesBy)if(this.dataset.collectValuesBy[h].type==="yField"&&!this.dataset.collectValuesBy[h].range){o=(t=this.dataset.collectedValues[h])===null||t===void 0?void 0:t[s.map(c=>c.value).join(this.dataset.stringJoinChar)];break}if(this._chartItemBandSize)a=jt((n=o==null?void 0:o.length)!==null&&n!==void 0?n:0,this._chartItemBandSize,this._chartPaddingInner,this._chartPaddingOuter);else{const h=this._chartItemSpanSize||25;a=((i=o==null?void 0:o.length)!==null&&i!==void 0?i:0)*(h+h/3)}const d=Mt((l=(r=this._chartPadding)!==null&&r!==void 0?r:this._table.theme.bodyStyle.padding)!==null&&l!==void 0?l:0);return a+d[0]+d[2]}getOptimunWidthForChart(e){var t,n,i,r,l;const s=this.getCellHeaderPaths(e,this.columnHeaderLevelCount).colHeaderPaths;let o,a;for(const h in this.dataset.collectValuesBy)if(this.dataset.collectValuesBy[h].type==="xField"&&!this.dataset.collectValuesBy[h].range){o=(t=this.dataset.collectedValues[h])===null||t===void 0?void 0:t[s.map(c=>c.value).join(this.dataset.stringJoinChar)];break}if(this._chartItemBandSize)a=jt((n=o==null?void 0:o.length)!==null&&n!==void 0?n:0,this._chartItemBandSize,this._chartPaddingInner,this._chartPaddingOuter);else{const h=this._chartItemSpanSize||25;a=((i=o==null?void 0:o.length)!==null&&i!==void 0?i:0)*(h+h/3)}const d=Mt((l=(r=this._chartPadding)!==null&&r!==void 0?r:this._table.theme.bodyStyle.padding)!==null&&l!==void 0?l:0);return a+d[1]+d[3]}get leftAxesCount(){if(!this._table.isPivotChart())return 0;const e=this._table.pivotChartAxes.find(t=>t.orient==="left");return(e==null?void 0:e.visible)===!1?0:(this.indicatorsAsCol,1)}get topAxesCount(){if(!this._table.isPivotChart())return 0;const e=this._table.pivotChartAxes.find(t=>t.orient==="top");return(e==null?void 0:e.visible)===!1?0:this.indicatorsAsCol&&this.hasTwoIndicatorAxes?1:0}get rightAxesCount(){return this.rightFrozenColCount}get bottomAxesCount(){return this.bottomFrozenRowCount}getColKeysPath(e,t){const n=this.getCellHeaderPaths(e,t),i=[];return n.colHeaderPaths.length&&n.colHeaderPaths.forEach(r=>{r.dimensionKey&&i.push(r.value)}),i==null?void 0:i.join(this.dataset.stringJoinChar)}getRowKeysPath(e,t){const n=this.getCellHeaderPaths(e,t),i=[];return n.rowHeaderPaths.length&&n.rowHeaderPaths.forEach(r=>{r.dimensionKey&&i.push(r.value)}),i==null?void 0:i.join(this.dataset.stringJoinChar)}getIndicatorInfo(e,t=""){var n;return(n=this.indicatorsDefine)===null||n===void 0?void 0:n.find(i=>typeof i!="string"&&(e?i.indicatorKey===e:!!t&&i.title===t))}getLayoutColumnTree(){const e=[],t=this.columnDimensionTree.tree.children;return Et(e,t),e}getLayoutRowTree(){const e=[],t=this.rowDimensionTree.tree.children;return Et(e,t),e}getLayoutColumnTreeCount(){const e=this.columnDimensionTree.tree.children;return yt(e,this.rowHierarchyType==="tree")}getLayoutRowTreeCount(){var e;const t=this.rowDimensionTree.tree.children;let n=yt(t,this.rowHierarchyType==="tree");return(e=this.extensionRows)===null||e===void 0||e.forEach(i=>{if(typeof i.rowTree!="function"){const r=yt(i.rowTree,!0);n*=r}}),n}resetHeaderTree(){var e,t,n;this.colIndex=0,this._rowHeaderCellFullPathIds_FULL=[],this._columnHeaderCellFullPathIds=[],this._columnHeaderCellIds=[];const i=this.dataset;this.rowTree=i.rowHeaderTree,this.columnTree=i.colHeaderTree;const r=this.rowDimensionTree.tree.children;(e=this.rowTree)===null||e===void 0||e.forEach((l,s)=>{const o=r.find(a=>a.dimensionKey===l.dimensionKey&&a.value===l.value);o&&this._table._syncHierarchyState(o,l)}),this.columnDimensionTree=new ce((t=this.columnTree)!==null&&t!==void 0?t:[],this.sharedVar),this.rowDimensionTree=new ce((n=this.rowTree)!==null&&n!==void 0?n:[],this.sharedVar,this.rowHierarchyType,this.rowHierarchyType==="tree"?this.rowExpandLevel:void 0),this.resetColumnHeaderLevelCount(),this._generateColHeaderIds(),this.colIndex=0,this._generateRowHeaderIds(),this._rowHeaderCellFullPathIds_FULL=Ct(this._rowHeaderCellFullPathIds_FULL),this._headerObjectMap=this._headerObjects.reduce((l,s)=>(l[s.id]=s,l),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,this.generateCellIdsConsiderHideHeader(),this.setPagination(this.pagination)}isSeriesNumberInHeader(e,t){return this.leftRowSeriesNumberColumnCount>0&&e>=0&&t>=0&&e<this.leftRowSeriesNumberColumnCount&&t<this.headerLevelCount||this.rightRowSeriesNumberColumnCount>0&&t>=0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t<this.headerLevelCount}isSeriesNumberInBody(e,t){return this.leftRowSeriesNumberColumnCount>0&&e>=0&&e<this.leftRowSeriesNumberColumnCount&&t>=this.headerLevelCount||this.rightRowSeriesNumberColumnCount>0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t>=this.headerLevelCount}isSeriesNumber(e,t){return!!(L(e)&&L(t)&&(this.leftRowSeriesNumberColumnCount>0&&e>=0&&t>=0&&e<this.leftRowSeriesNumberColumnCount||this.rightRowSeriesNumberColumnCount>0&&t>=0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount))}getSeriesNumberHeader(e,t){return this.leftRowSeriesNumberColumnCount>0&&e>=0&&e<this.leftRowSeriesNumberColumnCount&&t<this.headerLevelCount?Object.assign({},this.leftRowSeriesNumberColumn[e],{style:this._table.internalProps.rowSeriesNumber.headerStyle}):this.rightRowSeriesNumberColumnCount>0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t<this.headerLevelCount&&t<this.headerLevelCount?this.rightRowSeriesNumberColumn[e-(this.colCount-this.rightRowSeriesNumberColumnCount)]:void 0}getSeriesNumberBody(e,t){return this.leftRowSeriesNumberColumnCount>0&&e>=0&&e<this.leftRowSeriesNumberColumnCount&&t>=this.headerLevelCount?this.leftRowSeriesNumberColumn[e]:this.rightRowSeriesNumberColumnCount>0&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t>=this.headerLevelCount?this.rightRowSeriesNumberColumn[e-(this.colCount-this.rightRowSeriesNumberColumnCount)]:void 0}changeTreeNodeTitle(e,t,n){this.getHeadNode(e,t).value=n;const i=this.getCellId(e,t);this._headerObjectMap[i].title=n}changeCornerTitle(e,t,n){if(this.isCornerHeader(e,t)){const i=this.getCellId(e,t);this._headerObjectMap[i].title=n}}generateCellIdsConsiderHideHeader(){if(this._columnHeaderCellIds=this._columnHeaderCellFullPathIds.slice(),!this.showColumnHeader)if(this.indicatorsAsCol&&!this.hideIndicatorName){const e=this.colDimensionKeys.indexOf(Oe),t=this._columnHeaderCellIds.splice(e,1);this._columnHeaderCellIds.splice(0,this._columnHeaderCellIds.length),this._columnHeaderCellIds.push(t[0])}else this._columnHeaderCellIds.splice(0,this._columnHeaderCellIds.length);if(this._rowHeaderCellIds_FULL=this._rowHeaderCellFullPathIds_FULL.slice(),!this.showRowHeader)if(this.indicatorsAsCol||this.hideIndicatorName)this._rowHeaderCellIds_FULL.forEach((e,t)=>{const n=e.slice();n.splice(0,n.length),this._rowHeaderCellIds_FULL[t]=n});else{const e=this.rowDimensionKeys.indexOf(Oe);this._rowHeaderCellIds_FULL.forEach((t,n)=>{const i=t.slice(),r=i.splice(e,1);i.splice(0,i.length),i.push(r[0]),this._rowHeaderCellIds_FULL[n]=i})}if(this._rowHeaderCellIds=this._rowHeaderCellIds_FULL.slice(),this._cornerHeaderCellIds=this._cornerHeaderCellFullPathIds.slice(),this.rowHeaderLevelCount===0||this.columnHeaderLevelCount===0)this._cornerHeaderCellIds=[];else if(this.cornerSetting.titleOnDimension!=="row"||this.showRowHeader){if(this.cornerSetting.titleOnDimension==="column"&&!this.showColumnHeader)if(this.indicatorsAsCol&&!this.hideIndicatorName){const e=this.colDimensionKeys.indexOf(Oe),t=this._cornerHeaderCellIds.splice(e,1);this._cornerHeaderCellIds.splice(0,this._cornerHeaderCellIds.length),this._cornerHeaderCellIds.push(t[0])}else this._cornerHeaderCellIds.splice(0,this._cornerHeaderCellIds.length)}else if(this.indicatorsAsCol||this.hideIndicatorName)this._cornerHeaderCellIds.forEach((e,t)=>{const n=e.slice();n.splice(0,n.length),this._cornerHeaderCellIds[t]=n});else{const e=this.rowDimensionKeys.indexOf(Oe);this._cornerHeaderCellIds.forEach((t,n)=>{const i=t.slice(),r=i.splice(e,1);i.splice(0,i.length),i.push(r[0]),this._cornerHeaderCellIds[n]=i})}}enableUseGetBodyCache(){this._useGetBodyCache=!0,this._getBodyCache.clear()}disableUseGetBodyCache(){this._useGetBodyCache=!1,this._getBodyCache.clear()}enableUseHeaderPathCache(){this._useHeaderPathCache=!0,this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear()}disableUseHeaderPathCache(){this._useHeaderPathCache=!1,this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear()}getBodyWidthCache(e,t){if(this._useGetBodyCache&&!this.isHeader(e,t)&&!this.isSeriesNumber(e,t))return this.indicatorsAsCol&&this._getBodyCache.has(e)?this._getBodyCache.get(e):!this.indicatorsAsCol&&this._getBodyCache.has(t)?this._getBodyCache.get(t):void 0}setBodyWidthCache(e,t,n){!this._useGetBodyCache||this.isHeader(e,t)||this.isSeriesNumber(e,t)||(this.indicatorsAsCol?this._getBodyCache.set(e,n):this._getBodyCache.set(t,n))}getColHeaderPathCache(e,t){if(this._useHeaderPathCache&&!this.isHeader(e,t)&&!this.isSeriesNumber(e,t)&&this._colHeaderPathCache.has(e))return this._colHeaderPathCache.get(e)}setColHeaderPathCache(e,t,n){!this._useHeaderPathCache||this.isHeader(e,t)||this.isSeriesNumber(e,t)||this._colHeaderPathCache.set(e,n)}getRowHeaderPathCache(e,t){if(this._useHeaderPathCache&&!this.isHeader(e,t)&&!this.isSeriesNumber(e,t)&&this._rowHeaderPathCache.has(t))return this._rowHeaderPathCache.get(t)}setRowHeaderPathCache(e,t,n){!this._useHeaderPathCache||this.isHeader(e,t)||this.isSeriesNumber(e,t)||this._rowHeaderPathCache.set(t,n)}}function jt(D,e,t,n){t===1&&(t=0);const i=oi(D,t,n),r=e/(1-t);return Math.ceil(i*r)}function oi(D,e,t){let n;return n=D===1?D+2*t:D-e+2*t,D?n>0?n:1:0}class _t{constructor(e,t){this.tree={},this.beforeChangedTree={},this.colFlatKeys={},this.rowFlatKeys={},this.stringJoinChar="\0",this.rowsIsTotal=[],this.colsIsTotal=[],this.dataConfig=e,t&&(this.records=t,typeof window<"u"&&window.performance.now(),this.setRecords(t),typeof window<"u"&&window.performance.now())}changeDataConfig(e){this.dataConfig=e}setRecords(e){this.processRecords()}processRecords(){for(let e=0,t=this.records.length;e<t;e++){const n=this.records[e];this.processRecord(n)}}processRecord(e){var t;const n=[],i=[];for(let r=0,l=this.dataConfig.rows.length;r<l;r++){const s=this.dataConfig.rows[r];e[s]!==void 0&&s!==this.dataConfig.indicatorDimensionKey&&i.push(e[s])}for(let r=0,l=this.dataConfig.columns.length;r<l;r++){const s=this.dataConfig.columns[r];e[s]!==void 0&&s!==this.dataConfig.indicatorDimensionKey&&n.push(e[s])}(t=this.dataConfig.indicators)===null||t===void 0||t.forEach(r=>{const l=e[r];l!==void 0&&(this.dataConfig.indicatorsAsCol?n.push(r):i.push(r));const s=i.join(this.stringJoinChar),o=n.join(this.stringJoinChar);i.length!==0&&(this.rowFlatKeys[s]||(this.rowFlatKeys[s]=1)),n.length!==0&&(this.colFlatKeys[o]||(this.colFlatKeys[o]=1)),n.length===0&&i.length===0||(this.tree[s]||(this.tree[s]={}),l!==void 0&&(this.tree[s][o]={value:l,record:e},this.dataConfig.indicatorsAsCol?n.pop():i.pop()))})}getTreeNode(e=[],t=[],n,i=!0){var r,l,s,o;let a,d;if(typeof e=="string")a=e;else{let h=!1;e.map((c,u)=>{c===n&&(e.splice(u,1),h=!0)}),h&&e.push(n),a=e.join(this.stringJoinChar)}if(typeof t=="string")d=t;else{let h=!1;t.map((c,u)=>{c===n&&(t.splice(u,1),h=!0)}),h&&t.push(n),d=t.join(this.stringJoinChar)}return i?(s=(l=(r=this.tree)===null||r===void 0?void 0:r[a])===null||l===void 0?void 0:l[d])!==null&&s!==void 0?s:void 0:L((o=this.beforeChangedTree[a])===null||o===void 0?void 0:o[d])?{value:this.beforeChangedTree[a][d].value,record:this.beforeChangedTree[a][d].record}:void 0}changeTreeNodeValue(e=[],t=[],n,i){var r,l,s,o,a,d,h;let c,u;if(typeof e=="string")c=e;else{let m=!1;e.map((y,w)=>{y===n&&(e.splice(w,1),m=!0)}),m&&e.push(n),c=e.join(this.stringJoinChar)}if(typeof t=="string")u=t;else{let m=!1;t.map((y,w)=>{y===n&&(t.splice(w,1),m=!0)}),m&&t.push(n),u=t.join(this.stringJoinChar)}const f=(l=(r=this.tree[c])===null||r===void 0?void 0:r[u])===null||l===void 0?void 0:l.value,g=Object.assign({},(o=(s=this.tree[c])===null||s===void 0?void 0:s[u])===null||o===void 0?void 0:o.record);!((d=(a=this.tree[c])===null||a===void 0?void 0:a[u])===null||d===void 0)&&d.record?(this.tree[c][u].record[n]=i,this.tree[c][u].value=i):(this.tree[c]||(this.tree[c]={}),this.tree[c][u]={record:this._buildRecord(e,t,n,i),value:i}),!((h=this.beforeChangedTree[c])===null||h===void 0)&&h[u]||(this.beforeChangedTree[c]={},this.beforeChangedTree[c][u]={record:void 0,value:void 0},this.beforeChangedTree[c][u].record=g,this.beforeChangedTree[c][u].value=f)}_buildRecord(e=[],t=[],n,i){const r={},l=this.dataConfig.rows,s=this.dataConfig.columns;return l.forEach((o,a)=>{o!==this.dataConfig.indicatorDimensionKey&&(r[o]=e[a])}),s.forEach((o,a)=>{o!==this.dataConfig.indicatorDimensionKey&&(r[o]=t[a])}),r[n]=i,this.records.push(r),r}addRecords(e){for(let t=0,n=e.length;t<n;t++){const i=e[t];this.processRecord(i)}this.records.push(e)}changeRecordFieldValue(e,t,n){let i=!1;for(let r=0;r<this.dataConfig.indicators.length;r++)this.dataConfig.indicators[r]===e&&(i=!0);if(!i){for(let r=0,l=this.records.length;r<l;r++){const s=this.records[r];s[e]===t&&(s[e]=n)}this.rowFlatKeys={},this.colFlatKeys={},this.tree={},this.processRecords()}}}function Wt(D,e){let t="";for(let n=0;n<D.length;n++)t+=D[n],n!==D.length-1&&(t+=e);return t}class ht{constructor(e,t,n,i,r,l,s,o,a,d,h,c,u){var f,g,m,y,w,S,b,_,p,I,H,C,P,T,v,A,F,B,Q,J,U,$,se,le,oe,de,ae,ue,he,Ce,Te,Pe,Se,be,ve,Ie,Re,ee;this.tree={},this.changedTree={},this.colFlatKeys={},this.rowFlatKeys={},this.colKeys=[],this.rowKeys=[],this.colKeys_normal=[],this.rowKeys_normal=[],this.rowOrder="key_a_to_z",this.colOrder="key_a_to_z",this.sorted=!1,this.indicatorStatistics=[],this.stringJoinChar="\0",this.rowsIsTotal=[],this.colsIsTotal=[],this.collectedValues={},this.cacheCollectedValues={},this.totalRecordsTree={},this.registerAggregators(),this.dataConfig=e,this.filterRules=(f=this.dataConfig)===null||f===void 0?void 0:f.filterRules,this.rowHierarchyType=o??"grid",this.sortRules=(g=this.dataConfig)===null||g===void 0?void 0:g.sortRules,this.aggregationRules=(m=this.dataConfig)===null||m===void 0?void 0:m.aggregationRules,this.derivedFieldRules=(y=this.dataConfig)===null||y===void 0?void 0:y.derivedFieldRules,this.mappingRules=(w=this.dataConfig)===null||w===void 0?void 0:w.mappingRules,this.calculatedFieldRules=(S=this.dataConfig)===null||S===void 0?void 0:S.calculatedFieldRules,this.calculatedFiledKeys=(_=(b=this.calculatedFieldRules)===null||b===void 0?void 0:b.map(j=>j.key))!==null&&_!==void 0?_:[],this.calculatedFieldDependIndicatorKeys=(I=(p=this.calculatedFieldRules)===null||p===void 0?void 0:p.reduce((j,q)=>{for(let G=0;G<q.dependIndicatorKeys.length;G++)j.indexOf(q.dependIndicatorKeys[G])===-1&&j.push(q.dependIndicatorKeys[G]);return j},[]))!==null&&I!==void 0?I:[],this.totals=(H=this.dataConfig)===null||H===void 0?void 0:H.totals,this.rows=t,this.columns=n,this.indicatorKeys=i,this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys=[...i];for(let j=0;j<this.calculatedFieldDependIndicatorKeys.length;j++)this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys.indexOf(this.calculatedFieldDependIndicatorKeys[j])===-1&&this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys.push(this.calculatedFieldDependIndicatorKeys[j]);if(this.indicatorsAsCol=l,this.indicators=r,this.customColTree=a,this.customRowTree=d,this.hasExtensionRowTree=c,this.parseCustomTreeToMatchRecords=u,this.parseCustomTreeToMatchRecords&&(this.customColTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customColTree,"col"),this.hasExtensionRowTree||(this.customRowTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customRowTree,"row"))),this.colGrandTotalLabel=(T=(P=(C=this.totals)===null||C===void 0?void 0:C.column)===null||P===void 0?void 0:P.grandTotalLabel)!==null&&T!==void 0?T:"总计",this.colSubTotalLabel=(F=(A=(v=this.totals)===null||v===void 0?void 0:v.column)===null||A===void 0?void 0:A.subTotalLabel)!==null&&F!==void 0?F:"小计",this.rowGrandTotalLabel=(J=(Q=(B=this.totals)===null||B===void 0?void 0:B.row)===null||Q===void 0?void 0:Q.grandTotalLabel)!==null&&J!==void 0?J:"总计",this.rowSubTotalLabel=(se=($=(U=this.totals)===null||U===void 0?void 0:U.row)===null||$===void 0?void 0:$.subTotalLabel)!==null&&se!==void 0?se:"小计",this.collectValuesBy=(le=this.dataConfig)===null||le===void 0?void 0:le.collectValuesBy,this.needSplitPositiveAndNegative=h!=null&&h,this.rowsIsTotal=new Array((de=(oe=this.rows)===null||oe===void 0?void 0:oe.length)!==null&&de!==void 0?de:0).fill(!1),this.colsIsTotal=new Array((ue=(ae=this.columns)===null||ae===void 0?void 0:ae.length)!==null&&ue!==void 0?ue:0).fill(!1),((he=this.totals)===null||he===void 0?void 0:he.row)&&this.totals.row.showSubTotals!==!1&&this.totals.row.subTotalsDimensions)for(let j=0,q=(Se=(Pe=(Te=(Ce=this.totals)===null||Ce===void 0?void 0:Ce.row)===null||Te===void 0?void 0:Te.subTotalsDimensions)===null||Pe===void 0?void 0:Pe.length)!==null&&Se!==void 0?Se:0;j<q;j++){const G=this.totals.row.subTotalsDimensions[j],fe=this.rows.indexOf(G);this.rowsIsTotal[fe]=!0}if(!((be=this.totals)===null||be===void 0)&&be.column&&this.totals.column.showSubTotals!==!1&&this.totals.column.subTotalsDimensions)for(let j=0,q=(ee=(Re=(Ie=(ve=this.totals)===null||ve===void 0?void 0:ve.column)===null||Ie===void 0?void 0:Ie.subTotalsDimensions)===null||Re===void 0?void 0:Re.length)!==null&&ee!==void 0?ee:0;j<q;j++){const G=this.totals.column.subTotalsDimensions[j],fe=this.columns.indexOf(G);this.colsIsTotal[fe]=!0}this.setRecords(s)}setRecords(e){var t,n,i,r,l,s,o,a,d,h,c,u,f,g,m,y,w,S,b;this.records=e,this.collectedValues={},this.cacheCollectedValues={},this.totalRecordsTree={},this.tree={},this.colFlatKeys={},this.rowFlatKeys={},this.colKeys=[],this.rowKeys=[],this.rowsHasValue=[],this.columnsHasValue=[],this.sorted=!1,e&&(this.records=e,typeof window<"u"&&window.performance.now(),this.processRecords(),this.processCollectedValuesWithSumBy(),this.generateCollectedValuesSortRule(),this.processCollectedValuesWithSortBy(),typeof window<"u"&&window.performance.now(),typeof window<"u"&&window.performance.now(),this.totalStatistics(),typeof window<"u"&&window.performance.now(),this.rowKeys_normal=this.rowKeys.slice(),this.colKeys_normal=this.colKeys.slice(),typeof window<"u"&&window.performance.now(),this.sortKeys(),typeof window<"u"&&window.performance.now(),typeof window<"u"&&window.performance.now(),this.customRowTree?this.rowHeaderTree=this.customRowTree:this.rowHierarchyType==="tree"?this.rowHeaderTree=this.ArrToTree1(this.rowKeys,this.rows.filter((_,p)=>this.rowsHasValue[p]),this.indicatorsAsCol?void 0:this.indicators,((n=(t=this.totals)===null||t===void 0?void 0:t.row)===null||n===void 0?void 0:n.showGrandTotals)||!this.indicatorsAsCol&&this.columns.length===0||this.indicatorsAsCol&&this.rows.length===0,this.rowGrandTotalLabel):this.rowHeaderTree=this.ArrToTree(this.rowKeys,this.rows.filter((_,p)=>this.rowsHasValue[p]),this.indicatorsAsCol?void 0:this.indicators,this.rowsIsTotal,((r=(i=this.totals)===null||i===void 0?void 0:i.row)===null||r===void 0?void 0:r.showGrandTotals)||this.indicatorsAsCol&&this.rows.length===0,this.rowGrandTotalLabel,this.rowSubTotalLabel,(o=(s=(l=this.totals)===null||l===void 0?void 0:l.row)===null||s===void 0?void 0:s.showGrandTotalsOnTop)!==null&&o!==void 0&&o,(h=(d=(a=this.totals)===null||a===void 0?void 0:a.row)===null||d===void 0?void 0:d.showSubTotalsOnTop)!==null&&h!==void 0&&h),this.customColTree?this.colHeaderTree=this.customColTree:this.colHeaderTree=this.ArrToTree(this.colKeys,this.columns.filter((_,p)=>this.columnsHasValue[p]),this.indicatorsAsCol?this.indicators:void 0,this.colsIsTotal,((u=(c=this.totals)===null||c===void 0?void 0:c.column)===null||u===void 0?void 0:u.showGrandTotals)||!this.indicatorsAsCol&&this.columns.length===0,this.colGrandTotalLabel,this.colSubTotalLabel,(m=(g=(f=this.totals)===null||f===void 0?void 0:f.column)===null||g===void 0?void 0:g.showGrandTotalsOnLeft)!==null&&m!==void 0&&m,(S=(w=(y=this.totals)===null||y===void 0?void 0:y.column)===null||w===void 0?void 0:w.showSubTotalsOnLeft)!==null&&S!==void 0&&S),typeof window<"u"&&window.performance.now(),!((b=this.dataConfig)===null||b===void 0)&&b.isPivotChart&&this.cacheDeminsionCollectedValues())}registerAggregator(e,t){He[e]=t}registerAggregators(){this.registerAggregator(Z.RECORD,Mn),this.registerAggregator(Z.SUM,En),this.registerAggregator(Z.COUNT,On),this.registerAggregator(Z.MAX,Nn),this.registerAggregator(Z.MIN,Bn),this.registerAggregator(Z.AVG,zn),this.registerAggregator(Z.NONE,Vn),this.registerAggregator(Z.RECALCULATE,kn),this.registerAggregator(Z.CUSTOM,jn)}processCollectedValuesWithSumBy(){var e,t,n,i,r,l;for(const s in this.collectedValues)if(!((t=(e=this.collectValuesBy)===null||e===void 0?void 0:e[s])===null||t===void 0)&&t.sumBy)for(const o in this.collectedValues[s]){let a;((n=this.collectValuesBy[s])===null||n===void 0?void 0:n.extendRange)==="sum"?(a=Object.values(this.collectedValues[s][o]).reduce((u,f)=>u+f.value(),0),a+=Math.round(a/20)):(a=Object.values(this.collectedValues[s][o]).reduce((u,f)=>f.value()>u?f.value():u,Number.MIN_SAFE_INTEGER),((i=this.collectValuesBy[s])===null||i===void 0?void 0:i.extendRange)==="max"?a+=Math.round(a/20):typeof((r=this.collectValuesBy[s])===null||r===void 0?void 0:r.extendRange)=="number"&&(a=Math.max(a,(l=this.collectValuesBy[s])===null||l===void 0?void 0:l.extendRange)));const d=Object.values(this.collectedValues[s][o]).reduce((u,f)=>f.value()<u?f.value():u,Number.MAX_SAFE_INTEGER);let h,c;this.needSplitPositiveAndNegative&&(h=Object.values(this.collectedValues[s][o]).reduce((u,f)=>f.positiveValue()>u?f.positiveValue():u,Number.MIN_SAFE_INTEGER),c=Object.values(this.collectedValues[s][o]).reduce((u,f)=>f.negativeValue()<u?f.negativeValue():u,Number.MAX_SAFE_INTEGER)),this.collectedValues[s][o]={},this.collectedValues[s][o].max=a,this.collectedValues[s][o].min=d,this.needSplitPositiveAndNegative&&(this.collectedValues[s][o].positiveMax=h,this.collectedValues[s][o].negativeMin=c)}}processCollectedValuesWithSortBy(){var e,t;const n=this;for(const i in this.collectedValues)if(!((t=(e=this.collectValuesBy)===null||e===void 0?void 0:e[i])===null||t===void 0)&&t.sortBy)for(const r in this.collectedValues[i])this.collectedValues[i][r]=this.collectedValues[i][r].sort((l,s)=>{var o,a,d,h;return((a=(o=n.collectValuesBy[i].sortBy)===null||o===void 0?void 0:o.indexOf(l))!==null&&a!==void 0?a:-1)-((h=(d=n.collectValuesBy[i].sortBy)===null||d===void 0?void 0:d.indexOf(s))!==null&&h!==void 0?h:-1)})}generateCollectedValuesSortRule(){for(const e in this.collectedValues)if(this.collectValuesBy&&this.collectValuesBy[e]&&!this.collectValuesBy[e].sortBy){let t=[];for(const n in this.collectedValues[e])Array.isArray(this.collectedValues[e][n])&&(t.push(...this.collectedValues[e][n]),t=Array.from(new Set(t)));t.length>0&&(this.collectValuesBy[e].sortBy=t)}}processRecords(){var e,t;let n=!1;if(((t=(e=this.filterRules)===null||e===void 0?void 0:e.length)!==null&&t!==void 0?t:0)>=1&&(n=!0),Array.isArray(this.records)){this.filteredRecords||(this.filteredRecords=[]);for(let i=0,r=this.records.length;i<r;i++){const l=this.records[i];n&&!this.filterRecord(l)||(this.filteredRecords.push(l),this.processRecord(l))}}else{this.filteredRecords||(this.filteredRecords={});for(const i in this.records)for(let r=0,l=this.records[i].length;r<l;r++){const s=this.records[i][r];n&&!this.filterRecord(s)||(this.filteredRecords[i]||(this.filteredRecords[i]=[]),this.filteredRecords[i].push(s),this.processRecord(s,i))}}this.rowFlatKeys={},this.colFlatKeys={}}filterRecord(e){var t,n;let i=!0;if(this.filterRules)for(let r=0;r<this.filterRules.length;r++){const l=this.filterRules[r];if(l.filterKey){const s=e[l.filterKey];if(((t=l.filteredValues)===null||t===void 0?void 0:t.indexOf(s))===-1){i=!1;break}}else if(!(!((n=l.filterFunc)===null||n===void 0)&&n.call(l,e))){i=!1;break}}return i}processRecord(e,t){var n,i,r,l,s,o,a,d,h,c,u,f,g,m,y,w,S,b,_,p,I,H,C,P,T,v,A,F,B,Q,J,U,$,se,le,oe,de,ae,ue,he,Ce,Te,Pe,Se,be,ve,Ie,Re,ee,j,q,G,fe,ye,me,ie,pe,De,Ve,ke,je,We,Ue,qe,Ge,Qe;(n=this.derivedFieldRules)===null||n===void 0||n.forEach((R,E)=>{R.fieldName&&R.derivedFunc&&(e[R.fieldName]=R.derivedFunc(e))});for(const R in this.collectValuesBy)if(L(e[R])){this.collectedValues[R]||(this.collectedValues[R]={});const E=this.collectValuesBy[R].by.map(W=>e[W]).join(this.stringJoinChar);if(this.collectedValues[R][E]||(this.collectValuesBy[R].sumBy?this.collectedValues[R][E]={}:this.collectValuesBy[R].range?this.collectedValues[R][E]={min:Number.MAX_SAFE_INTEGER,max:Number.MIN_SAFE_INTEGER}:this.collectedValues[R][E]=[]),this.collectValuesBy[R].sumBy){const W=(i=this.collectValuesBy[R].sumBy)===null||i===void 0?void 0:i.map(k=>e[k]).join(this.stringJoinChar);this.collectedValues[R][E][W]||(this.collectedValues[R][E][W]=new He[Z.SUM]({key:R,field:R,isRecord:void 0,needSplitPositiveAndNegative:this.needSplitPositiveAndNegative})),this.collectedValues[R][E][W].push(e)}else if(this.collectValuesBy[R].range){const W=this.collectedValues[R][E],k=Math.max(e[R],W.max),te=Math.min(e[R],W.min);isNaN(k)||(W.max=k,W.min=te)}else{const W=this.collectedValues[R][E];W.indexOf(e[R])===-1&&W.push(e[R])}}let Je=!1;const re=[],_e=[];if(!this.parseCustomTreeToMatchRecords||!((r=this.dataConfig)===null||r===void 0)&&r.isPivotChart||!(!((l=this.customRowTree)===null||l===void 0)&&l.length)||t||this.hasExtensionRowTree){const R=[];_e.push({rowKey:R,indicatorKey:t});for(let E=0,W=this.rows.length;E<W;E++){const k=this.rows[E];if(k in e)this.rowsHasValue[E]=!0,R.push(e[k]);else if(k!==Oe){if(!((a=(o=(s=this.dataConfig)===null||s===void 0?void 0:s.totals)===null||o===void 0?void 0:o.row)===null||a===void 0)&&a.showGrandTotals&&E===0&&!this.rows.find(te=>te in e)){R.push(this.rowGrandTotalLabel),Je=!0;break}if(!((c=(h=(d=this.dataConfig)===null||d===void 0?void 0:d.totals)===null||h===void 0?void 0:h.row)===null||c===void 0)&&c.subTotalsDimensions&&((g=(f=(u=this.dataConfig)===null||u===void 0?void 0:u.totals)===null||f===void 0?void 0:f.row)===null||g===void 0?void 0:g.subTotalsDimensions.indexOf(this.rows[E-1]))>=0){this.rowHierarchyType==="grid"&&R.push(this.rowSubTotalLabel),Je=!0;break}}}}else{const R=this.getFieldMatchRowDimensionPaths(e);if(R.length>0)for(let E=0,W=R.length;E<W;E++){const k=R[E],te=[];let x;for(let z=0,ne=k.length;z<ne;z++)L(k[z].indicatorKey)?x=k[z].indicatorKey:te.push(k[z].value);_e.push({rowKey:te,indicatorKey:x})}}if(!this.parseCustomTreeToMatchRecords||!((m=this.dataConfig)===null||m===void 0)&&m.isPivotChart||!(!((y=this.customColTree)===null||y===void 0)&&y.length)||t||this.hasExtensionRowTree){const R=[];re.push({colKey:R,indicatorKey:t});for(let E=0,W=this.columns.length;E<W;E++){const k=this.columns[E];if(k in e)this.columnsHasValue[E]=!0,R.push(e[k]);else if(k!==Oe){if(!((b=(S=(w=this.dataConfig)===null||w===void 0?void 0:w.totals)===null||S===void 0?void 0:S.column)===null||b===void 0)&&b.showGrandTotals&&E===0&&!this.columns.find(te=>te in e)){R.push(this.colGrandTotalLabel),Je=!0;break}if(!((I=(p=(_=this.dataConfig)===null||_===void 0?void 0:_.totals)===null||p===void 0?void 0:p.column)===null||I===void 0)&&I.subTotalsDimensions&&((P=(C=(H=this.dataConfig)===null||H===void 0?void 0:H.totals)===null||C===void 0?void 0:C.column)===null||P===void 0?void 0:P.subTotalsDimensions.indexOf(this.columns[E-1]))>=0){R.push(this.colSubTotalLabel),Je=!0;break}}}}else{const R=this.getFieldMatchColDimensionPaths(e);if(R.length>0)for(let E=0,W=R.length;E<W;E++){const k=R[E],te=[];let x;for(let z=0,ne=k.length;z<ne;z++)L(k[z].indicatorKey)?x=k[z].indicatorKey:te.push(k[z].value);re.push({colKey:te,indicatorKey:x})}}for(let R=0;R<_e.length;R++){const E=_e[R].rowKey;let W;this.indicatorsAsCol||(W=_e[R].indicatorKey);for(let k=0;k<re.length;k++){const te=re[k].colKey;this.indicatorsAsCol&&(W=re[k].indicatorKey);const x=E.join(this.stringJoinChar),z=te.join(this.stringJoinChar);if(Je){this.totalRecordsTree[x]||(this.totalRecordsTree[x]={}),this.totalRecordsTree[x][z]||(this.totalRecordsTree[x][z]=[]);const M=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let O=0;O<M.length;O++)if(this.calculatedFiledKeys.indexOf(M[O])>=0){const Y=(T=this.calculatedFieldRules)===null||T===void 0?void 0:T.find(Ke=>Ke.key===M[O]);!((A=(v=this.totalRecordsTree[x])===null||v===void 0?void 0:v[z])===null||A===void 0)&&A[O]||(this.totalRecordsTree[x][z][O]=new He[Z.RECALCULATE]({key:M[O],field:M[O],isRecord:!0,formatFun:(B=(F=this.indicators)===null||F===void 0?void 0:F.find(Ke=>typeof Ke!="string"&&Ke.indicatorKey===M[O]))===null||B===void 0?void 0:B.format,calculateFun:Y==null?void 0:Y.calculateFun,dependAggregators:this.totalRecordsTree[x][z],dependIndicatorKeys:Y==null?void 0:Y.dependIndicatorKeys})),M[O]in e&&((J=(Q=this.totalRecordsTree[x])===null||Q===void 0?void 0:Q[z])===null||J===void 0||J[O].push(e))}else{const Y=this.getAggregatorRule(M[O]);!(($=(U=this.totalRecordsTree[x])===null||U===void 0?void 0:U[z])===null||$===void 0)&&$[O]||(this.totalRecordsTree[x][z][O]=new He[(se=Y==null?void 0:Y.aggregationType)!==null&&se!==void 0?se:Z.SUM]({key:M[O],field:(le=Y==null?void 0:Y.field)!==null&&le!==void 0?le:M[O],aggregationFun:Y==null?void 0:Y.aggregationFun,formatFun:(oe=Y==null?void 0:Y.formatFun)!==null&&oe!==void 0?oe:(ae=(de=this.indicators)===null||de===void 0?void 0:de.find(Ke=>typeof Ke!="string"&&Ke.indicatorKey===M[O]))===null||ae===void 0?void 0:ae.format})),M[O]in e&&((he=(ue=this.totalRecordsTree[x])===null||ue===void 0?void 0:ue[z])===null||he===void 0||he[O].push(e))}return}E.length!==0&&(this.rowFlatKeys[x]||(this.rowKeys.push(E),this.rowFlatKeys[x]=1)),te.length!==0&&(this.colFlatKeys[z]||(this.colKeys.push(te),this.colFlatKeys[z]=1)),this.tree[x]||(this.tree[x]={}),!((Ce=this.tree[x])===null||Ce===void 0)&&Ce[z]||(this.tree[x][z]=[]);const ne=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let M=0;M<ne.length;M++)if(this.calculatedFiledKeys.indexOf(ne[M])>=0){const O=(Te=this.calculatedFieldRules)===null||Te===void 0?void 0:Te.find(Y=>Y.key===ne[M]);!((Se=(Pe=this.tree[x])===null||Pe===void 0?void 0:Pe[z])===null||Se===void 0)&&Se[M]||(this.tree[x][z][M]=new He[Z.RECALCULATE]({key:ne[M],field:ne[M],isRecord:!0,formatFun:(ve=(be=this.indicators)===null||be===void 0?void 0:be.find(Y=>typeof Y!="string"&&Y.indicatorKey===ne[M]))===null||ve===void 0?void 0:ve.format,calculateFun:O==null?void 0:O.calculateFun,dependAggregators:this.tree[x][z],dependIndicatorKeys:O==null?void 0:O.dependIndicatorKeys})),(Re=(Ie=this.tree[x])===null||Ie===void 0?void 0:Ie[z])===null||Re===void 0||Re[M].push(e)}else{const O=this.getAggregatorRule(ne[M]);let Y=!1;W?t===W?ne[M]===W&&(Y=!0):ne[M]===W&&ne[M]in e&&(Y=!0):O!=null&&O.field?typeof(O==null?void 0:O.field)=="string"?(O==null?void 0:O.field)in e&&(Y=!0):O!=null&&O.field.find(Ke=>Ke in e)&&(Y=!0):ne[M]in e&&(Y=!0),!(!((j=(ee=this.tree[x])===null||ee===void 0?void 0:ee[z])===null||j===void 0)&&j[M])&&Y&&(this.tree[x][z][M]=new He[(q=O==null?void 0:O.aggregationType)!==null&&q!==void 0?q:Z.SUM]({key:ne[M],field:(G=O==null?void 0:O.field)!==null&&G!==void 0?G:ne[M],aggregationFun:O==null?void 0:O.aggregationFun,formatFun:(fe=O==null?void 0:O.formatFun)!==null&&fe!==void 0?fe:(me=(ye=this.indicators)===null||ye===void 0?void 0:ye.find(Ke=>typeof Ke!="string"&&Ke.indicatorKey===ne[M]))===null||me===void 0?void 0:me.format})),Y&&((pe=(ie=this.tree[x])===null||ie===void 0?void 0:ie[z])===null||pe===void 0||pe[M].push(e))}if(this.mappingRules)for(let M=0;M<this.indicatorKeys.length;M++){if(!this.indicatorStatistics[M]){const O=this.getAggregatorRule(this.indicatorKeys[M]);this.indicatorStatistics[M]={max:new He[Z.MAX]({key:this.indicatorKeys[M],field:this.indicatorKeys[M]}),min:new He[Z.MIN]({key:this.indicatorKeys[M],field:this.indicatorKeys[M]}),total:new He[(De=O==null?void 0:O.aggregationType)!==null&&De!==void 0?De:Z.SUM]({key:this.indicatorKeys[M],field:(Ve=O==null?void 0:O.field)!==null&&Ve!==void 0?Ve:this.indicatorKeys[M],aggregationFun:O==null?void 0:O.aggregationFun,formatFun:(ke=O==null?void 0:O.formatFun)!==null&&ke!==void 0?ke:(We=(je=this.indicators)===null||je===void 0?void 0:je.find(Y=>typeof Y!="string"&&Y.indicatorKey===this.indicatorKeys[M]))===null||We===void 0?void 0:We.format})}}this.indicatorStatistics[M].max.push((qe=(Ue=this.tree[x])===null||Ue===void 0?void 0:Ue[z])===null||qe===void 0?void 0:qe[M].value()),this.indicatorStatistics[M].min.push((Qe=(Ge=this.tree[x])===null||Ge===void 0?void 0:Ge[z])===null||Qe===void 0?void 0:Qe[M].value()),this.indicatorStatistics[M].total.push(e)}}}}updateSortRules(e){var t,n,i,r,l,s,o,a,d,h,c,u,f,g,m,y,w,S;this.sorted=!1,this.sortRules=e,this.sortKeys(),this.customRowTree||(this.rowHierarchyType==="tree"?this.rowHeaderTree=this.ArrToTree1(this.rowKeys,this.rows.filter((b,_)=>this.rowsHasValue[_]),this.indicatorsAsCol?void 0:this.indicators,((n=(t=this.totals)===null||t===void 0?void 0:t.row)===null||n===void 0?void 0:n.showGrandTotals)||!this.indicatorsAsCol&&this.columns.length===0||this.indicatorsAsCol&&this.rows.length===0,this.rowGrandTotalLabel):this.rowHeaderTree=this.ArrToTree(this.rowKeys,this.rows.filter((b,_)=>this.rowsHasValue[_]),this.indicatorsAsCol?void 0:this.indicators,this.rowsIsTotal,((r=(i=this.totals)===null||i===void 0?void 0:i.row)===null||r===void 0?void 0:r.showGrandTotals)||this.indicatorsAsCol&&this.rows.length===0,this.rowGrandTotalLabel,this.rowSubTotalLabel,(o=(s=(l=this.totals)===null||l===void 0?void 0:l.row)===null||s===void 0?void 0:s.showGrandTotalsOnTop)!==null&&o!==void 0&&o,(h=(d=(a=this.totals)===null||a===void 0?void 0:a.row)===null||d===void 0?void 0:d.showSubTotalsOnTop)!==null&&h!==void 0&&h)),this.customColTree||(this.colHeaderTree=this.ArrToTree(this.colKeys,this.columns.filter((b,_)=>this.columnsHasValue[_]),this.indicatorsAsCol?this.indicators:void 0,this.colsIsTotal,((u=(c=this.totals)===null||c===void 0?void 0:c.column)===null||u===void 0?void 0:u.showGrandTotals)||!this.indicatorsAsCol&&this.columns.length===0,this.colGrandTotalLabel,this.colSubTotalLabel,(m=(g=(f=this.totals)===null||f===void 0?void 0:f.column)===null||g===void 0?void 0:g.showGrandTotalsOnLeft)!==null&&m!==void 0&&m,(S=(w=(y=this.totals)===null||y===void 0?void 0:y.column)===null||w===void 0?void 0:w.showSubTotalsOnLeft)!==null&&S!==void 0&&S))}updateFilterRules(e,t=!1){var n,i;if(this.filterRules=e,this.filteredRecords=void 0,t)this.tree={};else for(const r in this.tree)for(const l in this.tree[r])for(let s=0;s<this.tree[r][l].length;s++)(n=this.tree[r][l][s])===null||n===void 0||n.reset();this.collectedValues={},this.processRecords(),this.processCollectedValuesWithSumBy(),this.processCollectedValuesWithSortBy(),this.totalStatistics(),!((i=this.dataConfig)===null||i===void 0)&&i.isPivotChart&&this.cacheDeminsionCollectedValues()}getAggregatorRule(e){var t;return(t=this.aggregationRules)===null||t===void 0?void 0:t.find((n,i)=>e===n.indicatorKey)}getAggregator(e=[],t=[],n,i=!0,r){var l,s,o,a;const d=this.indicatorKeys.indexOf(n);let h,c;typeof e=="string"?h=e:(r&&r.position!=="row"||e.map((f,g)=>{f!==n||L(r==null?void 0:r.index)&&g!==r.index||e.splice(g,1)}),h=Wt(e,this.stringJoinChar)),typeof t=="string"?c=t:(r&&r.position!=="col"||t.map((f,g)=>{f!==n||L(r==null?void 0:r.index)&&g!==r.index||t.splice(g,1)}),c=Wt(t,this.stringJoinChar));const u=(s=(l=this.tree[h])===null||l===void 0?void 0:l[c])===null||s===void 0?void 0:s[d];if(i&&L((a=(o=this.changedTree[h])===null||o===void 0?void 0:o[c])===null||a===void 0?void 0:a[d])){const f=this.changedTree[h][c][d];return u?{value:()=>f,formatValue:u.formatValue,formatFun:u.formatFun,records:u.records,recalculate(){},push(){},deleteRecord(){},updateRecord(){},clearCacheValue(){},reset(){}}:{records:[],value:()=>f,push(){},deleteRecord(){},updateRecord(){},recalculate(){},formatValue:()=>f,clearCacheValue(){},reset(){}}}return u||{records:[],push(){},deleteRecord(){},updateRecord(){},recalculate(){},value:()=>null,clearCacheValue(){},reset(){}}}sortKeys(){if(this.colKeys=this.colKeys_normal.slice(),this.rowKeys=this.rowKeys_normal.slice(),!this.sorted){this.sorted=!0,this.rowKeys.sort(this.arrSort(this.rows,!0));const e=this.arrSort(this.columns,!1);this.colKeys.sort(e)}}arrSort(e,t){let n;const i=this,r=(function(l){const s=[];for(let o=0,a=e.length;o<a;o++)if(n=e[o],i.sortRules)for(let d=0,h=i.sortRules.length;d<h;d++)i.sortRules[d].sortField===n&&s.push({field:n,fieldIndex:o,sortRule:i.sortRules[d],func:i.getSort(i.sortRules[d],t)});return s}).call(this);return function(l,s){var o,a,d,h;let c,u;for(let f=0;f<r.length;f++){if(u=r[f],(o=u.sortRule)===null||o===void 0?void 0:o.sortByIndicator){let g=l,m=s;u.fieldIndex<e.length-1&&(g=l.slice(0,u.fieldIndex+1),i.rowHierarchyType==="grid"&&t?g.push(i.rowSubTotalLabel):t||g.push(i.colSubTotalLabel),m=s.slice(0,u.fieldIndex+1),i.rowHierarchyType==="grid"&&t?m.push(i.rowSubTotalLabel):t||m.push(i.colSubTotalLabel)),c=u.func(g,m,(a=u.sortRule)===null||a===void 0?void 0:a.sortType)}else c=(d=u.func)===null||d===void 0?void 0:d.call(u,l[u.fieldIndex],s[u.fieldIndex],(h=u.sortRule)===null||h===void 0?void 0:h.sortType);if(c!==0)return c}return 0}}getSort(e,t){const n=this;return e.sortByIndicator?(i,r,l)=>{const s=function(o,a){return n.rowHierarchyType==="grid"&&o.length<n.rows.length&&o[o.length-1]!==n.rowSubTotalLabel&&o[o.length-1]!==n.rowGrandTotalLabel&&o.push(n.rowSubTotalLabel),a.length<n.columns.length&&a[a.length-1]!==n.colSubTotalLabel&&a[a.length-1]!==n.colGrandTotalLabel&&a.push(n.colSubTotalLabel),n.getAggregator(o,a,e.sortByIndicator).value()};return t?pt(s(i,e.query),s(r,e.query),l):pt(s(e.query,i),s(e.query,r),l)}:e.sortBy?Wn(e.sortBy):e.sortFunc?e.sortFunc:e.sortType?Un:pt}totalStatistics(){var e,t,n,i,r,l,s,o,a,d,h,c,u,f;const g=this,m=(y,w)=>{var S,b,_,p,I,H,C,P,T,v,A,F,B,Q,J,U,$,se,le,oe,de,ae,ue,he,Ce,Te,Pe,Se,be,ve,Ie,Re,ee,j,q,G,fe,ye,me,ie,pe,De,Ve,ke,je,We,Ue,qe,Ge,Qe;if(!((b=(S=this.totalRecordsTree)===null||S===void 0?void 0:S[y])===null||b===void 0)&&b[w])return this.tree[y]||(this.tree[y]={}),void(this.tree[y][w]=(p=(_=this.totalRecordsTree)===null||_===void 0?void 0:_[y])===null||p===void 0?void 0:p[w]);const Je=w.split(this.stringJoinChar);if(!((H=(I=g.totals)===null||I===void 0?void 0:I.column)===null||H===void 0)&&H.subTotalsDimensions&&((T=(P=(C=g.totals)===null||C===void 0?void 0:C.column)===null||P===void 0?void 0:P.subTotalsDimensions)===null||T===void 0?void 0:T.length)>0&&g.totals.column.showSubTotals!==!1)for(let re=0,_e=(F=(A=(v=g.totals)===null||v===void 0?void 0:v.column)===null||A===void 0?void 0:A.subTotalsDimensions)===null||F===void 0?void 0:F.length;re<_e;re++){const R=g.totals.column.subTotalsDimensions[re],E=g.columns.indexOf(R);if(E>=0){const W=Je.slice(0,E+1);W.push(g.colSubTotalLabel);const k=W.join(this.stringJoinChar);if(!((Q=(B=this.totalRecordsTree)===null||B===void 0?void 0:B[y])===null||Q===void 0)&&Q[k])return void(this.tree[y][k]=(U=(J=this.totalRecordsTree)===null||J===void 0?void 0:J[y])===null||U===void 0?void 0:U[k]);this.tree[y][k]||(this.tree[y][k]=[]);const te=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let x=0;x<te.length;x++)if(this.calculatedFiledKeys.indexOf(te[x])>=0){const z=($=this.calculatedFieldRules)===null||$===void 0?void 0:$.find(ne=>ne.key===te[x]);!((le=(se=this.tree[y])===null||se===void 0?void 0:se[k])===null||le===void 0)&&le[x]||(this.tree[y][k][x]=new He[Z.RECALCULATE]({key:te[x],field:te[x],isRecord:!0,formatFun:(de=(oe=this.indicators)===null||oe===void 0?void 0:oe.find(ne=>typeof ne!="string"&&ne.indicatorKey===te[x]))===null||de===void 0?void 0:de.format,calculateFun:z==null?void 0:z.calculateFun,dependAggregators:this.tree[y][k],dependIndicatorKeys:z==null?void 0:z.dependIndicatorKeys})),k!==w&&this.tree[y][k][x].push((ue=(ae=g.tree[y])===null||ae===void 0?void 0:ae[w])===null||ue===void 0?void 0:ue[x])}else{if(!this.tree[y][k][x]){const z=this.getAggregatorRule(te[x]);this.tree[y][k][x]=new He[(he=z==null?void 0:z.aggregationType)!==null&&he!==void 0?he:Z.SUM]({key:te[x],field:(Ce=z==null?void 0:z.field)!==null&&Ce!==void 0?Ce:te[x],aggregationFun:z==null?void 0:z.aggregationFun,formatFun:(Te=z==null?void 0:z.formatFun)!==null&&Te!==void 0?Te:(Se=(Pe=this.indicators)===null||Pe===void 0?void 0:Pe.find(ne=>typeof ne!="string"&&ne.indicatorKey===te[x]))===null||Se===void 0?void 0:Se.format})}k!==w&&this.tree[y][k][x].push((ve=(be=g.tree[y])===null||be===void 0?void 0:be[w])===null||ve===void 0?void 0:ve[x])}}}if(!((Re=(Ie=g.totals)===null||Ie===void 0?void 0:Ie.column)===null||Re===void 0)&&Re.showGrandTotals||this.rows.length===0){const re=g.colGrandTotalLabel;if(!((j=(ee=this.totalRecordsTree)===null||ee===void 0?void 0:ee[y])===null||j===void 0)&&j[re])return void(this.tree[y][re]=(G=(q=this.totalRecordsTree)===null||q===void 0?void 0:q[y])===null||G===void 0?void 0:G[re]);this.tree[y][re]||(this.tree[y][re]=[]);const _e=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let R=0;R<_e.length;R++)if(this.calculatedFiledKeys.indexOf(_e[R])>=0){const E=(fe=this.calculatedFieldRules)===null||fe===void 0?void 0:fe.find(W=>W.key===_e[R]);!((me=(ye=this.tree[y])===null||ye===void 0?void 0:ye[re])===null||me===void 0)&&me[R]||(this.tree[y][re][R]=new He[Z.RECALCULATE]({key:_e[R],field:_e[R],isRecord:!0,formatFun:(pe=(ie=this.indicators)===null||ie===void 0?void 0:ie.find(W=>typeof W!="string"&&W.indicatorKey===_e[R]))===null||pe===void 0?void 0:pe.format,calculateFun:E==null?void 0:E.calculateFun,dependAggregators:this.tree[y][re],dependIndicatorKeys:E==null?void 0:E.dependIndicatorKeys})),re!==w&&this.tree[y][re][R].push((Ve=(De=g.tree[y])===null||De===void 0?void 0:De[w])===null||Ve===void 0?void 0:Ve[R])}else{if(!this.tree[y][re][R]){const E=this.getAggregatorRule(_e[R]);this.tree[y][re][R]=new He[(ke=E==null?void 0:E.aggregationType)!==null&&ke!==void 0?ke:Z.SUM]({key:_e[R],field:(je=E==null?void 0:E.field)!==null&&je!==void 0?je:_e[R],formatFun:(We=E==null?void 0:E.formatFun)!==null&&We!==void 0?We:(qe=(Ue=this.indicators)===null||Ue===void 0?void 0:Ue.find(W=>typeof W!="string"&&W.indicatorKey===_e[R]))===null||qe===void 0?void 0:qe.format})}re!==w&&this.tree[y][re][R].push((Qe=(Ge=g.tree[y])===null||Ge===void 0?void 0:Ge[w])===null||Qe===void 0?void 0:Qe[R])}}};if(!((t=(e=g==null?void 0:g.totals)===null||e===void 0?void 0:e.column)===null||t===void 0)&&t.subTotalsDimensions&&((r=(i=(n=g==null?void 0:g.totals)===null||n===void 0?void 0:n.column)===null||i===void 0?void 0:i.subTotalsDimensions)===null||r===void 0?void 0:r.length)>=1||!((s=(l=g==null?void 0:g.totals)===null||l===void 0?void 0:l.row)===null||s===void 0)&&s.subTotalsDimensions&&((d=(a=(o=g==null?void 0:g.totals)===null||o===void 0?void 0:o.row)===null||a===void 0?void 0:a.subTotalsDimensions)===null||d===void 0?void 0:d.length)>=1||!((c=(h=g==null?void 0:g.totals)===null||h===void 0?void 0:h.column)===null||c===void 0)&&c.showGrandTotals||!((f=(u=g==null?void 0:g.totals)===null||u===void 0?void 0:u.row)===null||f===void 0)&&f.showGrandTotals){const y=[];Object.keys(g.tree).forEach(w=>{const S=w.split(this.stringJoinChar);Object.keys(g.tree[w]).forEach(b=>{var _,p,I,H,C,P,T,v,A,F,B,Q,J,U,$,se,le,oe,de,ae,ue,he,Ce,Te,Pe,Se,be,ve,Ie,Re;if(!((p=(_=g.totals)===null||_===void 0?void 0:_.row)===null||p===void 0)&&p.subTotalsDimensions&&((C=(H=(I=g.totals)===null||I===void 0?void 0:I.row)===null||H===void 0?void 0:H.subTotalsDimensions)===null||C===void 0?void 0:C.length)>0&&g.totals.row.showSubTotals!==!1)for(let ee=0,j=(v=(T=(P=g.totals)===null||P===void 0?void 0:P.row)===null||T===void 0?void 0:T.subTotalsDimensions)===null||v===void 0?void 0:v.length;ee<j;ee++){const q=g.totals.row.subTotalsDimensions[ee],G=g.rows.indexOf(q);if(G>=0&&G<g.rows.length-1){const fe=S.slice(0,G+1);this.rowHierarchyType==="grid"&&fe.push(g.rowSubTotalLabel);const ye=fe.join(this.stringJoinChar);this.tree[ye]||(this.tree[ye]={},y.push(ye)),this.tree[ye][b]||(this.tree[ye][b]=[]);const me=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let ie=0;ie<me.length;ie++){if(!this.tree[ye][b][ie])if(this.calculatedFiledKeys.indexOf(me[ie])>=0){const pe=(A=this.calculatedFieldRules)===null||A===void 0?void 0:A.find(De=>De.key===me[ie]);this.tree[ye][b][ie]=new He[Z.RECALCULATE]({key:me[ie],field:me[ie],isRecord:!0,formatFun:(B=(F=this.indicators)===null||F===void 0?void 0:F.find(De=>typeof De!="string"&&De.indicatorKey===me[ie]))===null||B===void 0?void 0:B.format,calculateFun:pe==null?void 0:pe.calculateFun,dependAggregators:this.tree[ye][b],dependIndicatorKeys:pe==null?void 0:pe.dependIndicatorKeys})}else{const pe=this.getAggregatorRule(me[ie]);this.tree[ye][b][ie]=new He[(Q=pe==null?void 0:pe.aggregationType)!==null&&Q!==void 0?Q:Z.SUM]({key:me[ie],field:(J=pe==null?void 0:pe.field)!==null&&J!==void 0?J:me[ie],formatFun:(U=pe==null?void 0:pe.formatFun)!==null&&U!==void 0?U:(se=($=this.indicators)===null||$===void 0?void 0:$.find(De=>typeof De!="string"&&De.indicatorKey===me[ie]))===null||se===void 0?void 0:se.format})}ye!==w&&this.tree[ye][b][ie].push((oe=(le=g.tree[w])===null||le===void 0?void 0:le[b])===null||oe===void 0?void 0:oe[ie])}}}if(!((ae=(de=g.totals)===null||de===void 0?void 0:de.row)===null||ae===void 0)&&ae.showGrandTotals||this.columns.length===0){const ee=g.rowGrandTotalLabel;this.tree[ee]||(this.tree[ee]={},y.push(ee)),this.tree[ee][b]||(this.tree[ee][b]=[]);const j=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let q=0;q<j.length;q++){if(!this.tree[ee][b][q])if(this.calculatedFiledKeys.indexOf(j[q])>=0){const G=(ue=this.calculatedFieldRules)===null||ue===void 0?void 0:ue.find(fe=>fe.key===j[q]);this.tree[ee][b][q]=new He[Z.RECALCULATE]({key:j[q],field:j[q],isRecord:!0,formatFun:(Ce=(he=this.indicators)===null||he===void 0?void 0:he.find(fe=>typeof fe!="string"&&fe.indicatorKey===j[q]))===null||Ce===void 0?void 0:Ce.format,calculateFun:G==null?void 0:G.calculateFun,dependAggregators:this.tree[ee][b],dependIndicatorKeys:G==null?void 0:G.dependIndicatorKeys})}else{const G=this.getAggregatorRule(j[q]);this.tree[ee][b][q]=new He[(Te=G==null?void 0:G.aggregationType)!==null&&Te!==void 0?Te:Z.SUM]({key:j[q],field:(Pe=G==null?void 0:G.field)!==null&&Pe!==void 0?Pe:j[q],formatFun:(Se=G==null?void 0:G.formatFun)!==null&&Se!==void 0?Se:(ve=(be=this.indicators)===null||be===void 0?void 0:be.find(fe=>typeof fe!="string"&&fe.indicatorKey===j[q]))===null||ve===void 0?void 0:ve.format})}ee!==w&&this.tree[ee][b][q].push((Re=(Ie=g.tree[w])===null||Ie===void 0?void 0:Ie[b])===null||Re===void 0?void 0:Re[q])}}m(w,b)})}),y.forEach(w=>{Object.keys(g.tree[w]).forEach(S=>{m(w,S)})})}for(const y in g.totalRecordsTree)for(const w in g.totalRecordsTree[y])m(y,w)}ArrToTree1(e,t,n,i,r){const l=[],s=this.stringJoinChar,o=new Map;function a(d){const h=[];let c;d.forEach((u,f)=>{var g;h.push(u);const m=h.join(s);let y=o.get(m);y||(y={value:u,dimensionKey:t[f],children:f===d.length-1&&((g=n==null?void 0:n.length)!==null&&g!==void 0?g:0)>=1?n==null?void 0:n.map(w=>typeof w=="string"?{indicatorKey:w,value:w}:{indicatorKey:w.indicatorKey,value:w.title}):[]},o.set(m,y),c?c.children.push(y):l.push(y)),c=y})}return e.forEach(d=>a(d)),i&&a([r]),l}ArrToTree(e,t,n,i,r,l,s,o,a){var d;let h=[];const c=this.stringJoinChar,u=new Map;if(e!=null&&e.length?e.forEach(f=>function(g){const m=[];let y;g.forEach((w,S)=>{var b,_,p,I;m.push(w);const H=m.join(c);let C=u.get(H);if(!C){if(C={value:w,dimensionKey:t[S],children:S===g.length-1&&((b=n==null?void 0:n.length)!==null&&b!==void 0?b:0)>=1?n==null?void 0:n.map(P=>typeof P=="string"?{indicatorKey:P,value:P}:{indicatorKey:P.indicatorKey,value:P.title}):[]},i[S]){let P=(_=C.children)!==null&&_!==void 0?_:[];const T={value:s,dimensionKey:t[S+1],levelSpan:i.length-S-1,children:((p=n==null?void 0:n.length)!==null&&p!==void 0?p:0)>=1?n==null?void 0:n.map(v=>typeof v=="string"?{indicatorKey:v,value:v}:{indicatorKey:v.indicatorKey,value:v.title}):[]};P.push(T),P=(I=T.children)!==null&&I!==void 0?I:[]}u.set(H,C),y?i[S-1]&&!a?y.children.splice(y.children.length-1,0,C):y.children.push(C):h.push(C)}y=C})}(f)):n&&(h=n==null?void 0:n.map(f=>{var g;return typeof f=="string"?{indicatorKey:f,value:f}:{indicatorKey:f.indicatorKey,value:(g=f.title)!==null&&g!==void 0?g:f.indicatorKey}})),r&&(e==null?void 0:e.length)){const f={value:l,dimensionKey:t[0],levelSpan:i.length,children:(d=n==null?void 0:n.map(g=>typeof g=="string"?{indicatorKey:g,value:g}:{indicatorKey:g.indicatorKey,value:g.title}))!==null&&d!==void 0?d:[]};o?h.unshift(f):h.push(f)}return h}cacheDeminsionCollectedValues(){for(const e in this.collectValuesBy)this.collectValuesBy[e].type!=="xField"&&this.collectValuesBy[e].type!=="yField"||(this.dataConfig.dimensionSortArray?this.cacheCollectedValues[e]=di(this.collectedValues[e],this.dataConfig.dimensionSortArray):this.cacheCollectedValues[e]=this.collectedValues[e])}changeTreeNodeValue(e=[],t=[],n,i){var r,l,s;const o=this.indicatorKeys.indexOf(n);let a,d;a=typeof e=="string"?e:e.join(this.stringJoinChar),d=typeof t=="string"?t:t.join(this.stringJoinChar),!((r=this.changedTree[a])===null||r===void 0)&&r[d]?this.changedTree[a][d][o]=i:this.changedTree[a]?(this.changedTree[a][d]=[],this.changedTree[a][d][o]=i):(this.changedTree[a]={},this.changedTree[a][d]=[],this.changedTree[a][d][o]=i);const h=(s=(l=this.tree[a])===null||l===void 0?void 0:l[d])===null||s===void 0?void 0:s[o];(h==null?void 0:h.records.length)===1&&(h.records[0][this.indicatorKeys[o]]=i)}changeRecordFieldValue(e,t,n){let i=!1;for(let r=0;r<this.indicatorKeys.length;r++)this.indicatorKeys[r]===e&&(i=!0);if(!i){if(Array.isArray(this.records))for(let r=0,l=this.records.length;r<l;r++){const s=this.records[r];s[e]===t&&(s[e]=n)}else for(const r in this.records)for(let l=0,s=this.records[r].length;l<s;l++){const o=this.records[r][l];o[e]===t&&(o[e]=n)}this.rowFlatKeys={},this.colFlatKeys={},this.tree={},this.processRecords()}}_rowTreeHasChanged(){this.hasExtensionRowTree||(this.customRowTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customRowTree,"row"))}changeDataConfig(e){this.rows=e.rows,this.columns=e.columns}addRecords(e){for(let t=0,n=e.length;t<n;t++){const i=e[t];this.processRecord(i)}Array.isArray(this.records)&&this.records.push(e)}customTreeToDimensionPathArr(e,t){const n=[],i=this;function r(l,s){var o,a,d;l.virtual||(!((o=s[s.length-1])===null||o===void 0)&&o.childKeys&&l.dimensionKey&&s[s.length-1].childKeys.indexOf(l.dimensionKey)===-1&&l.dimensionKey!==s[s.length-1].dimensionKey&&s[s.length-1].childKeys.push(l.dimensionKey),s.push({dimensionKey:L(l.indicatorKey)?void 0:l.dimensionKey,value:l.value,indicatorKey:l.indicatorKey,virtual:l.virtual})),((a=l.children)===null||a===void 0?void 0:a.length)>0?(i.rowHierarchyType==="tree"&&t==="row"&&(s[s.length-1].childKeys=[],n.push([...s])),(d=l.children)===null||d===void 0||d.forEach(h=>r(h,[...s]))):n.push(s)}return e==null||e.forEach(l=>r(l,[])),n}getFieldMatchColDimensionPaths(e){var t,n;const i=[];for(let r=0;(n=r<((t=this.customColTreeDimensionPaths)===null||t===void 0?void 0:t.length))!==null&&n!==void 0&&n;r++){const l=this.customColTreeDimensionPaths[r];let s=!0;for(let o=0;o<l.length;o++){const a=l[o];if(a.dimensionKey&&e[a.dimensionKey]!==a.value||a.indicatorKey&&e[a.indicatorKey]===void 0){s=!1;break}}s&&i.push(l)}return i}getFieldMatchRowDimensionPaths(e){var t,n;const i=[];for(let r=0;(n=r<((t=this.customRowTreeDimensionPaths)===null||t===void 0?void 0:t.length))!==null&&n!==void 0&&n;r++){const l=this.customRowTreeDimensionPaths[r];let s=!0;for(let o=0;o<l.length;o++){const a=l[o];if(a.dimensionKey&&e[a.dimensionKey]!==a.value||a.indicatorKey&&e[a.indicatorKey]===void 0){s=!1;break}if(a.childKeys&&o===l.length-1&&a.childKeys.length>0&&a.childKeys.find(d=>L(e[d]))){s=!1;break}}s&&(this.indicatorsAsCol||this.rowHierarchyType!=="tree"||l.find(o=>o.indicatorKey)||(s=!1)),s&&i.push(l)}return i}}function di(D,e){return D.sort((t,n)=>{const i=e.indexOf(t),r=e.indexOf(n);return i<r?-1:i>r?1:0})}class ai extends Qt{constructor(e,t){var n,i,r,l,s,o,a,d,h,c,u,f,g,m,y,w,S,b;if(Ht.mode==="node"?(t=e,e=null):e instanceof HTMLElement||(t=e,e=e.container?e.container:null),super(e,t),this.layoutNodeId={seqId:0},t){t.layout&&Object.assign(t,t.layout),this.internalProps.columns=ge(t.columns),this.internalProps.rows=ge(t.rows),this.internalProps.indicators=at(t.indicators),(n=t.indicators)===null||n===void 0||n.forEach((p,I)=>{typeof p=="object"&&(p!=null&&p.editor)&&(this.internalProps.indicators[I].editor=p.editor)}),this.internalProps.columnTree=!t.indicatorsAsCol||!((i=t.columns)===null||i===void 0)&&i.length||t.columnTree?ge(t.columnTree):[],this.internalProps.rowTree=t.indicatorsAsCol||!((r=t.rows)===null||r===void 0)&&r.length||t.rowTree?ge(t.rowTree):[],this.internalProps.records=t.records,this.pagination=t.pagination,this.internalProps.columnResizeType=(l=t.columnResizeType)!==null&&l!==void 0?l:"column",this.internalProps.rowResizeType=(s=t.rowResizeType)!==null&&s!==void 0?s:"row",this.internalProps.dataConfig=ge(t.dataConfig),this.internalProps.columnWidthConfig=t.columnWidthConfig,this.internalProps.columnWidthConfigForRowHeader=t.columnWidthConfigForRowHeader;const _=this.internalProps.records;if(this.internalProps.recordsIsTwoDimensionalArray=!1,((o=_==null?void 0:_[0])===null||o===void 0?void 0:o.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0),((a=t.customConfig)===null||a===void 0?void 0:a.enableDataAnalysis)===!1){const p=new ce((d=this.internalProps.columnTree)!==null&&d!==void 0?d:[],this.layoutNodeId),I=new ce((h=this.internalProps.rowTree)!==null&&h!==void 0?h:[],this.layoutNodeId,this.options.rowHierarchyType,this.options.rowHierarchyType==="tree"?(c=this.options.rowExpandLevel)!==null&&c!==void 0?c:1:void 0);this.internalProps.layoutMap=new Be(this,null,p,I),this.internalProps.recordsIsTwoDimensionalArray===!1&&(this.flatDataToObjects=new _t({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys,indicators:this.internalProps.layoutMap.indicatorKeys,indicatorsAsCol:this.internalProps.layoutMap.indicatorsAsCol,indicatorDimensionKey:this.internalProps.layoutMap.indicatorDimensionKey},_))}else{const p=Ot(this,t),{rowKeys:I,columnKeys:H,indicatorKeys:C}=p;let{columnDimensionTree:P,rowDimensionTree:T}=p;this.dataset=new ht(this.internalProps.dataConfig,I,H,C,this.internalProps.indicators,(u=t.indicatorsAsCol)===null||u===void 0||u,t.records,t.rowHierarchyType,this.internalProps.columnTree,this.internalProps.rowTree,!1,!!t.extensionRows,!!t.parseCustomTreeToMatchRecords),t.columnTree?P.hasHideNode&&(Me(P.tree.children,t.indicators,!0,this),P.reset(P.tree.children)):(t.indicatorsAsCol!==!1&&(this.dataset.colHeaderTree=Le(this.dataset.colHeaderTree,t.indicators)),t.indicatorsAsCol!==!1&&t.indicators&&this.dataset.colHeaderTree&&Me(this.dataset.colHeaderTree,t.indicators,!1,this),P=new ce((f=this.dataset.colHeaderTree)!==null&&f!==void 0?f:[],this.layoutNodeId)),t.rowTree?T.hasHideNode&&(Me(T.tree.children,t.indicators,!0,this),T.reset(T.tree.children)):(t.indicatorsAsCol===!1&&(this.dataset.rowHeaderTree=Le(this.dataset.rowHeaderTree,t.indicators)),t.indicatorsAsCol===!1&&this.dataset.rowHeaderTree&&t.indicators&&Me(this.dataset.rowHeaderTree,t.indicators,!1,this),T=new ce((g=this.dataset.rowHeaderTree)!==null&&g!==void 0?g:[],this.layoutNodeId,this.options.rowHierarchyType,this.options.rowHierarchyType==="tree"?(m=this.options.rowExpandLevel)!==null&&m!==void 0?m:1:void 0)),this.internalProps.layoutMap=new Be(this,this.dataset,P,T)}if(this._changePivotSortStateBySortRules(),((w=(y=t.pivotSortState)===null||y===void 0?void 0:y.length)!==null&&w!==void 0?w:0)>0&&(this.pivotSortState=[],this.pivotSortState=t.pivotSortState),Ht.mode!=="node"&&(this.editorManager=new qn(this)),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.stateManager.initCheckedState(_),this.scenegraph.createSceneGraph(),t.title){const p=Ee.getComponent("title");this.internalProps.title=new p(t.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)(S=this.internalProps.emptyTip)===null||S===void 0||S.resetVisible();else{const p=Ee.getComponent("emptyTip");this.internalProps.emptyTip=new p(this.options.emptyTip,this),(b=this.internalProps.emptyTip)===null||b===void 0||b.resetVisible()}setTimeout(()=>{this.fireListeners(dt.INITIALIZED,null)},0)}}static get EVENT_TYPE(){return mt}isListTable(){return!1}isPivotTable(){return!0}isPivotChart(){return!1}get recordsCount(){var e;return(e=this.records)===null||e===void 0?void 0:e.length}_canResizeColumn(e,t){const n=super._canResizeColumn(e,t);if(n){if(this.internalProps.layoutMap.isSeriesNumber(e,t)&&this.internalProps.rowSeriesNumber.disableColumnResize===!0)return!1;if(!this.internalProps.layoutMap.indicatorsAsCol){const i=this.internalProps.layoutMap.getBody(e,this.columnHeaderLevelCount);if(i!=null&&i.disableColumnResize)return!1}}return n}updateOption(e){var t,n,i,r,l,s,o,a,d,h,c,u,f,g,m,y,w,S,b,_;const p=this.internalProps;if(super.updateOption(e),this.layoutNodeId={seqId:0},this.internalProps.columns=ge(e.columns),this.internalProps.rows=ge(e.rows),this.internalProps.indicators=!((t=e.indicators)===null||t===void 0)&&t.length?at(e.indicators):[],(n=e.indicators)===null||n===void 0||n.forEach((H,C)=>{typeof H=="object"&&(H!=null&&H.editor)&&(this.internalProps.indicators[C].editor=H.editor)}),this.internalProps.columnTree=!e.indicatorsAsCol||!((i=e.columns)===null||i===void 0)&&i.length||e.columnTree?ge(e.columnTree):[],this.internalProps.rowTree=e.indicatorsAsCol||!((r=e.rows)===null||r===void 0)&&r.length||e.rowTree?ge(e.rowTree):[],e.records&&(this.internalProps.records=e.records),this.stateManager.initCheckedState(this.internalProps.records),this.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1),this.pagination=e.pagination,p.columnResizeType=(l=e.columnResizeType)!==null&&l!==void 0?l:"column",p.rowResizeType=(s=e.rowResizeType)!==null&&s!==void 0?s:"row",p.dataConfig=ge(e.dataConfig),this.internalProps.columnWidthConfig=e.columnWidthConfig,this.internalProps.columnWidthConfigForRowHeader=e.columnWidthConfigForRowHeader,(e==null?void 0:e.rowHierarchyType)==="tree"&&this.internalProps.layoutMap.rowHierarchyType==="tree"&&this.internalProps.layoutMap.rowExpandLevel===(e==null?void 0:e.rowExpandLevel)){const H=this.internalProps.layoutMap.rowDimensionTree.tree.children;(o=this.internalProps.rowTree)===null||o===void 0||o.forEach((C,P)=>{const T=H.find(v=>v.dimensionKey===C.dimensionKey&&v.value===C.value);T&&this._syncHierarchyState(T,C)})}const I=this.internalProps.records;if(this.internalProps.recordsIsTwoDimensionalArray=!1,((a=I==null?void 0:I[0])===null||a===void 0?void 0:a.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0),((d=e.customConfig)===null||d===void 0?void 0:d.enableDataAnalysis)===!1){let H,C;e.columnTree&&(H=new ce((h=this.internalProps.columnTree)!==null&&h!==void 0?h:[],this.layoutNodeId)),e.rowTree&&(C=new ce((c=this.internalProps.rowTree)!==null&&c!==void 0?c:[],this.layoutNodeId,this.options.rowHierarchyType,this.options.rowHierarchyType==="tree"?(u=this.options.rowExpandLevel)!==null&&u!==void 0?u:1:void 0)),p.layoutMap=new Be(this,null,H,C),this.internalProps.recordsIsTwoDimensionalArray===!1&&(this.flatDataToObjects=new _t({rows:p.layoutMap.fullRowDimensionKeys,columns:p.layoutMap.colDimensionKeys,indicators:p.layoutMap.indicatorKeys,indicatorsAsCol:p.layoutMap.indicatorsAsCol,indicatorDimensionKey:p.layoutMap.indicatorDimensionKey},I))}else{const H=Ot(this,e),{rowKeys:C,columnKeys:P,indicatorKeys:T}=H;let{columnDimensionTree:v,rowDimensionTree:A}=H;this.dataset=new ht(p.dataConfig,C,P,T,this.internalProps.indicators,(f=e.indicatorsAsCol)===null||f===void 0||f,I,e.rowHierarchyType,this.internalProps.columnTree,this.internalProps.rowTree,!1,!!e.extensionRows,!!e.parseCustomTreeToMatchRecords),e.columnTree?v.hasHideNode&&(Me(v.tree.children,e.indicators,!0,this),v.reset(v.tree.children)):(e.indicatorsAsCol!==!1&&(this.dataset.colHeaderTree=Le(this.dataset.colHeaderTree,e.indicators)),e.indicatorsAsCol!==!1&&e.indicators&&this.dataset.colHeaderTree&&Me(this.dataset.colHeaderTree,e.indicators,!1,this),v=new ce((g=this.dataset.colHeaderTree)!==null&&g!==void 0?g:[],this.layoutNodeId)),e.rowTree?A.hasHideNode&&(Me(A.tree.children,e.indicators,!0,this),A.reset(A.tree.children)):(e.indicatorsAsCol===!1&&(this.dataset.rowHeaderTree=Le(this.dataset.rowHeaderTree,e.indicators)),e.indicatorsAsCol===!1&&this.dataset.rowHeaderTree&&e.indicators&&Me(this.dataset.rowHeaderTree,e.indicators,!1,this),A=new ce((m=this.dataset.rowHeaderTree)!==null&&m!==void 0?m:[],this.layoutNodeId,this.options.rowHierarchyType,this.options.rowHierarchyType==="tree"?(y=this.options.rowExpandLevel)!==null&&y!==void 0?y:1:void 0)),p.layoutMap=new Be(this,this.dataset,v,A)}if(this._changePivotSortStateBySortRules(),((S=(w=e.pivotSortState)===null||w===void 0?void 0:w.length)!==null&&S!==void 0?S:0)>0&&(this.pivotSortState=[],this.pivotSortState=e.pivotSortState),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,p.releaseList&&(p.releaseList.forEach(H=>{var C;return(C=H==null?void 0:H.release)===null||C===void 0?void 0:C.call(H)}),p.releaseList=null),this.scenegraph.clearCells(),this.scenegraph.createSceneGraph(),e.title){const H=Ee.getComponent("title");this.internalProps.title=new H(e.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)(b=this.internalProps.emptyTip)===null||b===void 0||b.resetVisible();else{const H=Ee.getComponent("emptyTip");this.internalProps.emptyTip=new H(this.options.emptyTip,this),(_=this.internalProps.emptyTip)===null||_===void 0||_.resetVisible()}return new Promise(H=>{setTimeout(H,0)})}updatePagination(e){e?(this.pagination||(this.pagination={currentPage:0,perPageCount:0}),typeof e.currentPage=="number"&&e.currentPage>=0&&(this.pagination.currentPage=e.currentPage),e.perPageCount&&(this.pagination.perPageCount=e.perPageCount||this.pagination.perPageCount),this.scenegraph.clearCells(),this.internalProps.layoutMap.setPagination(this.pagination),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render()):this.pagination&&(this.pagination=void 0,this.scenegraph.clearCells(),this.internalProps.layoutMap.setPagination(void 0),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render())}refreshHeader(){this.setMinMaxLimitWidth(!0),this.refreshRowColCount()}refreshRowColCount(){var e,t,n,i,r,l,s,o;const a=this,{layoutMap:d}=a.internalProps;d&&(a.colCount=(e=d.colCount)!==null&&e!==void 0?e:0,a.rowCount=(t=d.rowCount)!==null&&t!==void 0?t:0,this.internalProps.frozenColCount=this.options.frozenColCount?this.options.frozenColCount:((n=d.rowHeaderLevelCount)!==null&&n!==void 0?n:0)+d.leftRowSeriesNumberColumnCount,a.frozenRowCount=Math.max(d.headerLevelCount,(i=this.options.frozenRowCount)!==null&&i!==void 0?i:0),a.bottomFrozenRowCount!==((r=this.options.bottomFrozenRowCount)!==null&&r!==void 0?r:0)&&(a.bottomFrozenRowCount=(l=this.options.bottomFrozenRowCount)!==null&&l!==void 0?l:0),a.rightFrozenColCount!==((s=this.options.rightFrozenColCount)!==null&&s!==void 0?s:0)&&(a.rightFrozenColCount=(o=this.options.rightFrozenColCount)!==null&&o!==void 0?o:0),this.stateManager.setFrozenCol(this.internalProps.frozenColCount))}_getSortFuncFromHeaderOption(e,t,n){}get rowHierarchyType(){return this.internalProps.layoutMap.rowHierarchyType}_syncHierarchyState(e,t){var n,i;e.value===t.value&&e.dimensionKey===t.dimensionKey&&(t.hierarchyState=(n=t.hierarchyState)!==null&&n!==void 0?n:t!=null&&t.children?e.hierarchyState:void 0,(i=t==null?void 0:t.children)===null||i===void 0||i.forEach((r,l)=>{var s;if(!((s=e==null?void 0:e.children)===null||s===void 0)&&s[l]&&r){const o=e.children.find(a=>a.dimensionKey===r.dimensionKey&&a.value===r.value);o&&this._syncHierarchyState(o,r)}}))}getRecordShowIndexByCell(e,t){}getTableIndexByRecordIndex(e){}getTableIndexByField(e){}getCellAddrByFieldRecord(e,t){}getBodyIndexByRow(e){const{layoutMap:t}=this.internalProps;return t.getBodyIndexByRow(e)}getBodyIndexByCol(e){const{layoutMap:t}=this.internalProps;return t.getBodyIndexByCol(e)}getFieldData(e,t,n){var i,r,l;if(!this.internalProps.layoutMap.isHeader(t,n)){if(this.internalProps.recordsIsTwoDimensionalArray){const s=this.getBodyIndexByRow(n),o=this.getBodyIndexByCol(t);return(i=this.records[s])===null||i===void 0?void 0:i[o]}if(this.dataset){const s=this.internalProps.layoutMap.getCellHeaderPaths(t,n);if(s){let o;const a=(r=s.colHeaderPaths)===null||r===void 0?void 0:r.filter(c=>!c.virtual).map((c,u)=>{var f;return c.indicatorKey&&(o={position:"col",index:u}),(f=c.indicatorKey)!==null&&f!==void 0?f:c.value}),d=(l=s.rowHeaderPaths)===null||l===void 0?void 0:l.filter(c=>!c.virtual).map((c,u)=>{var f;return c.indicatorKey&&(o={position:"row",index:u}),(f=c.indicatorKey)!==null&&f!==void 0?f:c.value}),h=this.dataset.getAggregator(d,a,this.internalProps.layoutMap.getIndicatorKey(t,n),!0,o);if(h.records&&h.records.length>=1)return h.records[0][e]}}else if(this.flatDataToObjects){const s=this.internalProps.layoutMap.getCellHeaderPaths(t,n),o=s.colHeaderPaths.map(h=>{var c;return(c=h.indicatorKey)!==null&&c!==void 0?c:h.value}),a=s.rowHeaderPaths.map(h=>{var c;return(c=h.indicatorKey)!==null&&c!==void 0?c:h.value}),d=this.flatDataToObjects.getTreeNode(a,o,this.internalProps.layoutMap.getBody(t,n).indicatorKey,!1);if(d!=null&&d.record)return d==null?void 0:d.record[e]}}}getCellValue(e,t,n){var i,r,l,s,o,a,d;if(!n){const h=this.getCustomMergeValue(e,t);if(h)return h}if(this.internalProps.layoutMap.isSeriesNumber(e,t)){if(this.internalProps.layoutMap.isSeriesNumberInHeader(e,t)){const{title:c}=this.internalProps.layoutMap.getSeriesNumberHeader(e,t);return c}const{format:h}=this.internalProps.layoutMap.getSeriesNumberBody(e,t);return typeof h=="function"?h(e,t,this):t-this.columnHeaderLevelCount+1}if(this.internalProps.layoutMap.isHeader(e,t)){const{title:h,fieldFormat:c}=this.internalProps.layoutMap.getHeader(e,t);return typeof c=="function"?c(h,e,t,this):h}if(this.internalProps.recordsIsTwoDimensionalArray){const{fieldFormat:h}=this.internalProps.layoutMap.getBody(e,t),c=this.getBodyIndexByRow(t),u=this.getBodyIndexByCol(e),f=(i=this.records[c])===null||i===void 0?void 0:i[u];return typeof h=="function"?h(f,e,t,this):f}if(this.dataset){const h=this.internalProps.layoutMap.getCellHeaderPaths(e,t);let c;const u=(l=(r=h.colHeaderPaths)===null||r===void 0?void 0:r.filter(y=>!y.virtual))===null||l===void 0?void 0:l.map((y,w)=>{var S;return y.indicatorKey&&(c={position:"col",index:w}),(S=y.indicatorKey)!==null&&S!==void 0?S:y.value}),f=(o=(s=h.rowHeaderPaths)===null||s===void 0?void 0:s.filter(y=>!y.virtual))===null||o===void 0?void 0:o.map((y,w)=>{var S;return y.indicatorKey&&(c={position:"row",index:w}),(S=y.indicatorKey)!==null&&S!==void 0?S:y.value}),g=this.dataset.getAggregator(f,u,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,c),{fieldFormat:m}=this.internalProps.layoutMap.getBody(e,t);return g.formatValue?g.formatValue(e,t,this):typeof m=="function"?m(g==null?void 0:g.value(),e,t,this):(a=g==null?void 0:g.value())!==null&&a!==void 0?a:""}if(this.flatDataToObjects){const h=this.internalProps.layoutMap.getCellHeaderPaths(e,t),c=h.colHeaderPaths.map(m=>{var y;return(y=m.indicatorKey)!==null&&y!==void 0?y:m.value}),u=h.rowHeaderPaths.map(m=>{var y;return(y=m.indicatorKey)!==null&&y!==void 0?y:m.value}),f=this.flatDataToObjects.getTreeNode(u,c,this.internalProps.layoutMap.getBody(e,t).indicatorKey),{fieldFormat:g}=this.internalProps.layoutMap.getBody(e,t);return typeof g=="function"?g(f==null?void 0:f.value,e,t,this):(d=f==null?void 0:f.value)!==null&&d!==void 0?d:""}}getCellOriginValue(e,t){var n,i,r;const l=this;if(l.internalProps.layoutMap.isHeader(e,t)){const{title:s}=l.internalProps.layoutMap.getHeader(e,t);return typeof s=="function"?s():s}if(this.internalProps.recordsIsTwoDimensionalArray){const s=this.getBodyIndexByRow(t),o=this.getBodyIndexByCol(e);return(n=this.records[s])===null||n===void 0?void 0:n[o]}if(this.dataset){let s;const o=this.internalProps.layoutMap.getCellHeaderPaths(e,t),a=(i=o.colHeaderPaths)===null||i===void 0?void 0:i.filter(c=>!c.virtual).map((c,u)=>{var f;return c.indicatorKey&&(s={position:"col",index:u}),(f=c.indicatorKey)!==null&&f!==void 0?f:c.value}),d=(r=o.rowHeaderPaths)===null||r===void 0?void 0:r.filter(c=>!c.virtual).map((c,u)=>{var f;return c.indicatorKey&&(s={position:"row",index:u}),(f=c.indicatorKey)!==null&&f!==void 0?f:c.value}),h=this.dataset.getAggregator(d,a,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,s);return h.value?h.value():void 0}if(this.flatDataToObjects){const s=this.internalProps.layoutMap.getCellHeaderPaths(e,t),o=s.colHeaderPaths.map(h=>{var c;return(c=h.indicatorKey)!==null&&c!==void 0?c:h.value}),a=s.rowHeaderPaths.map(h=>{var c;return(c=h.indicatorKey)!==null&&c!==void 0?c:h.value}),d=this.flatDataToObjects.getTreeNode(a,o,this.internalProps.layoutMap.getBody(e,t).indicatorKey);return d==null?void 0:d.value}}getCellRawValue(e,t){var n,i,r;const l=this;if(l.internalProps.layoutMap.isHeader(e,t)){const{title:s}=l.internalProps.layoutMap.getHeader(e,t);return typeof s=="function"?s():s}if(this.internalProps.recordsIsTwoDimensionalArray){const s=this.getBodyIndexByRow(t),o=this.getBodyIndexByCol(e);return(n=this.records[s])===null||n===void 0?void 0:n[o]}if(this.dataset){let s;const o=this.internalProps.layoutMap.getCellHeaderPaths(e,t),a=(i=o.colHeaderPaths)===null||i===void 0?void 0:i.filter(c=>!c.virtual).map((c,u)=>{var f;return c.indicatorKey&&(s={position:"col",index:u}),(f=c.indicatorKey)!==null&&f!==void 0?f:c.value}),d=(r=o.rowHeaderPaths)===null||r===void 0?void 0:r.filter(c=>!c.virtual).map((c,u)=>{var f;return c.indicatorKey&&(s={position:"row",index:u}),(f=c.indicatorKey)!==null&&f!==void 0?f:c.value}),h=this.dataset.getAggregator(d,a,this.internalProps.layoutMap.getIndicatorKey(e,t),!1,s);return h.value?h.value():void 0}if(this.flatDataToObjects){const s=this.internalProps.layoutMap.getCellHeaderPaths(e,t),o=s.colHeaderPaths.map(h=>{var c;return(c=h.indicatorKey)!==null&&c!==void 0?c:h.value}),a=s.rowHeaderPaths.map(h=>{var c;return(c=h.indicatorKey)!==null&&c!==void 0?c:h.value}),d=this.flatDataToObjects.getTreeNode(a,o,this.internalProps.layoutMap.getBody(e,t).indicatorKey,!1);return d==null?void 0:d.value}}getCellOriginRecord(e,t){var n,i,r;if(!this.internalProps.layoutMap.isHeader(e,t)){if(this.internalProps.recordsIsTwoDimensionalArray){const l=this.getBodyIndexByRow(t),s=this.getBodyIndexByCol(e);return(n=this.records[l])===null||n===void 0?void 0:n[s]}if(this.dataset){let l;const s=this.internalProps.layoutMap.getCellHeaderPaths(e,t),o=(i=s.colHeaderPaths)===null||i===void 0?void 0:i.filter(d=>!d.virtual).map((d,h)=>{var c;return d.indicatorKey&&(l={position:"col",index:h}),(c=d.indicatorKey)!==null&&c!==void 0?c:d.value}),a=(r=s.rowHeaderPaths)===null||r===void 0?void 0:r.filter(d=>!d.virtual).map((d,h)=>{var c;return d.indicatorKey&&(l={position:"row",index:h}),(c=d.indicatorKey)!==null&&c!==void 0?c:d.value});return this.dataset.getAggregator(a,o,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,l).records}if(this.flatDataToObjects){const l=this.internalProps.layoutMap.getCellHeaderPaths(e,t),s=l.colHeaderPaths.map(d=>{var h;return(h=d.indicatorKey)!==null&&h!==void 0?h:d.value}),o=l.rowHeaderPaths.map(d=>{var h;return(h=d.indicatorKey)!==null&&h!==void 0?h:d.value}),a=this.flatDataToObjects.getTreeNode(o,s,this.internalProps.layoutMap.getBody(e,t).indicatorKey);return a==null?void 0:a.record}}}getCellRawRecord(e,t){var n,i,r;if(!this.internalProps.layoutMap.isHeader(e,t)){if(this.internalProps.recordsIsTwoDimensionalArray){const l=this.getBodyIndexByRow(t),s=this.getBodyIndexByCol(e);return(n=this.records[l])===null||n===void 0?void 0:n[s]}if(this.dataset){let l;const s=this.internalProps.layoutMap.getCellHeaderPaths(e,t),o=(i=s.colHeaderPaths)===null||i===void 0?void 0:i.filter(d=>!d.virtual).map((d,h)=>{var c;return d.indicatorKey&&(l={position:"col",index:h}),(c=d.indicatorKey)!==null&&c!==void 0?c:d.value}),a=(r=s.rowHeaderPaths)===null||r===void 0?void 0:r.filter(d=>!d.virtual).map((d,h)=>{var c;return d.indicatorKey&&(l={position:"row",index:h}),(c=d.indicatorKey)!==null&&c!==void 0?c:d.value});return this.dataset.getAggregator(a,o,this.internalProps.layoutMap.getIndicatorKey(e,t),!1,l).records}if(this.flatDataToObjects){const l=this.internalProps.layoutMap.getCellHeaderPaths(e,t),s=l.colHeaderPaths.map(d=>{var h;return(h=d.indicatorKey)!==null&&h!==void 0?h:d.value}),o=l.rowHeaderPaths.map(d=>{var h;return(h=d.indicatorKey)!==null&&h!==void 0?h:d.value}),a=this.flatDataToObjects.getTreeNode(o,s,this.internalProps.layoutMap.getBody(e,t).indicatorKey,!1);return a==null?void 0:a.record}}}updateSortRules(e,t,n){this.internalProps.dataConfig?this.internalProps.dataConfig.sortRules=e:this.internalProps.dataConfig={sortRules:e},this.dataset.updateSortRules(e),this._changePivotSortStateBySortRules();const{layoutMap:i}=this.internalProps;i.resetHeaderTree(),this.scenegraph.clearCells(),ut(t)&&ut(n)?(this.isRowHeader(t,n)?(this.setMinMaxLimitWidth(!0),this.internalProps._widthResizedColMap.clear()):this.isCornerHeader(t,n)?i.cornerSetting.titleOnDimension==="column"?(this.setMinMaxLimitWidth(!0),this.internalProps._widthResizedColMap.clear()):i.cornerSetting.titleOnDimension==="row"&&this.internalProps._heightResizedRowMap.clear():this.isColumnHeader(t,n)&&this.internalProps._heightResizedRowMap.clear(),this.refreshRowColCount()):this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.createSceneGraph(!0),this.render()}_changePivotSortStateBySortRules(){var e,t,n,i;this.pivotSortState=[];const r=(t=(e=this.internalProps.dataConfig)===null||e===void 0?void 0:e.sortRules)!==null&&t!==void 0?t:[];for(let l=0;l<r.length;l++){const s=r[l],o=[];if(s.sortByIndicator&&s.sortField===(this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1])){for(let d=0;d<s.query.length;d++)o.push({dimensionKey:this.dataset.indicatorsAsCol?this.dataset.columns[d]:this.dataset.rows[d],value:s.query[d]});o.push({indicatorKey:s.sortByIndicator,value:(i=(n=this.internalProps.layoutMap.getIndicatorInfo(s.sortByIndicator))===null||n===void 0?void 0:n.title)!==null&&i!==void 0?i:s.sortByIndicator})}else o.push({dimensionKey:s.sortField,isPivotCorner:!0,value:s.sortField});const a=s.sortType?s.sortType.toUpperCase():"ASC";this.pivotSortState.push({dimensions:o,order:tt[a]})}}_parseColumnWidthConfig(e){for(let t=0;t<(e==null?void 0:e.length);t++){const n=e[t],i=n.dimensions,r=n.width,l=this.getCellAddressByHeaderPaths(i);if(l&&l.col>=this.rowHeaderLevelCount){const s=this.getCellHeaderPaths(l.col,this.columnHeaderLevelCount);if(s.colHeaderPaths.length===i.length){let o=!0;for(let a=0;a<i.length;a++){const d=i[a];if(s.colHeaderPaths.findIndex((h,c)=>h.indicatorKey===d.indicatorKey||h.dimensionKey===d.dimensionKey&&h.value===d.value)<0){o=!1;break}}o&&!this.internalProps._widthResizedColMap.has(l.col)&&(this._setColWidth(l.col,r),this.internalProps._widthResizedColMap.add(l.col))}}else l&&l.col<this.rowHeaderLevelCount&&(this.internalProps._widthResizedColMap.has(l.col)||(this._setColWidth(l.col,r),this.internalProps._widthResizedColMap.add(l.col)))}}_parseColumnWidthConfigForRowHeader(e){for(let t=0;t<(e==null?void 0:e.length);t++){const n=e[t],i=n.dimensions,r=n.width,l=this.getCellAddressByHeaderPaths(i);l&&l.col<this.rowHeaderLevelCount&&(this.internalProps._widthResizedColMap.has(l.col)||(this._setColWidth(l.col,r),this.internalProps._widthResizedColMap.add(l.col)))}}updatePivotSortState(e){this.pivotSortState=e}sort(e,t,n){var i;let r;if(this.isCornerHeader(e,t)){const o=this.getHeaderDefine(e,t);r=[];const a={isPivotCorner:!0,dimensionKey:o.value,value:o.value};r.push(a)}else r=this.isColumnHeader(e,t)?this.getCellHeaderPaths(e,t).colHeaderPaths:this.getCellHeaderPaths(e,t).rowHeaderPaths;const l=r[r.length-1].indicatorKey,s=this.getHeaderDefine(e,t);if(s.sort){if(this.dataset.sortRules){const o={};for(let a=this.dataset.sortRules.length-1;a>=0;a--){const d=this.dataset.sortRules[a];s.dimensionKey&&d.sortField===s.dimensionKey?(o[d.sortField]=d,this.dataset.sortRules.splice(a,1)):l&&d.sortField===(this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1])&&this.dataset.sortRules.splice(a,1)}l?this.dataset.sortRules.push({sortField:this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1],sortType:tt[n],sortByIndicator:l,query:r.reduce((a,d)=>(d.dimensionKey&&a.push(d.value),a),[])}):this.dataset.sortRules.push(Object.assign((i=o[s.dimensionKey])!==null&&i!==void 0?i:{},{sortField:s.dimensionKey,sortType:tt[n]}))}else this.dataset.sortRules=l?[{sortField:this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1],sortType:tt[n],sortByIndicator:l,query:r.reduce((o,a)=>(a.dimensionKey&&o.push(a.value),o),[])}]:[{sortField:s.dimensionKey,sortType:tt[n]}];this.updateSortRules(this.dataset.sortRules,e,t)}}getPivotSortState(e,t){if(!this.pivotSortState)return;const n=this.getCellRange(e,t);for(let i=0;i<this.pivotSortState.length;i++){const r=this.pivotSortState[i],l=r.dimensions,s=this.getCellAddressByHeaderPaths(l),o=r.order;if(s&&Jt(n,s.col,s.row))return o}}_moveHeaderPosition(e,t){const n=this.getCellRange(e.col,e.row),i=this.getCellRange(t.col,t.row),r=this.internalProps.layoutMap.moveHeaderPosition(e,t);if(r){if(r.moveType==="column"){if(this.internalProps.recordsIsTwoDimensionalArray)for(let l=0;l<this.internalProps.records.length;l++){const s=this.internalProps.records[l].splice(r.sourceIndex-this.rowHeaderLevelCount,r.sourceSize);s.unshift(r.targetIndex-this.rowHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records[l],s)}this.colWidthsMap.exchangeOrder(n.start.col,n.end.col-n.start.col+1,i.start.col,i.end.col-i.start.col+1,r.targetIndex),this.setMinMaxLimitWidth()}else if(r.moveType==="row"){if(this.internalProps.recordsIsTwoDimensionalArray){const l=this.internalProps.records.splice(r.sourceIndex-this.columnHeaderLevelCount,r.sourceSize);l.unshift(r.targetIndex-this.columnHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records,l)}r.targetIndex>r.sourceIndex?this.rowHeightsMap.exchangeOrder(r.sourceIndex,r.sourceSize,r.targetIndex+r.sourceSize-r.targetSize,r.targetSize,r.targetIndex):this.rowHeightsMap.exchangeOrder(r.sourceIndex,r.sourceSize,r.targetIndex,r.targetSize,r.targetIndex)}return r}return null}toggleHierarchyState(e,t,n=!0){const i=this.getHierarchyState(e,t);if(i===Ye.expand)this._refreshHierarchyState(e,t,n),this.fireListeners(mt.TREE_HIERARCHY_STATE_CHANGE,{col:e,row:t,hierarchyState:Ye.collapse});else if(i===Ye.collapse){const r=this.internalProps.layoutMap.getHeadNode(e,t);Array.isArray(r.children)&&this._refreshHierarchyState(e,t,n),this.fireListeners(mt.TREE_HIERARCHY_STATE_CHANGE,{col:e,row:t,hierarchyState:Ye.expand,originData:r})}}_refreshHierarchyState(e,t,n=!0,i){var r,l;let s=!1,o=!1;this.stateManager.updateHoverIcon(e,t,void 0,void 0);const a=this.internalProps.layoutMap.checkHasChart();a&&(this.autoFillWidth&&(s=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&(o=this.getAllRowsHeight()<=this.tableNoFrameHeight));const d=this.internalProps.layoutMap.toggleHierarchyState(e,t);i&&i(),this.refreshRowColCount(),this.clearCellStyleCache(),this.scenegraph.updateHierarchyIcon(e,t),(r=this.reactCustomLayout)===null||r===void 0||r.clearCache(),this.scenegraph.updateRow(d.removeCellPositions,d.addCellPositions,d.updateCellPositions,n),(l=this.reactCustomLayout)===null||l===void 0||l.updateAllCustomCell(),a&&(this.autoFillWidth&&!s&&(s=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&!o&&(o=this.getAllRowsHeight()<=this.tableNoFrameHeight),(this.widthMode==="adaptive"||s||this.heightMode==="adaptive"||o)&&this.scenegraph.updateChartSizeForResizeColWidth(-1))}getHeaderCellAddressByPath(e){return this.internalProps.layoutMap.getPivotCellAdress(e)}getCellAddressByHeaderPaths(e){return this.internalProps.layoutMap.getCellAdressByHeaderPath(e)}getHeaderPathByXY(e){let t;return t=e?this.getCellAt(e.x+this.getFrozenColsWidth()+this.scrollLeft+1,e.y+this.getFrozenRowsHeight()+this.scrollTop+1):this.getCellAt(this.getFrozenColsWidth()+this.scrollLeft+1,this.getFrozenRowsHeight()+this.scrollTop+1),this.internalProps.layoutMap.getCellHeaderPaths(t.col,t.row)}getHierarchyState(e,t){var n;return(n=this._getHeaderLayoutMap(e,t))===null||n===void 0?void 0:n.hierarchyState}getLayoutColumnTree(){return this.internalProps.layoutMap.getLayoutColumnTree()}getLayoutColumnTreeCount(){return this.internalProps.layoutMap.getLayoutColumnTreeCount()}getLayoutRowTree(){return this.internalProps.layoutMap.getLayoutRowTree()}getLayoutRowTreeCount(){return this.internalProps.layoutMap.getLayoutRowTreeCount()}getCellHeaderTreeNodes(e,t){return this.internalProps.layoutMap.getCellHeaderPathsWithTreeNode(e,t)}_hasHierarchyTreeHeader(){return this.internalProps.layoutMap.rowHierarchyType==="tree"}getMenuInfo(e,t,n){const i=this.internalProps.layoutMap.getPivotDimensionInfo(e,t);return{dimensionKey:i[i.length-1].dimensionKey,value:this.getCellValue(e,t),cellLocation:this.getCellLocation(e,t),isPivotCorner:this.isCornerHeader(e,t),event:void 0}}setRecords(e){var t,n,i,r,l,s,o;const a={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.options.records=this.internalProps.records=e,this.internalProps.recordsIsTwoDimensionalArray=!1,((t=e==null?void 0:e[0])===null||t===void 0?void 0:t.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0);const d=this.options,h=this.internalProps;if(((n=this.options.customConfig)===null||n===void 0?void 0:n.enableDataAnalysis)===!1)this.internalProps.recordsIsTwoDimensionalArray===!1&&(this.flatDataToObjects=new _t({rows:h.layoutMap.fullRowDimensionKeys,columns:h.layoutMap.colDimensionKeys,indicators:h.layoutMap.indicatorKeys,indicatorsAsCol:h.layoutMap.indicatorsAsCol,indicatorDimensionKey:h.layoutMap.indicatorDimensionKey},e));else{let c,u;this.dataset.setRecords(e),d.columnTree?c=h.layoutMap.columnDimensionTree:(d.indicatorsAsCol!==!1&&d.indicators&&this.dataset.colHeaderTree&&Me(this.dataset.colHeaderTree,d.indicators,!1,this),c=new ce((i=this.dataset.colHeaderTree)!==null&&i!==void 0?i:[],this.layoutNodeId)),d.rowTree?u=h.layoutMap.rowDimensionTree:(d.indicatorsAsCol===!1&&this.dataset.rowHeaderTree&&d.indicators&&Me(this.dataset.rowHeaderTree,d.indicators,!1,this),u=new ce((r=this.dataset.rowHeaderTree)!==null&&r!==void 0?r:[],this.layoutNodeId,this.options.rowHierarchyType,this.options.rowHierarchyType==="tree"?(l=this.options.rowExpandLevel)!==null&&l!==void 0?l:1:void 0)),h.layoutMap=new Be(this,this.dataset,c,u),this.pivotSortState=[],d.pivotSortState&&(this.pivotSortState=d.pivotSortState)}if(this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(a.col,a.row),this.internalProps.title&&!this.internalProps.title.isReleased&&(this._updateSize(),this.internalProps.title.resize(),this.scenegraph.resize()),this.eventManager.updateEventBinder(),this.options.emptyTip)if(this.internalProps.emptyTip)(s=this.internalProps.emptyTip)===null||s===void 0||s.resetVisible();else{const c=Ee.getComponent("emptyTip");this.internalProps.emptyTip=new c(this.options.emptyTip,this),(o=this.internalProps.emptyTip)===null||o===void 0||o.resetVisible()}}startEditCell(e,t,n){var i;if(L(e)&&L(t))this.eventManager.isDraging=!1,this.selectCell(e,t),this.editorManager.startEditCell(e,t,n);else if(!((i=this.stateManager.select)===null||i===void 0)&&i.cellPos){const{col:r,row:l}=this.stateManager.select.cellPos;L(r)&&L(l)&&this.editorManager.startEditCell(r,l,n)}}completeEditCell(){this.editorManager.completeEdit()}getEditor(e,t){var n,i,r;let l;if(this.isCornerHeader(e,t)){const s=this.getHeaderDefine(e,t);l=(n=s==null?void 0:s.headerEditor)!==null&&n!==void 0?n:this.options.headerEditor}else if(this.isHeader(e,t)){const s=this.getHeaderDefine(e,t);l=(i=s==null?void 0:s.headerEditor)!==null&&i!==void 0?i:this.options.headerEditor}else{const s=this.getBodyColumnDefine(e,t);l=(r=s==null?void 0:s.editor)!==null&&r!==void 0?r:this.options.editor}return typeof l=="function"&&(l=l({col:e,row:t,dataValue:this.getCellOriginValue(e,t),value:this.getCellValue(e,t)||"",table:this})),typeof l=="string"?Gn(l):l}isHasEditorDefine(e,t){var n;const i=this.getBodyColumnDefine(e,t);let r=(n=i==null?void 0:i.editor)!==null&&n!==void 0?n:this.options.editor;return typeof r=="function"&&(r=r({col:e,row:t,dataValue:this.getCellOriginValue(e,t),value:this.getCellValue(e,t)||"",table:this})),L(r)}changeCellValue(e,t,n,i=!1){if(i&&this.isHasEditorDefine(e,t)||i===!1){let r=n;const l=this.getCellOriginValue(e,t),s=this.getCellRawValue(e,t);typeof s=="number"&&zt(n)&&(r=parseFloat(n)),this._changeCellValueToDataSet(e,t,l,r);const o=this.getCellRange(e,t);for(let a=o.start.col;a<=o.end.col;a++)for(let d=o.start.row;d<=o.end.row;d++)this.scenegraph.updateCellContent(a,d);if(this.widthMode==="adaptive"||this.autoFillWidth&&this.getAllColsWidth()<=this.tableNoFrameWidth)this.internalProps._widthResizedColMap.size===0&&this.scenegraph.recalculateColWidths();else if(!this.internalProps._widthResizedColMap.has(e)){const a=this.getColWidth(e),d=Nt(e,0,this.rowCount-1,this,!1);d!==a&&this.scenegraph.updateColWidth(e,d-a)}if(this.heightMode==="adaptive"||this.autoFillHeight&&this.getAllRowsHeight()<=this.tableNoFrameHeight)this.internalProps._heightResizedRowMap.size===0&&this.scenegraph.recalculateRowHeights();else if(this.isAutoRowHeight()&&!this.internalProps._heightResizedRowMap.has(t)){const a=this.getRowHeight(t),d=Bt(t,0,this.colCount-1,this);this.scenegraph.updateRowHeight(t,d-a)}l!==r&&this.fireListeners(dt.CHANGE_CELL_VALUE,{col:e,row:t,rawValue:s,currentValue:l,changedValue:r}),this.scenegraph.updateNextFrame()}}changeCellValues(e,t,n,i=!1){let r=e,l=t;const s=[],o=[];for(let h=0;h<n.length&&!(t+h>this.rowCount-1);h++){const c=n[h],u=[],f=[];s.push(u),o.push(f);for(let g=0;g<c.length&&!(e+g>this.colCount-1);g++){const m=this.getCellRawValue(e+g,t+h);u.push(m);const y=this.getCellOriginValue(e+g,t+h);f.push(y)}}for(let h=0;h<n.length&&!(t+h>this.rowCount-1);h++){l=t+h;const c=n[h];let u=e;for(let f=0;f<c.length&&!(e+f>this.colCount-1);f++)if(u=e+f,i&&this.isHasEditorDefine(e+f,t+h)||i===!1){const g=c[f];let m=g;const y=o[h][f],w=s[h][f];typeof w=="number"&&zt(g)&&(m=parseFloat(g)),this._changeCellValueToDataSet(e+f,t+h,y,m);const S=this.getCellOriginValue(e+f,t+h);S!==y&&this.fireListeners(dt.CHANGE_CELL_VALUE,{col:e+f,row:t+h,rawValue:w,currentValue:y,changedValue:S})}r=Math.max(r,u)}const a=this.getCellRange(e,t),d=this.getCellRange(r,l);for(let h=a.start.col;h<=d.end.col;h++)for(let c=a.start.row;c<=d.end.row;c++)this.scenegraph.updateCellContent(h,c);if(this.widthMode==="adaptive"||this.autoFillWidth&&this.getAllColsWidth()<=this.tableNoFrameWidth)this.internalProps._widthResizedColMap.size===0&&this.scenegraph.recalculateColWidths();else for(let h=e;h<=d.end.col;h++)if(!this.internalProps._widthResizedColMap.has(h)){const c=this.getColWidth(h),u=Nt(h,0,this.rowCount-1,this,!1);u!==c&&this.scenegraph.updateColWidth(h,u-c)}if(this.heightMode==="adaptive"||this.autoFillHeight&&this.getAllRowsHeight()<=this.tableNoFrameHeight)this.scenegraph.recalculateRowHeights();else if(this.isAutoRowHeight()){const h=[],c=[];for(let u=t;u<=d.end.row;u++)if(this.rowHeightsMap.get(u)){const f=this.getRowHeight(u),g=Bt(u,0,this.colCount-1,this);h.push(u),c.push(g-f)}this.scenegraph.updateRowsHeight(h,c)}this.scenegraph.updateNextFrame()}_changeCellValueToDataSet(e,t,n,i){var r,l,s,o,a,d,h,c;if(this.internalProps.recordsIsTwoDimensionalArray){const u=this.getBodyIndexByRow(t),f=this.getBodyIndexByCol(e);this.records[u][f]=i}else if(this.dataset){const u=this.internalProps.layoutMap.getCellHeaderPaths(e,t);if(this.isCornerHeader(e,t))this.internalProps.layoutMap.changeCornerTitle(e,t,i);else if(this.isHeader(e,t))this.internalProps.layoutMap.changeTreeNodeTitle(e,t,i),!this.isCornerHeader(e,t)&&this.dataset.changeRecordFieldValue(!((r=u.colHeaderPaths)===null||r===void 0)&&r.length?(l=u.colHeaderPaths[u.colHeaderPaths.length-1].indicatorKey)!==null&&l!==void 0?l:u.colHeaderPaths[u.colHeaderPaths.length-1].dimensionKey:(s=u.rowHeaderPaths[u.rowHeaderPaths.length-1].indicatorKey)!==null&&s!==void 0?s:u.rowHeaderPaths[u.rowHeaderPaths.length-1].dimensionKey,n,i);else{const f=(o=u.colHeaderPaths)===null||o===void 0?void 0:o.filter(m=>!m.virtual).map(m=>{var y;return(y=m.indicatorKey)!==null&&y!==void 0?y:m.value}),g=(a=u.rowHeaderPaths)===null||a===void 0?void 0:a.filter(m=>!m.virtual).map(m=>{var y;return(y=m.indicatorKey)!==null&&y!==void 0?y:m.value});this.dataset.changeTreeNodeValue(this.internalProps.layoutMap.indicatorsAsCol?g:g.slice(0,-1),this.internalProps.layoutMap.indicatorsAsCol?f.slice(0,-1):f,this.internalProps.layoutMap.getIndicatorKey(e,t),i)}}else if(this.flatDataToObjects){const u=this.internalProps.layoutMap.getCellHeaderPaths(e,t);if(this.isHeader(e,t))this.internalProps.layoutMap.changeTreeNodeTitle(e,t,i),!this.isCornerHeader(e,t)&&this.flatDataToObjects.changeRecordFieldValue(!((d=u.colHeaderPaths)===null||d===void 0)&&d.length?(h=u.colHeaderPaths[u.colHeaderPaths.length-1].indicatorKey)!==null&&h!==void 0?h:u.colHeaderPaths[u.colHeaderPaths.length-1].dimensionKey:(c=u.rowHeaderPaths[u.rowHeaderPaths.length-1].indicatorKey)!==null&&c!==void 0?c:u.rowHeaderPaths[u.rowHeaderPaths.length-1].dimensionKey,n,i);else{const f=u.colHeaderPaths.map(m=>{var y;return(y=m.indicatorKey)!==null&&y!==void 0?y:m.value}),g=u.rowHeaderPaths.map(m=>{var y;return(y=m.indicatorKey)!==null&&y!==void 0?y:m.value});this.flatDataToObjects.changeTreeNodeValue(g,f,this.internalProps.layoutMap.getBody(e,t).indicatorKey,i)}}}_hasCustomRenderOrLayout(){if(this.options.customRender)return!0;const{columnsDefine:e,rowsDefine:t,indicatorsDefine:n}=this.internalProps.layoutMap;for(let i=0;i<e.length;i++){const r=e[i];if(typeof r!="string"&&(r.headerCustomLayout||r.headerCustomRender))return!0}for(let i=0;i<t.length;i++){const r=t[i];if(typeof r!="string"&&(r.headerCustomLayout||r.headerCustomRender))return!0}for(let i=0;i<n.length;i++){const r=n[i];if(typeof r!="string"&&(r.customLayout||r.headerCustomLayout||r.customRender||r.headerCustomRender))return!0}return!1}changeRecordOrder(e,t){}setTreeNodeChildren(e,t,n,i){this.flatDataToObjects?(this.internalProps.layoutMap.getHeadNode(n,i).children=e,this._refreshHierarchyState(n,i,!0,()=>{this.flatDataToObjects.changeDataConfig({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys,indicators:this.internalProps.layoutMap.indicatorKeys,indicatorsAsCol:this.internalProps.layoutMap.indicatorsAsCol,indicatorDimensionKey:this.internalProps.layoutMap.indicatorDimensionKey}),this.flatDataToObjects.addRecords(t)})):(this.internalProps.layoutMap.getHeadNode(n,i).children=e,this._refreshHierarchyState(n,i,!0,()=>{this.dataset._rowTreeHasChanged(),this.dataset.changeDataConfig({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys}),this.dataset.addRecords(t)}))}updateFilterRules(e){this.internalProps.dataConfig.filterRules=e,this.dataset.updateFilterRules(e),this.renderWithRecreateCells()}getFilteredRecords(){var e;return(e=this.dataset)===null||e===void 0?void 0:e.filterRules}}$t(),Yt(),Xt(),Zt(),en(),tn(),nn(),rn(),sn(),ln(),on(),dn(),an(),un();class Pt extends ai{}$t(),Yt(),Xt(),Zt(),en(),tn(),nn(),rn(),sn(),ln(),on(),dn(),an(),un();class St extends Qt{constructor(e,t){var n,i,r,l,s,o,a,d,h,c,u,f,g,m,y,w,S,b,_,p;let I,H;Ht.mode==="node"?(t=e,e=null):e instanceof HTMLElement||(t=e,e=e.container?e.container:null),super(e,t),this.layoutNodeId={seqId:0},this._selectedDataItemsInChart=[],this._selectedDimensionInChart=[],this._chartEventMap={},t.layout&&Object.assign(t,t.layout),this.internalProps.columns=ge(t.columns),this.internalProps.rows=ge(t.rows),this.internalProps.indicators=at(t.indicators),this.internalProps.columnTree=!t.indicatorsAsCol||!((n=t.columns)===null||n===void 0)&&n.length||t.columnTree?ge(t.columnTree):[],this.internalProps.rowTree=t.indicatorsAsCol||!((i=t.rows)===null||i===void 0)&&i.length||t.rowTree?ge(t.rowTree):[],this.internalProps.records=t.records,this.setCustomStateNameToSpec(),this.internalProps.columnResizeType=(r=t.columnResizeType)!==null&&r!==void 0?r:"column",this.internalProps.rowResizeType=(l=t.rowResizeType)!==null&&l!==void 0?l:"row",this.internalProps.dataConfig={isPivotChart:!0},this._axes=Ne(t.axes)?t.axes:[],t.columnTree&&(t.indicatorsAsCol!==!1&&(this.internalProps.columnTree=Le(this.internalProps.columnTree,t.indicators)),I=new ce((s=this.internalProps.columnTree)!==null&&s!==void 0?s:[],this.layoutNodeId)),t.rowTree&&(t.indicatorsAsCol===!1&&(this.internalProps.rowTree=Le(this.internalProps.rowTree,t.indicators)),H=new ce((o=this.internalProps.rowTree)!==null&&o!==void 0?o:[],this.layoutNodeId));const C=!((a=H==null?void 0:H.dimensionKeys)===null||a===void 0)&&a.count?H.dimensionKeys.valueArr():(h=(d=t.rows)===null||d===void 0?void 0:d.reduce((v,A)=>(typeof A=="string"?v.push(A):v.push(A.dimensionKey),v),[]))!==null&&h!==void 0?h:[],P=!((c=I==null?void 0:I.dimensionKeys)===null||c===void 0)&&c.count?I.dimensionKeys.valueArr():(f=(u=t.columns)===null||u===void 0?void 0:u.reduce((v,A)=>(typeof A=="string"?v.push(A):v.push(A.dimensionKey),v),[]))!==null&&f!==void 0?f:[],T=(m=(g=t.indicators)===null||g===void 0?void 0:g.reduce((v,A)=>(typeof A=="string"?v.push(A):v.push(A.indicatorKey),v),[]))!==null&&m!==void 0?m:[];if(this.internalProps.dataConfig.collectValuesBy=this._generateCollectValuesConfig(P,C),this.internalProps.dataConfig.aggregationRules=this._generateAggregationRules(),this.internalProps.dataConfig.dimensionSortArray=this._getDimensionSortArray(),this.dataset=new ht(this.internalProps.dataConfig,C,P,T,this.internalProps.indicators,(y=t.indicatorsAsCol)===null||y===void 0||y,t.records,void 0,this.internalProps.columnTree,this.internalProps.rowTree,!0),this.options.indicatorsAsCol&&st(this.internalProps.indicators)){const v=A=>{A.forEach(F=>{var B;!((B=F.children)===null||B===void 0)&&B.length?v(F.children):F.children=[{dimensionKey:"axis",value:""}]})};!((w=this.dataset.rowHeaderTree)===null||w===void 0)&&w.length?v(this.dataset.rowHeaderTree):this.dataset.rowHeaderTree=[{dimensionKey:"axis",value:""}]}if(t.columnTree||t.indicatorsAsCol!==!1&&(this.dataset.colHeaderTree=Le(this.dataset.colHeaderTree,t.indicators)),t.rowTree||t.indicatorsAsCol===!1&&(this.dataset.rowHeaderTree=Le(this.dataset.rowHeaderTree,t.indicators)),I=new ce((S=this.dataset.colHeaderTree)!==null&&S!==void 0?S:[],this.layoutNodeId),H=new ce((b=this.dataset.rowHeaderTree)!==null&&b!==void 0?b:[],this.layoutNodeId),this.internalProps.layoutMap=new Be(this,this.dataset,I,H),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.createSceneGraph(),t.title){const v=Ee.getComponent("title");this.internalProps.title=new v(t.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)(_=this.internalProps.emptyTip)===null||_===void 0||_.resetVisible();else{const v=Ee.getComponent("emptyTip");this.internalProps.emptyTip=new v(this.options.emptyTip,this),(p=this.internalProps.emptyTip)===null||p===void 0||p.resetVisible()}setTimeout(()=>{this.fireListeners(dt.INITIALIZED,null)},0)}static get EVENT_TYPE(){return Qn}get pivotChartAxes(){return this._axes}get recordsCount(){var e;return(e=this.records)===null||e===void 0?void 0:e.length}isListTable(){return!1}isPivotTable(){return!0}isPivotChart(){return!0}_canResizeColumn(e,t){const n=super._canResizeColumn(e,t);if(n&&!this.internalProps.layoutMap.indicatorsAsCol){const i=this.internalProps.layoutMap.getBody(e,this.columnHeaderLevelCount);if(i!=null&&i.disableColumnResize)return!1}return n}updateOption(e){var t,n,i,r,l,s,o,a,d,h,c,u,f,g,m,y,w,S,b,_,p,I;const H=this.internalProps;let C,P;super.updateOption(e),this.layoutNodeId={seqId:0},this.internalProps.columns=ge(e.columns),this.internalProps.rows=ge(e.rows),this.internalProps.indicators=!((t=e.indicators)===null||t===void 0)&&t.length?at(e.indicators):[],this.internalProps.columnTree=!e.indicatorsAsCol||!((n=e.columns)===null||n===void 0)&&n.length||e.columnTree?ge(e.columnTree):[],this.internalProps.rowTree=e.indicatorsAsCol||!((i=e.rows)===null||i===void 0)&&i.length||e.rowTree?ge(e.rowTree):[],e.records&&(this.internalProps.records=e.records),this.setCustomStateNameToSpec(),this._selectedDataItemsInChart=[],H.columnResizeType=(r=e.columnResizeType)!==null&&r!==void 0?r:"column",H.rowResizeType=(l=e.rowResizeType)!==null&&l!==void 0?l:"row",H.dataConfig={isPivotChart:!0},this._axes=Ne(e.axes)?e.axes:[],e.columnTree&&(e.indicatorsAsCol!==!1&&(this.internalProps.columnTree=Le(this.internalProps.columnTree,e.indicators)),C=new ce((s=this.internalProps.columnTree)!==null&&s!==void 0?s:[],this.layoutNodeId)),e.rowTree&&(e.indicatorsAsCol===!1&&(this.internalProps.rowTree=Le(this.internalProps.rowTree,e.indicators)),P=new ce((o=this.internalProps.rowTree)!==null&&o!==void 0?o:[],this.layoutNodeId));const T=!((a=P==null?void 0:P.dimensionKeys)===null||a===void 0)&&a.count?P.dimensionKeys.valueArr():(h=(d=e.rows)===null||d===void 0?void 0:d.reduce((F,B)=>(typeof B=="string"?F.push(B):F.push(B.dimensionKey),F),[]))!==null&&h!==void 0?h:[],v=!((c=C==null?void 0:C.dimensionKeys)===null||c===void 0)&&c.count?C.dimensionKeys.valueArr():(f=(u=e.columns)===null||u===void 0?void 0:u.reduce((F,B)=>(typeof B=="string"?F.push(B):F.push(B.dimensionKey),F),[]))!==null&&f!==void 0?f:[],A=(m=(g=e.indicators)===null||g===void 0?void 0:g.reduce((F,B)=>(typeof B=="string"?F.push(B):F.push(B.indicatorKey),F),[]))!==null&&m!==void 0?m:[];if(this.internalProps.dataConfig.collectValuesBy=this._generateCollectValuesConfig(v,T),this.internalProps.dataConfig.aggregationRules=this._generateAggregationRules(),this.internalProps.dataConfig.dimensionSortArray=this._getDimensionSortArray(),this.dataset=new ht(this.internalProps.dataConfig,T,v,A,this.internalProps.indicators,(y=e.indicatorsAsCol)===null||y===void 0||y,(w=e.records)!==null&&w!==void 0?w:this.internalProps.records,void 0,this.internalProps.columnTree,this.internalProps.rowTree,!0),this.options.indicatorsAsCol&&st(this.internalProps.indicators)){const F=B=>{B.forEach(Q=>{var J;!((J=Q.children)===null||J===void 0)&&J.length?F(Q.children):Q.children=[{dimensionKey:"axis",value:""}]})};!((S=this.dataset.rowHeaderTree)===null||S===void 0)&&S.length?F(this.dataset.rowHeaderTree):this.dataset.rowHeaderTree=[{dimensionKey:"axis",value:""}]}if(e.columnTree||e.indicatorsAsCol!==!1&&(this.dataset.colHeaderTree=Le(this.dataset.colHeaderTree,e.indicators)),e.rowTree||e.indicatorsAsCol===!1&&(this.dataset.rowHeaderTree=Le(this.dataset.rowHeaderTree,e.indicators)),C=new ce((b=this.dataset.colHeaderTree)!==null&&b!==void 0?b:[],this.layoutNodeId),P=new ce((_=this.dataset.rowHeaderTree)!==null&&_!==void 0?_:[],this.layoutNodeId),H.layoutMap=new Be(this,this.dataset,C,P),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,H.releaseList&&(H.releaseList.forEach(F=>{var B;return(B=F==null?void 0:F.release)===null||B===void 0?void 0:B.call(F)}),H.releaseList=null),this.scenegraph.clearCells(),this.scenegraph.createSceneGraph(),e.title){const F=Ee.getComponent("title");this.internalProps.title=new F(e.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)(p=this.internalProps.emptyTip)===null||p===void 0||p.resetVisible();else{const F=Ee.getComponent("emptyTip");this.internalProps.emptyTip=new F(this.options.emptyTip,this),(I=this.internalProps.emptyTip)===null||I===void 0||I.resetVisible()}return new Promise(F=>{setTimeout(F,0)})}updatePagination(){}refreshHeader(){this.setMinMaxLimitWidth(!0),this.refreshRowColCount()}refreshRowColCount(){var e,t,n,i,r,l,s,o;const a=this,{layoutMap:d}=a.internalProps;d&&(a.colCount=(e=d.colCount)!==null&&e!==void 0?e:0,a.rowCount=(t=d.rowCount)!==null&&t!==void 0?t:0,a.internalProps.frozenColCount=(n=d.rowHeaderLevelCount)!==null&&n!==void 0?n:0,a.frozenRowCount=Math.max(d.headerLevelCount,(i=this.options.frozenRowCount)!==null&&i!==void 0?i:0),a.bottomFrozenRowCount!==((r=d==null?void 0:d.bottomFrozenRowCount)!==null&&r!==void 0?r:0)&&(a.bottomFrozenRowCount=(l=d==null?void 0:d.bottomFrozenRowCount)!==null&&l!==void 0?l:0),a.rightFrozenColCount!==((s=d==null?void 0:d.rightFrozenColCount)!==null&&s!==void 0?s:0)&&(a.rightFrozenColCount=(o=d==null?void 0:d.rightFrozenColCount)!==null&&o!==void 0?o:0),this.stateManager.setFrozenCol(this.internalProps.frozenColCount))}_getSortFuncFromHeaderOption(e,t,n){}syncHierarchyState(e,t){var n,i;e.value===t.value&&e.dimensionKey===t.dimensionKey&&(t.hierarchyState=(n=t.hierarchyState)!==null&&n!==void 0?n:t!=null&&t.children?e.hierarchyState:void 0,(i=t==null?void 0:t.children)===null||i===void 0||i.forEach((r,l)=>{var s;!((s=e==null?void 0:e.children)===null||s===void 0)&&s[l]&&r&&this.syncHierarchyState(e.children[l],r)}))}getRecordShowIndexByCell(e,t){}getTableIndexByRecordIndex(e){}getTableIndexByField(e){}getCellAddrByFieldRecord(e,t){}getBodyIndexByRow(e){const{layoutMap:t}=this.internalProps;return t.getBodyIndexByRow(e)}getBodyIndexByCol(e){const{layoutMap:t}=this.internalProps;return t.getBodyIndexByCol(e)}getCellValue(e,t,n){var i,r,l;if(!n){const h=this.getCustomMergeValue(e,t);if(h)return h}if(this.internalProps.layoutMap.isHeader(e,t)){if(this.internalProps.layoutMap.isBottomFrozenRow(e,t)||this.internalProps.layoutMap.isRightFrozenColumn(e,t)){const u=this.internalProps.layoutMap.getIndicatorKeyInChartSpec(e,t);let f;return u==null||u.forEach(g=>{const m=this.internalProps.layoutMap.getIndicatorInfo(g);m&&(f=m)}),(r=(i=f==null?void 0:f.title)!==null&&i!==void 0?i:f==null?void 0:f.indicatorKey)!==null&&r!==void 0?r:""}const{title:h,fieldFormat:c}=this.internalProps.layoutMap.getHeader(e,t);return typeof c=="function"?c(h,e,t,this):h}if(this.dataset){let h;const c=this.internalProps.layoutMap.getCellHeaderPaths(e,t),u=c.colHeaderPaths.map((m,y)=>{var w;return m.indicatorKey&&(h={position:"col",index:y}),(w=m.indicatorKey)!==null&&w!==void 0?w:m.value}),f=c.rowHeaderPaths.map((m,y)=>{var w;return m.indicatorKey&&(h={position:"row",index:y}),(w=m.indicatorKey)!==null&&w!==void 0?w:m.value}),g=this.dataset.getAggregator(f,u,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,h);return g.value?g.value():void 0}const{fieldFormat:s}=this.internalProps.layoutMap.getBody(e,t),o=this.getBodyIndexByRow(t),a=this.getBodyIndexByCol(e),d=(l=this.records[o])===null||l===void 0?void 0:l[a];return typeof s=="function"?s(d,e,t,this):d}getCellOriginValue(e,t){var n,i,r;const l=this;if(l.internalProps.layoutMap.isHeader(e,t)){if(this.internalProps.layoutMap.isBottomFrozenRow(e,t)||this.internalProps.layoutMap.isRightFrozenColumn(e,t)){const d=this.internalProps.layoutMap.getIndicatorKeyInChartSpec(e,t);let h;return d==null||d.forEach(c=>{const u=this.internalProps.layoutMap.getIndicatorInfo(c);u&&(h=u)}),(i=(n=h==null?void 0:h.title)!==null&&n!==void 0?n:h==null?void 0:h.indicatorKey)!==null&&i!==void 0?i:""}const{title:a}=l.internalProps.layoutMap.getHeader(e,t);return typeof a=="function"?a():a}if(this.dataset){let a;const d=this.internalProps.layoutMap.getCellHeaderPaths(e,t),h=d.colHeaderPaths.map((f,g)=>{var m;return f.indicatorKey&&(a={position:"col",index:g}),(m=f.indicatorKey)!==null&&m!==void 0?m:f.value}),c=d.rowHeaderPaths.map((f,g)=>{var m;return f.indicatorKey&&(a={position:"row",index:g}),(m=f.indicatorKey)!==null&&m!==void 0?m:f.value}),u=this.dataset.getAggregator(c,h,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,a);return u.value?u.value():void 0}const s=this.getBodyIndexByRow(t),o=this.getBodyIndexByCol(e);return(r=this.records[s])===null||r===void 0?void 0:r[o]}getCellRawValue(e,t){return this.getCellOriginValue(e,t)}getCellOriginRecord(e,t){if(!this.internalProps.layoutMap.isHeader(e,t)&&this.dataset){let n;const i=this.internalProps.layoutMap.getCellHeaderPaths(e,t),r=i.colHeaderPaths.map((s,o)=>{var a;return s.indicatorKey&&(n={position:"col",index:o}),(a=s.indicatorKey)!==null&&a!==void 0?a:s.value}),l=i.rowHeaderPaths.map((s,o)=>{var a;return s.indicatorKey&&(n={position:"row",index:o}),(a=s.indicatorKey)!==null&&a!==void 0?a:s.value});return this.dataset.getAggregator(l,r,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,n).records}}getCellRawRecord(e,t){return this.getCellOriginRecord(e,t)}getPivotSortState(e,t){if(!this.pivotSortState)return;const n=this.getCellRange(e,t);for(let i=0;i<this.pivotSortState.length;i++){const{col:r,row:l,order:s}=this.pivotSortState[i];if(Jt(n,r,l))return s}}_moveHeaderPosition(e,t){var n,i,r,l;const s=this.internalProps.layoutMap.moveHeaderPosition(e,t);if(s){if(s.moveType==="column"){if(((i=(n=this.options.records)===null||n===void 0?void 0:n[0])===null||i===void 0?void 0:i.constructor)===Array)for(let o=0;o<this.internalProps.records.length;o++){const a=this.internalProps.records[o].splice(s.sourceIndex-this.rowHeaderLevelCount,s.sourceSize);a.unshift(s.targetIndex-this.rowHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records[o],a)}this.colWidthsMap.adjustOrder(s.sourceIndex,s.targetIndex,s.sourceSize),this.setMinMaxLimitWidth()}else if(s.moveType==="row"){if(((l=(r=this.options.records)===null||r===void 0?void 0:r[0])===null||l===void 0?void 0:l.constructor)===Array){const o=this.internalProps.records.splice(s.sourceIndex-this.columnHeaderLevelCount,s.sourceSize);o.unshift(s.targetIndex-this.columnHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records,o)}this.rowHeightsMap.adjustOrder(s.sourceIndex,s.targetIndex,s.sourceSize)}return s}return null}toggleHierarchyState(e,t,n=!0){}getHeaderCellAddressByPath(e){return this.internalProps.layoutMap.getPivotCellAdress(e)}getCellAddressByHeaderPaths(e){return this.internalProps.layoutMap.getCellAdressByHeaderPath(e)}getHeaderPathByXY(e){let t;return t=e?this.getCellAt(e.x+this.getFrozenColsWidth()+this.scrollLeft+1,e.y+this.getFrozenRowsHeight()+this.scrollTop+1):this.getCellAt(this.getFrozenColsWidth()+this.scrollLeft+1,this.getFrozenRowsHeight()+this.scrollTop+1),this.internalProps.layoutMap.getCellHeaderPaths(t.col,t.row)}getHierarchyState(e,t){var n;return(n=this._getHeaderLayoutMap(e,t))===null||n===void 0?void 0:n.hierarchyState}_hasHierarchyTreeHeader(){return this.internalProps.layoutMap.rowHierarchyType==="tree"}getMenuInfo(e,t,n){const i=this.internalProps.layoutMap.getPivotDimensionInfo(e,t);return{dimensionKey:i[i.length-1].dimensionKey,value:this.getCellValue(e,t),cellLocation:this.getCellLocation(e,t),isPivotCorner:this.isCornerHeader(e,t),event:void 0}}_generateCollectValuesConfig(e,t){var n,i,r,l,s,o,a,d,h,c,u,f,g,m,y,w,S;e=e.filter(p=>p!==Oe),t=t.filter(p=>p!==Oe);const b=this.internalProps.indicators,_={};for(let p=0,I=b==null?void 0:b.length;p<I;p++)if(typeof b[p]!="string"&&b[p].chartSpec){if(((n=b[p].chartSpec)===null||n===void 0?void 0:n.type)==="pie"||((i=b[p].chartSpec)===null||i===void 0?void 0:i.type)==="rose"||((r=b[p].chartSpec)===null||r===void 0?void 0:r.type)==="radar"||((l=b[p].chartSpec)===null||l===void 0?void 0:l.type)==="gauge"||((s=b[p].chartSpec)===null||s===void 0?void 0:s.type)==="wordCloud")continue;const H=b[p],C=H.chartSpec;if(this.options.indicatorsAsCol===!1)if((C==null?void 0:C.stack)!==!1&&((C==null?void 0:C.type)==="bar"||(C==null?void 0:C.type)==="area")&&(C.stack=!0),_[H.indicatorKey]={by:t,range:!0,sumBy:(C==null?void 0:C.stack)&&e.concat(C==null?void 0:C.xField)},C.series)C.series.forEach(P=>{var T,v,A,F,B,Q,J,U,$,se,le,oe,de,ae;const ue=typeof P.xField=="string"?P.xField:P.xField[0];_[ue]={by:e,type:P.direction!=="horizontal"?"xField":void 0,range:$e(P,this._axes,P.direction==="horizontal",!0),sortBy:P.direction!=="horizontal"?(F=(A=(v=(T=P==null?void 0:P.data)===null||T===void 0?void 0:T.fields)===null||v===void 0?void 0:v[ue])===null||A===void 0?void 0:A.domain)!==null&&F!==void 0?F:(J=(Q=(B=C==null?void 0:C.data)===null||B===void 0?void 0:B.fields)===null||Q===void 0?void 0:Q[ue])===null||J===void 0?void 0:J.domain:void 0};const he=P.yField;P.stack!==!1&&(P.type==="bar"||P.type==="area")&&(P.stack=!0),_[he]={by:t,range:$e(P,this._axes,P.direction==="horizontal",!1),sumBy:P.stack&&e.concat(P==null?void 0:P.xField),sortBy:P.direction==="horizontal"?(le=(se=($=(U=P==null?void 0:P.data)===null||U===void 0?void 0:U.fields)===null||$===void 0?void 0:$[he])===null||se===void 0?void 0:se.domain)!==null&&le!==void 0?le:(ae=(de=(oe=C==null?void 0:C.data)===null||oe===void 0?void 0:oe.fields)===null||de===void 0?void 0:de[he])===null||ae===void 0?void 0:ae.domain:void 0,extendRange:ot(C.markLine)}});else{const P=typeof C.xField=="string"?C.xField:C.xField[0];_[P]={by:e,type:C.direction!=="horizontal"?"xField":void 0,range:$e(C,this._axes,C.direction==="horizontal",!0),sortBy:C.direction!=="horizontal"?(d=(a=(o=C==null?void 0:C.data)===null||o===void 0?void 0:o.fields)===null||a===void 0?void 0:a[P])===null||d===void 0?void 0:d.domain:void 0},(C==null?void 0:C.stack)!==!1&&((C==null?void 0:C.type)==="bar"||(C==null?void 0:C.type)==="area")&&(C.stack=!0);const T=C.yField;_[T]={by:t,range:C.direction!=="horizontal",sumBy:C.stack&&e.concat(C==null?void 0:C.xField),sortBy:C.direction==="horizontal"?(u=(c=(h=C==null?void 0:C.data)===null||h===void 0?void 0:h.fields)===null||c===void 0?void 0:c[T])===null||u===void 0?void 0:u.domain:void 0,extendRange:ot(C.markLine)}}else{const P=b[p];if((C==null?void 0:C.stack)!==!1&&((C==null?void 0:C.type)==="bar"||(C==null?void 0:C.type)==="area")&&(C.stack=!0),_[P.indicatorKey]={by:e,range:!0,sumBy:(C==null?void 0:C.stack)&&t.concat(C==null?void 0:C.yField)},C.series)C.series.forEach(T=>{var v,A,F,B,Q,J,U,$,se,le,oe,de,ae,ue;const he=typeof T.yField=="string"?T.yField:T.yField[0];_[he]={by:t,type:T.direction==="horizontal"?"yField":void 0,range:$e(T,this._axes,T.direction==="horizontal",!1),sortBy:T.direction==="horizontal"?(B=(F=(A=(v=T==null?void 0:T.data)===null||v===void 0?void 0:v.fields)===null||A===void 0?void 0:A[he])===null||F===void 0?void 0:F.domain)!==null&&B!==void 0?B:(U=(J=(Q=C==null?void 0:C.data)===null||Q===void 0?void 0:Q.fields)===null||J===void 0?void 0:J[he])===null||U===void 0?void 0:U.domain:void 0};const Ce=T.xField;T.stack!==!1&&(T.type==="bar"||T.type==="area")&&(T.stack=!0),_[Ce]={by:e,range:$e(T,this._axes,T.direction==="horizontal",!0),sumBy:T.stack&&t.concat(T==null?void 0:T.yField),sortBy:T.direction!=="horizontal"?(oe=(le=(se=($=T==null?void 0:T.data)===null||$===void 0?void 0:$.fields)===null||se===void 0?void 0:se[Ce])===null||le===void 0?void 0:le.domain)!==null&&oe!==void 0?oe:(ue=(ae=(de=C==null?void 0:C.data)===null||de===void 0?void 0:de.fields)===null||ae===void 0?void 0:ae[Ce])===null||ue===void 0?void 0:ue.domain:void 0,extendRange:ot(C.markLine)}});else{const T=typeof C.yField=="string"?C.yField:C.yField[0];_[T]={by:t,type:C.direction==="horizontal"?"yField":void 0,range:$e(C,this._axes,C.direction==="horizontal",!1),sortBy:C.direction==="horizontal"?(m=(g=(f=C==null?void 0:C.data)===null||f===void 0?void 0:f.fields)===null||g===void 0?void 0:g[T])===null||m===void 0?void 0:m.domain:void 0},(C==null?void 0:C.stack)!==!1&&((C==null?void 0:C.type)==="bar"||(C==null?void 0:C.type)==="area")&&(C.stack=!0);const v=C.xField;_[v]={by:e,range:$e(C,this._axes,C.direction==="horizontal",!0),sumBy:C.stack&&t.concat(C==null?void 0:C.yField),sortBy:C.direction!=="horizontal"?(S=(w=(y=C==null?void 0:C.data)===null||y===void 0?void 0:y.fields)===null||w===void 0?void 0:w[v])===null||S===void 0?void 0:S.domain:void 0,extendRange:ot(C.markLine)}}}}return _}_generateAggregationRules(){var e;const t=[];return(e=this.internalProps.indicators)===null||e===void 0||e.forEach(n=>{var i,r;if(typeof n=="string")t.push({indicatorKey:n,field:n,aggregationType:Z.RECORD});else if(!((i=n.chartSpec)===null||i===void 0)&&i.series){const l=[];(r=n.chartSpec)===null||r===void 0||r.series.forEach(s=>{const o=this.options.indicatorsAsCol===!1?s.yField:s.xField;l.indexOf(o)===-1&&l.push(o)}),t.push({indicatorKey:n.indicatorKey,field:l,aggregationType:Z.RECORD})}else{const l=this.options.indicatorsAsCol===!1?n.chartSpec.yField:n.chartSpec.xField;t.push({indicatorKey:n.indicatorKey,field:l??n.indicatorKey,aggregationType:Z.RECORD})}}),t}setCustomStateNameToSpec(){var e;const t=n=>{var i,r,l,s,o,a,d,h,c,u;!((r=(i=n.bar)===null||i===void 0?void 0:i.state)===null||r===void 0)&&r.selected&&(n.bar.state.vtable_selected=n.bar.state.selected,n.bar.state.vtable_selected_reverse=n.bar.state.selected_reverse,delete n.bar.state.selected,delete n.bar.state.selected_reverse),!((s=(l=n.point)===null||l===void 0?void 0:l.state)===null||s===void 0)&&s.selected&&(n.point.state.vtable_selected=n.point.state.selected,n.point.state.vtable_selected_reverse=n.point.state.selected_reverse,delete n.point.state.selected,delete n.point.state.selected_reverse),!((a=(o=n.line)===null||o===void 0?void 0:o.state)===null||a===void 0)&&a.selected&&(n.line.state.vtable_selected=n.line.state.selected,n.line.state.vtable_selected_reverse=n.line.state.selected_reverse,delete n.line.state.selected,delete n.line.state.selected_reverse),!((h=(d=n.area)===null||d===void 0?void 0:d.state)===null||h===void 0)&&h.selected&&(n.area.state.vtable_selected=n.area.state.selected,n.area.state.vtable_selected_reverse=n.area.state.selected_reverse,delete n.area.state.selected,delete n.area.state.selected_reverse),!((u=(c=n.pie)===null||c===void 0?void 0:c.state)===null||u===void 0)&&u.selected&&(n.pie.state.vtable_selected=n.pie.state.selected,n.pie.state.vtable_selected_reverse=n.pie.state.selected_reverse,delete n.pie.state.selected,delete n.pie.state.selected_reverse)};(e=this.internalProps.indicators)===null||e===void 0||e.forEach(n=>{if(n.chartSpec){const i=n.chartSpec;i.series?i.series.forEach(r=>{t(r)}):t(i)}})}updateFilterRules(e){this.internalProps.dataConfig.filterRules=e,this.dataset.updateFilterRules(e),Vt(this.scenegraph),Jn(this.scenegraph),this.render()}clearChartCacheImage(e,t){ut(e)&&ut(t)?$n(e,t,this.scenegraph):Vt(this.scenegraph)}getLegendSelected(){var e;const t=[];return(e=this.internalProps.legends)===null||e===void 0||e.forEach(n=>{const i=n.legendComponent._getSelectedLegends().map(r=>r.label);t.push(...i)}),t}setLegendSelected(e){var t;(t=this.internalProps.legends)===null||t===void 0||t.forEach(n=>{n.legendComponent.setSelected(e)})}getChartDatumPosition(e,t){const{chartInstance:n,bounds:i}=this.getChartInstance(t);if(n){const r=n.convertDatumToPosition(e);return r?{x:Math.round(r.x+i.x1),y:Math.round(r.y+i.y1)}:null}return null}getCellAddressByRecord(e){const t=[],n=[],i={},r=[];this.dataset.dataConfig.aggregationRules.forEach(l=>{if(typeof l.field=="string")i[l.field]=l.indicatorKey,r.push(l.field);else for(let s=0;s<l.field.length;s++)i[l.field[s]]=l.indicatorKey,r.push(l.field[s])});for(const l in e)this.dataset.rows.indexOf(l)>=0&&t.push({dimensionKey:l,value:e[l]}),this.dataset.columns.indexOf(l)>=0&&n.push({dimensionKey:l,value:e[l]}),r.indexOf(l)>=0&&(this.dataset.indicatorsAsCol?n.push({indicatorKey:i[l]}):t.push({indicatorKey:i[l]}));return this.getCellAddressByHeaderPaths({rowHeaderPaths:t,colHeaderPaths:n,cellLocation:"body"})}getChartInstance(e){var t,n,i,r,l;const s=this.getCellAddressByHeaderPaths(e);if(s){const o=this.getCellRelativeRect(s.col,s.row),a=this.scenegraph.getCell(s.col,s.row);let d;const h=(t=a==null?void 0:a.getChildren())===null||t===void 0?void 0:t[0];if(h.attribute.chartInstance){d=h.attribute.chartInstance;const{dataId:c,data:u,axes:f,spec:g}=h.attribute,m=h.getViewBox();if(f==null||f.forEach((y,w)=>{var S,b,_,p,I;y.type==="linear"?d.updateModelSpecSync({type:"axes",index:w},{min:(b=(S=y.range)===null||S===void 0?void 0:S.min)!==null&&b!==void 0?b:0,max:(p=(_=y.range)===null||_===void 0?void 0:_.max)!==null&&p!==void 0?p:0,tick:{tickMode:(I=y.tick)===null||I===void 0?void 0:I.tickMode}},!0):y.type==="band"&&d.updateModelSpec({type:"axes",index:w},{domain:y.domain.slice(0)},!0)}),d.updateViewBox({x1:m.x1-h.getRootNode().table.scrollLeft,x2:m.x2-h.getRootNode().table.scrollLeft,y1:m.y1-h.getRootNode().table.scrollTop,y2:m.y2-h.getRootNode().table.scrollTop},!1,!1),typeof c=="string")d.updateDataSync(c,u??[]);else{const y=[];for(const w in c){const S=c[w],b=g.series.find(_=>{var p;return((p=_==null?void 0:_.data)===null||p===void 0?void 0:p.id)===w});y.push({id:w,values:S?(n=u==null?void 0:u.filter(_=>_.hasOwnProperty(S)))!==null&&n!==void 0?n:[]:u??[],fields:(i=b==null?void 0:b.data)===null||i===void 0?void 0:i.fields}),d.updateFullDataSync||d.updateDataSync(w,S?(r=u==null?void 0:u.filter(_=>_.hasOwnProperty(S)))!==null&&r!==void 0?r:[]:u??[])}(l=d.updateFullDataSync)===null||l===void 0||l.call(d,y)}this.renderAsync()}return{chartInstance:d,bounds:o.bounds}}return{}}_getDimensionSortArray(){var e,t;if(!((t=(e=this.options)===null||e===void 0?void 0:e.axes)===null||t===void 0)&&t.length){const n=this.options.indicatorsAsCol?"left":"bottom",i=this.options.axes.find(r=>r.orient===n);if(i&&Ne(i.domain))return i.domain}}setRecords(e){var t,n;const i={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.options.records=this.internalProps.records=e;const r=this.options,l=this.internalProps;let s,o;this.dataset.setRecords(e),s=r.columnTree?l.layoutMap.columnDimensionTree:new ce((t=this.dataset.colHeaderTree)!==null&&t!==void 0?t:[],this.layoutNodeId),o=r.rowTree?l.layoutMap.rowDimensionTree:new ce((n=this.dataset.rowHeaderTree)!==null&&n!==void 0?n:[],this.layoutNodeId),l.layoutMap=new Be(this,this.dataset,s,o),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(i.col,i.row),this.internalProps.title&&!this.internalProps.title.isReleased&&(this._updateSize(),this.internalProps.title.resize(),this.scenegraph.resize()),this.eventManager.updateEventBinder()}_hasCustomRenderOrLayout(){if(this.options.customRender)return!0;const{columnsDefine:e,rowsDefine:t,indicatorsDefine:n}=this.internalProps.layoutMap;for(let i=0;i<e.length;i++){const r=e[i];if(typeof r!="string"&&(r.headerCustomLayout||r.headerCustomRender))return!0}for(let i=0;i<t.length;i++){const r=t[i];if(typeof r!="string"&&(r.headerCustomLayout||r.headerCustomRender))return!0}for(let i=0;i<n.length;i++){const r=n[i];if(typeof r!="string"&&(r.customLayout||r.headerCustomLayout||r.customRender||r.headerCustomRender))return!0}return!1}changeRecordOrder(e,t){}getLayoutColumnTree(){return this.internalProps.layoutMap.getLayoutColumnTree()}getLayoutColumnTreeCount(){return this.internalProps.layoutMap.getLayoutColumnTreeCount()}getLayoutRowTree(){return this.internalProps.layoutMap.getLayoutRowTree()}getLayoutRowTreeCount(){return this.internalProps.layoutMap.getLayoutRowTreeCount()}getCellHeaderTreeNodes(e,t){return this.internalProps.layoutMap.getCellHeaderPathsWithTreeNode(e,t)}}let ui=class extends Yn{constructor(e){var t,n,i,r,l,s,o,a,d,h;e.src&&(e.image=e.src),e.shape==="circle"&&(e.cornerRadius=e.width/2);const c=Ne(e.boundsPadding),u=[(n=(t=e.marginTop)!==null&&t!==void 0?t:c?e.boundsPadding[0]:e.boundsPadding)!==null&&n!==void 0?n:0,(r=(i=e.marginRight)!==null&&i!==void 0?i:c?e.boundsPadding[1]:e.boundsPadding)!==null&&r!==void 0?r:0,(o=(l=e.marginBottom)!==null&&l!==void 0?l:c?(s=e.boundsPadding[2])!==null&&s!==void 0?s:e.boundsPadding[0]:e.boundsPadding)!==null&&o!==void 0?o:0,(h=(a=e.marginLeft)!==null&&a!==void 0?a:c?(d=e.boundsPadding[3])!==null&&d!==void 0?d:e.boundsPadding[1]:e.boundsPadding)!==null&&h!==void 0?h:0];e.boundsPadding=u,super(e)}},hi=class extends Xn{constructor(e){var t,n,i,r,l,s,o,a,d,h,c;e.textBaseline||(e.textBaseline="top");const u=Ne(e.boundsPadding),f=[(n=(t=e.marginTop)!==null&&t!==void 0?t:u?e.boundsPadding[0]:e.boundsPadding)!==null&&n!==void 0?n:0,(r=(i=e.marginRight)!==null&&i!==void 0?i:u?e.boundsPadding[1]:e.boundsPadding)!==null&&r!==void 0?r:0,(o=(l=e.marginBottom)!==null&&l!==void 0?l:u?(s=e.boundsPadding[2])!==null&&s!==void 0?s:e.boundsPadding[0]:e.boundsPadding)!==null&&o!==void 0?o:0,(h=(a=e.marginLeft)!==null&&a!==void 0?a:u?(d=e.boundsPadding[3])!==null&&d!==void 0?d:e.boundsPadding[1]:e.boundsPadding)!==null&&h!==void 0?h:0];e.boundsPadding=f,e.fill=(c=e.fill)!==null&&c!==void 0?c:"#000",super(e)}getSize(e){this.AABBBounds.width()}},ci=class extends Zn{constructor(e){var t,n,i,r,l,s,o,a,d,h;const c=Ne(e.boundsPadding),u=[(n=(t=e.marginTop)!==null&&t!==void 0?t:c?e.boundsPadding[0]:e.boundsPadding)!==null&&n!==void 0?n:0,(r=(i=e.marginRight)!==null&&i!==void 0?i:c?e.boundsPadding[1]:e.boundsPadding)!==null&&r!==void 0?r:0,(o=(l=e.marginBottom)!==null&&l!==void 0?l:c?(s=e.boundsPadding[2])!==null&&s!==void 0?s:e.boundsPadding[0]:e.boundsPadding)!==null&&o!==void 0?o:0,(h=(a=e.marginLeft)!==null&&a!==void 0?a:c?(d=e.boundsPadding[3])!==null&&d!==void 0?d:e.boundsPadding[1]:e.boundsPadding)!==null&&h!==void 0?h:0];e.boundsPadding=u,super(e)}getSize(e){this.AABBBounds.width()}},fi=class extends ei{constructor(e){var t,n,i,r,l,s,o,a,d,h;const c=Ne(e.boundsPadding),u=[(n=(t=e.marginTop)!==null&&t!==void 0?t:c?e.boundsPadding[0]:e.boundsPadding)!==null&&n!==void 0?n:0,(r=(i=e.marginRight)!==null&&i!==void 0?i:c?e.boundsPadding[1]:e.boundsPadding)!==null&&r!==void 0?r:0,(o=(l=e.marginBottom)!==null&&l!==void 0?l:c?(s=e.boundsPadding[2])!==null&&s!==void 0?s:e.boundsPadding[0]:e.boundsPadding)!==null&&o!==void 0?o:0,(h=(a=e.marginLeft)!==null&&a!==void 0?a:c?(d=e.boundsPadding[3])!==null&&d!==void 0?d:e.boundsPadding[1]:e.boundsPadding)!==null&&h!==void 0?h:0];e.boundsPadding=u,super(e)}};function ct(D){return D.flatMap(e=>Array.isArray(e.children)?ct(e.children):e)}function hn(D){return D.replace(/-([a-z])/g,e=>e[1].toUpperCase())}function At(D){const e={};for(const t in D)if(D.hasOwnProperty(t)){const n=hn(t);e[n]=D[t]}return e}function gi(D,e){return D.startsWith("on")&&ri(e[D])}function Ci(D){const e={Group:fi,Image:ui,Text:hi,Tag:ci,Radio:ti,CheckBox:ni};function t(r){if(!r)return null;const{type:l,children:s}=r,o=At(r.props),a=(l==null?void 0:l.symbol)||(l==null?void 0:l.name),d=e[a];if(!d)return null;const h=new d(Object.assign({},o));return i(h,o),n(s).forEach(u=>{const f=t(u);f?h.add(f):u.type===Symbol.for("v-fgt")&&u.children.forEach(g=>{const m=t(g);m&&h.add(m)})}),h}function n(r){var l;return((l=r==null?void 0:r.default)===null||l===void 0?void 0:l.call(r))||r||[]}function i(r,l){Object.keys(l).forEach(s=>{if(gi(s,l)){let o;s.startsWith("on")?o=s.slice(2).toLowerCase():o=hn(s.slice(2)).toLowerCase(),r.addEventListener(o,l[s])}})}return{rootComponent:t(D)}}function yi(D){return e=>{const{table:t,row:n,col:i,rect:r}=e,l=t.getCellOriginRecord(i,n),{height:s,width:o}=r??t.getCellRect(i,n),a=D.customLayout({table:t,row:n,col:i,rect:r,record:l,height:s,width:o})[0],{rootComponent:d}=Ci(a);return{rootContainer:d,renderDefault:!1}}}function cn(D){const e={columns:[],columnHeaderTitle:[],rows:[],rowHeaderTitle:[],indicators:[],corner:{},tooltip:{},menu:{}},t={PivotColumnDimension:"columns",PivotColumnHeaderTitle:"columnHeaderTitle",PivotRowDimension:"rows",PivotRowHeaderTitle:"rowHeaderTitle",PivotCorner:"corner",PivotIndicator:"indicators",Tooltip:"tooltip",Menu:"menu"};return D.forEach(n=>{var i,r;n.props=At(n.props);const l=((i=n.type)===null||i===void 0?void 0:i.symbol)||((r=n.type)===null||r===void 0?void 0:r.name),s=t[l];s&&(Array.isArray(e[s])?n.props.hasOwnProperty("objectHandler")?e[s].push(n.props.objectHandler):e[s].push(n.props):e[s]=n.props)}),e}function pi(D){const e={columns:[],tooltip:{},menu:{}},t={ListColumn:"columns",Tooltip:"tooltip",Menu:"menu"};return D.forEach(n=>{var i,r;n.props=At(n.props);const l=((i=n.type)===null||i===void 0?void 0:i.symbol)||((r=n.type)===null||r===void 0?void 0:r.name),s=t[l];s&&(s==="columns"&&n.children&&(n.props.customLayout=yi(n.children)),Array.isArray(e[s])?e[s].push(n.props):e[s]=n.props)}),e}function Kt(D,e){return Object.assign(Object.assign({},D),{columns:e.columns&&e.columns.length?e.columns:D.columns,columnHeaderTitle:e.columnHeaderTitle&&e.columnHeaderTitle.length?e.columnHeaderTitle:D.columnHeaderTitle,rows:e.rows&&e.rows.length?e.rows:D.rows,rowHeaderTitle:e.rowHeaderTitle&&e.rowHeaderTitle.length?e.rowHeaderTitle:D.rowHeaderTitle,indicators:e.indicators&&e.indicators.length?e.indicators:D.indicators,corner:Object.keys(D.corner||{}).length?D.corner:e.corner,tooltip:Object.keys(e.tooltip||{}).length?e.tooltip:D.tooltip,menu:Object.keys(e.menu||{}).length?e.menu:D.menu})}const N=Object.assign(Object.assign(Object.assign({},Tt.EVENT_TYPE),Pt.EVENT_TYPE),St.EVENT_TYPE),fn={onClickCell:N.CLICK_CELL,onDblClickCell:N.DBLCLICK_CELL,onMouseDownCell:N.MOUSEDOWN_CELL,onMouseUpCell:N.MOUSEUP_CELL,onSelectedCell:N.SELECTED_CELL,onKeyDown:N.KEYDOWN,onMouseEnterTable:N.MOUSEENTER_TABLE,onMouseLeaveTable:N.MOUSELEAVE_TABLE,onMouseDownTable:N.MOUSEDOWN_TABLE,onMouseMoveCell:N.MOUSEMOVE_CELL,onMouseEnterCell:N.MOUSEENTER_CELL,onMouseLeaveCell:N.MOUSELEAVE_CELL,onContextMenuCell:N.CONTEXTMENU_CELL,onResizeColumn:N.RESIZE_COLUMN,onResizeColumnEnd:N.RESIZE_COLUMN_END,onChangeHeaderPosition:N.CHANGE_HEADER_POSITION,onChangeHeaderPositionStart:N.CHANGE_HEADER_POSITION_START,onChangeHeaderPositionFail:N.CHANGE_HEADER_POSITION_FAIL,onSortClick:N.SORT_CLICK,onFreezeClick:N.FREEZE_CLICK,onScroll:N.SCROLL,onDropdownMenuClick:N.DROPDOWN_MENU_CLICK,onMouseOverChartSymbol:N.MOUSEOVER_CHART_SYMBOL,onDragSelectEnd:N.DRAG_SELECT_END,onDropdownIconClick:N.DROPDOWN_ICON_CLICK,onDropdownMenuClear:N.DROPDOWN_MENU_CLEAR,onTreeHierarchyStateChange:N.TREE_HIERARCHY_STATE_CHANGE,onShowMenu:N.SHOW_MENU,onHideMenu:N.HIDE_MENU,onIconClick:N.ICON_CLICK,onLegendItemClick:N.LEGEND_ITEM_CLICK,onLegendItemHover:N.LEGEND_ITEM_HOVER,onLegendItemUnHover:N.LEGEND_ITEM_UNHOVER,onLegendChange:N.LEGEND_CHANGE,onMouseEnterAxis:N.MOUSEENTER_AXIS,onMouseLeaveAxis:N.MOUSELEAVE_AXIS,onCheckboxStateChange:N.CHECKBOX_STATE_CHANGE,onRadioStateChange:N.RADIO_STATE_CHANGE,onAfterRender:N.AFTER_RENDER,onInitialized:N.INITIALIZED,onPivotSortClick:N.PIVOT_SORT_CLICK,onDrillMenuClick:N.DRILLMENU_CLICK,onVChartEventType:N.VCHART_EVENT_TYPE,onChangeCellValue:N.CHANGE_CELL_VALUE,onMousedownFillHandle:N.MOUSEDOWN_FILL_HANDLE,onDragFillHandleEnd:N.DRAG_FILL_HANDLE_END,onDblclickFillHandle:N.DBLCLICK_FILL_HANDLE,onScrollVerticalEnd:N.SCROLL_VERTICAL_END,onScrollHorizontalEnd:N.SCROLL_HORIZONTAL_END,onChangCellValue:N.CHANGE_CELL_VALUE},Ut=Object.keys(fn);var Lt=lt({__name:"base-table",props:{type:{type:String,required:!1},options:{type:null,required:!1},records:{type:Array,required:!1},width:{type:[Number,String],required:!1,default:"100%"},height:{type:[Number,String],required:!1,default:"100%"},onReady:{type:Function,required:!1},onError:{type:Function,required:!1},onClickCell:{type:null,required:!1},onDblClickCell:{type:null,required:!1},onMouseDownCell:{type:null,required:!1},onMouseUpCell:{type:null,required:!1},onSelectedCell:{type:null,required:!1},onKeyDown:{type:null,required:!1},onMouseEnterTable:{type:null,required:!1},onMouseLeaveTable:{type:null,required:!1},onMouseDownTable:{type:null,required:!1},onMouseMoveCell:{type:null,required:!1},onMouseEnterCell:{type:null,required:!1},onMouseLeaveCell:{type:null,required:!1},onContextMenuCell:{type:null,required:!1},onResizeColumn:{type:null,required:!1},onResizeColumnEnd:{type:null,required:!1},onChangeHeaderPosition:{type:null,required:!1},onChangeHeaderPositionStart:{type:null,required:!1},onChangeHeaderPositionFail:{type:null,required:!1},onSortClick:{type:null,required:!1},onFreezeClick:{type:null,required:!1},onScroll:{type:null,required:!1},onDropdownMenuClick:{type:null,required:!1},onMouseOverChartSymbol:{type:null,required:!1},onDragSelectEnd:{type:null,required:!1},onDropdownIconClick:{type:null,required:!1},onDropdownMenuClear:{type:null,required:!1},onTreeHierarchyStateChange:{type:null,required:!1},onShowMenu:{type:null,required:!1},onHideMenu:{type:null,required:!1},onIconClick:{type:null,required:!1},onLegendItemClick:{type:null,required:!1},onLegendItemHover:{type:null,required:!1},onLegendItemUnHover:{type:null,required:!1},onLegendChange:{type:null,required:!1},onMouseEnterAxis:{type:null,required:!1},onMouseLeaveAxis:{type:null,required:!1},onCheckboxStateChange:{type:null,required:!1},onRadioStateChange:{type:null,required:!1},onAfterRender:{type:null,required:!1},onInitialized:{type:null,required:!1},onPivotSortClick:{type:null,required:!1},onDrillMenuClick:{type:null,required:!1},onVChartEventType:{type:null,required:!1},onChangeCellValue:{type:null,required:!1},onMousedownFillHandle:{type:null,required:!1},onDragFillHandleEnd:{type:null,required:!1},onDblclickFillHandle:{type:null,required:!1},onScrollVerticalEnd:{type:null,required:!1},onScrollHorizontalEnd:{type:null,required:!1}},emits:Ut,setup(D,{expose:e,emit:t}){const n=D,i=Fe(null),r=It(null);e({vTableInstance:r});const l=Ae(()=>typeof n.width=="number"?`${n.width}px`:n.width),s=Ae(()=>typeof n.height=="number"?`${n.height}px`:n.height),o=t,a=u=>{Ut.forEach(f=>{const g=m=>{o(f,m)};u.on(fn[f],g)})},d=(u,f)=>{r.value=new u(i.value,f)},h=()=>{var u,f;if(!i.value)return;r.value&&r.value.release();const g=()=>n.records!==void 0&&n.records!==null&&n.records.length>0?n.records:n.options.records;try{switch(n.type){case"list":d(Tt,Object.assign(Object.assign({},n.options),{records:g()}));break;case"pivot":d(Pt,Object.assign(Object.assign({},n.options),{records:g()}));break;case"chart":d(St,Object.assign(Object.assign({},n.options),{records:g()}));break}a(r.value),(u=n.onReady)===null||u===void 0||u.call(n,r.value,!0)}catch(m){(f=n.onError)===null||f===void 0||f.call(n,m)}},c=u=>{var f;if(r.value)try{switch(n.type){case"list":r.value instanceof Tt&&r.value.updateOption(u);break;case"pivot":r.value instanceof Pt&&r.value.updateOption(u);break;case"chart":r.value instanceof St&&r.value.updateOption(u);break}}catch(g){(f=n.onError)===null||f===void 0||f.call(n,g)}};return Gt(h),Tn(()=>{var u;return(u=r.value)===null||u===void 0?void 0:u.release()}),xt(()=>n.options,u=>{r.value?c(u):h()}),xt(()=>n.records,(u,f)=>{r.value?c(Object.assign(Object.assign({},n.options),{records:u})):h()},{deep:!0}),(u,f)=>(xe(),ze("div",{ref_key:"vTableContainer",ref:i,style:rt([{width:l.value,height:s.value},{position:"relative"}])},null,4))}}),wt=lt({__name:"list-table",props:{options:{type:Object,required:!0},records:{type:Array,required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1}},setup(D,{expose:e}){const t=D,n=Fe(null),i=Rt(),r=Ae(()=>{var l;const s=ct(((l=i.default)===null||l===void 0?void 0:l.call(i))||[]),o=pi(s);return Kt(t.options,o)});return e({vTableInstance:Ae(()=>{var l;return((l=n.value)===null||l===void 0?void 0:l.vTableInstance)||null})}),(l,s)=>(xe(),ze(et,null,[K(Lt,Dt({type:"list",options:r.value,records:l.records,width:l.width,height:l.height,ref_key:"baseTableRef",ref:n},l.$attrs),null,16,["options","records","width","height"]),Ft(l.$slots,"default")],64))}}),mi=lt({__name:"pivot-table",props:{options:{type:Object,required:!0},records:{type:Array,required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1}},setup(D,{expose:e}){const t=D,n=It(null),i=Rt(),r=Ae(()=>{var l;const s=ct(((l=i.default)===null||l===void 0?void 0:l.call(i))||[]),o=cn(s);return Kt(t.options,o)});return e({vTableInstance:Ae(()=>{var l;return((l=n.value)===null||l===void 0?void 0:l.vTableInstance)||null})}),(l,s)=>(xe(),ze(et,null,[K(Lt,Dt({type:"pivot",options:r.value,records:l.records,width:l.width,height:l.height,ref_key:"baseTableRef",ref:n},l.$attrs),null,16,["options","records","width","height"]),Ft(l.$slots,"default")],64))}}),_i=lt({__name:"pivot-chart",props:{options:{type:Object,required:!0},records:{type:Array,required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1}},setup(D,{expose:e}){const t=D,n=It(null),i=Rt(),r=Ae(()=>{var l;const s=ct(((l=i.default)===null||l===void 0?void 0:l.call(i))||[]),o=cn(s);return Kt(t.options,o)});return e({vTableInstance:Ae(()=>{var l;return((l=n.value)===null||l===void 0?void 0:l.vTableInstance)||null})}),(l,s)=>(xe(),ze(et,null,[K(Lt,Dt({type:"chart",options:r.value,records:l.records,width:l.width,height:l.height,ref_key:"baseTableRef",ref:n},l.$attrs),null,16,["options","records","width","height"]),Ft(l.$slots,"default")],64))}});const wi=(D,e)=>{ii(D,e)};function X(D){return null}X.symbol="ListColumn";function gn(D){return null}gn.symbol="PivotColumnDimension";function Cn(D){return null}Cn.symbol="PivotRowDimension";function yn(D){return null}yn.symbol="PivotIndicator";function pn(D){return null}pn.symbol="PivotCorner";function mn(D){return null}mn.symbol="Menu";function Ze(){return null}Ze.symbol="Group";function bt(){return null}bt.symbol="Image";function vt(){return null}vt.symbol="Text";function _n(D){return null}_n.symbol="Tag";const qt=[{"Row ID":"7981","Order ID":"CA-2015-103800","Order Date":"2015/1/3","Ship Date":"2015/1/7","Ship Mode":"Standard Class","Customer ID":"DP-13000","Customer Name":"Darren Powers",Segment:"Consumer",Country:"United States",City:"Houston",State:"Texas","Postal Code":"77095",Region:"Central","Product ID":"OFF-PA-10000174",Category:"Office Supplies","Sub-Category":"Paper","Product Name":'Message Book, Wirebound, Four 5 1/2" X 4" Forms/Pg., 200 Dupl. Sets/Book',Sales:"16.448",Quantity:"2",Discount:"0.2",Profit:"5.5512"},{"Row ID":"740","Order ID":"CA-2015-112326","Order Date":"2015/1/4","Ship Date":"2015/1/8","Ship Mode":"Standard Class","Customer ID":"PO-19195","Customer Name":"Phillina Ober",Segment:"Home Office",Country:"United States",City:"Naperville",State:"Illinois","Postal Code":"60540",Region:"Central","Product ID":"OFF-LA-10003223",Category:"Office Supplies","Sub-Category":"Labels","Product Name":"Avery 508",Sales:"11.784",Quantity:"3",Discount:"0.2",Profit:"4.2717"},{"Row ID":"741","Order ID":"CA-2015-112326","Order Date":"2015/1/4","Ship Date":"2015/1/8","Ship Mode":"Standard Class","Customer ID":"PO-19195","Customer Name":"Phillina Ober",Segment:"Home Office",Country:"United States",City:"Naperville",State:"Illinois","Postal Code":"60540",Region:"Central","Product ID":"OFF-ST-10002743",Category:"Office Supplies","Sub-Category":"Storage","Product Name":"SAFCO Boltless Steel Shelving",Sales:"272.736",Quantity:"3",Discount:"0.2",Profit:"-64.7748"},{"Row ID":"742","Order ID":"CA-2015-112326","Order Date":"2015/1/4","Ship Date":"2015/1/8","Ship Mode":"Standard Class","Customer ID":"PO-19195","Customer Name":"Phillina Ober",Segment:"Home Office",Country:"United States",City:"Naperville",State:"Illinois","Postal Code":"60540",Region:"Central","Product ID":"OFF-BI-10004094",Category:"Office Supplies","Sub-Category":"Binders","Product Name":"GBC Standard Plastic Binding Systems Combs",Sales:"3.54",Quantity:"2",Discount:"0.8",Profit:"-5.487"},{"Row ID":"1760","Order ID":"CA-2015-141817","Order Date":"2015/1/5","Ship Date":"2015/1/12","Ship Mode":"Standard Class","Customer ID":"MB-18085","Customer Name":"Mick Brown",Segment:"Consumer",Country:"United States",City:"Philadelphia",State:"Pennsylvania","Postal Code":"19143",Region:"East","Product ID":"OFF-AR-10003478",Category:"Office Supplies","Sub-Category":"Art","Product Name":"Avery Hi-Liter EverBold Pen Style Fluorescent Highlighters, 4/Pack",Sales:"19.536",Quantity:"3",Discount:"0.2",Profit:"4.884"},{"Row ID":"5328","Order ID":"CA-2015-130813","Order Date":"2015/1/6","Ship Date":"2015/1/8","Ship Mode":"Second Class","Customer ID":"LS-17230","Customer Name":"Lycoris Saunders",Segment:"Consumer",Country:"United States",City:"Los Angeles",State:"California","Postal Code":"90049",Region:"West","Product ID":"OFF-PA-10002005",Category:"Office Supplies","Sub-Category":"Paper","Product Name":"Xerox 225",Sales:"19.44",Quantity:"3",Discount:"0",Profit:"9.3312"},{"Row ID":"7181","Order ID":"CA-2015-106054","Order Date":"2015/1/6","Ship Date":"2015/1/7","Ship Mode":"First Class","Customer ID":"JO-15145","Customer Name":"Jack O'Briant",Segment:"Corporate",Country:"United States",City:"Athens",State:"Georgia","Postal Code":"30605",Region:"South","Product ID":"OFF-AR-10002399",Category:"Office Supplies","Sub-Category":"Art","Product Name":"Dixon Prang Watercolor Pencils, 10-Color Set with Brush",Sales:"12.78",Quantity:"3",Discount:"0",Profit:"5.2398"},{"Row ID":"7475","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"FUR-CH-10004063",Category:"Furniture","Sub-Category":"Chairs","Product Name":"Global Deluxe High-Back Manager's Chair",Sales:"2573.82",Quantity:"9",Discount:"0",Profit:"746.4078"},{"Row ID":"7476","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"OFF-BI-10004632",Category:"Office Supplies","Sub-Category":"Binders","Product Name":"Ibico Hi-Tech Manual Binding System",Sales:"609.98",Quantity:"2",Discount:"0",Profit:"274.491"},{"Row ID":"7477","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"OFF-AR-10001662",Category:"Office Supplies","Sub-Category":"Art","Product Name":"Rogers Handheld Barrel Pencil Sharpener",Sales:"5.48",Quantity:"2",Discount:"0",Profit:"1.4796"},{"Row ID":"7478","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"TEC-PH-10004977",Category:"Technology","Sub-Category":"Phones","Product Name":"GE 30524EE4",Sales:"391.98",Quantity:"2",Discount:"0",Profit:"113.6742"},{"Row ID":"7479","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"TEC-PH-10004539",Category:"Technology","Sub-Category":"Phones","Product Name":"Wireless Extenders zBoost YX545 SOHO Signal Booster",Sales:"755.96",Quantity:"4",Discount:"0",Profit:"204.1092"},{"Row ID":"7480","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"OFF-FA-10001883",Category:"Office Supplies","Sub-Category":"Fasteners","Product Name":"Alliance Super-Size Bands, Assorted Sizes",Sales:"31.12",Quantity:"4",Discount:"0",Profit:"0.3112"},{"Row ID":"7481","Order ID":"CA-2015-167199","Order Date":"2015/1/6","Ship Date":"2015/1/10","Ship Mode":"Standard Class","Customer ID":"ME-17320","Customer Name":"Maria Etezadi",Segment:"Home Office",Country:"United States",City:"Henderson",State:"Kentucky","Postal Code":"42420",Region:"South","Product ID":"OFF-PA-10000955",Category:"Office Supplies","Sub-Category":"Paper","Product Name":"Southworth 25% Cotton Granite Paper & Envelopes",Sales:"6.54",Quantity:"1",Discount:"0",Profit:"3.0084"},{"Row ID":"7661","Order ID":"CA-2015-105417","Order Date":"2015/1/7","Ship Date":"2015/1/12","Ship Mode":"Standard Class","Customer ID":"VS-21820","Customer Name":"Vivek Sundaresam",Segment:"Consumer",Country:"United States",City:"Huntsville",State:"Texas","Postal Code":"77340",Region:"Central","Product ID":"FUR-FU-10004864",Category:"Furniture","Sub-Category":"Furnishings","Product Name":'Howard Miller 14-1/2" Diameter Chrome Round Wall Clock',Sales:"76.728",Quantity:"3",Discount:"0.6",Profit:"-53.7096"},{"Row ID":"7662","Order ID":"CA-2015-105417","Order Date":"2015/1/7","Ship Date":"2015/1/12","Ship Mode":"Standard Class","Customer ID":"VS-21820","Customer Name":"Vivek Sundaresam",Segment:"Consumer",Country:"United States",City:"Huntsville",State:"Texas","Postal Code":"77340",Region:"Central","Product ID":"OFF-BI-10003708",Category:"Office Supplies","Sub-Category":"Binders","Product Name":'Acco Four Pocket Poly Ring Binder with Label Holder, Smoke, 1"',Sales:"10.43",Quantity:"7",Discount:"0.8",Profit:"-18.2525"},{"Row ID":"593","Order ID":"CA-2015-135405","Order Date":"2015/1/9","Ship Date":"2015/1/13","Ship Mode":"Standard Class","Customer ID":"MS-17830","Customer Name":"Melanie Seite",Segment:"Consumer",Country:"United States",City:"Laredo",State:"Texas","Postal Code":"78041",Region:"Central","Product ID":"OFF-AR-10004078",Category:"Office Supplies","Sub-Category":"Art","Product Name":"Newell 312",Sales:"9.344",Quantity:"2",Discount:"0.2",Profit:"1.168"},{"Row ID":"594","Order ID":"CA-2015-135405","Order Date":"2015/1/9","Ship Date":"2015/1/13","Ship Mode":"Standard Class","Customer ID":"MS-17830","Customer Name":"Melanie Seite",Segment:"Consumer",Country:"United States",City:"Laredo",State:"Texas","Postal Code":"78041",Region:"Central","Product ID":"TEC-AC-10001266",Category:"Technology","Sub-Category":"Accessories","Product Name":"Memorex Micro Travel Drive 8 GB",Sales:"31.2",Quantity:"3",Discount:"0.2",Profit:"9.75"},{"Row ID":"866","Order ID":"CA-2015-149020","Order Date":"2015/1/10","Ship Date":"2015/1/15","Ship Mode":"Standard Class","Customer ID":"AJ-10780","Customer Name":"Anthony Jacobs",Segment:"Corporate",Country:"United States",City:"Springfield",State:"Virginia","Postal Code":"22153",Region:"South","Product ID":"OFF-LA-10004272",Category:"Office Supplies","Sub-Category":"Labels","Product Name":"Avery 482",Sales:"2.89",Quantity:"1",Discount:"0",Profit:"1.3583"},{"Row ID":"867","Order ID":"CA-2015-149020","Order Date":"2015/1/10","Ship Date":"2015/1/15","Ship Mode":"Standard Class","Customer ID":"AJ-10780","Customer Name":"Anthony Jacobs",Segment:"Corporate",Country:"United States",City:"Springfield",State:"Virginia","Postal Code":"22153",Region:"South","Product ID":"FUR-FU-10000965",Category:"Furniture","Sub-Category":"Furnishings","Product Name":'Howard Miller 11-1/2" Diameter Ridgewood Wall Clock',Sales:"51.94",Quantity:"1",Discount:"0",Profit:"21.2954"},{"Row ID":"717","Order ID":"CA-2015-130092","Order Date":"2015/1/11","Ship Date":"2015/1/14","Ship Mode":"First Class","Customer ID":"SV-20365","Customer Name":"Seth Vernon",Segment:"Consumer",Country:"United States",City:"Dover",State:"Delaware","Postal Code":"19901",Region:"East","Product ID":"FUR-FU-10000010",Category:"Furniture","Sub-Category":"Furnishings","Product Name":"DAX Value U-Channel Document Frames, Easel Back",Sales:"9.94",Quantity:"2",Discount:"0",Profit:"3.0814"},{"Row ID":"764","Order ID":"CA-2015-162775","Order Date":"2015/1/13","Ship Date":"2015/1/15","Ship Mode":"Second Class","Customer ID":"CS-12250","Customer Name":"Chris Selesnick",Segment:"Corporate",Country:"United States",City:"Bossier City",State:"Louisiana","Postal Code":"71111",Region:"South","Product ID":"OFF-EN-10001990",Category:"Office Supplies","Sub-Category":"Envelopes","Product Name":"Staple envelope",Sales:"11.36",Quantity:"2",Discount:"0",Profit:"5.3392"},{"Row ID":"765","Order ID":"CA-2015-162775","Order Date":"2015/1/13","Ship Date":"2015/1/15","Ship Mode":"Second Class","Customer ID":"CS-12250","Customer Name":"Chris Selesnick",Segment:"Corporate",Country:"United States",City:"Bossier City",State:"Louisiana","Postal Code":"71111",Region:"South","Product ID":"OFF-EN-10001532",Category:"Office Supplies","Sub-Category":"Envelopes","Product Name":"Brown Kraft Recycled Envelopes",Sales:"50.94",Quantity:"3",Discount:"0",Profit:"25.47"},{"Row ID":"766","Order ID":"CA-2015-162775","Order Date":"2015/1/13","Ship Date":"2015/1/15","Ship Mode":"Second Class","Customer ID":"CS-12250","Customer Name":"Chris Selesnick",Segment:"Corporate",Country:"United States",City:"Bossier City",State:"Louisiana","Postal Code":"71111",Region:"South","Product ID":"TEC-AC-10003174",Category:"Technology","Sub-Category":"Accessories","Product Name":"Plantronics S12 Corded Telephone Headset System",Sales:"646.74",Quantity:"6",Discount:"0",Profit:"258.696"},{"Row ID":"767","Order ID":"CA-2015-162775","Order Date":"2015/1/13","Ship Date":"2015/1/15","Ship Mode":"Second Class","Customer ID":"CS-12250","Customer Name":"Chris Selesnick",Segment:"Corporate",Country:"United States",City:"Bossier City",State:"Louisiana","Postal Code":"71111",Region:"South","Product ID":"OFF-BI-10004187",Category:"Office Supplies","Sub-Category":"Binders","Product Name":"3-ring staple pack",Sales:"5.64",Quantity:"3",Discount:"0",Profit:"2.7072"},{"Row ID":"768","Order ID":"CA-2015-162775","Order Date":"2015/1/13","Ship Date":"2015/1/15","Ship Mode":"Second Class","Customer ID":"CS-12250","Customer Name":"Chris Selesnick",Segment:"Corporate",Country:"United States",City:"Bossier City",State:"Louisiana","Postal Code":"71111",Region:"South","Product ID":"OFF-ST-10000025",Category:"Office Supplies","Sub-Category":"Storage","Product Name":"Fellowes Stor/Drawer Steel Plus Storage Drawers",Sales:"572.58",Quantity:"6",Discount:"0",Profit:"34.3548"},{"Row ID":"2979","Order ID":"CA-2015-109232","Order Date":"2015/1/13","Ship Date":"2015/1/16","Ship Mode":"Second Class","Customer ID":"ND-18370","Customer Name":"Natalie DeCherney",Segment:"Consumer",Country:"United States",City:"Mount Pleasant",State:"South Carolina","Postal Code":"29464",Region:"South","Product ID":"FUR-CH-10000422",Category:"Furniture","Sub-Category":"Chairs","Product Name":"Global Highback Leather Tilter in Burgundy",Sales:"545.94",Quantity:"6",Discount:"0",Profit:"87.3504"},{"Row ID":"4938","Order ID":"CA-2015-157147","Order Date":"2015/1/13","Ship Date":"2015/1/18","Ship Mode":"Standard Class","Customer ID":"BD-11605","Customer Name":"Brian Dahlen",Segment:"Consumer",Country:"United States",City:"San Francisco",State:"California","Postal Code":"94109",Region:"West","Product ID":"OFF-ST-10000078",Category:"Office Supplies","Sub-Category":"Storage","Product Name":"Tennsco 6- and 18-Compartment Lockers",Sales:"1325.85",Quantity:"5",Discount:"0",Profit:"238.653"},{"Row ID":"4939","Order ID":"CA-2015-157147","Order Date":"2015/1/13","Ship Date":"2015/1/18","Ship Mode":"Standard Class","Customer ID":"BD-11605","Customer Name":"Brian Dahlen",Segment:"Consumer",Country:"United States",City:"San Francisco",State:"California","Postal Code":"94109",Region:"West","Product ID":"FUR-BO-10003034",Category:"Furniture","Sub-Category":"Bookcases","Product Name":"O'Sullivan Elevations Bookcase, Cherry Finish",Sales:"333.999",Quantity:"3",Discount:"0.15",Profit:"3.9294"},{"Row ID":"4940","Order ID":"CA-2015-157147","Order Date":"2015/1/13","Ship Date":"2015/1/18","Ship Mode":"Standard Class","Customer ID":"BD-11605","Customer Name":"Brian Dahlen",Segment:"Consumer",Country:"United States",City:"San Francisco",State:"California","Postal Code":"94109",Region:"West","Product ID":"OFF-AR-10003514",Category:"Office Supplies","Sub-Category":"Art","Product Name":"4009 Highlighters by Sanford",Sales:"19.9",Quantity:"5",Discount:"0",Profit:"6.567"}],Hi=[{bloggerId:1,bloggerName:"Virtual Anchor Xiaohua",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/flower.jpg",introduction:"Hi everyone, I am Xiaohua, the virtual host. I am a little fairy who likes games, animation and food. I hope to share happy moments with you through live broadcast.",fansCount:400,worksCount:10,viewCount:5,city:"Dream City",tags:["game","anime","food"]},{bloggerId:2,bloggerName:"Virtual anchor little wolf",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/wolf.jpg",introduction:"Hello everyone, I am the virtual anchor Little Wolf. I like music, travel and photography, and I hope to explore the beauty of the world with you through live broadcast.",fansCount:800,worksCount:20,viewCount:15,city:"City of Music",tags:["music","travel","photography"]},{bloggerId:3,bloggerName:"Virtual anchor bunny",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/rabbit.jpg",introduction:"Hello everyone, I am the virtual anchor Xiaotu. I like painting, handicrafts and beauty makeup. I hope to share creativity and fashion with you through live broadcast.",fansCount:600,worksCount:15,viewCount:10,city:"City of Art",tags:["painting","handmade","beauty makeup"]},{bloggerId:4,bloggerName:"Virtual anchor kitten",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/cat.jpg",introduction:"Hello everyone, I am the virtual host Kitty. I am a lazy cat who likes dancing, fitness and cooking. I hope to live a healthy and happy life with everyone through the live broadcast.",fansCount:1e3,worksCount:30,viewCount:20,city:"Health City",tags:["dance","fitness","cooking"]},{bloggerId:5,bloggerName:"Virtual anchor Bear",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/bear.jpg",introduction:"Hello everyone, I am the virtual host Xiaoxiong. A little wise man who likes movies, reading and philosophy, I hope to explore the meaning of life with you through live broadcast.",fansCount:1200,worksCount:25,viewCount:18,city:"City of Wisdom",tags:["Movie","Literature"]},{bloggerId:6,bloggerName:"Virtual anchor bird",bloggerAvatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/bird.jpeg",introduction:"Hello everyone, I am the virtual anchor Xiaoniao. I like singing, acting and variety shows. I hope to be happy with everyone through the live broadcast.",fansCount:900,worksCount:12,viewCount:8,city:"Happy City",tags:["music","performance","variety"]}],Ti=[{dimensionKey:"Region",title:"Region",headerStyle:{textStick:!0}},"Category"],Pi=[{dimensionKey:"Order Year",title:"Order Year",headerStyle:{textStick:!0}},"Ship Mode"],Si=[{indicatorKey:"Quantity",title:"Quantity",width:"auto",cellType:"chart",chartModule:"vchart",chartSpec:{stack:!0,type:"bar",data:{id:"data",fields:{"Sub-Category":{sortIndex:0,domain:["Chairs","Tables","Bookcases","Furnishings","Binders","Art","Storage","Appliances","Envelopes","Fasteners","Paper","Labels","Supplies","Accessories","Phones","Copiers","Machines"]},"Segment-Indicator":{sortIndex:1,domain:["Consumer-Quantity","Corporate-Quantity","Home Office-Quantity","Consumer-Sales","Corporate-Sales","Home Office-Sales","Consumer-Profit","Corporate-Profit","Home Office-Profit"]}}},xField:["Sub-Category"],yField:"Quantity",seriesField:"Segment-Indicator",axes:[{orient:"left",visible:!0,label:{visible:!0}},{orient:"bottom",visible:!0}],bar:{state:{selected:{fill:"yellow"},selected_reverse:{opacity:.2}}},scales:[{id:"color",type:"ordinal",domain:["Consumer-Quantity","Corporate-Quantity","Home Office-Quantity","Consumer-Sales","Corporate-Sales","Home Office-Sales","Consumer-Profit","Corporate-Profit","Home Office-Profit"],range:["#2E62F1","#4DC36A","#FF8406","#FFCC00","#4F44CF","#5AC8FA","#003A8C","#B08AE2","#FF6341","#98DD62","#07A199","#87DBDD"]}]},style:{padding:1}},{indicatorKey:"Sales",title:"Sales & Profit",cellType:"chart",chartModule:"vchart",chartSpec:{type:"common",series:[{type:"bar",data:{id:"data1",fields:{"Sub-Category":{sortIndex:0,domain:["Chairs","Tables","Bookcases","Furnishings","Binders","Art","Storage","Appliances","Envelopes","Fasteners","Paper","Labels","Supplies","Accessories","Phones","Copiers","Machines"]},"Segment-Indicator":{sortIndex:1,domain:["Consumer-Quantity","Corporate-Quantity","Home Office-Quantity","Consumer-Sales","Corporate-Sales","Home Office-Sales","Consumer-Profit","Corporate-Profit","Home Office-Profit"]}}},stack:!0,xField:["Sub-Category"],yField:"Sales",seriesField:"Segment-Indicator",bar:{state:{selected:{fill:"yellow"},selected_reverse:{opacity:.2}}}},{type:"line",data:{id:"data2",fields:{"Sub-Category":{sortIndex:0,domain:["Chairs","Tables","Bookcases","Furnishings","Binders","Art","Storage","Appliances","Envelopes","Fasteners","Paper","Labels","Supplies","Phones","Accessories","Machines","Copiers"]},"Segment-Indicator":{sortIndex:1,domain:["Consumer-Quantity","Corporate-Quantity","Home Office-Quantity","Consumer-Sales","Corporate-Sales","Home Office-Sales","Consumer-Profit","Corporate-Profit","Home Office-Profit"]}}},stack:!1,xField:["Sub-Category"],yField:"Profit",seriesField:"Segment-Indicator",line:{state:{selected:{lineWidth:3},selected_reverse:{lineWidth:1}}},point:{state:{selected:{fill:"yellow"},selected_reverse:{fill:"#ddd"}}}}],scales:[{id:"color",type:"ordinal",domain:["Consumer-Quantity","Corporate-Quantity","Home Office-Quantity","Consumer-Sales","Corporate-Sales","Home Office-Sales","Consumer-Profit","Corporate-Profit","Home Office-Profit"],range:["#2E62F1","#4DC36A","#FF8406","#FFCC00","#4F44CF","#5AC8FA","#003A8C","#B08AE2","#FF6341","#98DD62","#07A199","#87DBDD"]}]},style:{padding:1}}],bi={class:"h-full"},zi=lt({name:"plugin_tables_vtable",__name:"index",setup(D){wi("vchart",Hn);const e=["#3370ff","#34c724","#ff9f1a","#ff4050","#1f2329"],t=Pn(),n=Fe(null),i=Ae(()=>({theme:t.darkMode?nt:it})),r=Fe(qt),l=Fe(null),s=Ae(()=>({groupBy:["Category","Sub-Category"],theme:(t.darkMode?nt:it).extends({groupTitleStyle:{fontWeight:"bold",bgColor:I=>{const{col:H,row:C,table:P}=I,T=P.getGroupTitleLevel(H,C);return T!==void 0?e[T%e.length]:"white"}}})})),o=Fe(qt),a=Fe(null),d=Ae(()=>({tooltip:{isShowOverflowTextTooltip:!0},dataConfig:{sortRules:[{sortField:"Category",sortBy:["Office Supplies","Technology","Furniture"]}]},widthMode:"standard",theme:t.darkMode?nt:it,emptyTip:{text:"no data records"}})),h=Fe([{indicatorKey:"Quantity",title:"Quantity",width:"auto",showSort:!1,headerStyle:{fontWeight:"normal"},style:{padding:[16,28,16,28],color(p){return p.dataValue>=0?"black":"red"}}},{indicatorKey:"Sales",title:"Sales",width:"auto",showSort:!1,headerStyle:{fontWeight:"normal"},format:p=>`$${Number(p).toFixed(2)}`,style:{padding:[16,28,16,28],color(p){return p.dataValue>=0?"black":"red"}}},{indicatorKey:"Profit",title:"Profit",width:"auto",showSort:!1,headerStyle:{fontWeight:"normal"},format:p=>`$${Number(p).toFixed(2)}`,style:{padding:[16,28,16,28],color(p){return p.dataValue>=0?"black":"red"}}}]),c=Fe([{dimensionKey:"City",title:"City",headerStyle:{textStick:!0},width:"auto"}]),u=Fe([]),f=Fe(null),g=Ae(()=>({rows:Pi,columns:Ti,indicators:Si,indicatorsAsCol:!1,defaultRowHeight:200,defaultHeaderRowHeight:50,defaultColWidth:280,defaultHeaderColWidth:100,indicatorTitle:"指标",autoWrapText:!0,corner:{titleOnDimension:"row",headerStyle:{autoWrapText:!0}},legends:{orient:"bottom",type:"discrete",data:[{label:"Consumer-Quantity",shape:{fill:"#2E62F1",symbolType:"circle"}},{label:"Consumer-Quantity",shape:{fill:"#4DC36A",symbolType:"square"}},{label:"Home Office-Quantity",shape:{fill:"#FF8406",symbolType:"square"}},{label:"Consumer-Sales",shape:{fill:"#FFCC00",symbolType:"square"}},{label:"Consumer-Sales",shape:{fill:"#4F44CF",symbolType:"square"}},{label:"Home Office-Sales",shape:{fill:"#5AC8FA",symbolType:"square"}},{label:"Consumer-Profit",shape:{fill:"#003A8C",symbolType:"square"}},{label:"Consumer-Profit",shape:{fill:"#B08AE2",symbolType:"square"}},{label:"Home Office-Profit",shape:{fill:"#FF6341",symbolType:"square"}}]},theme:(t.darkMode?nt:it).extends({bodyStyle:{borderColor:"gray",borderLineWidth:[1,0,0,1]},headerStyle:{borderColor:"gray",borderLineWidth:[0,0,1,1],hover:{cellBgColor:"#CCE0FF"}},rowHeaderStyle:{borderColor:"gray",borderLineWidth:[1,1,0,0],hover:{cellBgColor:"#CCE0FF"}},cornerHeaderStyle:{borderColor:"gray",borderLineWidth:[0,1,1,0],hover:{cellBgColor:""}},cornerRightTopCellStyle:{borderColor:"gray",borderLineWidth:[0,0,1,1],hover:{cellBgColor:""}},cornerLeftBottomCellStyle:{borderColor:"gray",borderLineWidth:[1,1,0,0],hover:{cellBgColor:""}},cornerRightBottomCellStyle:{borderColor:"gray",borderLineWidth:[1,0,0,1],hover:{cellBgColor:""}},rightFrozenStyle:{borderColor:"gray",borderLineWidth:[1,0,1,1],hover:{cellBgColor:""}},bottomFrozenStyle:{borderColor:"gray",borderLineWidth:[1,1,0,1],hover:{cellBgColor:""}},selectionStyle:{cellBgColor:"",cellBorderColor:""},frameStyle:{borderLineWidth:0}}),emptyTip:{text:"no data records"}})),m=Fe({}),y=p=>{var I;(I=f==null?void 0:f.value)==null||I.vTableInstance.updateFilterRules([{filterKey:"Segment-Indicator",filteredValues:p.value}])},w=Fe(null),S=Ae(()=>({defaultRowHeight:80,theme:t.darkMode?nt:it})),b=Fe(Hi),_=Fe({fontFamily:"Arial",fontSize:12,fontWeight:"bold"});return Gt(()=>{fetch("https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/North_American_Superstore_Pivot_data.json").then(p=>p.json()).then(p=>{u.value=p}),fetch("https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/North_American_Superstore_Pivot_Chart_data.json").then(p=>p.json()).then(p=>{m.value=p})}),(p,I)=>{const H=Sn,C=wn,P=si;return xe(),ze("div",bi,[K(P,{vertical:"",size:16},{default:we(()=>[K(H,{title:"List Table",bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:we(()=>[K(V(wt),{ref_key:"listTableRef",ref:n,options:i.value,records:r.value,height:"400px"},{default:we(()=>[K(V(X),{field:"Order ID",title:"Order ID",width:"auto"}),K(V(X),{field:"Customer ID",title:"Customer ID",width:"auto"}),K(V(X),{field:"Product Name",title:"Product Name",width:"auto"}),K(V(X),{field:"Category",title:"Category",width:"auto"}),K(V(X),{field:"Sub-Category",title:"Sub-Category",width:"auto"}),K(V(X),{field:"Region",title:"Region",width:"auto"}),K(V(X),{field:"City",title:"City",width:"auto"}),K(V(X),{field:"Order Date",title:"Order Date",width:"auto"}),K(V(X),{field:"Quantity",title:"Quantity",width:"auto"}),K(V(X),{field:"Sales",title:"Sales",width:"auto"}),K(V(X),{field:"Profit",title:"Profit",width:"auto"})]),_:1},8,["options","records"])]),_:1}),K(H,{title:"Group Table",bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:we(()=>[K(V(wt),{ref_key:"groupTableRef",ref:l,options:s.value,records:o.value,height:"400px"},{default:we(()=>[K(V(X),{field:"Order ID",title:"Order ID",width:"auto"}),K(V(X),{field:"Customer ID",title:"Customer ID",width:"auto"}),K(V(X),{field:"Product Name",title:"Product Name",width:"auto"}),K(V(X),{field:"Category",title:"Category",width:"auto"}),K(V(X),{field:"Sub-Category",title:"Sub-Category",width:"auto"}),K(V(X),{field:"Region",title:"Region",width:"auto"}),K(V(X),{field:"City",title:"City",width:"auto"}),K(V(X),{field:"Order Date",title:"Order Date",width:"auto"}),K(V(X),{field:"Quantity",title:"Quantity",width:"auto"}),K(V(X),{field:"Sales",title:"Sales",width:"auto"}),K(V(X),{field:"Profit",title:"Profit",width:"auto"})]),_:1},8,["options","records"])]),_:1}),K(H,{title:"Pivot Table",bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:we(()=>[K(V(mi),{ref_key:"pivotTableRef",ref:a,options:d.value,records:u.value,height:"400px"},{default:we(()=>[K(V(gn),{title:"Category","dimension-key":"Category","header-style":{textStick:!0},width:"auto"}),(xe(!0),ze(et,null,ft(c.value,(T,v)=>(xe(),gt(V(Cn),{key:v,"dimension-key":T.dimensionKey,title:T.title,"header-style":T.headerStyle,width:T.width},null,8,["dimension-key","title","header-style","width"]))),128)),(xe(!0),ze(et,null,ft(h.value,(T,v)=>(xe(),gt(V(yn),{key:v,"indicator-key":T.indicatorKey,title:T.title,width:T.width,"show-sort":T.showSort,"header-style":T.headerStyle,format:T.format,style:rt(T.style)},null,8,["indicator-key","title","width","show-sort","header-style","format","style"]))),128)),K(V(pn),{"title-on-dimension":"row"}),K(V(mn),{"menu-type":"html","context-menu-items":["copy","paste","delete","..."]})]),_:1},8,["options","records"])]),_:1}),K(H,{title:"Pivot Chart",bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:we(()=>[K(V(_i),{ref_key:"pivotChartRef",ref:f,options:g.value,records:m.value,height:"800px",onOnLegendItemClick:y},null,8,["options","records"])]),_:1}),K(H,{title:"Custom Component",bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:we(()=>[K(V(wt),{ref_key:"customLayoutListTableRef",ref:w,options:S.value,records:b.value,height:"400px"},{default:we(()=>[K(V(X),{field:"bloggerId",title:"Order Number",width:"100"}),K(V(X),{field:"bloggerName",title:"Anchor Nickname",width:330},{customLayout:we(({record:T,height:v,width:A})=>[K(V(Ze),{height:v,width:A,display:"flex","flex-direction":"row","flex-wrap":"nowrap"},{default:we(()=>[K(V(Ze),{height:v,width:60,display:"flex","flex-direction":"column","align-items":"center","justify-content":"space-around",fill:"red",opacity:.1},{default:we(()=>[K(V(bt),{id:"icon0",width:50,height:50,image:T.bloggerAvatar,"corner-radius":25},null,8,["image"])]),_:2},1032,["height"]),K(V(Ze),{height:v,width:A-60,display:"flex","flex-direction":"column","flex-wrap":"nowrap"},{default:we(()=>[K(V(Ze),{height:v/2,width:A-60,display:"flex","flex-wrap":"wrap","align-items":"center",fill:"orange",opacity:.1},{default:we(()=>[K(V(vt),{text:T.bloggerName,"font-size":13,"font-family":"sans-serif",fill:"black","bounds-padding":[0,0,0,10]},null,8,["text"]),K(V(bt),{id:"location",image:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/location.svg",width:15,height:15,"bounds-padding":[0,0,0,10],cursor:"pointer"}),K(V(vt),{text:T.city,"font-size":11,"font-family":"sans-serif",fill:"#6f7070"},null,8,["text"])]),_:2},1032,["height","width"]),K(V(Ze),{height:v/2,width:A-60,display:"flex","align-items":"center",fill:"yellow",opacity:.1},{default:we(()=>[(xe(!0),ze(et,null,ft(T==null?void 0:T.tags,F=>(xe(),gt(V(_n),{key:F,text:F,"text-style":{fontSize:10,fontFamily:"sans-serif",fill:"rgb(51, 101, 238)"},panel:{visible:!0,fill:"#f4f4f2",cornerRadius:5},space:5,"bounds-padding":[0,0,0,5]},null,8,["text"]))),128))]),_:2},1032,["height","width"])]),_:2},1032,["height","width"])]),_:2},1032,["height","width"])]),_:1}),K(V(X),{field:"fansCount",title:"Fans Count",width:"120","field-format":T=>T.fansCount+"w",style:rt(_.value)},null,8,["field-format","style"]),K(V(X),{field:"worksCount",title:"Works Count",style:rt(_.value),width:"135"},null,8,["style"]),K(V(X),{field:"viewCount",title:"View Count",width:"120","field-format":T=>T.viewCount+"w",style:rt(_.value)},null,8,["field-format","style"])]),_:1},8,["options","records"])]),_:1}),K(H,{bordered:!1,class:"h-full w-2/3 card-wrapper"},{default:we(()=>[K(C,{label:"More VTable Demos: ",link:"https://www.visactor.com/vtable/example"})]),_:1})]),_:1})])}}});export{zi as default};
