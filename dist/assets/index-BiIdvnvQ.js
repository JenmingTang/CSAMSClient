import{u as S,b as p,w as T,_ as B}from"./table-Gm6yRvUm.js";import{y as C,d as v,z as E,o as j,b as z,f as r,w as u,h as i,B as M,g as V,$ as s,V as f,J as L,W as P}from"./index-D6W6_zXP.js";import{a as g,b as h}from"./business-B55Z98WP.js";import{_ as R}from"./Space-zKntJrGG.js";import{_ as W}from"./DataTable-BesTDHU0.js";import"./get-slot-Bk_rJcZu.js";import"./Pagination-BQ2WJ-Rm.js";function $(l){return C({url:"/systemManage/getUserList",method:"get",params:l})}const F={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function x(l){return typeof l=="function"||Object.prototype.toString.call(l)==="[object Object]"&&!P(l)}const K=v({name:"plugin_excel",__name:"index",setup(l){const y=E(),{columns:d,data:_,loading:k}=S({apiFn:$,showTotal:!0,apiParams:{current:1,size:999,status:null,userName:null,userGender:null,nickName:null,userPhone:null,userEmail:null},columns:()=>[{type:"selection",align:"center",width:48},{key:"index",title:s("common.index"),align:"center",width:64},{key:"userName",title:s("page.manage.user.userName"),align:"center",minWidth:100},{key:"userGender",title:s("page.manage.user.userGender"),align:"center",width:100,render:e=>{if(e.userGender===null)return null;const n={1:"primary",2:"error"},t=s(g[e.userGender]);return r(f,{type:n[e.userGender]},x(t)?t:{default:()=>[t]})}},{key:"nickName",title:s("page.manage.user.nickName"),align:"center",minWidth:100},{key:"userPhone",title:s("page.manage.user.userPhone"),align:"center",width:120},{key:"userEmail",title:s("page.manage.user.userEmail"),align:"center",minWidth:200},{key:"status",title:s("page.manage.user.userStatus"),align:"center",width:100,render:e=>{if(e.status===null)return null;const n={1:"success",2:"warning"},t=s(h[e.status]);return r(f,{type:n[e.status]},x(t)?t:{default:()=>[t]})}}]});function b(){const e=d.value.slice(2),n=_.value.map(a=>e.map(m=>w(m,a))),t=e.map(a=>G(a)&&a.title||null);n.unshift(t);const o=p.book_new(),c=p.aoa_to_sheet(n);c["!cols"]=e.map(a=>({width:Math.round(Number(a.width)/10||20)})),p.book_append_sheet(o,c,"用户列表"),T(o,"用户数据.xlsx")}function w(e,n){if(!N(e))return null;const{key:t}=e;return t==="operate"?null:t==="userRoles"?n.userRoles.map(o=>o).join(","):t==="status"?n.status&&s(h[n.status])||null:t==="userGender"?n.userGender&&s(g[n.userGender])||null:n[t]}function N(e){return!!e.key}function G(e){return!!e.title}return(e,n)=>{const t=B,o=R,c=W,a=L;return j(),z("div",F,[r(a,{title:"Excel导出",bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":u(()=>[r(o,{align:"end",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:u(()=>[r(i(M),{size:"small",ghost:"",type:"primary",onClick:b},{icon:u(()=>[r(t,{class:"text-icon"})]),default:u(()=>[n[0]||(n[0]=V(" 导出excel "))]),_:1})]),_:1})]),default:u(()=>[r(c,{columns:i(d),data:i(_),size:"small","flex-height":!i(y).isMobile,"scroll-x":962,loading:i(k),remote:"","row-key":m=>m.id,pagination:!1,"virtual-scroll":!0,class:"sm:h-full"},null,8,["columns","data","flex-height","loading","row-key"])]),_:1})])}}});export{K as default};
