var mC=Object.defineProperty;var _1=r=>{throw TypeError(r)};var bC=(r,e,t)=>e in r?mC(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var xt=(r,e,t)=>bC(r,typeof e!="symbol"?e+"":e,t),Zd=(r,e,t)=>e.has(r)||_1("Cannot "+t);var Pr=(r,e,t)=>(Zd(r,e,"read from private field"),t?t.call(r):e.get(r)),Qd=(r,e,t)=>e.has(r)?_1("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),ku=(r,e,t,n)=>(Zd(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),Jd=(r,e,t)=>(Zd(r,e,"access private method"),t);import{a2 as _o,aI as T1,a6 as Wi,a4 as Ia,a3 as Bl,d as Ec,a7 as F_,cm as wC,aX as xC,cG as EC,a9 as z_,X as $_,cH as MC,a8 as q_,a as Jo,ab as SC,cf as _C,bx as O1,bk as TC,at as Xa,o as Bn,b as ui,e as Vt,cd as Os,O as eu,cI as Zy,r as Io,cJ as OC,cK as AC,i as G_,cL as A1,cM as kC,cN as NC,ax as CC,cO as k1,cE as tu,cP as W_,cQ as Qy,A as PC,cR as V_,bD as LC,cS as DC,f as Xt,w as fn,L as IC,K as RC,h as eh,aR as jC,E as th,B as Y_,c4 as BC,c as To,g as fo,t as FC,V as zC,bf as $C,J as qC}from"./index-D6W6_zXP.js";import{_ as Ue,a as ke,b as q,c as Jt,d as he,e as nh,f as nu}from"./tslib.es6-kXu3IDFL.js";import{r as Jy,a as U_,b as H_,c as ru,d as iu,e as Tn,f as Mc,g as GC,h as em,i as Sc,j as WC,k as X_,l as tm,m as nm,n as VC}from"./get-CQkwdf_k.js";import{r as au,a as Li,b as Ka,c as YC,d as Di,e as rm,f as K_}from"./isSymbol-BLe3SAcv.js";import{r as UC,a as HC}from"./toNumber-m6rCw5xZ.js";import{_ as XC,a as KC}from"./Grid-Cxuy6_wU.js";import{g as ZC}from"./get-slot-Bk_rJcZu.js";const Rt="0!important",Z_="-1px!important";function us(r){return Ia(`${r}-type`,[Wi("& +",[_o("button",{},[Ia(`${r}-type`,[Bl("border",{borderLeftWidth:Rt}),Bl("state-border",{left:Z_})])])])])}function ls(r){return Ia(`${r}-type`,[Wi("& +",[_o("button",[Ia(`${r}-type`,[Bl("border",{borderTopWidth:Rt}),Bl("state-border",{top:Z_})])])])])}const QC=_o("button-group",`
 flex-wrap: nowrap;
 display: inline-flex;
 position: relative;
`,[T1("vertical",{flexDirection:"row"},[T1("rtl",[_o("button",[Wi("&:first-child:not(:last-child)",`
 margin-right: ${Rt};
 border-top-right-radius: ${Rt};
 border-bottom-right-radius: ${Rt};
 `),Wi("&:last-child:not(:first-child)",`
 margin-left: ${Rt};
 border-top-left-radius: ${Rt};
 border-bottom-left-radius: ${Rt};
 `),Wi("&:not(:first-child):not(:last-child)",`
 margin-left: ${Rt};
 margin-right: ${Rt};
 border-radius: ${Rt};
 `),us("default"),Ia("ghost",[us("primary"),us("info"),us("success"),us("warning"),us("error")])])])]),Ia("vertical",{flexDirection:"column"},[_o("button",[Wi("&:first-child:not(:last-child)",`
 margin-bottom: ${Rt};
 margin-left: ${Rt};
 margin-right: ${Rt};
 border-bottom-left-radius: ${Rt};
 border-bottom-right-radius: ${Rt};
 `),Wi("&:last-child:not(:first-child)",`
 margin-top: ${Rt};
 margin-left: ${Rt};
 margin-right: ${Rt};
 border-top-left-radius: ${Rt};
 border-top-right-radius: ${Rt};
 `),Wi("&:not(:first-child):not(:last-child)",`
 margin: ${Rt};
 border-radius: ${Rt};
 `),ls("default"),Ia("ghost",[ls("primary"),ls("info"),ls("success"),ls("warning"),ls("error")])])])]),JC={size:{type:String,default:void 0},vertical:Boolean},eP=Ec({name:"ButtonGroup",props:JC,setup(r){const{mergedClsPrefixRef:e,mergedRtlRef:t}=F_(r);return wC("-button-group",QC,e),xC(EC,r),{rtlEnabled:z_("ButtonGroup",t,e),mergedClsPrefix:e}},render(){const{mergedClsPrefix:r}=this;return $_("div",{class:[`${r}-button-group`,this.rtlEnabled&&`${r}-button-group--rtl`,this.vertical&&`${r}-button-group--vertical`],role:"group"},this.$slots)}});function tP(){return MC}const nP={name:"Flex",self:tP},rP=Object.assign(Object.assign({},q_.props),{align:String,justify:{type:String,default:"start"},inline:Boolean,vertical:Boolean,reverse:Boolean,size:{type:[String,Number,Array],default:"medium"},wrap:{type:Boolean,default:!0}}),iP=Ec({name:"Flex",props:rP,setup(r){const{mergedClsPrefixRef:e,mergedRtlRef:t}=F_(r),n=q_("Flex","-flex",void 0,nP,r,e);return{rtlEnabled:z_("Flex",t,e),mergedClsPrefix:e,margin:Jo(()=>{const{size:a}=r;if(Array.isArray(a))return{horizontal:a[0],vertical:a[1]};if(typeof a=="number")return{horizontal:a,vertical:a};const{self:{[SC("gap",a)]:s}}=n.value,{row:o,col:u}=_C(s);return{horizontal:O1(u),vertical:O1(o)}})}},render(){const{vertical:r,reverse:e,align:t,inline:n,justify:i,margin:a,wrap:s,mergedClsPrefix:o,rtlEnabled:u}=this,l=TC(ZC(this),!1);return l.length?$_("div",{role:"none",class:[`${o}-flex`,u&&`${o}-flex--rtl`],style:{display:n?"inline-flex":"flex",flexDirection:r&&!e?"column":r&&e?"column-reverse":!r&&e?"row-reverse":"row",justifyContent:i,flexWrap:!s||r?"nowrap":"wrap",alignItems:t,gap:`${a.vertical}px ${a.horizontal}px`}},l):null}}),aP={class:"inline-block",viewBox:"0 0 56 56",width:"1em",height:"1em"};function sP(r,e){return Bn(),ui("svg",aP,e[0]||(e[0]=[Vt("path",{fill:"currentColor",d:"M28 51.906c13.055 0 23.906-10.828 23.906-23.906c0-13.055-10.875-23.906-23.93-23.906C14.899 4.094 4.095 14.945 4.095 28c0 13.078 10.828 23.906 23.906 23.906"},null,-1)]))}const oP=Xa({name:"f7-circle-fill",render:sP}),uP={class:"inline-block",viewBox:"0 0 56 56",width:"1em",height:"1em"};function lP(r,e){return Bn(),ui("svg",uP,e[0]||(e[0]=[Vt("path",{fill:"currentColor",d:"M28 51.906c13.055 0 23.906-10.851 23.906-23.906c0-13.078-10.875-23.906-23.93-23.906C14.899 4.094 4.095 14.922 4.095 28c0 13.055 10.828 23.906 23.906 23.906m-9.07-11.11c-.586 0-1.102-.515-1.102-1.077V19.82c0-1.008.492-1.758 1.453-2.18c.844-.374 1.57-.585 3.375-.585c4.242 0 6.89 2.086 10.875 2.086c1.922 0 2.93-.493 3.54-.493c.796 0 1.406.493 1.406 1.172v11.555c0 1.055-.446 1.734-1.454 2.18c-.867.398-1.617.609-3.375.609c-4.078 0-6.68-2.062-10.875-2.062c-1.43 0-2.367.28-2.789.468v7.149c0 .586-.445 1.078-1.054 1.078"},null,-1)]))}const cP=Xa({name:"f7-flag-circle-fill",render:lP}),dP={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"};function hP(r,e){return Bn(),ui("svg",dP,e[0]||(e[0]=[Vt("path",{fill:"currentColor","fill-rule":"evenodd",d:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10s-4.477 10-10 10m0-2a8 8 0 1 0 0-16a8 8 0 0 0 0 16m-1-4h2v2h-2zm0-1.992s2-.008 2 0C13 13.006 16 12 16 10c0-2.21-1.773-4-3.991-4A4 4 0 0 0 8 10h2c0-1.1.9-2 2-2s2 .9 2 2c0 .9-3 2.367-3 4.008"},null,-1)]))}const fP=Xa({name:"fe-question",render:hP}),gP={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"};function pP(r,e){return Bn(),ui("svg",gP,e[0]||(e[0]=[Vt("g",{fill:"currentColor"},[Vt("path",{d:"M4 6v6h2V8h4V6zm16 12h-6v-2h4v-4h2z"}),Vt("path",{"fill-rule":"evenodd",d:"M4 2a4 4 0 0 0-4 4v12a4 4 0 0 0 4 4h16a4 4 0 0 0 4-4V6a4 4 0 0 0-4-4zm16 2H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2","clip-rule":"evenodd"})],-1)]))}const vP=Xa({name:"gg-ratio",render:pP}),yP={class:"inline-block",viewBox:"0 0 48 48",width:"1em",height:"1em"};function mP(r,e){return Bn(),ui("svg",yP,e[0]||(e[0]=[Vt("g",{fill:"none"},[Vt("rect",{width:"36",height:"36",x:"6",y:"6",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"4",rx:"3"}),Vt("path",{fill:"currentColor","fill-rule":"evenodd",d:"M24 22.5a2.5 2.5 0 1 0 0-5a2.5 2.5 0 0 0 0 5m0 8a2.5 2.5 0 1 0 0-5a2.5 2.5 0 0 0 0 5","clip-rule":"evenodd"}),Vt("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"4",d:"M15.5 17v14m17-14v14"})],-1)]))}const bP=Xa({name:"icon-park-outline-equal-ratio",render:mP}),wP={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"};function xP(r,e){return Bn(),ui("svg",wP,e[0]||(e[0]=[Vt("g",{fill:"none"},[Vt("path",{d:"m12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035q-.016-.005-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093q.019.005.029-.008l.004-.014l-.034-.614q-.005-.018-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"}),Vt("path",{fill:"currentColor",d:"M10.5 2a8.5 8.5 0 0 1 6.873 13.502l-.197.26l3.652 3.652a1 1 0 0 1-1.32 1.498l-.094-.084l-3.652-3.652A8.5 8.5 0 1 1 10.5 2m0 2a6.5 6.5 0 1 0 0 13a6.5 6.5 0 0 0 0-13m0 2a1 1 0 0 1 .993.883L11.5 7v2.5H14a1 1 0 0 1 .117 1.993L14 11.5h-2.5V14a1 1 0 0 1-1.993.117L9.5 14v-2.5H7a1 1 0 0 1-.117-1.993L7 9.5h2.5V7a1 1 0 0 1 1-1"})],-1)]))}const EP=Xa({name:"mingcute-zoom-in-line",render:xP}),MP={class:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em"};function SP(r,e){return Bn(),ui("svg",MP,e[0]||(e[0]=[Vt("g",{fill:"none"},[Vt("path",{d:"m12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035q-.016-.005-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093q.019.005.029-.008l.004-.014l-.034-.614q-.005-.018-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"}),Vt("path",{fill:"currentColor",d:"M10.5 2a8.5 8.5 0 0 1 6.676 13.762l3.652 3.652a1 1 0 0 1-1.414 1.414l-3.652-3.652A8.5 8.5 0 1 1 10.5 2m0 2a6.5 6.5 0 1 0 0 13a6.5 6.5 0 0 0 0-13M14 9.5a1 1 0 1 1 0 2H7a1 1 0 1 1 0-2z"})],-1)]))}const _P=Xa({name:"mingcute-zoom-out-line",render:SP}),Q_=AC?window:void 0;function z0(r){var e;const t=Os(r);return(e=t==null?void 0:t.$el)!=null?e:t}function TP(...r){let e,t,n,i;if(typeof r[0]=="string"||Array.isArray(r[0])?([t,n,i]=r,e=Q_):[e,t,n,i]=r,!e)return kC;t=k1(t),n=k1(n);const a=[],s=()=>{a.forEach(c=>c()),a.length=0},o=(c,d,h,f)=>(c.addEventListener(d,h,f),()=>c.removeEventListener(d,h,f)),u=eu(()=>[z0(e),Os(i)],([c,d])=>{if(s(),!c)return;const h=NC(d)?{...d}:d;a.push(...t.flatMap(f=>n.map(g=>o(c,f,g,h))))},{immediate:!0,flush:"post"}),l=()=>{u(),s()};return Zy(l),l}function OP(){const r=Io(!1),e=CC();return e&&G_(()=>{r.value=!0},e),r}function AP(r){const e=OP();return Jo(()=>(e.value,!!r()))}function N1(r,e,t={}){const{window:n=Q_,...i}=t;let a;const s=AP(()=>n&&"ResizeObserver"in n),o=()=>{a&&(a.disconnect(),a=void 0)},u=Jo(()=>{const d=Os(r);return Array.isArray(d)?d.map(h=>z0(h)):[z0(d)]}),l=eu(u,d=>{if(o(),s.value&&n){a=new ResizeObserver(e);for(const h of d)h&&a.observe(h,i)}},{immediate:!0,flush:"post"}),c=()=>{o(),l()};return Zy(c),{isSupported:s,stop:c}}function rh(r){return typeof Window<"u"&&r instanceof Window?r.document.documentElement:typeof Document<"u"&&r instanceof Document?r.documentElement:r}const kP={mounted(r,e){typeof e.value=="function"?N1(r,e.value):N1(r,...e.value)}};function J_(r){const e=window.getComputedStyle(r);if(e.overflowX==="scroll"||e.overflowY==="scroll"||e.overflowX==="auto"&&r.clientWidth<r.scrollWidth||e.overflowY==="auto"&&r.clientHeight<r.scrollHeight)return!0;{const t=r.parentNode;return!t||t.tagName==="BODY"?!1:J_(t)}}function NP(r){const e=r||window.event,t=e.target;return J_(t)?!1:e.touches.length>1?!0:(e.preventDefault&&e.preventDefault(),!1)}const ih=new WeakMap;function CP(r,e=!1){const t=Io(e);let n=null,i="";eu(OC(r),o=>{const u=rh(Os(o));if(u){const l=u;if(ih.get(l)||ih.set(l,l.style.overflow),l.style.overflow!=="hidden"&&(i=l.style.overflow),l.style.overflow==="hidden")return t.value=!0;if(t.value)return l.style.overflow="hidden"}},{immediate:!0});const a=()=>{const o=rh(Os(r));!o||t.value||(A1&&(n=TP(o,"touchmove",u=>{NP(u)},{passive:!1})),o.style.overflow="hidden",t.value=!0)},s=()=>{const o=rh(Os(r));!o||!t.value||(A1&&(n==null||n()),o.style.overflow=i,ih.delete(o),t.value=!1)};return Zy(s),Jo({get(){return t.value},set(o){o?a():s()}})}function PP(){let r=!1;const e=Io(!1);return(t,n)=>{if(e.value=n.value,r)return;r=!0;const i=CP(t,n.value);eu(e,a=>i.value=a)}}PP();function oa(r){"@babel/helpers - typeof";return oa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oa(r)}function LP(r,e){if(oa(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(oa(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function eT(r){var e=LP(r,"string");return oa(e)=="symbol"?e:e+""}function Me(r,e,t){return(e=eT(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function C1(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function qe(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?C1(Object(t),!0).forEach(function(n){Me(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):C1(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function ce(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function P1(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,eT(n.key),n)}}function de(r,e,t){return e&&P1(r.prototype,e),t&&P1(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function $0(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function DP(r){if(Array.isArray(r))return $0(r)}function IP(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function im(r,e){if(r){if(typeof r=="string")return $0(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?$0(r,e):void 0}}function RP(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pt(r){return DP(r)||IP(r)||im(r)||RP()}function Ds(r){return Ds=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ds(r)}function tT(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tT=function(){return!!r})()}function jP(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function BP(r,e){if(e&&(oa(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jP(r)}function Ge(r,e,t){return e=Ds(e),BP(r,tT()?Reflect.construct(e,t||[],Ds(r).constructor):e.apply(r,t))}function q0(r,e){return q0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},q0(r,e)}function We(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&q0(r,e)}function FP(r){if(Array.isArray(r))return r}function zP(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n,i,a,s,o=[],u=!0,l=!1;try{if(a=(t=t.call(r)).next,e===0){if(Object(t)!==t)return;u=!1}else for(;!(u=(n=a.call(t)).done)&&(o.push(n.value),o.length!==e);u=!0);}catch(c){l=!0,i=c}finally{try{if(!u&&t.return!=null&&(s=t.return(),Object(s)!==s))return}finally{if(l)throw i}}return o}}function $P(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ze(r,e){return FP(r)||zP(r,e)||im(r,e)||$P()}var ah={exports:{}},L1;function qP(){return L1||(L1=1,function(r){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function i(u,l,c){this.fn=u,this.context=l,this.once=c||!1}function a(u,l,c,d,h){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new i(c,d||u,h),g=t?t+l:l;return u._events[g]?u._events[g].fn?u._events[g]=[u._events[g],f]:u._events[g].push(f):(u._events[g]=f,u._eventsCount++),u}function s(u,l){--u._eventsCount===0?u._events=new n:delete u._events[l]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var l=[],c,d;if(this._eventsCount===0)return l;for(d in c=this._events)e.call(c,d)&&l.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},o.prototype.listeners=function(l){var c=t?t+l:l,d=this._events[c];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,f=d.length,g=new Array(f);h<f;h++)g[h]=d[h].fn;return g},o.prototype.listenerCount=function(l){var c=t?t+l:l,d=this._events[c];return d?d.fn?1:d.length:0},o.prototype.emit=function(l,c,d,h,f,g){var v=t?t+l:l;if(!this._events[v])return!1;var p=this._events[v],y=arguments.length,m,w;if(p.fn){switch(p.once&&this.removeListener(l,p.fn,void 0,!0),y){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,c),!0;case 3:return p.fn.call(p.context,c,d),!0;case 4:return p.fn.call(p.context,c,d,h),!0;case 5:return p.fn.call(p.context,c,d,h,f),!0;case 6:return p.fn.call(p.context,c,d,h,f,g),!0}for(w=1,m=new Array(y-1);w<y;w++)m[w-1]=arguments[w];p.fn.apply(p.context,m)}else{var M=p.length,S;for(w=0;w<M;w++)switch(p[w].once&&this.removeListener(l,p[w].fn,void 0,!0),y){case 1:p[w].fn.call(p[w].context);break;case 2:p[w].fn.call(p[w].context,c);break;case 3:p[w].fn.call(p[w].context,c,d);break;case 4:p[w].fn.call(p[w].context,c,d,h);break;default:if(!m)for(S=1,m=new Array(y-1);S<y;S++)m[S-1]=arguments[S];p[w].fn.apply(p[w].context,m)}}return!0},o.prototype.on=function(l,c,d){return a(this,l,c,d,!1)},o.prototype.once=function(l,c,d){return a(this,l,c,d,!0)},o.prototype.removeListener=function(l,c,d,h){var f=t?t+l:l;if(!this._events[f])return this;if(!c)return s(this,f),this;var g=this._events[f];if(g.fn)g.fn===c&&(!h||g.once)&&(!d||g.context===d)&&s(this,f);else{for(var v=0,p=[],y=g.length;v<y;v++)(g[v].fn!==c||h&&!g[v].once||d&&g[v].context!==d)&&p.push(g[v]);p.length?this._events[f]=p.length===1?p[0]:p:s(this,f)}return this},o.prototype.removeAllListeners=function(l){var c;return l?(c=t?t+l:l,this._events[c]&&s(this,c)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,r.exports=o}(ah)),ah.exports}var GP=qP();const nT=tu(GP);var St=1e-6,en=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});function rT(){var r=new en(9);return en!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function WP(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[4],r[4]=e[5],r[5]=e[6],r[6]=e[8],r[7]=e[9],r[8]=e[10],r}function VP(r,e,t,n,i,a,s,o,u){var l=new en(9);return l[0]=r,l[1]=e,l[2]=t,l[3]=n,l[4]=i,l[5]=a,l[6]=s,l[7]=o,l[8]=u,l}function ht(){var r=new en(16);return en!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}function iT(r){var e=new en(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function Is(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function aT(r,e,t,n,i,a,s,o,u,l,c,d,h,f,g,v){var p=new en(16);return p[0]=r,p[1]=e,p[2]=t,p[3]=n,p[4]=i,p[5]=a,p[6]=s,p[7]=o,p[8]=u,p[9]=l,p[10]=c,p[11]=d,p[12]=h,p[13]=f,p[14]=g,p[15]=v,p}function G0(r,e,t,n,i,a,s,o,u,l,c,d,h,f,g,v,p){return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r[4]=a,r[5]=s,r[6]=o,r[7]=u,r[8]=l,r[9]=c,r[10]=d,r[11]=h,r[12]=f,r[13]=g,r[14]=v,r[15]=p,r}function ua(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function sT(r,e){if(r===e){var t=e[1],n=e[2],i=e[3],a=e[6],s=e[7],o=e[11];r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=t,r[6]=e[9],r[7]=e[13],r[8]=n,r[9]=a,r[11]=e[14],r[12]=i,r[13]=s,r[14]=o}else r[0]=e[0],r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=e[1],r[5]=e[5],r[6]=e[9],r[7]=e[13],r[8]=e[2],r[9]=e[6],r[10]=e[10],r[11]=e[14],r[12]=e[3],r[13]=e[7],r[14]=e[11],r[15]=e[15];return r}function ni(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=e[4],o=e[5],u=e[6],l=e[7],c=e[8],d=e[9],h=e[10],f=e[11],g=e[12],v=e[13],p=e[14],y=e[15],m=t*o-n*s,w=t*u-i*s,M=t*l-a*s,S=n*u-i*o,T=n*l-a*o,A=i*l-a*u,O=c*v-d*g,N=c*p-h*g,C=c*y-f*g,P=d*p-h*v,D=d*y-f*v,j=h*y-f*p,G=m*j-w*D+M*P+S*C-T*N+A*O;return G?(G=1/G,r[0]=(o*j-u*D+l*P)*G,r[1]=(i*D-n*j-a*P)*G,r[2]=(v*A-p*T+y*S)*G,r[3]=(h*T-d*A-f*S)*G,r[4]=(u*C-s*j-l*N)*G,r[5]=(t*j-i*C+a*N)*G,r[6]=(p*M-g*A-y*w)*G,r[7]=(c*A-h*M+f*w)*G,r[8]=(s*D-o*C+l*O)*G,r[9]=(n*C-t*D-a*O)*G,r[10]=(g*T-v*M+y*m)*G,r[11]=(d*M-c*T-f*m)*G,r[12]=(o*N-s*P-u*O)*G,r[13]=(t*P-n*N+i*O)*G,r[14]=(v*w-g*S-p*m)*G,r[15]=(c*S-d*w+h*m)*G,r):null}function YP(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=e[4],o=e[5],u=e[6],l=e[7],c=e[8],d=e[9],h=e[10],f=e[11],g=e[12],v=e[13],p=e[14],y=e[15];return r[0]=o*(h*y-f*p)-d*(u*y-l*p)+v*(u*f-l*h),r[1]=-(n*(h*y-f*p)-d*(i*y-a*p)+v*(i*f-a*h)),r[2]=n*(u*y-l*p)-o*(i*y-a*p)+v*(i*l-a*u),r[3]=-(n*(u*f-l*h)-o*(i*f-a*h)+d*(i*l-a*u)),r[4]=-(s*(h*y-f*p)-c*(u*y-l*p)+g*(u*f-l*h)),r[5]=t*(h*y-f*p)-c*(i*y-a*p)+g*(i*f-a*h),r[6]=-(t*(u*y-l*p)-s*(i*y-a*p)+g*(i*l-a*u)),r[7]=t*(u*f-l*h)-s*(i*f-a*h)+c*(i*l-a*u),r[8]=s*(d*y-f*v)-c*(o*y-l*v)+g*(o*f-l*d),r[9]=-(t*(d*y-f*v)-c*(n*y-a*v)+g*(n*f-a*d)),r[10]=t*(o*y-l*v)-s*(n*y-a*v)+g*(n*l-a*o),r[11]=-(t*(o*f-l*d)-s*(n*f-a*d)+c*(n*l-a*o)),r[12]=-(s*(d*p-h*v)-c*(o*p-u*v)+g*(o*h-u*d)),r[13]=t*(d*p-h*v)-c*(n*p-i*v)+g*(n*h-i*d),r[14]=-(t*(o*p-u*v)-s*(n*p-i*v)+g*(n*u-i*o)),r[15]=t*(o*h-u*d)-s*(n*h-i*d)+c*(n*u-i*o),r}function oT(r){var e=r[0],t=r[1],n=r[2],i=r[3],a=r[4],s=r[5],o=r[6],u=r[7],l=r[8],c=r[9],d=r[10],h=r[11],f=r[12],g=r[13],v=r[14],p=r[15],y=e*s-t*a,m=e*o-n*a,w=e*u-i*a,M=t*o-n*s,S=t*u-i*s,T=n*u-i*o,A=l*g-c*f,O=l*v-d*f,N=l*p-h*f,C=c*v-d*g,P=c*p-h*g,D=d*p-h*v;return y*D-m*P+w*C+M*N-S*O+T*A}function Dn(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],u=e[5],l=e[6],c=e[7],d=e[8],h=e[9],f=e[10],g=e[11],v=e[12],p=e[13],y=e[14],m=e[15],w=t[0],M=t[1],S=t[2],T=t[3];return r[0]=w*n+M*o+S*d+T*v,r[1]=w*i+M*u+S*h+T*p,r[2]=w*a+M*l+S*f+T*y,r[3]=w*s+M*c+S*g+T*m,w=t[4],M=t[5],S=t[6],T=t[7],r[4]=w*n+M*o+S*d+T*v,r[5]=w*i+M*u+S*h+T*p,r[6]=w*a+M*l+S*f+T*y,r[7]=w*s+M*c+S*g+T*m,w=t[8],M=t[9],S=t[10],T=t[11],r[8]=w*n+M*o+S*d+T*v,r[9]=w*i+M*u+S*h+T*p,r[10]=w*a+M*l+S*f+T*y,r[11]=w*s+M*c+S*g+T*m,w=t[12],M=t[13],S=t[14],T=t[15],r[12]=w*n+M*o+S*d+T*v,r[13]=w*i+M*u+S*h+T*p,r[14]=w*a+M*l+S*f+T*y,r[15]=w*s+M*c+S*g+T*m,r}function As(r,e,t){var n=t[0],i=t[1],a=t[2],s,o,u,l,c,d,h,f,g,v,p,y;return e===r?(r[12]=e[0]*n+e[4]*i+e[8]*a+e[12],r[13]=e[1]*n+e[5]*i+e[9]*a+e[13],r[14]=e[2]*n+e[6]*i+e[10]*a+e[14],r[15]=e[3]*n+e[7]*i+e[11]*a+e[15]):(s=e[0],o=e[1],u=e[2],l=e[3],c=e[4],d=e[5],h=e[6],f=e[7],g=e[8],v=e[9],p=e[10],y=e[11],r[0]=s,r[1]=o,r[2]=u,r[3]=l,r[4]=c,r[5]=d,r[6]=h,r[7]=f,r[8]=g,r[9]=v,r[10]=p,r[11]=y,r[12]=s*n+c*i+g*a+e[12],r[13]=o*n+d*i+v*a+e[13],r[14]=u*n+h*i+p*a+e[14],r[15]=l*n+f*i+y*a+e[15]),r}function uT(r,e,t){var n=t[0],i=t[1],a=t[2];return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r[4]=e[4]*i,r[5]=e[5]*i,r[6]=e[6]*i,r[7]=e[7]*i,r[8]=e[8]*a,r[9]=e[9]*a,r[10]=e[10]*a,r[11]=e[11]*a,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function UP(r,e,t,n){var i=n[0],a=n[1],s=n[2],o=Math.hypot(i,a,s),u,l,c,d,h,f,g,v,p,y,m,w,M,S,T,A,O,N,C,P,D,j,G,V;return o<St?null:(o=1/o,i*=o,a*=o,s*=o,u=Math.sin(t),l=Math.cos(t),c=1-l,d=e[0],h=e[1],f=e[2],g=e[3],v=e[4],p=e[5],y=e[6],m=e[7],w=e[8],M=e[9],S=e[10],T=e[11],A=i*i*c+l,O=a*i*c+s*u,N=s*i*c-a*u,C=i*a*c-s*u,P=a*a*c+l,D=s*a*c+i*u,j=i*s*c+a*u,G=a*s*c-i*u,V=s*s*c+l,r[0]=d*A+v*O+w*N,r[1]=h*A+p*O+M*N,r[2]=f*A+y*O+S*N,r[3]=g*A+m*O+T*N,r[4]=d*C+v*P+w*D,r[5]=h*C+p*P+M*D,r[6]=f*C+y*P+S*D,r[7]=g*C+m*P+T*D,r[8]=d*j+v*G+w*V,r[9]=h*j+p*G+M*V,r[10]=f*j+y*G+S*V,r[11]=g*j+m*G+T*V,e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r)}function lT(r,e,t){var n=Math.sin(t),i=Math.cos(t),a=e[4],s=e[5],o=e[6],u=e[7],l=e[8],c=e[9],d=e[10],h=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=a*i+l*n,r[5]=s*i+c*n,r[6]=o*i+d*n,r[7]=u*i+h*n,r[8]=l*i-a*n,r[9]=c*i-s*n,r[10]=d*i-o*n,r[11]=h*i-u*n,r}function cT(r,e,t){var n=Math.sin(t),i=Math.cos(t),a=e[0],s=e[1],o=e[2],u=e[3],l=e[8],c=e[9],d=e[10],h=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=a*i-l*n,r[1]=s*i-c*n,r[2]=o*i-d*n,r[3]=u*i-h*n,r[8]=a*n+l*i,r[9]=s*n+c*i,r[10]=o*n+d*i,r[11]=u*n+h*i,r}function HP(r,e,t){var n=Math.sin(t),i=Math.cos(t),a=e[0],s=e[1],o=e[2],u=e[3],l=e[4],c=e[5],d=e[6],h=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=a*i+l*n,r[1]=s*i+c*n,r[2]=o*i+d*n,r[3]=u*i+h*n,r[4]=l*i-a*n,r[5]=c*i-s*n,r[6]=d*i-o*n,r[7]=h*i-u*n,r}function Ui(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function Aa(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function dT(r,e,t){var n=t[0],i=t[1],a=t[2],s=Math.hypot(n,i,a),o,u,l;return s<St?null:(s=1/s,n*=s,i*=s,a*=s,o=Math.sin(e),u=Math.cos(e),l=1-u,r[0]=n*n*l+u,r[1]=i*n*l+a*o,r[2]=a*n*l-i*o,r[3]=0,r[4]=n*i*l-a*o,r[5]=i*i*l+u,r[6]=a*i*l+n*o,r[7]=0,r[8]=n*a*l+i*o,r[9]=i*a*l-n*o,r[10]=a*a*l+u,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}function hT(r,e){var t=Math.sin(e),n=Math.cos(e);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=n,r[6]=t,r[7]=0,r[8]=0,r[9]=-t,r[10]=n,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function fT(r,e){var t=Math.sin(e),n=Math.cos(e);return r[0]=n,r[1]=0,r[2]=-t,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=t,r[9]=0,r[10]=n,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function W0(r,e){var t=Math.sin(e),n=Math.cos(e);return r[0]=n,r[1]=t,r[2]=0,r[3]=0,r[4]=-t,r[5]=n,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function gT(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],o=n+n,u=i+i,l=a+a,c=n*o,d=n*u,h=n*l,f=i*u,g=i*l,v=a*l,p=s*o,y=s*u,m=s*l;return r[0]=1-(f+v),r[1]=d+m,r[2]=h-y,r[3]=0,r[4]=d-m,r[5]=1-(c+v),r[6]=g+p,r[7]=0,r[8]=h+y,r[9]=g-p,r[10]=1-(c+f),r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r}function XP(r,e){var t=new en(3),n=-e[0],i=-e[1],a=-e[2],s=e[3],o=e[4],u=e[5],l=e[6],c=e[7],d=n*n+i*i+a*a+s*s;return d>0?(t[0]=(o*s+c*n+u*a-l*i)*2/d,t[1]=(u*s+c*i+l*n-o*a)*2/d,t[2]=(l*s+c*a+o*i-u*n)*2/d):(t[0]=(o*s+c*n+u*a-l*i)*2,t[1]=(u*s+c*i+l*n-o*a)*2,t[2]=(l*s+c*a+o*i-u*n)*2),gT(r,e,t),r}function Fl(r,e){return r[0]=e[12],r[1]=e[13],r[2]=e[14],r}function Rs(r,e){var t=e[0],n=e[1],i=e[2],a=e[4],s=e[5],o=e[6],u=e[8],l=e[9],c=e[10];return r[0]=Math.hypot(t,n,i),r[1]=Math.hypot(a,s,o),r[2]=Math.hypot(u,l,c),r}function zl(r,e){var t=new en(3);Rs(t,e);var n=1/t[0],i=1/t[1],a=1/t[2],s=e[0]*n,o=e[1]*i,u=e[2]*a,l=e[4]*n,c=e[5]*i,d=e[6]*a,h=e[8]*n,f=e[9]*i,g=e[10]*a,v=s+c+g,p=0;return v>0?(p=Math.sqrt(v+1)*2,r[3]=.25*p,r[0]=(d-f)/p,r[1]=(h-u)/p,r[2]=(o-l)/p):s>c&&s>g?(p=Math.sqrt(1+s-c-g)*2,r[3]=(d-f)/p,r[0]=.25*p,r[1]=(o+l)/p,r[2]=(h+u)/p):c>g?(p=Math.sqrt(1+c-s-g)*2,r[3]=(h-u)/p,r[0]=(o+l)/p,r[1]=.25*p,r[2]=(d+f)/p):(p=Math.sqrt(1+g-s-c)*2,r[3]=(o-l)/p,r[0]=(h+u)/p,r[1]=(d+f)/p,r[2]=.25*p),r}function KP(r,e,t,n){var i=e[0],a=e[1],s=e[2],o=e[3],u=i+i,l=a+a,c=s+s,d=i*u,h=i*l,f=i*c,g=a*l,v=a*c,p=s*c,y=o*u,m=o*l,w=o*c,M=n[0],S=n[1],T=n[2];return r[0]=(1-(g+p))*M,r[1]=(h+w)*M,r[2]=(f-m)*M,r[3]=0,r[4]=(h-w)*S,r[5]=(1-(d+p))*S,r[6]=(v+y)*S,r[7]=0,r[8]=(f+m)*T,r[9]=(v-y)*T,r[10]=(1-(d+g))*T,r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r}function Oo(r,e,t,n,i){var a=e[0],s=e[1],o=e[2],u=e[3],l=a+a,c=s+s,d=o+o,h=a*l,f=a*c,g=a*d,v=s*c,p=s*d,y=o*d,m=u*l,w=u*c,M=u*d,S=n[0],T=n[1],A=n[2],O=i[0],N=i[1],C=i[2],P=(1-(v+y))*S,D=(f+M)*S,j=(g-w)*S,G=(f-M)*T,V=(1-(h+y))*T,Y=(p+m)*T,$=(g+w)*A,z=(p-m)*A,Z=(1-(h+v))*A;return r[0]=P,r[1]=D,r[2]=j,r[3]=0,r[4]=G,r[5]=V,r[6]=Y,r[7]=0,r[8]=$,r[9]=z,r[10]=Z,r[11]=0,r[12]=t[0]+O-(P*O+G*N+$*C),r[13]=t[1]+N-(D*O+V*N+z*C),r[14]=t[2]+C-(j*O+Y*N+Z*C),r[15]=1,r}function am(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=t+t,o=n+n,u=i+i,l=t*s,c=n*s,d=n*o,h=i*s,f=i*o,g=i*u,v=a*s,p=a*o,y=a*u;return r[0]=1-d-g,r[1]=c+y,r[2]=h-p,r[3]=0,r[4]=c-y,r[5]=1-l-g,r[6]=f+v,r[7]=0,r[8]=h+p,r[9]=f-v,r[10]=1-l-d,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function ZP(r,e,t,n,i,a,s){var o=1/(t-e),u=1/(i-n),l=1/(a-s);return r[0]=a*2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a*2*u,r[6]=0,r[7]=0,r[8]=(t+e)*o,r[9]=(i+n)*u,r[10]=(s+a)*l,r[11]=-1,r[12]=0,r[13]=0,r[14]=s*a*2*l,r[15]=0,r}function pT(r,e,t,n,i){var a=1/Math.tan(e/2),s;return r[0]=a/t,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0?(s=1/(n-i),r[10]=(i+n)*s,r[14]=2*i*n*s):(r[10]=-1,r[14]=-2*n),r}var QP=pT;function JP(r,e,t,n,i){var a=1/Math.tan(e/2),s;return r[0]=a/t,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0?(s=1/(n-i),r[10]=i*s,r[14]=i*n*s):(r[10]=-1,r[14]=-n),r}function eL(r,e,t,n){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),o=Math.tan(e.rightDegrees*Math.PI/180),u=2/(s+o),l=2/(i+a);return r[0]=u,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=l,r[6]=0,r[7]=0,r[8]=-((s-o)*u*.5),r[9]=(i-a)*l*.5,r[10]=n/(t-n),r[11]=-1,r[12]=0,r[13]=0,r[14]=n*t/(t-n),r[15]=0,r}function vT(r,e,t,n,i,a,s){var o=1/(e-t),u=1/(n-i),l=1/(a-s);return r[0]=-2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*u,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*l,r[11]=0,r[12]=(e+t)*o,r[13]=(i+n)*u,r[14]=(s+a)*l,r[15]=1,r}var yT=vT;function mT(r,e,t,n,i,a,s){var o=1/(e-t),u=1/(n-i),l=1/(a-s);return r[0]=-2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*u,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=l,r[11]=0,r[12]=(e+t)*o,r[13]=(i+n)*u,r[14]=a*l,r[15]=1,r}function bT(r,e,t,n){var i,a,s,o,u,l,c,d,h,f,g=e[0],v=e[1],p=e[2],y=n[0],m=n[1],w=n[2],M=t[0],S=t[1],T=t[2];return Math.abs(g-M)<St&&Math.abs(v-S)<St&&Math.abs(p-T)<St?ua(r):(c=g-M,d=v-S,h=p-T,f=1/Math.hypot(c,d,h),c*=f,d*=f,h*=f,i=m*h-w*d,a=w*c-y*h,s=y*d-m*c,f=Math.hypot(i,a,s),f?(f=1/f,i*=f,a*=f,s*=f):(i=0,a=0,s=0),o=d*s-h*a,u=h*i-c*s,l=c*a-d*i,f=Math.hypot(o,u,l),f?(f=1/f,o*=f,u*=f,l*=f):(o=0,u=0,l=0),r[0]=i,r[1]=o,r[2]=c,r[3]=0,r[4]=a,r[5]=u,r[6]=d,r[7]=0,r[8]=s,r[9]=l,r[10]=h,r[11]=0,r[12]=-(i*g+a*v+s*p),r[13]=-(o*g+u*v+l*p),r[14]=-(c*g+d*v+h*p),r[15]=1,r)}function tL(r,e,t,n){var i=e[0],a=e[1],s=e[2],o=n[0],u=n[1],l=n[2],c=i-t[0],d=a-t[1],h=s-t[2],f=c*c+d*d+h*h;f>0&&(f=1/Math.sqrt(f),c*=f,d*=f,h*=f);var g=u*h-l*d,v=l*c-o*h,p=o*d-u*c;return f=g*g+v*v+p*p,f>0&&(f=1/Math.sqrt(f),g*=f,v*=f,p*=f),r[0]=g,r[1]=v,r[2]=p,r[3]=0,r[4]=d*p-h*v,r[5]=h*g-c*p,r[6]=c*v-d*g,r[7]=0,r[8]=c,r[9]=d,r[10]=h,r[11]=0,r[12]=i,r[13]=a,r[14]=s,r[15]=1,r}function nL(r){return"mat4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+", "+r[9]+", "+r[10]+", "+r[11]+", "+r[12]+", "+r[13]+", "+r[14]+", "+r[15]+")"}function rL(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15])}function iL(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r[4]=e[4]+t[4],r[5]=e[5]+t[5],r[6]=e[6]+t[6],r[7]=e[7]+t[7],r[8]=e[8]+t[8],r[9]=e[9]+t[9],r[10]=e[10]+t[10],r[11]=e[11]+t[11],r[12]=e[12]+t[12],r[13]=e[13]+t[13],r[14]=e[14]+t[14],r[15]=e[15]+t[15],r}function wT(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r[4]=e[4]-t[4],r[5]=e[5]-t[5],r[6]=e[6]-t[6],r[7]=e[7]-t[7],r[8]=e[8]-t[8],r[9]=e[9]-t[9],r[10]=e[10]-t[10],r[11]=e[11]-t[11],r[12]=e[12]-t[12],r[13]=e[13]-t[13],r[14]=e[14]-t[14],r[15]=e[15]-t[15],r}function aL(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r[4]=e[4]*t,r[5]=e[5]*t,r[6]=e[6]*t,r[7]=e[7]*t,r[8]=e[8]*t,r[9]=e[9]*t,r[10]=e[10]*t,r[11]=e[11]*t,r[12]=e[12]*t,r[13]=e[13]*t,r[14]=e[14]*t,r[15]=e[15]*t,r}function sL(r,e,t,n){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r[2]=e[2]+t[2]*n,r[3]=e[3]+t[3]*n,r[4]=e[4]+t[4]*n,r[5]=e[5]+t[5]*n,r[6]=e[6]+t[6]*n,r[7]=e[7]+t[7]*n,r[8]=e[8]+t[8]*n,r[9]=e[9]+t[9]*n,r[10]=e[10]+t[10]*n,r[11]=e[11]+t[11]*n,r[12]=e[12]+t[12]*n,r[13]=e[13]+t[13]*n,r[14]=e[14]+t[14]*n,r[15]=e[15]+t[15]*n,r}function V0(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]&&r[8]===e[8]&&r[9]===e[9]&&r[10]===e[10]&&r[11]===e[11]&&r[12]===e[12]&&r[13]===e[13]&&r[14]===e[14]&&r[15]===e[15]}function oL(r,e){var t=r[0],n=r[1],i=r[2],a=r[3],s=r[4],o=r[5],u=r[6],l=r[7],c=r[8],d=r[9],h=r[10],f=r[11],g=r[12],v=r[13],p=r[14],y=r[15],m=e[0],w=e[1],M=e[2],S=e[3],T=e[4],A=e[5],O=e[6],N=e[7],C=e[8],P=e[9],D=e[10],j=e[11],G=e[12],V=e[13],Y=e[14],$=e[15];return Math.abs(t-m)<=St*Math.max(1,Math.abs(t),Math.abs(m))&&Math.abs(n-w)<=St*Math.max(1,Math.abs(n),Math.abs(w))&&Math.abs(i-M)<=St*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(a-S)<=St*Math.max(1,Math.abs(a),Math.abs(S))&&Math.abs(s-T)<=St*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(o-A)<=St*Math.max(1,Math.abs(o),Math.abs(A))&&Math.abs(u-O)<=St*Math.max(1,Math.abs(u),Math.abs(O))&&Math.abs(l-N)<=St*Math.max(1,Math.abs(l),Math.abs(N))&&Math.abs(c-C)<=St*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(d-P)<=St*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(h-D)<=St*Math.max(1,Math.abs(h),Math.abs(D))&&Math.abs(f-j)<=St*Math.max(1,Math.abs(f),Math.abs(j))&&Math.abs(g-G)<=St*Math.max(1,Math.abs(g),Math.abs(G))&&Math.abs(v-V)<=St*Math.max(1,Math.abs(v),Math.abs(V))&&Math.abs(p-Y)<=St*Math.max(1,Math.abs(p),Math.abs(Y))&&Math.abs(y-$)<=St*Math.max(1,Math.abs(y),Math.abs($))}var xT=Dn,uL=wT;const lL=Object.freeze(Object.defineProperty({__proto__:null,add:iL,adjoint:YP,clone:iT,copy:Is,create:ht,determinant:oT,equals:oL,exactEquals:V0,frob:rL,fromQuat:am,fromQuat2:XP,fromRotation:dT,fromRotationTranslation:gT,fromRotationTranslationScale:KP,fromRotationTranslationScaleOrigin:Oo,fromScaling:Aa,fromTranslation:Ui,fromValues:aT,fromXRotation:hT,fromYRotation:fT,fromZRotation:W0,frustum:ZP,getRotation:zl,getScaling:Rs,getTranslation:Fl,identity:ua,invert:ni,lookAt:bT,mul:xT,multiply:Dn,multiplyScalar:aL,multiplyScalarAndAdd:sL,ortho:yT,orthoNO:vT,orthoZO:mT,perspective:QP,perspectiveFromFieldOfView:eL,perspectiveNO:pT,perspectiveZO:JP,rotate:UP,rotateX:lT,rotateY:cT,rotateZ:HP,scale:uT,set:G0,str:nL,sub:uL,subtract:wT,targetTo:tL,translate:As,transpose:sT},Symbol.toStringTag,{value:"Module"}));function Ze(){var r=new en(3);return en!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function yi(r){var e=new en(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function bi(r){var e=r[0],t=r[1],n=r[2];return Math.hypot(e,t,n)}function vt(r,e,t){var n=new en(3);return n[0]=r,n[1]=e,n[2]=t,n}function ri(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r}function Ln(r,e,t,n){return r[0]=e,r[1]=t,r[2]=n,r}function ra(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r}function Y0(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r}function cL(r,e,t){return r[0]=e[0]*t[0],r[1]=e[1]*t[1],r[2]=e[2]*t[2],r}function dL(r,e,t){return r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.min(e[2],t[2]),r}function hL(r,e,t){return r[0]=Math.max(e[0],t[0]),r[1]=Math.max(e[1],t[1]),r[2]=Math.max(e[2],t[2]),r}function $l(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r}function fL(r,e){var t=e[0]-r[0],n=e[1]-r[1],i=e[2]-r[2];return Math.hypot(t,n,i)}function Ra(r,e){var t=e[0],n=e[1],i=e[2],a=t*t+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),r[0]=e[0]*a,r[1]=e[1]*a,r[2]=e[2]*a,r}function ii(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]}function Al(r,e,t){var n=e[0],i=e[1],a=e[2],s=t[0],o=t[1],u=t[2];return r[0]=i*u-a*o,r[1]=a*s-n*u,r[2]=n*o-i*s,r}function U0(r,e,t,n){var i=e[0],a=e[1],s=e[2];return r[0]=i+n*(t[0]-i),r[1]=a+n*(t[1]-a),r[2]=s+n*(t[2]-s),r}function In(r,e,t){var n=e[0],i=e[1],a=e[2],s=t[3]*n+t[7]*i+t[11]*a+t[15];return s=s||1,r[0]=(t[0]*n+t[4]*i+t[8]*a+t[12])/s,r[1]=(t[1]*n+t[5]*i+t[9]*a+t[13])/s,r[2]=(t[2]*n+t[6]*i+t[10]*a+t[14])/s,r}function gL(r,e,t){var n=e[0],i=e[1],a=e[2];return r[0]=n*t[0]+i*t[3]+a*t[6],r[1]=n*t[1]+i*t[4]+a*t[7],r[2]=n*t[2]+i*t[5]+a*t[8],r}function pL(r,e,t){var n=t[0],i=t[1],a=t[2],s=t[3],o=e[0],u=e[1],l=e[2],c=i*l-a*u,d=a*o-n*l,h=n*u-i*o,f=i*h-a*d,g=a*c-n*h,v=n*d-i*c,p=s*2;return c*=p,d*=p,h*=p,f*=2,g*=2,v*=2,r[0]=o+c+f,r[1]=u+d+g,r[2]=l+h+v,r}function eo(r,e){var t=r[0],n=r[1],i=r[2],a=e[0],s=e[1],o=e[2];return Math.abs(t-a)<=St*Math.max(1,Math.abs(t),Math.abs(a))&&Math.abs(n-s)<=St*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-o)<=St*Math.max(1,Math.abs(i),Math.abs(o))}var vL=Y0,D1=fL,ET=bi;(function(){var r=Ze();return function(e,t,n,i,a,s){var o,u;for(t||(t=3),n||(n=0),i?u=Math.min(i*t+n,e.length):u=e.length,o=n;o<u;o+=t)r[0]=e[o],r[1]=e[o+1],r[2]=e[o+2],a(r,r,s),e[o]=r[0],e[o+1]=r[1],e[o+2]=r[2];return e}})();function ai(){var r=new en(4);return en!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function go(r,e,t,n){var i=new en(4);return i[0]=r,i[1]=e,i[2]=t,i[3]=n,i}function yL(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}function mL(r,e,t,n,i){return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r}function bL(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=t*t+n*n+i*i+a*a;return s>0&&(s=1/Math.sqrt(s)),r[0]=t*s,r[1]=n*s,r[2]=i*s,r[3]=a*s,r}function Si(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3];return r[0]=t[0]*n+t[4]*i+t[8]*a+t[12]*s,r[1]=t[1]*n+t[5]*i+t[9]*a+t[13]*s,r[2]=t[2]*n+t[6]*i+t[10]*a+t[14]*s,r[3]=t[3]*n+t[7]*i+t[11]*a+t[15]*s,r}(function(){var r=ai();return function(e,t,n,i,a,s){var o,u;for(t||(t=4),n||(n=0),i?u=Math.min(i*t+n,e.length):u=e.length,o=n;o<u;o+=t)r[0]=e[o],r[1]=e[o+1],r[2]=e[o+2],r[3]=e[o+3],a(r,r,s),e[o]=r[0],e[o+1]=r[1],e[o+2]=r[2],e[o+3]=r[3];return e}})();function an(){var r=new en(4);return en!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function Xi(r,e,t){t=t*.5;var n=Math.sin(t);return r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=Math.cos(t),r}function ia(r,e,t){var n=e[0],i=e[1],a=e[2],s=e[3],o=t[0],u=t[1],l=t[2],c=t[3];return r[0]=n*c+s*o+i*l-a*u,r[1]=i*c+s*u+a*o-n*l,r[2]=a*c+s*l+n*u-i*o,r[3]=s*c-n*o-i*u-a*l,r}function sh(r,e,t,n){var i=e[0],a=e[1],s=e[2],o=e[3],u=t[0],l=t[1],c=t[2],d=t[3],h,f,g,v,p;return f=i*u+a*l+s*c+o*d,f<0&&(f=-f,u=-u,l=-l,c=-c,d=-d),1-f>St?(h=Math.acos(f),g=Math.sin(h),v=Math.sin((1-n)*h)/g,p=Math.sin(n*h)/g):(v=1-n,p=n),r[0]=v*i+p*u,r[1]=v*a+p*l,r[2]=v*s+p*c,r[3]=v*o+p*d,r}function oh(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=t*t+n*n+i*i+a*a,o=s?1/s:0;return r[0]=-t*o,r[1]=-n*o,r[2]=-i*o,r[3]=a*o,r}function wL(r,e){var t=e[0]+e[4]+e[8],n;if(t>0)n=Math.sqrt(t+1),r[3]=.5*n,n=.5/n,r[0]=(e[5]-e[7])*n,r[1]=(e[6]-e[2])*n,r[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var a=(i+1)%3,s=(i+2)%3;n=Math.sqrt(e[i*3+i]-e[a*3+a]-e[s*3+s]+1),r[i]=.5*n,n=.5/n,r[3]=(e[a*3+s]-e[s*3+a])*n,r[a]=(e[a*3+i]+e[i*3+a])*n,r[s]=(e[s*3+i]+e[i*3+s])*n}return r}function Nu(r,e,t,n){var i=.5*Math.PI/180;e*=i,t*=i,n*=i;var a=Math.sin(e),s=Math.cos(e),o=Math.sin(t),u=Math.cos(t),l=Math.sin(n),c=Math.cos(n);return r[0]=a*u*c-s*o*l,r[1]=s*o*c+a*u*l,r[2]=s*u*l-a*o*c,r[3]=s*u*c+a*o*l,r}var xL=go,Cu=yL,I1=mL,R1=ia,ql=bL;(function(){var r=Ze(),e=vt(1,0,0),t=vt(0,1,0);return function(n,i,a){var s=ii(i,a);return s<-.999999?(Al(r,e,i),ET(r)<1e-6&&Al(r,t,i),Ra(r,r),Xi(n,r,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(Al(r,i,a),n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=1+s,ql(n,n))}})();(function(){var r=an(),e=an();return function(t,n,i,a,s,o){return sh(r,n,s,o),sh(e,i,a,o),sh(t,r,e,2*o*(1-o)),t}})();(function(){var r=rT();return function(e,t,n,i){return r[0]=n[0],r[3]=n[1],r[6]=n[2],r[1]=i[0],r[4]=i[1],r[7]=i[2],r[2]=-t[0],r[5]=-t[1],r[8]=-t[2],ql(e,wL(e,r))}})();function sm(){var r=new en(2);return en!=Float32Array&&(r[0]=0,r[1]=0),r}function EL(r,e){return r[0]=e[0],r[1]=e[1],r}function ML(r,e,t){return r[0]=e,r[1]=t,r}function SL(r,e){var t=e[0],n=e[1],i=t*t+n*n;return i>0&&(i=1/Math.sqrt(i)),r[0]=e[0]*i,r[1]=e[1]*i,r}function _L(r,e){return r[0]*e[0]+r[1]*e[1]}function TL(r,e){return r[0]===e[0]&&r[1]===e[1]}(function(){var r=sm();return function(e,t,n,i,a,s){var o,u;for(t||(t=2),n||(n=0),i?u=Math.min(i*t+n,e.length):u=e.length,o=n;o<u;o+=t)r[0]=e[o],r[1]=e[o+1],a(r,r,s),e[o]=r[0],e[o+1]=r[1];return e}})();var Ro=function(r){return r!==null&&typeof r!="function"&&isFinite(r.length)},OL=function(r,e){return Ro(r)?r.indexOf(e)>-1:!1},AL=function(r,e){if(!Ro(r))return r;for(var t=[],n=0;n<r.length;n++){var i=r[n];e(i,n)&&t.push(i)}return t},kL=function(r,e){return e===void 0&&(e=[]),AL(r,function(t){return!OL(e,t)})};function Te(r){return typeof r=="function"}function Le(r){return r==null}function gr(r){return Array.isArray(r)}const Yt=function(r){var e=typeof r;return r!==null&&e==="object"||e==="function"};function MT(r,e){if(r){var t;if(gr(r))for(var n=0,i=r.length;n<i&&(t=e(r[n],n),t!==!1);n++);else if(Yt(r)){for(var a in r)if(r.hasOwnProperty(a)&&(t=e(r[a],a),t===!1))break}}}var H0=function(r){return typeof r=="object"&&r!==null},NL={}.toString,ST=function(r,e){return NL.call(r)==="[object "+e+"]"},js=function(r){if(!H0(r)||!ST(r,"Object"))return!1;if(Object.getPrototypeOf(r)===null)return!0;for(var e=r;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(r)===e};function Gl(r){if(!Array.isArray(r))return-1/0;var e=r.length;if(!e)return-1/0;for(var t=r[0],n=1;n<e;n++)t=Math.max(t,r[n]);return t}const Wl=function(r){if(gr(r))return r.reduce(function(e,t){return Math.min(e,t)},r[0])};var CL=function(r,e,t){if(!gr(r)&&!js(r))return r;var n=t;return MT(r,function(i,a){n=e(n,i,a)}),n};function tt(r){return typeof r=="string"}function PL(r,e){e===void 0&&(e=new Map);var t=[];if(Array.isArray(r))for(var n=0,i=r.length;n<i;n++){var a=r[n];e.has(a)||(t.push(a),e.set(a,!0))}return t}var LL=Object.prototype.hasOwnProperty;function _c(r,e){if(!e||!gr(r))return{};for(var t={},n=Te(e)?e:function(o){return o[e]},i,a=0;a<r.length;a++){var s=r[a];i=n(s),LL.call(t,i)?t[i].push(s):t[i]=[s]}return t}var jt=function(r,e,t){return r<e?e:r>t?t:r};function Ee(r){return typeof r=="number"}var DL=1e-5;function Ao(r,e,t){return t===void 0&&(t=DL),r===e||Math.abs(r-e)<t}const IL=function(r,e){if(gr(r)){for(var t,n=-1/0,i=0;i<r.length;i++){var a=r[i],s=Te(e)?e(a):a[e];s>n&&(t=a,n=s)}return t}},RL=function(r,e){if(gr(r)){for(var t,n=1/0,i=0;i<r.length;i++){var a=r[i],s=Te(e)?e(a):a[e];s<n&&(t=a,n=s)}return t}};var _T=function(r,e){return(r%e+e)%e};const TT=function(r){return Le(r)?"":r.toString()};var jL=function(r){var e=TT(r);return e.charAt(0).toLowerCase()+e.substring(1)};function BL(r,e){return!r||!e?r:r.replace(/\\?\{([^{}]+)\}/g,function(t,n){return t.charAt(0)==="\\"?t.slice(1):e[n]===void 0?"":e[n]})}var Vl=function(r){var e=TT(r);return e.charAt(0).toUpperCase()+e.substring(1)},FL={}.toString,zL=function(r){return FL.call(r).replace(/^\[object /,"").replace(/]$/,"")},Yl=function(r){return ST(r,"Boolean")};function $L(r){return r instanceof Date}function qL(r){return r===null}var GL=Object.prototype,WL=function(r){var e=r&&r.constructor,t=typeof e=="function"&&e.prototype||GL;return r===t},je=function(r){return r===void 0},la=function(r){if(typeof r!="object"||r===null)return r;var e;if(gr(r)){e=[];for(var t=0,n=r.length;t<n;t++)typeof r[t]=="object"&&r[t]!=null?e[t]=la(r[t]):e[t]=r[t]}else{e={};for(var i in r)typeof r[i]=="object"&&r[i]!=null?e[i]=la(r[i]):e[i]=r[i]}return e};function su(r,e,t){var n;return function(){var i=this,a=arguments,s=function(){n=null,t||r.apply(i,a)},o=t&&!n;clearTimeout(n),n=setTimeout(s,e),o&&r.apply(i,a)}}function VL(r){var e,t,n,i=r||1;function a(o,u){++e>i&&(n=t,s(1),++e),t[o]=u}function s(o){e=0,t=Object.create(null),o||(n=Object.create(null))}return s(),{clear:s,has:function(o){return t[o]!==void 0||n[o]!==void 0},get:function(o){var u=t[o];if(u!==void 0)return u;if((u=n[o])!==void 0)return a(o,u),u},set:function(o,u){t[o]!==void 0?t[o]=u:a(o,u)}}}var uh=new Map;function X0(r,e,t){t===void 0&&(t=128);var n=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var s=e?e.apply(this,i):i[0];uh.has(r)||uh.set(r,VL(t));var o=uh.get(r);if(o.has(s))return o.get(s);var u=r.apply(this,i);return o.set(s,u),u};return n}var YL=5;function UL(r,e){if(Object.hasOwn)return Object.hasOwn(r,e);if(r==null)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(r),e)}function OT(r,e,t,n){t=t||0,n=n||YL;for(var i in e)if(UL(e,i)){var a=e[i];a!==null&&js(a)?(js(r[i])||(r[i]={}),t<n?OT(r[i],a,t+1,n):r[i]=e[i]):gr(a)?(r[i]=[],r[i]=r[i].concat(a)):a!==void 0&&(r[i]=a)}}var Gn=function(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var n=0;n<e.length;n+=1)OT(r,e[n]);return r},HL=Object.prototype.hasOwnProperty;function ti(r){if(Le(r))return!0;if(Ro(r))return!r.length;var e=zL(r);if(e==="Map"||e==="Set")return!r.size;if(WL(r))return!Object.keys(r).length;for(var t in r)if(HL.call(r,t))return!1;return!0}var Bt=function(r,e){if(r===e)return!0;if(!r||!e||tt(r)||tt(e))return!1;if(Ro(r)||Ro(e)){if(r.length!==e.length)return!1;for(var t=!0,n=0;n<r.length&&(t=Bt(r[n],e[n]),!!t);n++);return t}if(H0(r)||H0(e)){var i=Object.keys(r),a=Object.keys(e);if(i.length!==a.length)return!1;for(var t=!0,n=0;n<i.length&&(t=Bt(r[i[n]],e[i[n]]),!!t);n++);return t}return!1};const Fn=function(r,e,t){for(var n=0,i=tt(e)?e.split("."):e;r&&n<i.length;)r=r[i[n++]];return r===void 0||n<i.length?t:r},jo=function(r,e,t){var n=r,i=tt(e)?e.split("."):e;return i.forEach(function(a,s){s<i.length-1?(Yt(n[a])||(n[a]=Ee(i[s+1])?[]:{}),n=n[a]):n[a]=t}),r};var XL=Object.prototype.hasOwnProperty;const $a=function(r,e){if(r===null||!js(r))return{};var t={};return MT(e,function(n){XL.call(r,n)&&(t[n]=r[n])}),t},om=function(r,e){return CL(r,function(t,n,i){return e.includes(i)||(t[i]=n),t},{})},AT=function(r,e,t){var n,i,a,s,o=0;t||(t={});var u=function(){o=t.leading===!1?0:Date.now(),n=null,s=r.apply(i,a),n||(i=a=null)},l=function(){var c=Date.now();!o&&t.leading===!1&&(o=c);var d=e-(c-o);return i=this,a=arguments,d<=0||d>e?(n&&(clearTimeout(n),n=null),o=c,s=r.apply(i,a),n||(i=a=null)):!n&&t.trailing!==!1&&(n=setTimeout(u,d)),s};return l.cancel=function(){clearTimeout(n),o=0,n=i=a=null},l};var Pu={};const KL=function(r){return r=r||"g",Pu[r]?Pu[r]+=1:Pu[r]=1,r+Pu[r]},lh=function(){},K0=function(r){return r};var ca=function(){return ca=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},ca.apply(this,arguments)};function kT(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t}function Ye(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})}function Tr(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,a=[],s;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(o){s={error:o}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(s)throw s.error}}return a}function ZL(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),i=0,e=0;e<t;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n}function Cn(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,a;n<i;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return r.concat(a||Array.prototype.slice.call(e))}var NT={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function QL(r,e,t){if(r[t].length>7){r[t].shift();for(var n=r[t],i=t;n.length;)e[t]="A",r.splice(i+=1,0,["C"].concat(n.splice(0,6)));r.splice(t,1)}}var ko={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function CT(r){return Array.isArray(r)&&r.every(function(e){var t=e[0].toLowerCase();return ko[t]===e.length-1&&"achlmqstvz".includes(t)})}function PT(r){return CT(r)&&r.every(function(e){var t=e[0];return t===t.toUpperCase()})}function LT(r){return PT(r)&&r.every(function(e){var t=e[0];return"ACLMQZ".includes(t)})}function j1(r){for(var e=r.pathValue[r.segmentStart],t=e.toLowerCase(),n=r.data;n.length>=ko[t]&&(t==="m"&&n.length>2?(r.segments.push([e].concat(n.splice(0,2))),t="l",e=e==="m"?"l":"L"):r.segments.push([e].concat(n.splice(0,ko[t]))),!!ko[t]););}function JL(r){var e=r.index,t=r.pathValue,n=t.charCodeAt(e);if(n===48){r.param=0,r.index+=1;return}if(n===49){r.param=1,r.index+=1;return}r.err='[path-util]: invalid Arc flag "'.concat(t[e],'", expecting 0 or 1 at index ').concat(e)}function e3(r){return r>=48&&r<=57||r===43||r===45||r===46}function cs(r){return r>=48&&r<=57}function t3(r){var e=r.max,t=r.pathValue,n=r.index,i=n,a=!1,s=!1,o=!1,u=!1,l;if(i>=e){r.err="[path-util]: Invalid path value at index ".concat(i,', "pathValue" is missing param');return}if(l=t.charCodeAt(i),(l===43||l===45)&&(i+=1,l=t.charCodeAt(i)),!cs(l)&&l!==46){r.err="[path-util]: Invalid path value at index ".concat(i,', "').concat(t[i],'" is not a number');return}if(l!==46){if(a=l===48,i+=1,l=t.charCodeAt(i),a&&i<e&&l&&cs(l)){r.err="[path-util]: Invalid path value at index ".concat(n,', "').concat(t[n],'" illegal number');return}for(;i<e&&cs(t.charCodeAt(i));)i+=1,s=!0;l=t.charCodeAt(i)}if(l===46){for(u=!0,i+=1;cs(t.charCodeAt(i));)i+=1,o=!0;l=t.charCodeAt(i)}if(l===101||l===69){if(u&&!s&&!o){r.err="[path-util]: Invalid path value at index ".concat(i,', "').concat(t[i],'" invalid float exponent');return}if(i+=1,l=t.charCodeAt(i),(l===43||l===45)&&(i+=1),i<e&&cs(t.charCodeAt(i)))for(;i<e&&cs(t.charCodeAt(i));)i+=1;else{r.err="[path-util]: Invalid path value at index ".concat(i,', "').concat(t[i],'" invalid integer exponent');return}}r.index=i,r.param=+r.pathValue.slice(n,i)}function n3(r){var e=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];return r===10||r===13||r===8232||r===8233||r===32||r===9||r===11||r===12||r===160||r>=5760&&e.includes(r)}function kl(r){for(var e=r.pathValue,t=r.max;r.index<t&&n3(e.charCodeAt(r.index));)r.index+=1}function r3(r){switch(r|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}function i3(r){return(r|32)===97}function a3(r){var e=r.max,t=r.pathValue,n=r.index,i=t.charCodeAt(n),a=ko[t[n].toLowerCase()];if(r.segmentStart=n,!r3(i)){r.err='[path-util]: Invalid path value "'.concat(t[n],'" is not a path command');return}if(r.index+=1,kl(r),r.data=[],!a){j1(r);return}for(;;){for(var s=a;s>0;s-=1){if(i3(i)&&(s===3||s===4)?JL(r):t3(r),r.err.length)return;r.data.push(r.param),kl(r),r.index<e&&t.charCodeAt(r.index)===44&&(r.index+=1,kl(r))}if(r.index>=r.max||!e3(t.charCodeAt(r.index)))break}j1(r)}var s3=function(){function r(e){this.pathValue=e,this.segments=[],this.max=e.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}return r}();function o3(r){if(CT(r))return[].concat(r);var e=new s3(r);for(kl(e);e.index<e.max&&!e.err.length;)a3(e);return e.err?e.err:e.segments}function u3(r){if(PT(r))return[].concat(r);var e=o3(r),t=0,n=0,i=0,a=0;return e.map(function(s){var o=s.slice(1).map(Number),u=s[0],l=u.toUpperCase();if(u==="M")return t=o[0],n=o[1],i=t,a=n,["M",t,n];var c;if(u!==l)switch(l){case"A":c=[l,o[0],o[1],o[2],o[3],o[4],o[5]+t,o[6]+n];break;case"V":c=[l,o[0]+n];break;case"H":c=[l,o[0]+t];break;default:{var d=o.map(function(f,g){return f+(g%2?n:t)});c=[l].concat(d)}}else c=[l].concat(o);var h=c.length;switch(l){case"Z":t=i,n=a;break;case"H":t=c[1];break;case"V":n=c[1];break;default:t=c[h-2],n=c[h-1],l==="M"&&(i=t,a=n)}return c})}function l3(r,e){var t=r[0],n=e.x1,i=e.y1,a=e.x2,s=e.y2,o=r.slice(1).map(Number),u=r;if("TQ".includes(t)||(e.qx=null,e.qy=null),t==="H")u=["L",r[1],i];else if(t==="V")u=["L",n,r[1]];else if(t==="S"){var l=n*2-a,c=i*2-s;e.x1=l,e.y1=c,u=["C",l,c].concat(o)}else if(t==="T"){var d=n*2-e.qx,h=i*2-e.qy;e.qx=d,e.qy=h,u=["Q",d,h].concat(o)}else if(t==="Q"){var f=o[0],g=o[1];e.qx=f,e.qy=g}return u}function Ul(r){if(LT(r))return[].concat(r);for(var e=u3(r),t=ca({},NT),n=0;n<e.length;n+=1){e[n]=l3(e[n],t);var i=e[n],a=i.length;t.x1=+i[a-2],t.y1=+i[a-1],t.x2=+i[a-4]||t.x1,t.y2=+i[a-3]||t.y1}return e}function c3(r){return LT(r)&&r.every(function(e){var t=e[0];return"MC".includes(t)})}function Lu(r,e,t){var n=r*Math.cos(t)-e*Math.sin(t),i=r*Math.sin(t)+e*Math.cos(t);return{x:n,y:i}}function um(r,e,t,n,i,a,s,o,u,l){var c=r,d=e,h=t,f=n,g=o,v=u,p=Math.PI*120/180,y=Math.PI/180*(+i||0),m=[],w,M,S,T,A;if(l)M=l[0],S=l[1],T=l[2],A=l[3];else{w=Lu(c,d,-y),c=w.x,d=w.y,w=Lu(g,v,-y),g=w.x,v=w.y;var O=(c-g)/2,N=(d-v)/2,C=O*O/(h*h)+N*N/(f*f);C>1&&(C=Math.sqrt(C),h*=C,f*=C);var P=h*h,D=f*f,j=(a===s?-1:1)*Math.sqrt(Math.abs((P*D-P*N*N-D*O*O)/(P*N*N+D*O*O)));T=j*h*N/f+(c+g)/2,A=j*-f*O/h+(d+v)/2,M=Math.asin(((d-A)/f*Math.pow(10,9)>>0)/Math.pow(10,9)),S=Math.asin(((v-A)/f*Math.pow(10,9)>>0)/Math.pow(10,9)),M=c<T?Math.PI-M:M,S=g<T?Math.PI-S:S,M<0&&(M=Math.PI*2+M),S<0&&(S=Math.PI*2+S),s&&M>S&&(M-=Math.PI*2),!s&&S>M&&(S-=Math.PI*2)}var G=S-M;if(Math.abs(G)>p){var V=S,Y=g,$=v;S=M+p*(s&&S>M?1:-1),g=T+h*Math.cos(S),v=A+f*Math.sin(S),m=um(g,v,h,f,i,0,s,Y,$,[S,V,T,A])}G=S-M;var z=Math.cos(M),Z=Math.sin(M),ne=Math.cos(S),se=Math.sin(S),oe=Math.tan(G/4),Ne=4/3*h*oe,K=4/3*f*oe,W=[c,d],ee=[c+Ne*Z,d-K*z],le=[g+Ne*se,v-K*ne],xe=[g,v];if(ee[0]=2*W[0]-ee[0],ee[1]=2*W[1]-ee[1],l)return ee.concat(le,xe,m);m=ee.concat(le,xe,m);for(var Ce=[],Ve=0,Tt=m.length;Ve<Tt;Ve+=1)Ce[Ve]=Ve%2?Lu(m[Ve-1],m[Ve],y).y:Lu(m[Ve],m[Ve+1],y).x;return Ce}function d3(r,e,t,n,i,a){var s=.3333333333333333,o=2/3;return[s*r+o*t,s*e+o*n,s*i+o*t,s*a+o*n,i,a]}function Vi(r,e,t){var n=r[0],i=r[1],a=e[0],s=e[1];return[n+(a-n)*t,i+(s-i)*t]}var B1=function(r,e,t,n){var i=.5,a=Vi([r,e],[t,n],i);return Cn(Cn([],a,!0),[t,n,t,n],!1)};function h3(r,e){var t=r[0],n=r.slice(1).map(Number),i=n[0],a=n[1],s,o=e.x1,u=e.y1,l=e.x,c=e.y;switch("TQ".includes(t)||(e.qx=null,e.qy=null),t){case"M":return e.x=i,e.y=a,r;case"A":return s=[o,u].concat(n),["C"].concat(um(s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],s[8],s[9]));case"Q":return e.qx=i,e.qy=a,s=[o,u].concat(n),["C"].concat(d3(s[0],s[1],s[2],s[3],s[4],s[5]));case"L":return["C"].concat(B1(o,u,i,a));case"Z":return o===l&&u===c?["C",o,u,l,c,l,c]:["C"].concat(B1(o,u,l,c))}return r}function Z0(r,e){if(e===void 0&&(e=!1),c3(r)){var t=[].concat(r);return e?[t,[]]:t}for(var n=Ul(r),i=ca({},NT),a=[],s="",o=n.length,u,l,c=[],d=0;d<o;d+=1){n[d]&&(s=n[d][0]),a[d]=s;var h=h3(n[d],i);n[d]=h,QL(n,a,d),o=n.length,s==="Z"&&c.push(d),u=n[d],l=u.length,i.x1=+u[l-2],i.y1=+u[l-1],i.x2=+u[l-4]||i.x1,i.y2=+u[l-3]||i.y1}return e?[n,c]:n}function f3(r){return r.map(function(e){return Array.isArray(e)?[].concat(e):e})}function g3(r){var e=r.slice(1).map(function(t,n,i){return n?i[n-1].slice(-2).concat(t.slice(1)):r[0].slice(1).concat(t.slice(1))}).map(function(t){return t.map(function(n,i){return t[t.length-i-2*(1-i%2)]})}).reverse();return[["M"].concat(e[0].slice(0,2))].concat(e.map(function(t){return["C"].concat(t.slice(2))}))}function Kn(r,e){return Math.sqrt((r[0]-e[0])*(r[0]-e[0])+(r[1]-e[1])*(r[1]-e[1]))}function Q0(r,e,t,n,i){var a=Kn([r,e],[t,n]),s={x:0,y:0};if(typeof i=="number")if(i<=0)s={x:r,y:e};else if(i>=a)s={x:t,y:n};else{var o=Vi([r,e],[t,n],i/a),u=o[0],l=o[1];s={x:u,y:l}}return{length:a,point:s,min:{x:Math.min(r,t),y:Math.min(e,n)},max:{x:Math.max(r,t),y:Math.max(e,n)}}}function F1(r,e){var t=r.x,n=r.y,i=e.x,a=e.y,s=t*i+n*a,o=Math.sqrt((Math.pow(t,2)+Math.pow(n,2))*(Math.pow(i,2)+Math.pow(a,2))),u=t*a-n*i<0?-1:1,l=u*Math.acos(s/o);return l}function p3(r,e,t,n,i,a,s,o,u,l){var c=Math.abs,d=Math.sin,h=Math.cos,f=Math.sqrt,g=Math.PI,v=c(t),p=c(n),y=(i%360+360)%360,m=y*(g/180);if(r===o&&e===u)return{x:r,y:e};if(v===0||p===0)return Q0(r,e,o,u,l).point;var w=(r-o)/2,M=(e-u)/2,S={x:h(m)*w+d(m)*M,y:-d(m)*w+h(m)*M},T=Math.pow(S.x,2)/Math.pow(v,2)+Math.pow(S.y,2)/Math.pow(p,2);T>1&&(v*=f(T),p*=f(T));var A=Math.pow(v,2)*Math.pow(p,2)-Math.pow(v,2)*Math.pow(S.y,2)-Math.pow(p,2)*Math.pow(S.x,2),O=Math.pow(v,2)*Math.pow(S.y,2)+Math.pow(p,2)*Math.pow(S.x,2),N=A/O;N=N<0?0:N;var C=(a!==s?1:-1)*f(N),P={x:C*(v*S.y/p),y:C*(-(p*S.x)/v)},D={x:h(m)*P.x-d(m)*P.y+(r+o)/2,y:d(m)*P.x+h(m)*P.y+(e+u)/2},j={x:(S.x-P.x)/v,y:(S.y-P.y)/p},G=F1({x:1,y:0},j),V={x:(-S.x-P.x)/v,y:(-S.y-P.y)/p},Y=F1(j,V);!s&&Y>0?Y-=2*g:s&&Y<0&&(Y+=2*g),Y%=2*g;var $=G+Y*l,z=v*h($),Z=p*d($),ne={x:h(m)*z-d(m)*Z+D.x,y:d(m)*z+h(m)*Z+D.y};return ne}function v3(r,e,t,n,i,a,s,o,u,l,c){var d,h=c.bbox,f=h===void 0?!0:h,g=c.length,v=g===void 0?!0:g,p=c.sampleSize,y=p===void 0?30:p,m=typeof l=="number",w=r,M=e,S=0,T=[w,M,S],A=[w,M],O=0,N={x:0,y:0},C=[{x:w,y:M}];m&&l<=0&&(N={x:w,y:M});for(var P=0;P<=y;P+=1){if(O=P/y,d=p3(r,e,t,n,i,a,s,o,u,O),w=d.x,M=d.y,f&&C.push({x:w,y:M}),v&&(S+=Kn(A,[w,M])),A=[w,M],m&&S>=l&&l>T[2]){var D=(S-l)/(S-T[2]);N={x:A[0]*(1-D)+T[0]*D,y:A[1]*(1-D)+T[1]*D}}T=[w,M,S]}return m&&l>=S&&(N={x:o,y:u}),{length:S,point:N,min:{x:Math.min.apply(null,C.map(function(j){return j.x})),y:Math.min.apply(null,C.map(function(j){return j.y}))},max:{x:Math.max.apply(null,C.map(function(j){return j.x})),y:Math.max.apply(null,C.map(function(j){return j.y}))}}}function y3(r,e,t,n,i,a,s,o,u){var l=1-u;return{x:Math.pow(l,3)*r+3*Math.pow(l,2)*u*t+3*l*Math.pow(u,2)*i+Math.pow(u,3)*s,y:Math.pow(l,3)*e+3*Math.pow(l,2)*u*n+3*l*Math.pow(u,2)*a+Math.pow(u,3)*o}}function DT(r,e,t,n,i,a,s,o,u,l){var c,d=l.bbox,h=d===void 0?!0:d,f=l.length,g=f===void 0?!0:f,v=l.sampleSize,p=v===void 0?10:v,y=typeof u=="number",m=r,w=e,M=0,S=[m,w,M],T=[m,w],A=0,O={x:0,y:0},N=[{x:m,y:w}];y&&u<=0&&(O={x:m,y:w});for(var C=0;C<=p;C+=1){if(A=C/p,c=y3(r,e,t,n,i,a,s,o,A),m=c.x,w=c.y,h&&N.push({x:m,y:w}),g&&(M+=Kn(T,[m,w])),T=[m,w],y&&M>=u&&u>S[2]){var P=(M-u)/(M-S[2]);O={x:T[0]*(1-P)+S[0]*P,y:T[1]*(1-P)+S[1]*P}}S=[m,w,M]}return y&&u>=M&&(O={x:s,y:o}),{length:M,point:O,min:{x:Math.min.apply(null,N.map(function(D){return D.x})),y:Math.min.apply(null,N.map(function(D){return D.y}))},max:{x:Math.max.apply(null,N.map(function(D){return D.x})),y:Math.max.apply(null,N.map(function(D){return D.y}))}}}function m3(r,e,t,n,i,a,s){var o=1-s;return{x:Math.pow(o,2)*r+2*o*s*t+Math.pow(s,2)*i,y:Math.pow(o,2)*e+2*o*s*n+Math.pow(s,2)*a}}function b3(r,e,t,n,i,a,s,o){var u,l=o.bbox,c=l===void 0?!0:l,d=o.length,h=d===void 0?!0:d,f=o.sampleSize,g=f===void 0?10:f,v=typeof s=="number",p=r,y=e,m=0,w=[p,y,m],M=[p,y],S=0,T={x:0,y:0},A=[{x:p,y}];v&&s<=0&&(T={x:p,y});for(var O=0;O<=g;O+=1){if(S=O/g,u=m3(r,e,t,n,i,a,S),p=u.x,y=u.y,c&&A.push({x:p,y}),h&&(m+=Kn(M,[p,y])),M=[p,y],v&&m>=s&&s>w[2]){var N=(m-s)/(m-w[2]);T={x:M[0]*(1-N)+w[0]*N,y:M[1]*(1-N)+w[1]*N}}w=[p,y,m]}return v&&s>=m&&(T={x:i,y:a}),{length:m,point:T,min:{x:Math.min.apply(null,A.map(function(C){return C.x})),y:Math.min.apply(null,A.map(function(C){return C.y}))},max:{x:Math.max.apply(null,A.map(function(C){return C.x})),y:Math.max.apply(null,A.map(function(C){return C.y}))}}}function IT(r,e,t){for(var n,i,a,s,o,u,l=Ul(r),c=typeof e=="number",d,h=[],f,g=0,v=0,p=0,y=0,m,w=[],M=[],S=0,T={x:0,y:0},A=T,O=T,N=T,C=0,P=0,D=l.length;P<D;P+=1)m=l[P],f=m[0],d=f==="M",h=d?h:[g,v].concat(m.slice(1)),d?(p=m[1],y=m[2],T={x:p,y},A=T,S=0,c&&e<.001&&(N=T)):f==="L"?(n=Q0(h[0],h[1],h[2],h[3],(e||0)-C),S=n.length,T=n.min,A=n.max,O=n.point):f==="A"?(i=v3(h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],h[8],(e||0)-C,t||{}),S=i.length,T=i.min,A=i.max,O=i.point):f==="C"?(a=DT(h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],(e||0)-C,t||{}),S=a.length,T=a.min,A=a.max,O=a.point):f==="Q"?(s=b3(h[0],h[1],h[2],h[3],h[4],h[5],(e||0)-C,t||{}),S=s.length,T=s.min,A=s.max,O=s.point):f==="Z"&&(h=[g,v,p,y],o=Q0(h[0],h[1],h[2],h[3],(e||0)-C),S=o.length,T=o.min,A=o.max,O=o.point),c&&C<e&&C+S>=e&&(N=O),M.push(A),w.push(T),C+=S,u=f!=="Z"?m.slice(-2):[p,y],g=u[0],v=u[1];return c&&e>=C&&(N={x:g,y:v}),{length:C,point:N,min:{x:Math.min.apply(null,w.map(function(j){return j.x})),y:Math.min.apply(null,w.map(function(j){return j.y}))},max:{x:Math.max.apply(null,M.map(function(j){return j.x})),y:Math.max.apply(null,M.map(function(j){return j.y}))}}}function w3(r,e){return IT(r,void 0,ca(ca({},e),{bbox:!1,length:!0})).length}function x3(r){var e=r.length,t=e-1;return r.map(function(n,i){return r.map(function(a,s){var o=i+s,u;return s===0||r[o]&&r[o][0]==="M"?(u=r[o],["M"].concat(u.slice(-2))):(o>=e&&(o-=t),r[o])})})}function E3(r,e){var t=r.length-1,n=[],i=0,a=0,s=x3(r);return s.forEach(function(o,u){r.slice(1).forEach(function(l,c){a+=Kn(r[(u+c)%t].slice(-2),e[c%t].slice(-2))}),n[u]=a,a=0}),i=n.indexOf(Math.min.apply(null,n)),s[i]}function M3(r,e,t,n,i,a,s,o){return 3*((o-e)*(t+i)-(s-r)*(n+a)+n*(r-i)-t*(e-a)+o*(i+r/3)-s*(a+e/3))/20}function S3(r){var e=0,t=0,n=0;return Z0(r).map(function(i){var a;switch(i[0]){case"M":return e=i[1],t=i[2],0;default:var s=i.slice(1),o=s[0],u=s[1],l=s[2],c=s[3],d=s[4],h=s[5];return n=M3(e,t,o,u,l,c,d,h),a=i.slice(-2),e=a[0],t=a[1],n}}).reduce(function(i,a){return i+a},0)}function z1(r){return S3(r)>=0}function _3(r,e,t){return IT(r,e,ca(ca({},t),{bbox:!1,length:!0})).point}function T3(r,e){e===void 0&&(e=.5);var t=r.slice(0,2),n=r.slice(2,4),i=r.slice(4,6),a=r.slice(6,8),s=Vi(t,n,e),o=Vi(n,i,e),u=Vi(i,a,e),l=Vi(s,o,e),c=Vi(o,u,e),d=Vi(l,c,e);return[["C"].concat(s,l,d),["C"].concat(c,u,a)]}function $1(r){return r.map(function(e,t,n){var i=t&&n[t-1].slice(-2).concat(e.slice(1)),a=t?DT(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],{bbox:!1}).length:0,s;return t?s=a?T3(i):[e,e]:s=[e],{s:e,ss:s,l:a}})}function RT(r,e,t){var n=$1(r),i=$1(e),a=n.length,s=i.length,o=n.filter(function(p){return p.l}).length,u=i.filter(function(p){return p.l}).length,l=n.filter(function(p){return p.l}).reduce(function(p,y){var m=y.l;return p+m},0)/o||0,c=i.filter(function(p){return p.l}).reduce(function(p,y){var m=y.l;return p+m},0)/u||0,d=t||Math.max(a,s),h=[l,c],f=[d-a,d-s],g=0,v=[n,i].map(function(p,y){return p.l===d?p.map(function(m){return m.s}):p.map(function(m,w){return g=w&&f[y]&&m.l>=h[y],f[y]-=g?1:0,g?m.ss:[m.s]}).flat()});return v[0].length===v[1].length?v:RT(v[0],v[1],d)}function J0(r){var e=document.createElement("div");e.innerHTML=r;var t=e.childNodes[0];return t&&e.contains(t)&&e.removeChild(t),t}function O3(r,e){for(;!{}.hasOwnProperty.call(r,e)&&(r=Ds(r))!==null;);return r}function ey(){return ey=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(r,e,t){var n=O3(r,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(arguments.length<3?r:t):i.value}},ey.apply(null,arguments)}function q1(r,e,t,n){var i=ey(Ds(r.prototype),e,t);return typeof i=="function"?function(a){return i.apply(t,a)}:i}function lm(r,e,t){r.prototype=e.prototype=t,t.constructor=r}function jT(r,e){var t=Object.create(r.prototype);for(var n in e)t[n]=e[n];return t}function ou(){}var Bo=.7,Hl=1/Bo,ks="\\s*([+-]?\\d+)\\s*",Fo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",si="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",A3=/^#([0-9a-f]{3,8})$/,k3=new RegExp(`^rgb\\(${ks},${ks},${ks}\\)$`),N3=new RegExp(`^rgb\\(${si},${si},${si}\\)$`),C3=new RegExp(`^rgba\\(${ks},${ks},${ks},${Fo}\\)$`),P3=new RegExp(`^rgba\\(${si},${si},${si},${Fo}\\)$`),L3=new RegExp(`^hsl\\(${Fo},${si},${si}\\)$`),D3=new RegExp(`^hsla\\(${Fo},${si},${si},${Fo}\\)$`),G1={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};lm(ou,Tc,{copy(r){return Object.assign(new this.constructor,this,r)},displayable(){return this.rgb().displayable()},hex:W1,formatHex:W1,formatHex8:I3,formatHsl:R3,formatRgb:V1,toString:V1});function W1(){return this.rgb().formatHex()}function I3(){return this.rgb().formatHex8()}function R3(){return BT(this).formatHsl()}function V1(){return this.rgb().formatRgb()}function Tc(r){var e,t;return r=(r+"").trim().toLowerCase(),(e=A3.exec(r))?(t=e[1].length,e=parseInt(e[1],16),t===6?Y1(e):t===3?new er(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?Du(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?Du(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=k3.exec(r))?new er(e[1],e[2],e[3],1):(e=N3.exec(r))?new er(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=C3.exec(r))?Du(e[1],e[2],e[3],e[4]):(e=P3.exec(r))?Du(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=L3.exec(r))?X1(e[1],e[2]/100,e[3]/100,1):(e=D3.exec(r))?X1(e[1],e[2]/100,e[3]/100,e[4]):G1.hasOwnProperty(r)?Y1(G1[r]):r==="transparent"?new er(NaN,NaN,NaN,0):null}function Y1(r){return new er(r>>16&255,r>>8&255,r&255,1)}function Du(r,e,t,n){return n<=0&&(r=e=t=NaN),new er(r,e,t,n)}function j3(r){return r instanceof ou||(r=Tc(r)),r?(r=r.rgb(),new er(r.r,r.g,r.b,r.opacity)):new er}function B3(r,e,t,n){return arguments.length===1?j3(r):new er(r,e,t,n??1)}function er(r,e,t,n){this.r=+r,this.g=+e,this.b=+t,this.opacity=+n}lm(er,B3,jT(ou,{brighter(r){return r=r==null?Hl:Math.pow(Hl,r),new er(this.r*r,this.g*r,this.b*r,this.opacity)},darker(r){return r=r==null?Bo:Math.pow(Bo,r),new er(this.r*r,this.g*r,this.b*r,this.opacity)},rgb(){return this},clamp(){return new er(ja(this.r),ja(this.g),ja(this.b),Xl(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:U1,formatHex:U1,formatHex8:F3,formatRgb:H1,toString:H1}));function U1(){return`#${Ca(this.r)}${Ca(this.g)}${Ca(this.b)}`}function F3(){return`#${Ca(this.r)}${Ca(this.g)}${Ca(this.b)}${Ca((isNaN(this.opacity)?1:this.opacity)*255)}`}function H1(){const r=Xl(this.opacity);return`${r===1?"rgb(":"rgba("}${ja(this.r)}, ${ja(this.g)}, ${ja(this.b)}${r===1?")":`, ${r})`}`}function Xl(r){return isNaN(r)?1:Math.max(0,Math.min(1,r))}function ja(r){return Math.max(0,Math.min(255,Math.round(r)||0))}function Ca(r){return r=ja(r),(r<16?"0":"")+r.toString(16)}function X1(r,e,t,n){return n<=0?r=e=t=NaN:t<=0||t>=1?r=e=NaN:e<=0&&(r=NaN),new jr(r,e,t,n)}function BT(r){if(r instanceof jr)return new jr(r.h,r.s,r.l,r.opacity);if(r instanceof ou||(r=Tc(r)),!r)return new jr;if(r instanceof jr)return r;r=r.rgb();var e=r.r/255,t=r.g/255,n=r.b/255,i=Math.min(e,t,n),a=Math.max(e,t,n),s=NaN,o=a-i,u=(a+i)/2;return o?(e===a?s=(t-n)/o+(t<n)*6:t===a?s=(n-e)/o+2:s=(e-t)/o+4,o/=u<.5?a+i:2-a-i,s*=60):o=u>0&&u<1?0:s,new jr(s,o,u,r.opacity)}function z3(r,e,t,n){return arguments.length===1?BT(r):new jr(r,e,t,n??1)}function jr(r,e,t,n){this.h=+r,this.s=+e,this.l=+t,this.opacity=+n}lm(jr,z3,jT(ou,{brighter(r){return r=r==null?Hl:Math.pow(Hl,r),new jr(this.h,this.s,this.l*r,this.opacity)},darker(r){return r=r==null?Bo:Math.pow(Bo,r),new jr(this.h,this.s,this.l*r,this.opacity)},rgb(){var r=this.h%360+(this.h<0)*360,e=isNaN(r)||isNaN(this.s)?0:this.s,t=this.l,n=t+(t<.5?t:1-t)*e,i=2*t-n;return new er(ch(r>=240?r-240:r+120,i,n),ch(r,i,n),ch(r<120?r+240:r-120,i,n),this.opacity)},clamp(){return new jr(K1(this.h),Iu(this.s),Iu(this.l),Xl(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const r=Xl(this.opacity);return`${r===1?"hsl(":"hsla("}${K1(this.h)}, ${Iu(this.s)*100}%, ${Iu(this.l)*100}%${r===1?")":`, ${r})`}`}}));function K1(r){return r=(r||0)%360,r<0?r+360:r}function Iu(r){return Math.max(0,Math.min(1,r||0))}function ch(r,e,t){return(r<60?e+(t-e)*r/60:r<180?t:r<240?e+(t-e)*(240-r)/60:e)*255}function Ti(r,e,t,n){var i=r-t,a=e-n;return Math.sqrt(i*i+a*a)}function FT(r,e){var t=Math.min.apply(Math,Cn([],Tr(r),!1)),n=Math.min.apply(Math,Cn([],Tr(e),!1)),i=Math.max.apply(Math,Cn([],Tr(r),!1)),a=Math.max.apply(Math,Cn([],Tr(e),!1));return{x:t,y:n,width:i-t,height:a-n}}function $3(r,e,t){return Math.atan(-e/r*Math.tan(t))}function q3(r,e,t){return Math.atan(e/(r*Math.tan(t)))}function G3(r,e,t,n,i,a){return t*Math.cos(i)*Math.cos(a)-n*Math.sin(i)*Math.sin(a)+r}function W3(r,e,t,n,i,a){return t*Math.sin(i)*Math.cos(a)+n*Math.cos(i)*Math.sin(a)+e}function V3(r,e,t,n,i,a,s){for(var o=$3(t,n,i),u=1/0,l=-1/0,c=[a,s],d=-Math.PI*2;d<=Math.PI*2;d+=Math.PI){var h=o+d;a<s?a<h&&h<s&&c.push(h):s<h&&h<a&&c.push(h)}for(var d=0;d<c.length;d++){var f=G3(r,e,t,n,i,c[d]);f<u&&(u=f),f>l&&(l=f)}for(var g=q3(t,n,i),v=1/0,p=-1/0,y=[a,s],d=-Math.PI*2;d<=Math.PI*2;d+=Math.PI){var m=g+d;a<s?a<m&&m<s&&y.push(m):s<m&&m<a&&y.push(m)}for(var d=0;d<y.length;d++){var w=W3(r,e,t,n,i,y[d]);w<v&&(v=w),w>p&&(p=w)}return{x:u,y:v,width:l-u,height:p-v}}var Y3=1e-4;function zT(r,e,t,n,i,a){var s=-1,o=1/0,u=[t,n],l=20;a&&a>200&&(l=a/10);for(var c=1/l,d=c/10,h=0;h<=l;h++){var f=h*c,g=[i.apply(void 0,Cn([],Tr(r.concat([f])),!1)),i.apply(void 0,Cn([],Tr(e.concat([f])),!1))],v=Ti(u[0],u[1],g[0],g[1]);v<o&&(s=f,o=v)}if(s===0)return{x:r[0],y:e[0]};if(s===1){var p=r.length;return{x:r[p-1],y:e[p-1]}}o=1/0;for(var h=0;h<32&&!(d<Y3);h++){var y=s-d,m=s+d,g=[i.apply(void 0,Cn([],Tr(r.concat([y])),!1)),i.apply(void 0,Cn([],Tr(e.concat([y])),!1))],v=Ti(u[0],u[1],g[0],g[1]);if(y>=0&&v<o)s=y,o=v;else{var w=[i.apply(void 0,Cn([],Tr(r.concat([m])),!1)),i.apply(void 0,Cn([],Tr(e.concat([m])),!1))],M=Ti(u[0],u[1],w[0],w[1]);m<=1&&M<o?(s=m,o=M):d*=.5}}return{x:i.apply(void 0,Cn([],Tr(r.concat([s])),!1)),y:i.apply(void 0,Cn([],Tr(e.concat([s])),!1))}}function $T(r,e,t,n){return Ti(r,e,t,n)}function qT(r,e,t,n,i){return{x:(1-i)*r+i*t,y:(1-i)*e+i*n}}function U3(r,e,t,n,i,a){var s=[t-r,n-e];if(TL(s,[0,0]))return Math.sqrt((i-r)*(i-r)+(a-e)*(a-e));var o=[-s[1],s[0]];SL(o,o);var u=[i-r,a-e];return Math.abs(_L(u,o))}function ty(r,e,t,n,i){var a=1-i;return a*a*a*r+3*e*i*a*a+3*t*i*i*a+n*i*i*i}function Z1(r,e,t,n){var i=-3*r+9*e-9*t+3*n,a=6*r-12*e+6*t,s=3*e-3*r,o=[],u,l,c;if(Ao(i,0))Ao(a,0)||(u=-s/a,u>=0&&u<=1&&o.push(u));else{var d=a*a-4*i*s;Ao(d,0)?o.push(-a/(2*i)):d>0&&(c=Math.sqrt(d),u=(-a+c)/(2*i),l=(-a-c)/(2*i),u>=0&&u<=1&&o.push(u),l>=0&&l<=1&&o.push(l))}return o}function H3(r,e,t,n,i,a,s,o){for(var u=[r,s],l=[e,o],c=Z1(r,t,i,s),d=Z1(e,n,a,o),h=0;h<c.length;h++)u.push(ty(r,t,i,s,c[h]));for(var h=0;h<d.length;h++)l.push(ty(e,n,a,o,d[h]));return FT(u,l)}function X3(r,e,t,n,i,a,s,o,u,l,c){return zT([r,t,i,s],[e,n,a,o],u,l,ty,c)}function Q1(r,e,t,n,i,a,s,o,u,l,c){var d=X3(r,e,t,n,i,a,s,o,u,l,c);return Ti(d.x,d.y,u,l)}function K3(r){if(r.length<2)return 0;for(var e=0,t=0;t<r.length-1;t++){var n=r[t],i=r[t+1];e+=Ti(n[0],n[1],i[0],i[1])}return e}function Z3(r){return K3(r)}function ny(r,e,t,n){var i=1-n;return i*i*r+2*n*i*e+n*n*t}function J1(r,e,t){var n=r+t-2*e;if(Ao(n,0))return[.5];var i=(r-e)/n;return i<=1&&i>=0?[i]:[]}function Q3(r,e,t,n,i,a){var s=J1(r,t,i)[0],o=J1(e,n,a)[0],u=[r,i],l=[e,a];return s!==void 0&&u.push(ny(r,t,i,s)),o!==void 0&&l.push(ny(e,n,a,o)),FT(u,l)}function J3(r,e,t,n,i,a,s,o){return zT([r,t,i],[e,n,a],s,o,ny)}function eD(r,e,t,n,i,a,s,o){var u=J3(r,e,t,n,i,a,s,o);return Ti(u.x,u.y,s,o)}function Mn(){Mn=function(){return e};var r,e={},t=Object.prototype,n=t.hasOwnProperty,i=Object.defineProperty||function(Y,$,z){Y[$]=z.value},a=typeof Symbol=="function"?Symbol:{},s=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(Y,$,z){return Object.defineProperty(Y,$,{value:z,enumerable:!0,configurable:!0,writable:!0}),Y[$]}try{l({},"")}catch{l=function(z,Z,ne){return z[Z]=ne}}function c(Y,$,z,Z){var ne=$&&$.prototype instanceof y?$:y,se=Object.create(ne.prototype),oe=new G(Z||[]);return i(se,"_invoke",{value:C(Y,z,oe)}),se}function d(Y,$,z){try{return{type:"normal",arg:Y.call($,z)}}catch(Z){return{type:"throw",arg:Z}}}e.wrap=c;var h="suspendedStart",f="suspendedYield",g="executing",v="completed",p={};function y(){}function m(){}function w(){}var M={};l(M,s,function(){return this});var S=Object.getPrototypeOf,T=S&&S(S(V([])));T&&T!==t&&n.call(T,s)&&(M=T);var A=w.prototype=y.prototype=Object.create(M);function O(Y){["next","throw","return"].forEach(function($){l(Y,$,function(z){return this._invoke($,z)})})}function N(Y,$){function z(ne,se,oe,Ne){var K=d(Y[ne],Y,se);if(K.type!=="throw"){var W=K.arg,ee=W.value;return ee&&oa(ee)=="object"&&n.call(ee,"__await")?$.resolve(ee.__await).then(function(le){z("next",le,oe,Ne)},function(le){z("throw",le,oe,Ne)}):$.resolve(ee).then(function(le){W.value=le,oe(W)},function(le){return z("throw",le,oe,Ne)})}Ne(K.arg)}var Z;i(this,"_invoke",{value:function(se,oe){function Ne(){return new $(function(K,W){z(se,oe,K,W)})}return Z=Z?Z.then(Ne,Ne):Ne()}})}function C(Y,$,z){var Z=h;return function(ne,se){if(Z===g)throw Error("Generator is already running");if(Z===v){if(ne==="throw")throw se;return{value:r,done:!0}}for(z.method=ne,z.arg=se;;){var oe=z.delegate;if(oe){var Ne=P(oe,z);if(Ne){if(Ne===p)continue;return Ne}}if(z.method==="next")z.sent=z._sent=z.arg;else if(z.method==="throw"){if(Z===h)throw Z=v,z.arg;z.dispatchException(z.arg)}else z.method==="return"&&z.abrupt("return",z.arg);Z=g;var K=d(Y,$,z);if(K.type==="normal"){if(Z=z.done?v:f,K.arg===p)continue;return{value:K.arg,done:z.done}}K.type==="throw"&&(Z=v,z.method="throw",z.arg=K.arg)}}}function P(Y,$){var z=$.method,Z=Y.iterator[z];if(Z===r)return $.delegate=null,z==="throw"&&Y.iterator.return&&($.method="return",$.arg=r,P(Y,$),$.method==="throw")||z!=="return"&&($.method="throw",$.arg=new TypeError("The iterator does not provide a '"+z+"' method")),p;var ne=d(Z,Y.iterator,$.arg);if(ne.type==="throw")return $.method="throw",$.arg=ne.arg,$.delegate=null,p;var se=ne.arg;return se?se.done?($[Y.resultName]=se.value,$.next=Y.nextLoc,$.method!=="return"&&($.method="next",$.arg=r),$.delegate=null,p):se:($.method="throw",$.arg=new TypeError("iterator result is not an object"),$.delegate=null,p)}function D(Y){var $={tryLoc:Y[0]};1 in Y&&($.catchLoc=Y[1]),2 in Y&&($.finallyLoc=Y[2],$.afterLoc=Y[3]),this.tryEntries.push($)}function j(Y){var $=Y.completion||{};$.type="normal",delete $.arg,Y.completion=$}function G(Y){this.tryEntries=[{tryLoc:"root"}],Y.forEach(D,this),this.reset(!0)}function V(Y){if(Y||Y===""){var $=Y[s];if($)return $.call(Y);if(typeof Y.next=="function")return Y;if(!isNaN(Y.length)){var z=-1,Z=function ne(){for(;++z<Y.length;)if(n.call(Y,z))return ne.value=Y[z],ne.done=!1,ne;return ne.value=r,ne.done=!0,ne};return Z.next=Z}}throw new TypeError(oa(Y)+" is not iterable")}return m.prototype=w,i(A,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:m,configurable:!0}),m.displayName=l(w,u,"GeneratorFunction"),e.isGeneratorFunction=function(Y){var $=typeof Y=="function"&&Y.constructor;return!!$&&($===m||($.displayName||$.name)==="GeneratorFunction")},e.mark=function(Y){return Object.setPrototypeOf?Object.setPrototypeOf(Y,w):(Y.__proto__=w,l(Y,u,"GeneratorFunction")),Y.prototype=Object.create(A),Y},e.awrap=function(Y){return{__await:Y}},O(N.prototype),l(N.prototype,o,function(){return this}),e.AsyncIterator=N,e.async=function(Y,$,z,Z,ne){ne===void 0&&(ne=Promise);var se=new N(c(Y,$,z,Z),ne);return e.isGeneratorFunction($)?se:se.next().then(function(oe){return oe.done?oe.value:se.next()})},O(A),l(A,u,"Generator"),l(A,s,function(){return this}),l(A,"toString",function(){return"[object Generator]"}),e.keys=function(Y){var $=Object(Y),z=[];for(var Z in $)z.push(Z);return z.reverse(),function ne(){for(;z.length;){var se=z.pop();if(se in $)return ne.value=se,ne.done=!1,ne}return ne.done=!0,ne}},e.values=V,G.prototype={constructor:G,reset:function($){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(j),!$)for(var z in this)z.charAt(0)==="t"&&n.call(this,z)&&!isNaN(+z.slice(1))&&(this[z]=r)},stop:function(){this.done=!0;var $=this.tryEntries[0].completion;if($.type==="throw")throw $.arg;return this.rval},dispatchException:function($){if(this.done)throw $;var z=this;function Z(W,ee){return oe.type="throw",oe.arg=$,z.next=W,ee&&(z.method="next",z.arg=r),!!ee}for(var ne=this.tryEntries.length-1;ne>=0;--ne){var se=this.tryEntries[ne],oe=se.completion;if(se.tryLoc==="root")return Z("end");if(se.tryLoc<=this.prev){var Ne=n.call(se,"catchLoc"),K=n.call(se,"finallyLoc");if(Ne&&K){if(this.prev<se.catchLoc)return Z(se.catchLoc,!0);if(this.prev<se.finallyLoc)return Z(se.finallyLoc)}else if(Ne){if(this.prev<se.catchLoc)return Z(se.catchLoc,!0)}else{if(!K)throw Error("try statement without catch or finally");if(this.prev<se.finallyLoc)return Z(se.finallyLoc)}}}},abrupt:function($,z){for(var Z=this.tryEntries.length-1;Z>=0;--Z){var ne=this.tryEntries[Z];if(ne.tryLoc<=this.prev&&n.call(ne,"finallyLoc")&&this.prev<ne.finallyLoc){var se=ne;break}}se&&($==="break"||$==="continue")&&se.tryLoc<=z&&z<=se.finallyLoc&&(se=null);var oe=se?se.completion:{};return oe.type=$,oe.arg=z,se?(this.method="next",this.next=se.finallyLoc,p):this.complete(oe)},complete:function($,z){if($.type==="throw")throw $.arg;return $.type==="break"||$.type==="continue"?this.next=$.arg:$.type==="return"?(this.rval=this.arg=$.arg,this.method="return",this.next="end"):$.type==="normal"&&z&&(this.next=z),p},finish:function($){for(var z=this.tryEntries.length-1;z>=0;--z){var Z=this.tryEntries[z];if(Z.finallyLoc===$)return this.complete(Z.completion,Z.afterLoc),j(Z),p}},catch:function($){for(var z=this.tryEntries.length-1;z>=0;--z){var Z=this.tryEntries[z];if(Z.tryLoc===$){var ne=Z.completion;if(ne.type==="throw"){var se=ne.arg;j(Z)}return se}}throw Error("illegal catch attempt")},delegateYield:function($,z,Z){return this.delegate={iterator:V($),resultName:z,nextLoc:Z},this.method==="next"&&(this.arg=r),p}},e}function eb(r,e,t,n,i,a,s){try{var o=r[a](s),u=o.value}catch(l){return void t(l)}o.done?e(u):Promise.resolve(u).then(n,i)}function da(r){return function(){var e=this,t=arguments;return new Promise(function(n,i){var a=r.apply(e,t);function s(u){eb(a,n,i,s,o,"next",u)}function o(u){eb(a,n,i,s,o,"throw",u)}s(void 0)})}}function ka(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=im(r))||e){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,s=!0,o=!1;return{s:function(){t=t.call(r)},n:function(){var l=t.next();return s=l.done,l},e:function(l){o=!0,a=l},f:function(){try{s||t.return==null||t.return()}finally{if(o)throw a}}}}function tD(r,e){if(r==null)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.includes(n))continue;t[n]=r[n]}return t}function Za(r,e){if(r==null)return{};var t,n,i=tD(r,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);for(n=0;n<a.length;n++)t=a[n],e.includes(t)||{}.propertyIsEnumerable.call(r,t)&&(i[t]=r[t])}return i}/*!
 * @antv/g-lite
 * @description A core module for rendering engine implements DOM API.
 * @version 2.2.15
 * @date 1/17/2025, 2:05:37 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var nD=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},GT={exports:{}};(function(r,e){(function(t,n){r.exports=n()})(nD,function(){function t(S,T,A,O,N){n(S,T,A||0,O||S.length-1,N||a)}function n(S,T,A,O,N){for(;O>A;){if(O-A>600){var C=O-A+1,P=T-A+1,D=Math.log(C),j=.5*Math.exp(2*D/3),G=.5*Math.sqrt(D*j*(C-j)/C)*(P-C/2<0?-1:1),V=Math.max(A,Math.floor(T-P*j/C+G)),Y=Math.min(O,Math.floor(T+(C-P)*j/C+G));n(S,T,V,Y,N)}var $=S[T],z=A,Z=O;for(i(S,A,T),N(S[O],$)>0&&i(S,A,O);z<Z;){for(i(S,z,Z),z++,Z--;N(S[z],$)<0;)z++;for(;N(S[Z],$)>0;)Z--}N(S[A],$)===0?i(S,A,Z):(Z++,i(S,Z,O)),Z<=T&&(A=Z+1),T<=Z&&(O=Z-1)}}function i(S,T,A){var O=S[T];S[T]=S[A],S[A]=O}function a(S,T){return S<T?-1:S>T?1:0}var s=function(T){T===void 0&&(T=9),this._maxEntries=Math.max(4,T),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()};s.prototype.all=function(){return this._all(this.data,[])},s.prototype.search=function(T){var A=this.data,O=[];if(!m(T,A))return O;for(var N=this.toBBox,C=[];A;){for(var P=0;P<A.children.length;P++){var D=A.children[P],j=A.leaf?N(D):D;m(T,j)&&(A.leaf?O.push(D):y(T,j)?this._all(D,O):C.push(D))}A=C.pop()}return O},s.prototype.collides=function(T){var A=this.data;if(!m(T,A))return!1;for(var O=[];A;){for(var N=0;N<A.children.length;N++){var C=A.children[N],P=A.leaf?this.toBBox(C):C;if(m(T,P)){if(A.leaf||y(T,P))return!0;O.push(C)}}A=O.pop()}return!1},s.prototype.load=function(T){if(!(T&&T.length))return this;if(T.length<this._minEntries){for(var A=0;A<T.length;A++)this.insert(T[A]);return this}var O=this._build(T.slice(),0,T.length-1,0);if(!this.data.children.length)this.data=O;else if(this.data.height===O.height)this._splitRoot(this.data,O);else{if(this.data.height<O.height){var N=this.data;this.data=O,O=N}this._insert(O,this.data.height-O.height-1,!0)}return this},s.prototype.insert=function(T){return T&&this._insert(T,this.data.height-1),this},s.prototype.clear=function(){return this.data=w([]),this},s.prototype.remove=function(T,A){if(!T)return this;for(var O=this.data,N=this.toBBox(T),C=[],P=[],D,j,G;O||C.length;){if(O||(O=C.pop(),j=C[C.length-1],D=P.pop(),G=!0),O.leaf){var V=o(T,O.children,A);if(V!==-1)return O.children.splice(V,1),C.push(O),this._condense(C),this}!G&&!O.leaf&&y(O,N)?(C.push(O),P.push(D),D=0,j=O,O=O.children[0]):j?(D++,O=j.children[D],G=!1):O=null}return this},s.prototype.toBBox=function(T){return T},s.prototype.compareMinX=function(T,A){return T.minX-A.minX},s.prototype.compareMinY=function(T,A){return T.minY-A.minY},s.prototype.toJSON=function(){return this.data},s.prototype.fromJSON=function(T){return this.data=T,this},s.prototype._all=function(T,A){for(var O=[];T;)T.leaf?A.push.apply(A,T.children):O.push.apply(O,T.children),T=O.pop();return A},s.prototype._build=function(T,A,O,N){var C=O-A+1,P=this._maxEntries,D;if(C<=P)return D=w(T.slice(A,O+1)),u(D,this.toBBox),D;N||(N=Math.ceil(Math.log(C)/Math.log(P)),P=Math.ceil(C/Math.pow(P,N-1))),D=w([]),D.leaf=!1,D.height=N;var j=Math.ceil(C/P),G=j*Math.ceil(Math.sqrt(P));M(T,A,O,G,this.compareMinX);for(var V=A;V<=O;V+=G){var Y=Math.min(V+G-1,O);M(T,V,Y,j,this.compareMinY);for(var $=V;$<=Y;$+=j){var z=Math.min($+j-1,Y);D.children.push(this._build(T,$,z,N-1))}}return u(D,this.toBBox),D},s.prototype._chooseSubtree=function(T,A,O,N){for(;N.push(A),!(A.leaf||N.length-1===O);){for(var C=1/0,P=1/0,D=void 0,j=0;j<A.children.length;j++){var G=A.children[j],V=f(G),Y=v(T,G)-V;Y<P?(P=Y,C=V<C?V:C,D=G):Y===P&&V<C&&(C=V,D=G)}A=D||A.children[0]}return A},s.prototype._insert=function(T,A,O){var N=O?T:this.toBBox(T),C=[],P=this._chooseSubtree(N,this.data,A,C);for(P.children.push(T),c(P,N);A>=0&&C[A].children.length>this._maxEntries;)this._split(C,A),A--;this._adjustParentBBoxes(N,C,A)},s.prototype._split=function(T,A){var O=T[A],N=O.children.length,C=this._minEntries;this._chooseSplitAxis(O,C,N);var P=this._chooseSplitIndex(O,C,N),D=w(O.children.splice(P,O.children.length-P));D.height=O.height,D.leaf=O.leaf,u(O,this.toBBox),u(D,this.toBBox),A?T[A-1].children.push(D):this._splitRoot(O,D)},s.prototype._splitRoot=function(T,A){this.data=w([T,A]),this.data.height=T.height+1,this.data.leaf=!1,u(this.data,this.toBBox)},s.prototype._chooseSplitIndex=function(T,A,O){for(var N,C=1/0,P=1/0,D=A;D<=O-A;D++){var j=l(T,0,D,this.toBBox),G=l(T,D,O,this.toBBox),V=p(j,G),Y=f(j)+f(G);V<C?(C=V,N=D,P=Y<P?Y:P):V===C&&Y<P&&(P=Y,N=D)}return N||O-A},s.prototype._chooseSplitAxis=function(T,A,O){var N=T.leaf?this.compareMinX:d,C=T.leaf?this.compareMinY:h,P=this._allDistMargin(T,A,O,N),D=this._allDistMargin(T,A,O,C);P<D&&T.children.sort(N)},s.prototype._allDistMargin=function(T,A,O,N){T.children.sort(N);for(var C=this.toBBox,P=l(T,0,A,C),D=l(T,O-A,O,C),j=g(P)+g(D),G=A;G<O-A;G++){var V=T.children[G];c(P,T.leaf?C(V):V),j+=g(P)}for(var Y=O-A-1;Y>=A;Y--){var $=T.children[Y];c(D,T.leaf?C($):$),j+=g(D)}return j},s.prototype._adjustParentBBoxes=function(T,A,O){for(var N=O;N>=0;N--)c(A[N],T)},s.prototype._condense=function(T){for(var A=T.length-1,O=void 0;A>=0;A--)T[A].children.length===0?A>0?(O=T[A-1].children,O.splice(O.indexOf(T[A]),1)):this.clear():u(T[A],this.toBBox)};function o(S,T,A){if(!A)return T.indexOf(S);for(var O=0;O<T.length;O++)if(A(S,T[O]))return O;return-1}function u(S,T){l(S,0,S.children.length,T,S)}function l(S,T,A,O,N){N||(N=w(null)),N.minX=1/0,N.minY=1/0,N.maxX=-1/0,N.maxY=-1/0;for(var C=T;C<A;C++){var P=S.children[C];c(N,S.leaf?O(P):P)}return N}function c(S,T){return S.minX=Math.min(S.minX,T.minX),S.minY=Math.min(S.minY,T.minY),S.maxX=Math.max(S.maxX,T.maxX),S.maxY=Math.max(S.maxY,T.maxY),S}function d(S,T){return S.minX-T.minX}function h(S,T){return S.minY-T.minY}function f(S){return(S.maxX-S.minX)*(S.maxY-S.minY)}function g(S){return S.maxX-S.minX+(S.maxY-S.minY)}function v(S,T){return(Math.max(T.maxX,S.maxX)-Math.min(T.minX,S.minX))*(Math.max(T.maxY,S.maxY)-Math.min(T.minY,S.minY))}function p(S,T){var A=Math.max(S.minX,T.minX),O=Math.max(S.minY,T.minY),N=Math.min(S.maxX,T.maxX),C=Math.min(S.maxY,T.maxY);return Math.max(0,N-A)*Math.max(0,C-O)}function y(S,T){return S.minX<=T.minX&&S.minY<=T.minY&&T.maxX<=S.maxX&&T.maxY<=S.maxY}function m(S,T){return T.minX<=S.maxX&&T.minY<=S.maxY&&T.maxX>=S.minX&&T.maxY>=S.minY}function w(S){return{children:S,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function M(S,T,A,O,N){for(var C=[T,A];C.length;)if(A=C.pop(),T=C.pop(),!(A-T<=O)){var P=T+Math.ceil((A-T)/O/2)*O;t(S,P,T,A,N),C.push(T,P,P,A)}}return s})})(GT);var rD=GT.exports,re=function(r){return r.GROUP="g",r.FRAGMENT="fragment",r.CIRCLE="circle",r.ELLIPSE="ellipse",r.IMAGE="image",r.RECT="rect",r.LINE="line",r.POLYLINE="polyline",r.POLYGON="polygon",r.TEXT="text",r.PATH="path",r.HTML="html",r.MESH="mesh",r}({}),Nl=function(r){return r[r.ZERO=0]="ZERO",r[r.NEGATIVE_ONE=1]="NEGATIVE_ONE",r}({}),ga=function(){function r(){ce(this,r),this.plugins=[]}return de(r,[{key:"addRenderingPlugin",value:function(t){this.plugins.push(t),this.context.renderingPlugins.push(t)}},{key:"removeAllRenderingPlugins",value:function(){var t=this;this.plugins.forEach(function(n){var i=t.context.renderingPlugins.indexOf(n);i>=0&&t.context.renderingPlugins.splice(i,1)})}}])}(),iD=function(){function r(e){ce(this,r),this.clipSpaceNearZ=Nl.NEGATIVE_ONE,this.plugins=[],this.config=qe({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0,enableRenderingOptimization:!1},e)}return de(r,[{key:"registerPlugin",value:function(t){var n=this.plugins.findIndex(function(i){return i===t});n===-1&&this.plugins.push(t)}},{key:"unregisterPlugin",value:function(t){var n=this.plugins.findIndex(function(i){return i===t});n>-1&&this.plugins.splice(n,1)}},{key:"getPlugins",value:function(){return this.plugins}},{key:"getPlugin",value:function(t){return this.plugins.find(function(n){return n.name===t})}},{key:"getConfig",value:function(){return this.config}},{key:"setConfig",value:function(t){Object.assign(this.config,t)}}])}(),dh=ra,ds=ri,aD=hL,sD=dL,tb=$l,hh=vL,ft=function(){function r(){ce(this,r),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return de(r,[{key:"update",value:function(t,n){ds(this.center,t),ds(this.halfExtents,n),hh(this.min,this.center,this.halfExtents),dh(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(t,n){dh(this.center,n,t),tb(this.center,this.center,.5),hh(this.halfExtents,n,t),tb(this.halfExtents,this.halfExtents,.5),ds(this.min,t),ds(this.max,n)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(t){if(!r.isEmpty(t)){if(r.isEmpty(this)){this.setMinMax(t.getMin(),t.getMax());return}var n=this.center,i=n[0],a=n[1],s=n[2],o=this.halfExtents,u=o[0],l=o[1],c=o[2],d=i-u,h=i+u,f=a-l,g=a+l,v=s-c,p=s+c,y=t.center,m=y[0],w=y[1],M=y[2],S=t.halfExtents,T=S[0],A=S[1],O=S[2],N=m-T,C=m+T,P=w-A,D=w+A,j=M-O,G=M+O;N<d&&(d=N),C>h&&(h=C),P<f&&(f=P),D>g&&(g=D),j<v&&(v=j),G>p&&(p=G),n[0]=(d+h)*.5,n[1]=(f+g)*.5,n[2]=(v+p)*.5,o[0]=(h-d)*.5,o[1]=(g-f)*.5,o[2]=(p-v)*.5,this.min[0]=d,this.min[1]=f,this.min[2]=v,this.max[0]=h,this.max[1]=g,this.max[2]=p}}},{key:"setFromTransformedAABB",value:function(t,n){var i=this.center,a=this.halfExtents,s=t.center,o=t.halfExtents,u=n[0],l=n[4],c=n[8],d=n[1],h=n[5],f=n[9],g=n[2],v=n[6],p=n[10],y=Math.abs(u),m=Math.abs(l),w=Math.abs(c),M=Math.abs(d),S=Math.abs(h),T=Math.abs(f),A=Math.abs(g),O=Math.abs(v),N=Math.abs(p);i[0]=n[12]+u*s[0]+l*s[1]+c*s[2],i[1]=n[13]+d*s[0]+h*s[1]+f*s[2],i[2]=n[14]+g*s[0]+v*s[1]+p*s[2],a[0]=y*o[0]+m*o[1]+w*o[2],a[1]=M*o[0]+S*o[1]+T*o[2],a[2]=A*o[0]+O*o[1]+N*o[2],hh(this.min,i,a),dh(this.max,i,a)}},{key:"intersects",value:function(t){var n=this.getMax(),i=this.getMin(),a=t.getMax(),s=t.getMin();return i[0]<=a[0]&&n[0]>=s[0]&&i[1]<=a[1]&&n[1]>=s[1]&&i[2]<=a[2]&&n[2]>=s[2]}},{key:"intersection",value:function(t){if(!this.intersects(t))return null;var n=new r,i=aD([0,0,0],this.getMin(),t.getMin()),a=sD([0,0,0],this.getMax(),t.getMax());return n.setMinMax(i,a),n}},{key:"getNegativeFarPoint",value:function(t){return t.pnVertexFlag===273?ds([0,0,0],this.min):t.pnVertexFlag===272?[this.min[0],this.min[1],this.max[2]]:t.pnVertexFlag===257?[this.min[0],this.max[1],this.min[2]]:t.pnVertexFlag===256?[this.min[0],this.max[1],this.max[2]]:t.pnVertexFlag===17?[this.max[0],this.min[1],this.min[2]]:t.pnVertexFlag===16?[this.max[0],this.min[1],this.max[2]]:t.pnVertexFlag===1?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]}},{key:"getPositiveFarPoint",value:function(t){return t.pnVertexFlag===273?ds([0,0,0],this.max):t.pnVertexFlag===272?[this.max[0],this.max[1],this.min[2]]:t.pnVertexFlag===257?[this.max[0],this.min[1],this.max[2]]:t.pnVertexFlag===256?[this.max[0],this.min[1],this.min[2]]:t.pnVertexFlag===17?[this.min[0],this.max[1],this.max[2]]:t.pnVertexFlag===16?[this.min[0],this.max[1],this.min[2]]:t.pnVertexFlag===1?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]}}],[{key:"isEmpty",value:function(t){return!t||t.halfExtents[0]===0&&t.halfExtents[1]===0&&t.halfExtents[2]===0}}])}(),oD=function(){function r(e,t){ce(this,r),this.distance=e||0,this.normal=t||vt(0,1,0),this.updatePNVertexFlag()}return de(r,[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(+(this.normal[0]>=0)<<8)+(+(this.normal[1]>=0)<<4)+ +(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(t){return ii(t,this.normal)-this.distance}},{key:"normalize",value:function(){var t=1/ET(this.normal);$l(this.normal,this.normal,t),this.distance*=t}},{key:"intersectsLine",value:function(t,n,i){var a=this.distanceToPoint(t),s=this.distanceToPoint(n),o=a/(a-s),u=o>=0&&o<=1;return u&&i&&U0(i,t,n,o),u}}])}(),hs=function(r){return r[r.OUTSIDE=4294967295]="OUTSIDE",r[r.INSIDE=0]="INSIDE",r[r.INDETERMINATE=2147483647]="INDETERMINATE",r}({}),uD=function(){function r(e){if(ce(this,r),this.planes=[],e)this.planes=e;else for(var t=0;t<6;t++)this.planes.push(new oD)}return de(r,[{key:"extractFromVPMatrix",value:function(t){var n=ze(t,16),i=n[0],a=n[1],s=n[2],o=n[3],u=n[4],l=n[5],c=n[6],d=n[7],h=n[8],f=n[9],g=n[10],v=n[11],p=n[12],y=n[13],m=n[14],w=n[15];Ln(this.planes[0].normal,o-i,d-u,v-h),this.planes[0].distance=w-p,Ln(this.planes[1].normal,o+i,d+u,v+h),this.planes[1].distance=w+p,Ln(this.planes[2].normal,o+a,d+l,v+f),this.planes[2].distance=w+y,Ln(this.planes[3].normal,o-a,d-l,v-f),this.planes[3].distance=w-y,Ln(this.planes[4].normal,o-s,d-c,v-g),this.planes[4].distance=w-m,Ln(this.planes[5].normal,o+s,d+c,v+g),this.planes[5].distance=w+m,this.planes.forEach(function(M){M.normalize(),M.updatePNVertexFlag()})}}])}(),xn=function(){function r(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;ce(this,r),this.x=0,this.y=0,this.x=e,this.y=t}return de(r,[{key:"clone",value:function(){return new r(this.x,this.y)}},{key:"copyFrom",value:function(t){this.x=t.x,this.y=t.y}}])}(),Bs=function(){function r(e,t,n,i){ce(this,r),this.x=e,this.y=t,this.width=n,this.height=i,this.left=e,this.right=e+n,this.top=t,this.bottom=t+i}return de(r,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(t){return new r(t.x,t.y,t.width,t.height)}},{key:"applyTransform",value:function(t,n){var i=go(t.x,t.y,0,1),a=go(t.x+t.width,t.y,0,1),s=go(t.x,t.y+t.height,0,1),o=go(t.x+t.width,t.y+t.height,0,1),u=ai(),l=ai(),c=ai(),d=ai();Si(u,i,n),Si(l,a,n),Si(c,s,n),Si(d,o,n);var h=Math.min(u[0],l[0],c[0],d[0]),f=Math.min(u[1],l[1],c[1],d[1]),g=Math.max(u[0],l[0],c[0],d[0]),v=Math.max(u[1],l[1],c[1],d[1]);return r.fromRect({x:h,y:f,width:g-h,height:v-f})}}])}(),it="Method not implemented.",fs="Use document.documentElement instead.",lD="Cannot append a destroyed element.";function Ns(r){return r===void 0?0:r>360||r<-360?r%360:r}var fh=Ze();function jn(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return Array.isArray(r)&&r.length===3?n?yi(r):ri(fh,r):Ee(r)?n?vt(r,e,t):Ln(fh,r,e,t):n?vt(r[0],r[1]||e,r[2]||t):Ln(fh,r[0],r[1]||e,r[2]||t)}var cD=Math.PI/180;function at(r){return r*cD}var dD=180/Math.PI;function Zn(r){return r*dD}function hD(r){return 360*r}var Kl=Math.PI/2;function fD(r,e){var t=e[0],n=e[1],i=e[2],a=e[3],s=t*t,o=n*n,u=i*i,l=a*a,c=s+o+u+l,d=t*a-n*i;return d>.499995*c?(r[0]=Kl,r[1]=2*Math.atan2(n,t),r[2]=0):d<-.499995*c?(r[0]=-Kl,r[1]=2*Math.atan2(n,t),r[2]=0):(r[0]=Math.asin(2*(t*i-a*n)),r[1]=Math.atan2(2*(t*a+n*i),1-2*(u+l)),r[2]=Math.atan2(2*(t*n+i*a),1-2*(o+u))),r}function gD(r,e){var t,n,i=Rs(Ze(),e),a=ze(i,3),s=a[0],o=a[1],u=a[2],l=Math.asin(-e[2]/s);return l<Kl?l>-Kl?(t=Math.atan2(e[6]/o,e[10]/u),n=Math.atan2(e[1]/s,e[0]/s)):(n=0,t=-Math.atan2(e[4]/o,e[5]/o)):(n=0,t=Math.atan2(e[4]/o,e[5]/o)),r[0]=t,r[1]=l,r[2]=n,r}function gh(r,e){return e.length===16?gD(r,e):fD(r,e)}function pD(r,e,t,n,i){var a=Math.cos(r),s=Math.sin(r);return VP(n*a,i*s,0,-n*s,i*a,0,e,t,1)}function vD(r,e,t,n,i,a,s){var o=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,u=2*a,l=t-e,c=n-i,d=u/l,h=u/c,f=(t+e)/l,g=(n+i)/c,v,p,y=s-a,m=s*a;return o?(v=-s/y,p=-m/y):(v=-(s+a)/y,p=-2*m/y),r[0]=d,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=h,r[6]=0,r[7]=0,r[8]=f,r[9]=g,r[10]=v,r[11]=-1,r[12]=0,r[13]=0,r[14]=p,r[15]=0,r}function nb(r){var e=r[0],t=r[1],n=r[3],i=r[4],a=Math.sqrt(e*e+t*t),s=Math.sqrt(n*n+i*i),o=e*i-t*n;if(o<0&&(e<i?a=-a:s=-s),a){var u=1/a;e*=u,t*=u}if(s){var l=1/s;n*=l,i*=l}var c=Math.atan2(t,e),d=Zn(c);return[r[6],r[7],a,s,d]}var Zr=ht(),Lr=ht(),to=ai(),Ie=[Ze(),Ze(),Ze()],rb=Ze();function yD(r,e,t,n,i,a){if(!mD(Zr,r)||(Is(Lr,Zr),Lr[3]=0,Lr[7]=0,Lr[11]=0,Lr[15]=1,Math.abs(oT(Lr))<1e-8))return!1;var s=Zr[3],o=Zr[7],u=Zr[11],l=Zr[12],c=Zr[13],d=Zr[14],h=Zr[15];if(s!==0||o!==0||u!==0){to[0]=s,to[1]=o,to[2]=u,to[3]=h;var f=ni(Lr,Lr);if(!f)return!1;sT(Lr,Lr),Si(i,to,Lr)}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=l,e[1]=c,e[2]=d,bD(Ie,Zr),t[0]=bi(Ie[0]),Ra(Ie[0],Ie[0]),n[0]=ii(Ie[0],Ie[1]),ph(Ie[1],Ie[1],Ie[0],1,-n[0]),t[1]=bi(Ie[1]),Ra(Ie[1],Ie[1]),n[0]/=t[1],n[1]=ii(Ie[0],Ie[2]),ph(Ie[2],Ie[2],Ie[0],1,-n[1]),n[2]=ii(Ie[1],Ie[2]),ph(Ie[2],Ie[2],Ie[1],1,-n[2]),t[2]=bi(Ie[2]),Ra(Ie[2],Ie[2]),n[1]/=t[2],n[2]/=t[2],Al(rb,Ie[1],Ie[2]),ii(Ie[0],rb)<0)for(var g=0;g<3;g++)t[g]*=-1,Ie[g][0]*=-1,Ie[g][1]*=-1,Ie[g][2]*=-1;return a[0]=.5*Math.sqrt(Math.max(1+Ie[0][0]-Ie[1][1]-Ie[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-Ie[0][0]+Ie[1][1]-Ie[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-Ie[0][0]-Ie[1][1]+Ie[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+Ie[0][0]+Ie[1][1]+Ie[2][2],0)),Ie[2][1]>Ie[1][2]&&(a[0]=-a[0]),Ie[0][2]>Ie[2][0]&&(a[1]=-a[1]),Ie[1][0]>Ie[0][1]&&(a[2]=-a[2]),!0}function mD(r,e){var t=e[15];if(t===0)return!1;for(var n=1/t,i=0;i<16;i++)r[i]=e[i]*n;return!0}function bD(r,e){r[0][0]=e[0],r[0][1]=e[1],r[0][2]=e[2],r[1][0]=e[4],r[1][1]=e[5],r[1][2]=e[6],r[2][0]=e[8],r[2][1]=e[9],r[2][2]=e[10]}function ph(r,e,t,n,i){r[0]=e[0]*n+t[0]*i,r[1]=e[1]*n+t[1]*i,r[2]=e[2]*n+t[2]*i}var rt=function(r){return r[r.ORBITING=0]="ORBITING",r[r.EXPLORING=1]="EXPLORING",r[r.TRACKING=2]="TRACKING",r}({}),ry=function(r){return r[r.DEFAULT=0]="DEFAULT",r[r.ROTATIONAL=1]="ROTATIONAL",r[r.TRANSLATIONAL=2]="TRANSLATIONAL",r[r.CINEMATIC=3]="CINEMATIC",r}({}),Sr=function(r){return r[r.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",r[r.PERSPECTIVE=1]="PERSPECTIVE",r}({}),WT={UPDATED:"updated"},ib=2e-4,VT=function(){function r(){ce(this,r),this.clipSpaceNearZ=Nl.NEGATIVE_ONE,this.eventEmitter=new nT,this.matrix=ht(),this.right=vt(1,0,0),this.up=vt(0,1,0),this.forward=vt(0,0,1),this.position=vt(0,0,1),this.focalPoint=vt(0,0,0),this.distanceVector=vt(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=ht(),this.projectionMatrixInverse=ht(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=rt.EXPLORING,this.trackingMode=ry.DEFAULT,this.projectionMode=Sr.PERSPECTIVE,this.frustum=new uD,this.orthoMatrix=ht()}return de(r,[{key:"isOrtho",value:function(){return this.projectionMode===Sr.ORTHOGRAPHIC}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getDollyingStep",value:function(){return this.dollyingStep}},{key:"getNear",value:function(){return this.near}},{key:"getFar",value:function(){return this.far}},{key:"getZoom",value:function(){return this.zoom}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix}},{key:"getView",value:function(){return this.view}},{key:"setEnableUpdate",value:function(t){this.enableUpdate=t}},{key:"setType",value:function(t,n){return this.type=t,this.type===rt.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===rt.TRACKING&&n!==void 0&&this.setTrackingMode(n),this}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this}},{key:"setTrackingMode",value:function(t){if(this.type!==rt.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this}},{key:"setWorldRotation",value:function(t){return this.rotateWorld=t,this._getAngles(),this}},{key:"getViewTransform",value:function(){return ni(ht(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"jitterProjectionMatrix",value:function(t,n){var i=Ui(ht(),[t,n,0]);this.jitteredProjectionMatrix=Dn(ht(),i,this.projectionMatrix)}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this}},{key:"setProjectionMatrix",value:function(t){this.projectionMatrix=t}},{key:"setFov",value:function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this}},{key:"setNear",value:function(t){return this.projectionMode===Sr.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this}},{key:"setFar",value:function(t){return this.projectionMode===Sr.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this}},{key:"setViewOffset",value:function(t,n,i,a,s,o){return this.aspect=t/n,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=a,this.view.width=s,this.view.height=o,this.projectionMode===Sr.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===Sr.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setZoom",value:function(t){return this.zoom=t,this.projectionMode===Sr.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===Sr.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this}},{key:"setZoomByViewportPoint",value:function(t,n){var i=this.canvas.viewport2Canvas({x:n[0],y:n[1]}),a=i.x,s=i.y,o=this.roll;this.rotate(0,0,-o),this.setPosition(a,s),this.setFocalPoint(a,s),this.setZoom(t),this.rotate(0,0,o);var u=this.canvas.viewport2Canvas({x:n[0],y:n[1]}),l=u.x,c=u.y,d=vt(l-a,c-s,0),h=ii(d,this.right)/bi(this.right),f=ii(d,this.up)/bi(this.up),g=this.getPosition(),v=ze(g,2),p=v[0],y=v[1],m=this.getFocalPoint(),w=ze(m,2),M=w[0],S=w[1];return this.setPosition(p-h,y-f),this.setFocalPoint(M-h,S-f),this}},{key:"setPerspective",value:function(t,n,i,a){var s;this.projectionMode=Sr.PERSPECTIVE,this.fov=i,this.near=t,this.far=n,this.aspect=a;var o=this.near*Math.tan(at(.5*this.fov))/this.zoom,u=2*o,l=this.aspect*u,c=-.5*l;if((s=this.view)!==null&&s!==void 0&&s.enabled){var d=this.view.fullWidth,h=this.view.fullHeight;c+=this.view.offsetX*l/d,o-=this.view.offsetY*u/h,l*=this.view.width/d,u*=this.view.height/h}return vD(this.projectionMatrix,c,c+l,o-u,o,t,this.far,this.clipSpaceNearZ===Nl.ZERO),ni(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this}},{key:"setOrthographic",value:function(t,n,i,a,s,o){var u;this.projectionMode=Sr.ORTHOGRAPHIC,this.rright=n,this.left=t,this.top=i,this.bottom=a,this.near=s,this.far=o;var l=(this.rright-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),d=(this.rright+this.left)/2,h=(this.top+this.bottom)/2,f=d-l,g=d+l,v=h+c,p=h-c;if((u=this.view)!==null&&u!==void 0&&u.enabled){var y=(this.rright-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;f+=y*this.view.offsetX,g=f+y*this.view.width,v-=m*this.view.offsetY,p=v-m*this.view.height}return this.clipSpaceNearZ===Nl.NEGATIVE_ONE?yT(this.projectionMatrix,f,g,v,p,s,o):mT(this.projectionMatrix,f,g,v,p,s,o),ni(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this}},{key:"setPosition",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.position[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.position[2],a=jn(t,n,i);return this._setPosition(a),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this}},{key:"setFocalPoint",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.focalPoint[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.focalPoint[2],a=vt(0,1,0);if(this.focalPoint=jn(t,n,i),this.trackingMode===ry.CINEMATIC){var s=Y0(Ze(),this.focalPoint,this.position);t=s[0],n=s[1],i=s[2];var o=bi(s),u=Zn(Math.asin(n/o)),l=90+Zn(Math.atan2(i,t)),c=ht();cT(c,c,at(l)),lT(c,c,at(u)),a=In(Ze(),[0,1,0],c)}return ni(this.matrix,bT(ht(),this.position,this.focalPoint,a)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this}},{key:"getDistance",value:function(){return this.distance}},{key:"getDistanceVector",value:function(){return this.distanceVector}},{key:"setDistance",value:function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<ib&&(this.distance=ib),this.dollyingStep=this.distance/100;var n=Ze();t=this.distance;var i=this.forward,a=this.focalPoint;return n[0]=t*i[0]+a[0],n[1]=t*i[1]+a[1],n[2]=t*i[2]+a[2],this._setPosition(n),this.triggerUpdate(),this}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this}},{key:"setAzimuth",value:function(t){return this.azimuth=Ns(t),this.computeMatrix(),this._getAxes(),this.type===rt.ORBITING||this.type===rt.EXPLORING?this._getPosition():this.type===rt.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(t){return this.elevation=Ns(t),this.computeMatrix(),this._getAxes(),this.type===rt.ORBITING||this.type===rt.EXPLORING?this._getPosition():this.type===rt.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getElevation",value:function(){return this.elevation}},{key:"setRoll",value:function(t){return this.roll=Ns(t),this.computeMatrix(),this._getAxes(),this.type===rt.ORBITING||this.type===rt.EXPLORING?this._getPosition():this.type===rt.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getRoll",value:function(){return this.roll}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()}},{key:"computeMatrix",value:function(){var t=Xi(an(),[0,0,1],at(this.roll));ua(this.matrix);var n=Xi(an(),[1,0,0],at((this.rotateWorld&&this.type!==rt.TRACKING||this.type===rt.TRACKING?1:-1)*this.elevation)),i=Xi(an(),[0,1,0],at((this.rotateWorld&&this.type!==rt.TRACKING||this.type===rt.TRACKING?1:-1)*this.azimuth)),a=ia(an(),i,n);a=ia(an(),a,t);var s=am(ht(),a);this.type===rt.ORBITING||this.type===rt.EXPLORING?(As(this.matrix,this.matrix,this.focalPoint),Dn(this.matrix,this.matrix,s),As(this.matrix,this.matrix,[0,0,this.distance])):this.type===rt.TRACKING&&(As(this.matrix,this.matrix,this.position),Dn(this.matrix,this.matrix,s))}},{key:"_setPosition",value:function(t,n,i){this.position=jn(t,n,i);var a=this.matrix;a[12]=this.position[0],a[13]=this.position[1],a[14]=this.position[2],a[15]=1,this._getOrthoMatrix()}},{key:"_getAxes",value:function(){ri(this.right,jn(Si(ai(),[1,0,0,0],this.matrix))),ri(this.up,jn(Si(ai(),[0,1,0,0],this.matrix))),ri(this.forward,jn(Si(ai(),[0,0,1,0],this.matrix))),Ra(this.right,this.right),Ra(this.up,this.up),Ra(this.forward,this.forward)}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],n=this.distanceVector[1],i=this.distanceVector[2],a=bi(this.distanceVector);if(a===0){this.elevation=0,this.azimuth=0;return}this.type===rt.TRACKING?(this.elevation=Zn(Math.asin(n/a)),this.azimuth=Zn(Math.atan2(-t,-i))):this.rotateWorld?(this.elevation=Zn(Math.asin(n/a)),this.azimuth=Zn(Math.atan2(-t,-i))):(this.elevation=-Zn(Math.asin(n/a)),this.azimuth=-Zn(Math.atan2(-t,-i)))}},{key:"_getPosition",value:function(){ri(this.position,jn(Si(ai(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){gL(this.distanceVector,[0,0,-this.distance],WP(rT(),this.matrix)),ra(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=Y0(Ze(),this.focalPoint,this.position),this.distance=bi(this.distanceVector),this.dollyingStep=this.distance/100}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===Sr.ORTHOGRAPHIC){var t=this.position,n=Xi(an(),[0,0,1],-this.roll*Math.PI/180);Oo(this.orthoMatrix,n,vt((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),vt(this.zoom,this.zoom,1),t)}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var t=this.getViewTransform(),n=Dn(ht(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(n),this.eventEmitter.emit(WT.UPDATED)}}},{key:"rotate",value:function(t,n,i){throw new Error(it)}},{key:"pan",value:function(t,n){throw new Error(it)}},{key:"dolly",value:function(t){throw new Error(it)}},{key:"createLandmark",value:function(t,n){throw new Error(it)}},{key:"gotoLandmark",value:function(t,n){throw new Error(it)}},{key:"cancelLandmarkAnimation",value:function(){throw new Error(it)}}])}(),wD=function(r){return r[r.Standard=0]="Standard",r}({}),Zl=function(r){return r[r.ADDED=0]="ADDED",r[r.REMOVED=1]="REMOVED",r[r.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",r}({}),YT={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Bs(0,0,0,0)},be=function(r){return r.COORDINATE="<coordinate>",r.COLOR="<color>",r.PAINT="<paint>",r.NUMBER="<number>",r.ANGLE="<angle>",r.OPACITY_VALUE="<opacity-value>",r.SHADOW_BLUR="<shadow-blur>",r.LENGTH="<length>",r.PERCENTAGE="<percentage>",r.LENGTH_PERCENTAGE="<length> | <percentage>",r.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",r.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",r.LIST_OF_POINTS="<list-of-points>",r.PATH="<path>",r.FILTER="<filter>",r.Z_INDEX="<z-index>",r.OFFSET_DISTANCE="<offset-distance>",r.DEFINED_PATH="<defined-path>",r.MARKER="<marker>",r.TRANSFORM="<transform>",r.TRANSFORM_ORIGIN="<transform-origin>",r.TEXT="<text>",r.TEXT_TRANSFORM="<text-transform>",r}({});function tn(r,e){if(typeof r!="function"||e!=null&&typeof e!="function")throw new TypeError("Expected a function");var t=function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];var o=e?e.apply(this,a):a[0],u=t.cache;if(u.has(o))return u.get(o);var l=r.apply(this,a);return t.cache=u.set(o,l)||u,l};return t.cache=new(tn.Cache||Map),tn.cacheList.push(t.cache),t}tn.Cache=Map;tn.cacheList=[];tn.clearCache=function(){tn.cacheList.forEach(function(r){return r.clear()})};var we=function(r){return r[r.kUnknown=0]="kUnknown",r[r.kNumber=1]="kNumber",r[r.kPercentage=2]="kPercentage",r[r.kEms=3]="kEms",r[r.kPixels=4]="kPixels",r[r.kRems=5]="kRems",r[r.kDegrees=6]="kDegrees",r[r.kRadians=7]="kRadians",r[r.kGradians=8]="kGradians",r[r.kTurns=9]="kTurns",r[r.kMilliseconds=10]="kMilliseconds",r[r.kSeconds=11]="kSeconds",r[r.kInteger=12]="kInteger",r}({}),Rr=function(r){return r[r.kUNumber=0]="kUNumber",r[r.kUPercent=1]="kUPercent",r[r.kULength=2]="kULength",r[r.kUAngle=3]="kUAngle",r[r.kUTime=4]="kUTime",r[r.kUOther=5]="kUOther",r}({}),xD=function(r){return r[r.kYes=0]="kYes",r[r.kNo=1]="kNo",r}({}),ED=function(r){return r[r.kYes=0]="kYes",r[r.kNo=1]="kNo",r}({}),MD=[{name:"em",unit_type:we.kEms},{name:"px",unit_type:we.kPixels},{name:"deg",unit_type:we.kDegrees},{name:"rad",unit_type:we.kRadians},{name:"grad",unit_type:we.kGradians},{name:"ms",unit_type:we.kMilliseconds},{name:"s",unit_type:we.kSeconds},{name:"rem",unit_type:we.kRems},{name:"turn",unit_type:we.kTurns}],Fs=function(r){return r[r.kUnknownType=0]="kUnknownType",r[r.kUnparsedType=1]="kUnparsedType",r[r.kKeywordType=2]="kKeywordType",r[r.kUnitType=3]="kUnitType",r[r.kSumType=4]="kSumType",r[r.kProductType=5]="kProductType",r[r.kNegateType=6]="kNegateType",r[r.kInvertType=7]="kInvertType",r[r.kMinType=8]="kMinType",r[r.kMaxType=9]="kMaxType",r[r.kClampType=10]="kClampType",r[r.kTransformType=11]="kTransformType",r[r.kPositionType=12]="kPositionType",r[r.kURLImageType=13]="kURLImageType",r[r.kColorType=14]="kColorType",r[r.kUnsupportedColorType=15]="kUnsupportedColorType",r}({}),SD=function(e){return MD.find(function(t){return t.name===e}).unit_type},_D=function(e){return e?e==="number"?we.kNumber:e==="percent"||e==="%"?we.kPercentage:SD(e):we.kUnknown},TD=function(e){switch(e){case we.kNumber:case we.kInteger:return Rr.kUNumber;case we.kPercentage:return Rr.kUPercent;case we.kPixels:return Rr.kULength;case we.kMilliseconds:case we.kSeconds:return Rr.kUTime;case we.kDegrees:case we.kRadians:case we.kGradians:case we.kTurns:return Rr.kUAngle;default:return Rr.kUOther}},OD=function(e){switch(e){case Rr.kUNumber:return we.kNumber;case Rr.kULength:return we.kPixels;case Rr.kUPercent:return we.kPercentage;case Rr.kUTime:return we.kSeconds;case Rr.kUAngle:return we.kDegrees;default:return we.kUnknown}},ab=function(e){var t=1;switch(e){case we.kPixels:case we.kDegrees:case we.kSeconds:break;case we.kMilliseconds:t=.001;break;case we.kRadians:t=180/Math.PI;break;case we.kGradians:t=.9;break;case we.kTurns:t=360;break}return t},iy=function(e){switch(e){case we.kNumber:case we.kInteger:return"";case we.kPercentage:return"%";case we.kEms:return"em";case we.kRems:return"rem";case we.kPixels:return"px";case we.kDegrees:return"deg";case we.kRadians:return"rad";case we.kGradians:return"grad";case we.kMilliseconds:return"ms";case we.kSeconds:return"s";case we.kTurns:return"turn"}return""},Oc=function(){function r(){ce(this,r)}return de(r,[{key:"toString",value:function(){return this.buildCSSText(xD.kNo,ED.kNo,"")}},{key:"isNumericValue",value:function(){return this.getType()>=Fs.kUnitType&&this.getType()<=Fs.kClampType}}],[{key:"isAngle",value:function(t){return t===we.kDegrees||t===we.kRadians||t===we.kGradians||t===we.kTurns}},{key:"isLength",value:function(t){return t>=we.kEms&&t<we.kDegrees}},{key:"isRelativeUnit",value:function(t){return t===we.kPercentage||t===we.kEms||t===we.kRems}},{key:"isTime",value:function(t){return t===we.kSeconds||t===we.kMilliseconds}}])}(),AD=function(r){function e(t){var n;return ce(this,e),n=Ge(this,e),n.colorSpace=t,n}return We(e,r),de(e,[{key:"getType",value:function(){return Fs.kColorType}},{key:"to",value:function(n){return this}}])}(Oc),Ki=function(r){return r[r.Constant=0]="Constant",r[r.LinearGradient=1]="LinearGradient",r[r.RadialGradient=2]="RadialGradient",r}({}),Ru=function(r){function e(t,n){var i;return ce(this,e),i=Ge(this,e),i.type=t,i.value=n,i}return We(e,r),de(e,[{key:"clone",value:function(){return new e(this.type,this.value)}},{key:"buildCSSText",value:function(n,i,a){return a}},{key:"getType",value:function(){return Fs.kColorType}}])}(Oc),kr=function(r){function e(t){var n;return ce(this,e),n=Ge(this,e),n.value=t,n}return We(e,r),de(e,[{key:"clone",value:function(){return new e(this.value)}},{key:"getType",value:function(){return Fs.kKeywordType}},{key:"buildCSSText",value:function(n,i,a){return a+this.value}}])}(Oc),kD=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n="";return Number.isFinite(e)?n="NaN":e>0?n="infinity":n="-infinity",n+=t},ay=function(e){return OD(TD(e))},gn=function(r){function e(t){var n,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:we.kNumber;ce(this,e),n=Ge(this,e);var a;return typeof i=="string"?a=_D(i):a=i,n.unit=a,n.value=t,n}return We(e,r),de(e,[{key:"clone",value:function(){return new e(this.value,this.unit)}},{key:"equals",value:function(n){var i=n;return this.value===i.value&&this.unit===i.unit}},{key:"getType",value:function(){return Fs.kUnitType}},{key:"convertTo",value:function(n){if(this.unit===n)return new e(this.value,this.unit);var i=ay(this.unit);if(i!==ay(n)||i===we.kUnknown)return null;var a=ab(this.unit)/ab(n);return new e(this.value*a,n)}},{key:"buildCSSText",value:function(n,i,a){var s;switch(this.unit){case we.kUnknown:break;case we.kInteger:s=Number(this.value).toFixed(0);break;case we.kNumber:case we.kPercentage:case we.kEms:case we.kRems:case we.kPixels:case we.kDegrees:case we.kRadians:case we.kGradians:case we.kMilliseconds:case we.kSeconds:case we.kTurns:{var o=-999999,u=999999,l=this.value,c=iy(this.unit);if(l<o||l>u){var d=iy(this.unit);!Number.isFinite(l)||Number.isNaN(l)?s=kD(l,d):s=l+(d||"")}else s="".concat(l).concat(c)}}return a+=s,a}}])}(Oc),Dr=new gn(0,"px");new gn(1,"px");var qa=new gn(0,"deg"),cm=function(r){function e(t,n,i){var a,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return ce(this,e),a=Ge(this,e,["rgb"]),a.r=t,a.g=n,a.b=i,a.alpha=s,a.isNone=o,a}return We(e,r),de(e,[{key:"clone",value:function(){return new e(this.r,this.g,this.b,this.alpha)}},{key:"buildCSSText",value:function(n,i,a){return"".concat(a,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")}}])}(AD),sb=new kr("unset"),ND=new kr("initial"),CD=new kr("inherit"),vh={"":sb,unset:sb,initial:ND,inherit:CD},PD=function(e){return vh[e]||(vh[e]=new kr(e)),vh[e]},UT=new cm(0,0,0,0,!0),HT=new cm(0,0,0,0),LD=tn(function(r,e,t,n){return new cm(r,e,t,n)},function(r,e,t,n){return"rgba(".concat(r,",").concat(e,",").concat(t,",").concat(n,")")}),_t=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:we.kNumber;return new gn(e,t)};new gn(50,"%");function DD(r){var e=r.type,t=r.value;return e==="hex"?"#".concat(t):e==="literal"?t:e==="rgb"?"rgb(".concat(t.join(","),")"):"rgba(".concat(t.join(","),")")}var ID=function(){var r={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function t($){throw new Error("".concat(e,": ").concat($))}function n(){var $=i();return e.length>0&&t("Invalid input not EOF"),$}function i(){return w(a)}function a(){return s("linear-gradient",r.linearGradient,u)||s("repeating-linear-gradient",r.repeatingLinearGradient,u)||s("radial-gradient",r.radialGradient,d)||s("repeating-radial-gradient",r.repeatingRadialGradient,d)||s("conic-gradient",r.conicGradient,d)}function s($,z,Z){return o(z,function(ne){var se=Z();return se&&(V(r.comma)||t("Missing comma before color stops")),{type:$,orientation:se,colorStops:w(M)}})}function o($,z){var Z=V($);if(Z){V(r.startCall)||t("Missing (");var ne=z(Z);return V(r.endCall)||t("Missing )"),ne}}function u(){return l()||c()}function l(){return G("directional",r.sideOrCorner,1)}function c(){return G("angular",r.angleValue,1)}function d(){var $,z=h(),Z;return z&&($=[],$.push(z),Z=e,V(r.comma)&&(z=h(),z?$.push(z):e=Z)),$}function h(){var $=f()||g();if($)$.at=p();else{var z=v();if(z){$=z;var Z=p();Z&&($.at=Z)}else{var ne=y();ne&&($={type:"default-radial",at:ne})}}return $}function f(){var $=G("shape",/^(circle)/i,0);return $&&($.style=j()||v()),$}function g(){var $=G("shape",/^(ellipse)/i,0);return $&&($.style=P()||v()),$}function v(){return G("extent-keyword",r.extentKeywords,1)}function p(){if(G("position",/^at/,0)){var $=y();return $||t("Missing positioning value"),$}}function y(){var $=m();if($.x||$.y)return{type:"position",value:$}}function m(){return{x:P(),y:P()}}function w($){var z=$(),Z=[];if(z)for(Z.push(z);V(r.comma);)z=$(),z?Z.push(z):t("One extra comma");return Z}function M(){var $=S();return $||t("Expected color definition"),$.length=P(),$}function S(){return A()||N()||O()||T()}function T(){return G("literal",r.literalColor,0)}function A(){return G("hex",r.hexColor,1)}function O(){return o(r.rgbColor,function(){return{type:"rgb",value:w(C)}})}function N(){return o(r.rgbaColor,function(){return{type:"rgba",value:w(C)}})}function C(){return V(r.number)[1]}function P(){return G("%",r.percentageValue,1)||D()||j()}function D(){return G("position-keyword",r.positionKeywords,1)}function j(){return G("px",r.pixelValue,1)||G("em",r.emValue,1)}function G($,z,Z){var ne=V(z);if(ne)return{type:$,value:ne[Z]}}function V($){var z=/^[\n\r\t\s]+/.exec(e);z&&Y(z[0].length);var Z=$.exec(e);return Z&&Y(Z[0].length),Z}function Y($){e=e.substring($)}return function($){return e=$,n()}}();function RD(r,e,t,n){var i=at(n.value),a=0,s=0,o=a+e/2,u=s+t/2,l=Math.abs(e*Math.cos(i))+Math.abs(t*Math.sin(i)),c=r[0]+o-Math.cos(i)*l/2,d=r[1]+u-Math.sin(i)*l/2,h=r[0]+o+Math.cos(i)*l/2,f=r[1]+u+Math.sin(i)*l/2;return{x1:c,y1:d,x2:h,y2:f}}function jD(r,e,t,n,i,a){var s=n.value,o=i.value;n.unit===we.kPercentage&&(s=n.value/100*e),i.unit===we.kPercentage&&(o=i.value/100*t);var u=Math.max(Kn([0,0],[s,o]),Kn([0,t],[s,o]),Kn([e,t],[s,o]),Kn([e,0],[s,o]));return a&&(a instanceof gn?u=a.value:a instanceof kr&&(a.value==="closest-side"?u=Math.min(s,e-s,o,t-o):a.value==="farthest-side"?u=Math.max(s,e-s,o,t-o):a.value==="closest-corner"&&(u=Math.min(Kn([0,0],[s,o]),Kn([0,t],[s,o]),Kn([e,t],[s,o]),Kn([e,0],[s,o]))))),{x:s+r[0],y:o+r[1],r:u}}var BD=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,FD=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,zD=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,XT=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function $D(r){var e,t=r.length;if(r[t-1].length=(e=r[t-1].length)!==null&&e!==void 0?e:{type:"%",value:"100"},t>1){var n;r[0].length=(n=r[0].length)!==null&&n!==void 0?n:{type:"%",value:"0"}}for(var i=0,a=Number(r[0].length.value),s=1;s<t;s++){var o,u=(o=r[s].length)===null||o===void 0?void 0:o.value;if(!Le(u)&&!Le(a)){for(var l=1;l<s-i;l++)r[i+l].length={type:"%",value:"".concat(a+(Number(u)-a)*l/(s-i))};i=s,a=Number(u)}}}var qD={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},GD=tn(function(r){var e;return r.type==="angular"?e=Number(r.value):e=qD[r.value]||0,_t(e,"deg")}),WD=tn(function(r){var e=50,t=50,n="%",i="%";if((r==null?void 0:r.type)==="position"){var a=r.value,s=a.x,o=a.y;(s==null?void 0:s.type)==="position-keyword"&&(s.value==="left"?e=0:s.value==="center"?e=50:s.value==="right"?e=100:s.value==="top"?t=0:s.value==="bottom"&&(t=100)),(o==null?void 0:o.type)==="position-keyword"&&(o.value==="left"?e=0:o.value==="center"?t=50:o.value==="right"?e=100:o.value==="top"?t=0:o.value==="bottom"&&(t=100)),((s==null?void 0:s.type)==="px"||(s==null?void 0:s.type)==="%"||(s==null?void 0:s.type)==="em")&&(n=s==null?void 0:s.type,e=Number(s.value)),((o==null?void 0:o.type)==="px"||(o==null?void 0:o.type)==="%"||(o==null?void 0:o.type)==="em")&&(i=o==null?void 0:o.type,t=Number(o.value))}return{cx:_t(e,n),cy:_t(t,i)}}),VD=tn(function(r){if(r.indexOf("linear")>-1||r.indexOf("radial")>-1){var e=ID(r);return e.map(function(o){var u=o.type,l=o.orientation,c=o.colorStops;$D(c);var d=c.map(function(w){return{offset:_t(Number(w.length.value),"%"),color:DD(w)}});if(u==="linear-gradient")return new Ru(Ki.LinearGradient,{angle:l?GD(l):qa,steps:d});if(u==="radial-gradient"&&(l||(l=[{type:"shape",value:"circle"}]),l[0].type==="shape"&&l[0].value==="circle")){var h=WD(l[0].at),f=h.cx,g=h.cy,v;if(l[0].style){var p=l[0].style,y=p.type,m=p.value;y==="extent-keyword"?v=PD(m):v=_t(m,y)}return new Ru(Ki.RadialGradient,{cx:f,cy:g,size:v,steps:d})}})}var t=r[0];if(r[1]==="("||r[2]==="("){if(t==="l"){var n=BD.exec(r);if(n){var i,a=((i=n[2].match(XT))===null||i===void 0?void 0:i.map(function(o){return o.split(":")}))||[];return[new Ru(Ki.LinearGradient,{angle:_t(parseFloat(n[1]),"deg"),steps:a.map(function(o){var u=ze(o,2),l=u[0],c=u[1];return{offset:_t(Number(l)*100,"%"),color:c}})})]}}else if(t==="r"){var s=YD(r);if(s)if(tt(s))r=s;else return[new Ru(Ki.RadialGradient,s)]}else if(t==="p")return UD(r)}});function YD(r){var e=FD.exec(r);if(e){var t,n=((t=e[4].match(XT))===null||t===void 0?void 0:t.map(function(i){return i.split(":")}))||[];return{cx:_t(50,"%"),cy:_t(50,"%"),steps:n.map(function(i){var a=ze(i,2),s=a[0],o=a[1];return{offset:_t(Number(s)*100,"%"),color:o}})}}return null}function UD(r){var e=zD.exec(r);if(e){var t=e[1],n=e[2];switch(t){case"a":t="repeat";break;case"x":t="repeat-x";break;case"y":t="repeat-y";break;case"n":t="no-repeat";break;default:t="no-repeat"}return{image:n,repetition:t}}return null}function Ga(r){return r&&!!r.image}function Ql(r){return r&&!Le(r.r)&&!Le(r.g)&&!Le(r.b)}var No=tn(function(r){if(Ga(r))return qe({repetition:"repeat"},r);if(Le(r)&&(r=""),r==="transparent")return HT;if(r==="currentColor")r="black";else if(r==="none")return UT;var e=VD(r);if(e)return e;var t=Tc(r),n=[0,0,0,0];return t!==null&&(n[0]=t.r||0,n[1]=t.g||0,n[2]=t.b||0,n[3]=t.opacity),LD.apply(void 0,n)});function HD(r,e){if(!(!Ql(r)||!Ql(e)))return[[Number(r.r),Number(r.g),Number(r.b),Number(r.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var n=t.slice();if(n[3])for(var i=0;i<3;i++)n[i]=Math.round(jt(n[i],0,255));return n[3]=jt(n[3],0,1),"rgba(".concat(n.join(","),")")}]}function uu(r,e){if(Le(e))return _t(0,"px");if(e="".concat(e).trim().toLowerCase(),isFinite(Number(e))){if("px".search(r)>=0)return _t(Number(e),"px");if("deg".search(r)>=0)return _t(Number(e),"deg")}var t=[];e=e.replace(r,function(i){return t.push(i),"U".concat(i)});var n="U(".concat(r.source,")");return t.map(function(i){return _t(Number(e.replace(new RegExp("U".concat(i),"g"),"").replace(new RegExp(n,"g"),"*0")),i)})[0]}var KT=function(e){return uu(new RegExp("px","g"),e)},XD=tn(KT),KD=function(e){return uu(new RegExp("%","g"),e)};tn(KD);var ZT=function(e){return Ee(e)||isFinite(Number(e))?_t(Number(e)||0,"px"):uu(new RegExp("px|%|em|rem","g"),e)},sy=tn(ZT),QT=function(e){return uu(new RegExp("deg|rad|grad|turn","g"),e)},ZD=tn(QT);function QD(r,e,t,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,a="",s=r.value||0,o=e.value||0,u=ay(r.unit),l=r.convertTo(u),c=e.convertTo(u);return l&&c?(s=l.value,o=c.value,a=iy(r.unit)):(gn.isLength(r.unit)||gn.isLength(e.unit))&&(s=sr(r,i,t),o=sr(e,i,t),a="px"),[s,o,function(d){return d+a}]}function Qn(r){var e=0;return r.unit===we.kDegrees?e=r.value:r.unit===we.kRadians?e=Zn(Number(r.value)):r.unit===we.kTurns?e=hD(Number(r.value)):r.value&&(e=r.value),e}function ob(r,e){var t;return Array.isArray(r)?t=r.map(function(n){return Number(n)}):tt(r)?t=r.split(" ").map(function(n){return Number(n)}):Ee(r)&&(t=[r]),e===2?t.length===1?[t[0],t[0]]:[t[0],t[1]]:e===4?t.length===1?[t[0],t[0],t[0],t[0]]:t.length===2?[t[0],t[1],t[0],t[1]]:t.length===3?[t[0],t[1],t[2],t[1]]:[t[0],t[1],t[2],t[3]]:e==="even"&&t.length%2===1?[].concat(pt(t),pt(t)):t}function sr(r,e,t){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(r.unit===we.kPixels)return Number(r.value);if(r.unit===we.kPercentage&&t){var i=t.nodeName===re.GROUP?t.getLocalBounds():t.getGeometryBounds();return(n?i.min[e]:0)+r.value/100*i.halfExtents[e]*2}return 0}var JD=function(e){return uu(/deg|rad|grad|turn|px|%/g,e)},eI=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function tI(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";if(r=r.toLowerCase().trim(),r==="none")return[];for(var e=/\s*([\w-]+)\(([^)]*)\)/g,t=[],n,i=0;n=e.exec(r);){if(n.index!==i)return[];if(i=n.index+n[0].length,eI.indexOf(n[1])>-1&&t.push({name:n[1],params:n[2].split(" ").map(function(a){return JD(a)||No(a)})}),e.lastIndex===r.length)return t}return[]}function JT(r){return r.toString()}var eO=function(e){return typeof e=="number"?_t(e):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(e)?_t(Number(e)):_t(0)},oy=tn(eO);tn(function(r){return tt(r)?r.split(" ").map(oy):r.map(oy)});function dm(r,e){return[r,e,JT]}function hm(r,e){return function(t,n){return[t,n,function(i){return JT(jt(i,r,e))}]}}function tO(r,e){if(r.length===e.length)return[r,e,function(t){return t}]}function uy(r){return r.parsedStyle.d.totalLength===0&&(r.parsedStyle.d.totalLength=w3(r.parsedStyle.d.absolutePath)),r.parsedStyle.d.totalLength}function nI(r){return r.parsedStyle.points.totalLength===0&&(r.parsedStyle.points.totalLength=Z3(r.parsedStyle.points.points)),r.parsedStyle.points.totalLength}function rI(r){for(var e=0;e<r.length;e++){var t=r[e-1],n=r[e],i=n[0];if(i==="M"&&t){var a=t[0],s=[n[1],n[2]],o=void 0;a==="L"||a==="M"?o=[t[1],t[2]]:(a==="C"||a==="A"||a==="Q")&&(o=[t[t.length-2],t[t.length-1]]),o&&Jl(s,o)&&(r.splice(e,1),e--)}}}function iI(r){for(var e=!1,t=r.length,n=0;n<t;n++){var i=r[n],a=i[0];if(a==="C"||a==="A"||a==="Q"){e=!0;break}}return e}function aI(r){for(var e=[],t=[],n=[],i=0;i<r.length;i++){var a=r[i],s=a[0];s==="M"?(n.length&&(t.push(n),n=[]),n.push([a[1],a[2]])):s==="Z"?n.length&&(e.push(n),n=[]):n.push([a[1],a[2]])}return n.length>0&&t.push(n),{polygons:e,polylines:t}}function Jl(r,e){return r[0]===e[0]&&r[1]===e[1]}function sI(r,e){for(var t=[],n=[],i=[],a=0;a<r.length;a++){var s=r[a],o=s.currentPoint,u=s.params,l=s.prePoint,c=void 0;switch(s.command){case"Q":c=Q3(l[0],l[1],u[1],u[2],u[3],u[4]);break;case"C":c=H3(l[0],l[1],u[1],u[2],u[3],u[4],u[5],u[6]);break;case"A":var d=s.arcParams;c=V3(d.cx,d.cy,d.rx,d.ry,d.xRotation,d.startAngle,d.endAngle);break;default:t.push(o[0]),n.push(o[1]);break}c&&(s.box=c,t.push(c.x,c.x+c.width),n.push(c.y,c.y+c.height))}t=t.filter(function(M){return!Number.isNaN(M)&&M!==1/0&&M!==-1/0}),n=n.filter(function(M){return!Number.isNaN(M)&&M!==1/0&&M!==-1/0});var h=Wl(t),f=Wl(n),g=Gl(t),v=Gl(n);if(i.length===0)return{x:h,y:f,width:g-h,height:v-f};for(var p=0;p<i.length;p++){var y=i[p],m=y.currentPoint,w=void 0;m[0]===h?(w=ju(y,e),h-=w.xExtra):m[0]===g&&(w=ju(y,e),g+=w.xExtra),m[1]===f?(w=ju(y,e),f-=w.yExtra):m[1]===v&&(w=ju(y,e),v+=w.yExtra)}return{x:h,y:f,width:g-h,height:v-f}}function ju(r,e){var t=r.prePoint,n=r.currentPoint,i=r.nextPoint,a=Math.pow(n[0]-t[0],2)+Math.pow(n[1]-t[1],2),s=Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2),o=Math.pow(t[0]-i[0],2)+Math.pow(t[1]-i[1],2),u=Math.acos((a+s-o)/(2*Math.sqrt(a)*Math.sqrt(s)));if(!u||Math.sin(u)===0||Ao(u,0))return{xExtra:0,yExtra:0};var l=Math.abs(Math.atan2(i[1]-n[1],i[0]-n[0])),c=Math.abs(Math.atan2(i[0]-n[0],i[1]-n[1]));l=l>Math.PI/2?Math.PI-l:l,c=c>Math.PI/2?Math.PI-c:c;var d={xExtra:Math.cos(u/2-l)*(e/2*(1/Math.sin(u/2)))-e/2||0,yExtra:Math.cos(c-u/2)*(e/2*(1/Math.sin(u/2)))-e/2||0};return d}function ub(r,e){return[e[0]+(e[0]-r[0]),e[1]+(e[1]-r[1])]}var lb=function(e,t){var n=e.x*t.x+e.y*t.y,i=Math.sqrt((Math.pow(e.x,2)+Math.pow(e.y,2))*(Math.pow(t.x,2)+Math.pow(t.y,2))),a=e.x*t.y-e.y*t.x<0?-1:1,s=a*Math.acos(n/i);return s},cb=function(e,t,n,i,a,s,o,u){t=Math.abs(t),n=Math.abs(n),i=_T(i,360);var l=at(i);if(e.x===o.x&&e.y===o.y)return{x:e.x,y:e.y,ellipticalArcAngle:0};if(t===0||n===0)return{x:0,y:0,ellipticalArcAngle:0};var c=(e.x-o.x)/2,d=(e.y-o.y)/2,h={x:Math.cos(l)*c+Math.sin(l)*d,y:-Math.sin(l)*c+Math.cos(l)*d},f=Math.pow(h.x,2)/Math.pow(t,2)+Math.pow(h.y,2)/Math.pow(n,2);f>1&&(t*=Math.sqrt(f),n*=Math.sqrt(f));var g=Math.pow(t,2)*Math.pow(n,2)-Math.pow(t,2)*Math.pow(h.y,2)-Math.pow(n,2)*Math.pow(h.x,2),v=Math.pow(t,2)*Math.pow(h.y,2)+Math.pow(n,2)*Math.pow(h.x,2),p=g/v;p=p<0?0:p;var y=(a!==s?1:-1)*Math.sqrt(p),m={x:y*(t*h.y/n),y:y*(-(n*h.x)/t)},w={x:Math.cos(l)*m.x-Math.sin(l)*m.y+(e.x+o.x)/2,y:Math.sin(l)*m.x+Math.cos(l)*m.y+(e.y+o.y)/2},M={x:(h.x-m.x)/t,y:(h.y-m.y)/n},S=lb({x:1,y:0},M),T={x:(-h.x-m.x)/t,y:(-h.y-m.y)/n},A=lb(M,T);!s&&A>0?A-=2*Math.PI:s&&A<0&&(A+=2*Math.PI),A%=2*Math.PI;var O=S+A*u,N=t*Math.cos(O),C=n*Math.sin(O),P={x:Math.cos(l)*N-Math.sin(l)*C+w.x,y:Math.sin(l)*N+Math.cos(l)*C+w.y,ellipticalArcStartAngle:S,ellipticalArcEndAngle:S+A,ellipticalArcAngle:O,ellipticalArcCenter:w,resultantRx:t,resultantRy:n};return P};function oI(r){for(var e=[],t=null,n=null,i=null,a=0,s=r.length,o=0;o<s;o++){var u=r[o];n=r[o+1];var l=u[0],c={command:l,prePoint:t,params:u,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(l){case"M":i=[u[1],u[2]],a=o;break;case"A":var d=uI(t,u);c.arcParams=d;break}if(l==="Z")t=i,n=r[a+1];else{var h=u.length;t=[u[h-2],u[h-1]]}n&&n[0]==="Z"&&(n=r[a],e[a]&&(e[a].prePoint=t)),c.currentPoint=t,e[a]&&Jl(t,e[a].currentPoint)&&(e[a].prePoint=c.prePoint);var f=n?[n[n.length-2],n[n.length-1]]:null;c.nextPoint=f;var g=c.prePoint;if(["L","H","V"].includes(l))c.startTangent=[g[0]-t[0],g[1]-t[1]],c.endTangent=[t[0]-g[0],t[1]-g[1]];else if(l==="Q"){var v=[u[1],u[2]];c.startTangent=[g[0]-v[0],g[1]-v[1]],c.endTangent=[t[0]-v[0],t[1]-v[1]]}else if(l==="T"){var p=e[o-1],y=ub(p.currentPoint,g);p.command==="Q"?(c.command="Q",c.startTangent=[g[0]-y[0],g[1]-y[1]],c.endTangent=[t[0]-y[0],t[1]-y[1]]):(c.command="TL",c.startTangent=[g[0]-t[0],g[1]-t[1]],c.endTangent=[t[0]-g[0],t[1]-g[1]])}else if(l==="C"){var m=[u[1],u[2]],w=[u[3],u[4]];c.startTangent=[g[0]-m[0],g[1]-m[1]],c.endTangent=[t[0]-w[0],t[1]-w[1]],c.startTangent[0]===0&&c.startTangent[1]===0&&(c.startTangent=[m[0]-w[0],m[1]-w[1]]),c.endTangent[0]===0&&c.endTangent[1]===0&&(c.endTangent=[w[0]-m[0],w[1]-m[1]])}else if(l==="S"){var M=e[o-1],S=ub(M.currentPoint,g),T=[u[1],u[2]];M.command==="C"?(c.command="C",c.startTangent=[g[0]-S[0],g[1]-S[1]],c.endTangent=[t[0]-T[0],t[1]-T[1]]):(c.command="SQ",c.startTangent=[g[0]-T[0],g[1]-T[1]],c.endTangent=[t[0]-T[0],t[1]-T[1]])}else if(l==="A"){var A=db(c,0),O=A.x,N=A.y,C=db(c,1,!1),P=C.x,D=C.y;c.startTangent=[O,N],c.endTangent=[P,D]}e.push(c)}return e}function db(r,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=r.arcParams,i=n.rx,a=i===void 0?0:i,s=n.ry,o=s===void 0?0:s,u=n.xRotation,l=n.arcFlag,c=n.sweepFlag,d=cb({x:r.prePoint[0],y:r.prePoint[1]},a,o,u,!!l,!!c,{x:r.currentPoint[0],y:r.currentPoint[1]},e),h=cb({x:r.prePoint[0],y:r.prePoint[1]},a,o,u,!!l,!!c,{x:r.currentPoint[0],y:r.currentPoint[1]},t?e+.005:e-.005),f=h.x-d.x,g=h.y-d.y,v=Math.sqrt(f*f+g*g);return{x:-f/v,y:-g/v}}function Bu(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function ly(r,e){return Bu(r)*Bu(e)?(r[0]*e[0]+r[1]*e[1])/(Bu(r)*Bu(e)):1}function hb(r,e){return(r[0]*e[1]<r[1]*e[0]?-1:1)*Math.acos(ly(r,e))}function uI(r,e){var t=e[1],n=e[2],i=_T(at(e[3]),Math.PI*2),a=e[4],s=e[5],o=r[0],u=r[1],l=e[6],c=e[7],d=Math.cos(i)*(o-l)/2+Math.sin(i)*(u-c)/2,h=-1*Math.sin(i)*(o-l)/2+Math.cos(i)*(u-c)/2,f=d*d/(t*t)+h*h/(n*n);f>1&&(t*=Math.sqrt(f),n*=Math.sqrt(f));var g=t*t*(h*h)+n*n*(d*d),v=g?Math.sqrt((t*t*(n*n)-g)/g):1;a===s&&(v*=-1),isNaN(v)&&(v=0);var p=n?v*t*h/n:0,y=t?v*-n*d/t:0,m=(o+l)/2+Math.cos(i)*p-Math.sin(i)*y,w=(u+c)/2+Math.sin(i)*p+Math.cos(i)*y,M=[(d-p)/t,(h-y)/n],S=[(-1*d-p)/t,(-1*h-y)/n],T=hb([1,0],M),A=hb(M,S);return ly(M,S)<=-1&&(A=Math.PI),ly(M,S)>=1&&(A=0),s===0&&A>0&&(A-=2*Math.PI),s===1&&A<0&&(A+=2*Math.PI),{cx:m,cy:w,rx:Jl(r,[l,c])?0:t,ry:Jl(r,[l,c])?0:n,startAngle:T,endAngle:T+A,xRotation:i,arcFlag:a,sweepFlag:s}}var nO=function(e){if(e===""||Array.isArray(e)&&e.length===0)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var t;try{t=Ul(e)}catch{t=Ul(""),console.error("[g]: Invalid SVG Path definition: ".concat(e))}rI(t);var n=iI(t),i=aI(t),a=i.polygons,s=i.polylines,o=oI(t),u=sI(o,0),l=u.x,c=u.y,d=u.width,h=u.height;return{absolutePath:t,hasArc:n,segments:o,polygons:a,polylines:s,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(c)?c:0,width:Number.isFinite(d)?d:0,height:Number.isFinite(h)?h:0}}},lI=tn(nO);function rO(r){return tt(r)?lI(r):nO(r)}function cI(r,e,t){var n=r.curve,i=e.curve;(!n||n.length===0)&&(n=Z0(r.absolutePath,!1),r.curve=n),(!i||i.length===0)&&(i=Z0(e.absolutePath,!1),e.curve=i);var a=[n,i];n.length!==i.length&&(a=RT(n,i));var s=z1(a[0])!==z1(a[1])?g3(a[0]):f3(a[0]);return[s,E3(a[1],s),function(o){return o}]}function dI(r,e){var t;return tt(r)?t=r.split(" ").map(function(n){var i=n.split(","),a=ze(i,2),s=a[0],o=a[1];return[Number(s),Number(o)]}):t=r,{points:t,totalLength:0,segments:[]}}function hI(r,e){return[r.points,e.points,function(t){return t}]}var It=null,Cs=/\s*(\w+)\(([^)]*)\)/g;function Un(r){return function(e){var t=0;return r.map(function(n){return n===It?e[t++]:n})}}function Ea(r){return r}var zo={matrix:["NNNNNN",[It,It,0,0,It,It,0,0,0,0,1,0,It,It,0,1],Ea],matrix3d:["NNNNNNNNNNNNNNNN",Ea],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",Un([It,It,new gn(1)]),Ea],scaleX:["N",Un([It,new gn(1),new gn(1)]),Un([It,new gn(1)])],scaleY:["N",Un([new gn(1),It,new gn(1)]),Un([new gn(1),It])],scaleZ:["N",Un([new gn(1),new gn(1),It])],scale3d:["NNN",Ea],skew:["Aa",null,Ea],skewX:["A",null,Un([It,qa])],skewY:["A",null,Un([qa,It])],translate:["Tt",Un([It,It,Dr]),Ea],translateX:["T",Un([It,Dr,Dr]),Un([It,Dr])],translateY:["T",Un([Dr,It,Dr]),Un([Dr,It])],translateZ:["L",Un([Dr,Dr,It])],translate3d:["TTL",Ea]};function iO(r){for(var e=[],t=r.length,n=0;n<t;n++){var i=r[n],a=i[0],s=i.slice(1);a==="translate"||a==="skew"?s.length===1&&s.push(0):a==="scale"&&s.length===1&&s.push(s[0]);var o=zo[a];if(!o)return[];var u=s.map(function(l){return _t(l)});e.push({t:a,d:u})}return e}function aO(r){if(Array.isArray(r))return iO(r);if(r=(r||"none").trim(),r==="none")return[];var e=[],t,n=0;for(Cs.lastIndex=0;t=Cs.exec(r);){if(t.index!==n)return[];n=t.index+t[0].length;var i=t[1],a=zo[i];if(!a)return[];var s=t[2].split(","),o=a[0];if(o.length<s.length)return[];for(var u=[],l=0;l<o.length;l++){var c=s[l],d=o[l],h=void 0;if(c?h={A:function(g){return g.trim()==="0"?qa:ZD(g)},N:oy,T:sy,L:XD}[d.toUpperCase()](c):h={a:qa,n:u[0],t:Dr}[d],h===void 0)return[];u.push(h)}if(e.push({t:i,d:u}),Cs.lastIndex===r.length)return e}return[]}function fI(r){if(Array.isArray(r))return iO(r);if(r=(r||"none").trim(),r==="none")return[];var e=[],t,n=0;for(Cs.lastIndex=0;t=Cs.exec(r);){if(t.index!==n)return[];n=t.index+t[0].length;var i=t[1],a=zo[i];if(!a)return[];var s=t[2].split(","),o=a[0];if(o.length<s.length)return[];for(var u=[],l=0;l<o.length;l++){var c=s[l],d=o[l],h=void 0;if(c?h={A:function(g){return g.trim()==="0"?qa:QT(g)},N:eO,T:ZT,L:KT}[d.toUpperCase()](c):h={a:qa,n:u[0],t:Dr}[d],h===void 0)return[];u.push(h)}if(e.push({t:i,d:u}),Cs.lastIndex===r.length)return e}return[]}function gI(r){var e,t,n,i;switch(r.t){case"rotateX":return i=at(Qn(r.d[0])),[1,0,0,0,0,Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotateY":return i=at(Qn(r.d[0])),[Math.cos(i),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotateZ":return i=at(Qn(r.d[0])),[Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=r.d[0].value,t=r.d[1].value,n=r.d[2].value,i=at(Qn(r.d[3]));var a=e*e+t*t+n*n;if(a===0)e=1,t=0,n=0;else if(a!==1){var s=Math.sqrt(a);e/=s,t/=s,n/=s}var o=Math.sin(i/2),u=o*Math.cos(i/2),l=o*o;return[1-2*(t*t+n*n)*l,2*(e*t*l+n*u),2*(e*n*l-t*u),0,2*(e*t*l-n*u),1-2*(e*e+n*n)*l,2*(t*n*l+e*u),0,2*(e*n*l+t*u),2*(t*n*l-e*u),1-2*(e*e+t*t)*l,0,0,0,0,1];case"scale":return[r.d[0].value,0,0,0,0,r.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[r.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,r.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,r.d[0].value,0,0,0,0,1];case"scale3d":return[r.d[0].value,0,0,0,0,r.d[1].value,0,0,0,0,r.d[2].value,0,0,0,0,1];case"skew":var c=at(Qn(r.d[0])),d=at(Qn(r.d[1]));return[1,Math.tan(d),0,0,Math.tan(c),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return i=at(Qn(r.d[0])),[1,0,0,0,Math.tan(i),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return i=at(Qn(r.d[0])),[1,Math.tan(i),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return e=sr(r.d[0],0,null)||0,t=sr(r.d[1],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,t,0,1];case"translateX":return e=sr(r.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,0,0,1];case"translateY":return t=sr(r.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,t,0,1];case"translateZ":return n=sr(r.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,n,1];case"translate3d":return e=sr(r.d[0],0,null)||0,t=sr(r.d[1],0,null)||0,n=sr(r.d[2],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,t,n,1];case"perspective":var h=sr(r.d[0],0,null)||0,f=h?-1/h:0;return[1,0,0,0,0,1,0,0,0,0,1,f,0,0,0,1];case"matrix":return[r.d[0].value,r.d[1].value,0,0,r.d[2].value,r.d[3].value,0,0,0,0,1,0,r.d[4].value,r.d[5].value,0,1];case"matrix3d":return r.d.map(function(g){return g.value})}}function pI(r,e){return[r[0]*e[0]+r[4]*e[1]+r[8]*e[2]+r[12]*e[3],r[1]*e[0]+r[5]*e[1]+r[9]*e[2]+r[13]*e[3],r[2]*e[0]+r[6]*e[1]+r[10]*e[2]+r[14]*e[3],r[3]*e[0]+r[7]*e[1]+r[11]*e[2]+r[15]*e[3],r[0]*e[4]+r[4]*e[5]+r[8]*e[6]+r[12]*e[7],r[1]*e[4]+r[5]*e[5]+r[9]*e[6]+r[13]*e[7],r[2]*e[4]+r[6]*e[5]+r[10]*e[6]+r[14]*e[7],r[3]*e[4]+r[7]*e[5]+r[11]*e[6]+r[15]*e[7],r[0]*e[8]+r[4]*e[9]+r[8]*e[10]+r[12]*e[11],r[1]*e[8]+r[5]*e[9]+r[9]*e[10]+r[13]*e[11],r[2]*e[8]+r[6]*e[9]+r[10]*e[10]+r[14]*e[11],r[3]*e[8]+r[7]*e[9]+r[11]*e[10]+r[15]*e[11],r[0]*e[12]+r[4]*e[13]+r[8]*e[14]+r[12]*e[15],r[1]*e[12]+r[5]*e[13]+r[9]*e[14]+r[13]*e[15],r[2]*e[12]+r[6]*e[13]+r[10]*e[14]+r[14]*e[15],r[3]*e[12]+r[7]*e[13]+r[11]*e[14]+r[15]*e[15]]}function vI(r){return r.length===0?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:r.map(gI).reduce(pI)}function fb(r){var e=[0,0,0],t=[1,1,1],n=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return yD(vI(r),e,t,n,i,a),[[e,t,n,a,i]]}var yI=function(){function r(n,i){for(var a=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],s=0;s<4;s++)for(var o=0;o<4;o++)for(var u=0;u<4;u++)a[s][o]+=i[s][u]*n[u][o];return a}function e(n){return n[0][2]===0&&n[0][3]===0&&n[1][2]===0&&n[1][3]===0&&n[2][0]===0&&n[2][1]===0&&n[2][2]===1&&n[2][3]===0&&n[3][2]===0&&n[3][3]===1}function t(n,i,a,s,o){for(var u=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],l=0;l<4;l++)u[l][3]=o[l];for(var c=0;c<3;c++)for(var d=0;d<3;d++)u[3][c]+=n[d]*u[d][c];var h=s[0],f=s[1],g=s[2],v=s[3],p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];p[0][0]=1-2*(f*f+g*g),p[0][1]=2*(h*f-g*v),p[0][2]=2*(h*g+f*v),p[1][0]=2*(h*f+g*v),p[1][1]=1-2*(h*h+g*g),p[1][2]=2*(f*g-h*v),p[2][0]=2*(h*g-f*v),p[2][1]=2*(f*g+h*v),p[2][2]=1-2*(h*h+f*f),u=r(u,p);var y=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];a[2]&&(y[2][1]=a[2],u=r(u,y)),a[1]&&(y[2][1]=0,y[2][0]=a[0],u=r(u,y)),a[0]&&(y[2][0]=0,y[1][0]=a[0],u=r(u,y));for(var m=0;m<3;m++)for(var w=0;w<3;w++)u[m][w]*=i[m];return e(u)?[u[0][0],u[0][1],u[1][0],u[1][1],u[3][0],u[3][1]]:u[0].concat(u[1],u[2],u[3])}return t}();function mI(r){return r.toFixed(6).replace(".000000","")}function yh(r,e){var t,n;return r.decompositionPair!==e&&(r.decompositionPair=e,t=fb(r)),e.decompositionPair!==r&&(e.decompositionPair=r,n=fb(e)),t[0]===null||n[0]===null?[[!1],[!0],function(i){return i?e[0].d:r[0].d}]:(t[0].push(0),n[0].push(1),[t,n,function(i){var a=wI(t[0][3],n[0][3],i[5]),s=yI(i[0],i[1],i[2],a,i[4]),o=s.map(mI).join(",");return o}])}function bI(r,e){for(var t=0,n=0;n<r.length;n++)t+=r[n]*e[n];return t}function wI(r,e,t){var n=bI(r,e);n=jt(n,-1,1);var i=[];if(n===1)i=r;else for(var a=Math.acos(n),s=Math.sin(t*a)*1/Math.sqrt(1-n*n),o=0;o<4;o++)i.push(r[o]*(Math.cos(t*a)-n*s)+e[o]*s);return i}function mh(r){return r.replace(/[XY]/,"")}function bh(r){return r.replace(/(X|Y|Z|3d)?$/,"3d")}var xI=function(e,t){return e==="perspective"&&t==="perspective"||(e==="matrix"||e==="matrix3d")&&(t==="matrix"||t==="matrix3d")};function EI(r,e,t){var n=!1;if(!r.length||!e.length){r.length||(n=!0,r=e,e=[]);for(var i=function(){var P=r[a],D=P.t,j=P.d,G=D.substring(0,5)==="scale"?1:0;e.push({t:D,d:j.map(function(V){return typeof V=="number"?_t(G):_t(G,V.unit)})})},a=0;a<r.length;a++)i()}var s=[],o=[],u=[];if(r.length!==e.length){var l=yh(r,e);s=[l[0]],o=[l[1]],u=[["matrix",[l[2]]]]}else for(var c=0;c<r.length;c++){var d=r[c].t,h=e[c].t,f=r[c].d,g=e[c].d,v=zo[d],p=zo[h],y=void 0;if(xI(d,h)){var m=yh([r[c]],[e[c]]);s.push(m[0]),o.push(m[1]),u.push(["matrix",[m[2]]]);continue}else if(d===h)y=d;else if(v[2]&&p[2]&&mh(d)===mh(h))y=mh(d),f=v[2](f),g=p[2](g);else if(v[1]&&p[1]&&bh(d)===bh(h))y=bh(d),f=v[1](f),g=p[1](g);else{var w=yh(r,e);s=[w[0]],o=[w[1]],u=[["matrix",[w[2]]]];break}for(var M=[],S=[],T=[],A=0;A<f.length;A++){var O=QD(f[A],g[A],t,!1,A);M[A]=O[0],S[A]=O[1],T.push(O[2])}s.push(M),o.push(S),u.push([y,T])}if(n){var N=s;s=o,o=N}return[s,o,function(C){return C.map(function(P,D){var j=P.map(function(G,V){return u[D][1][V](G)}).join(",");return u[D][0]==="matrix"&&j.split(",").length===16&&(u[D][0]="matrix3d"),u[D][0]==="matrix3d"&&j.split(",").length===6&&(u[D][0]="matrix"),"".concat(u[D][0],"(").concat(j,")")}).join(" ")}]}var MI=tn(function(r){if(tt(r)){if(r==="text-anchor")return[_t(0,"px"),_t(0,"px")];var e=r.split(" ");return e.length===1&&(e[0]==="top"||e[0]==="bottom"?(e[1]=e[0],e[0]="center"):e[1]="center"),e.length!==2?null:[sy(gb(e[0])),sy(gb(e[1]))]}return[_t(r[0]||0,"px"),_t(r[1]||0,"px")]});function gb(r){return r==="center"?"50%":r==="left"||r==="top"?"0%":r==="right"||r==="bottom"?"100%":r}var fm=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:be.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:be.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:be.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:be.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:be.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:be.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:be.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:be.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:be.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:be.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:be.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:be.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:be.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:be.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:be.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:be.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:be.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:be.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:be.FILTER},{n:"clipPath",syntax:be.DEFINED_PATH},{n:"textPath",syntax:be.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:be.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:be.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:be.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:be.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:be.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:be.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:be.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:be.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:be.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:be.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:be.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:be.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:be.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:be.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:be.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:be.COORDINATE},{n:"y1",int:!0,l:!0,syntax:be.COORDINATE},{n:"z1",int:!0,l:!0,syntax:be.COORDINATE},{n:"x2",int:!0,l:!0,syntax:be.COORDINATE},{n:"y2",int:!0,l:!0,syntax:be.COORDINATE},{n:"z2",int:!0,l:!0,syntax:be.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:be.PATH,p:50},{n:"points",int:!0,l:!0,syntax:be.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:be.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:be.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:be.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:be.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:be.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:be.NUMBER,d:function(e){return e===re.PATH||e===re.POLYGON||e===re.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:be.MARKER},{n:"markerEnd",syntax:be.MARKER},{n:"markerMid",syntax:be.MARKER},{n:"markerStartOffset",syntax:be.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:be.LENGTH,l:!0,int:!0,d:"0"}],SI=new Set(fm.filter(function(r){return!!r.l}).map(function(r){return r.n})),sO={},_I=function(){function r(e){var t=this;ce(this,r),this.runtime=e,fm.forEach(function(n){t.registerMetadata(n)})}return de(r,[{key:"registerMetadata",value:function(t){[t.n].concat(pt(t.a||[])).forEach(function(n){sO[n]=t})}},{key:"getPropertySyntax",value:function(t){return this.runtime.CSSPropertySyntaxFactory[t]}},{key:"processProperties",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(t.attributes,n);var a=t.parsedStyle.clipPath,s=t.parsedStyle.offsetPath;TI(t,n);var o=!!i.forceUpdateGeometry;if(!o){for(var u in n)if(SI.has(u)){o=!0;break}}var l=oO(t);l.has("fill")&&n.fill&&(t.parsedStyle.fill=No(n.fill)),l.has("stroke")&&n.stroke&&(t.parsedStyle.stroke=No(n.stroke)),l.has("shadowColor")&&n.shadowColor&&(t.parsedStyle.shadowColor=No(n.shadowColor)),l.has("filter")&&n.filter&&(t.parsedStyle.filter=tI(n.filter)),l.has("radius")&&!Le(n.radius)&&(t.parsedStyle.radius=ob(n.radius,4)),l.has("lineDash")&&!Le(n.lineDash)&&(t.parsedStyle.lineDash=ob(n.lineDash,"even")),l.has("points")&&n.points&&(t.parsedStyle.points=dI(n.points)),l.has("d")&&n.d===""&&(t.parsedStyle.d=qe({},YT)),l.has("d")&&n.d&&(t.parsedStyle.d=rO(n.d)),l.has("textTransform")&&n.textTransform&&this.runtime.CSSPropertySyntaxFactory[be.TEXT_TRANSFORM].calculator(null,null,{value:n.textTransform},t,null),l.has("clipPath")&&!je(n.clipPath)&&this.runtime.CSSPropertySyntaxFactory[be.DEFINED_PATH].calculator("clipPath",a,n.clipPath,t,this.runtime),l.has("offsetPath")&&n.offsetPath&&this.runtime.CSSPropertySyntaxFactory[be.DEFINED_PATH].calculator("offsetPath",s,n.offsetPath,t,this.runtime),l.has("transform")&&n.transform&&(t.parsedStyle.transform=aO(n.transform)),l.has("transformOrigin")&&n.transformOrigin&&(t.parsedStyle.transformOrigin=MI(n.transformOrigin)),l.has("markerStart")&&n.markerStart&&(t.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[be.MARKER].calculator(null,n.markerStart,n.markerStart,null,null)),l.has("markerEnd")&&n.markerEnd&&(t.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[be.MARKER].calculator(null,n.markerEnd,n.markerEnd,null,null)),l.has("markerMid")&&n.markerMid&&(t.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[be.MARKER].calculator("",n.markerMid,n.markerMid,null,null)),l.has("zIndex")&&!Le(n.zIndex)&&this.runtime.CSSPropertySyntaxFactory[be.Z_INDEX].postProcessor(t),l.has("offsetDistance")&&!Le(n.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[be.OFFSET_DISTANCE].postProcessor(t),l.has("transform")&&n.transform&&this.runtime.CSSPropertySyntaxFactory[be.TRANSFORM].postProcessor(t),l.has("transformOrigin")&&n.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[be.TRANSFORM_ORIGIN].postProcessor(t),o&&(t.geometry.dirty=!0,t.renderable.boundsDirty=!0,t.renderable.renderBoundsDirty=!0,i.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(t))}},{key:"updateGeometry",value:function(t){var n=t.nodeName,i=this.runtime.geometryUpdaterFactory[n];if(i){var a=t.geometry;a.contentBounds||(a.contentBounds=new ft),a.renderBounds||(a.renderBounds=new ft);var s=t.parsedStyle,o=i.update(s,t),u=o.cx,l=u===void 0?0:u,c=o.cy,d=c===void 0?0:c,h=o.cz,f=h===void 0?0:h,g=o.hwidth,v=g===void 0?0:g,p=o.hheight,y=p===void 0?0:p,m=o.hdepth,w=m===void 0?0:m,M=[Math.abs(v),Math.abs(y),w],S=s.stroke,T=s.lineWidth,A=T===void 0?1:T,O=s.increasedLineWidthForHitTesting,N=O===void 0?0:O,C=s.shadowType,P=C===void 0?"outer":C,D=s.shadowColor,j=s.filter,G=j===void 0?[]:j,V=s.transformOrigin,Y=[l,d,f];a.contentBounds.update(Y,M);var $=n===re.POLYLINE||n===re.POLYGON||n===re.PATH?Math.SQRT2:.5,z=S&&!S.isNone;if(z){var Z=((A||0)+(N||0))*$;M[0]+=Z,M[1]+=Z}if(a.renderBounds.update(Y,M),D&&P&&P!=="inner"){var ne=a.renderBounds,se=ne.min,oe=ne.max,Ne=s.shadowBlur,K=s.shadowOffsetX,W=s.shadowOffsetY,ee=Ne||0,le=K||0,xe=W||0,Ce=se[0]-ee+le,Ve=oe[0]+ee+le,Tt=se[1]-ee+xe,dn=oe[1]+ee+xe;se[0]=Math.min(se[0],Ce),oe[0]=Math.max(oe[0],Ve),se[1]=Math.min(se[1],Tt),oe[1]=Math.max(oe[1],dn),a.renderBounds.setMinMax(se,oe)}G.forEach(function(Qe){var yr=Qe.name,bt=Qe.params;if(yr==="blur"){var as=bt[0].value;a.renderBounds.update(a.renderBounds.center,ra(a.renderBounds.halfExtents,a.renderBounds.halfExtents,[as,as,0]))}else if(yr==="drop-shadow"){var mr=bt[0].value,qt=bt[1].value,Lt=bt[2].value,Vn=a.renderBounds,Yn=Vn.min,br=Vn.max,pi=Yn[0]-Lt+mr,Ur=br[0]+Lt+mr,ss=Yn[1]-Lt+qt,os=br[1]+Lt+qt;Yn[0]=Math.min(Yn[0],pi),br[0]=Math.max(br[0],Ur),Yn[1]=Math.min(Yn[1],ss),br[1]=Math.max(br[1],os),a.renderBounds.setMinMax(Yn,br)}}),t.geometry.dirty=!1;var Ot=v<0,Ut=y<0,Xe=(Ot?-1:1)*(V?sr(V[0],0,t,!0):0),vr=(Ut?-1:1)*(V?sr(V[1],1,t,!0):0);(Xe||vr)&&t.setOrigin(Xe,vr)}}},{key:"updateSizeAttenuation",value:function(t,n){t.style.isSizeAttenuation?(t.style.rawLineWidth||(t.style.rawLineWidth=t.style.lineWidth),t.style.lineWidth=(t.style.rawLineWidth||1)/n,t.nodeName===re.CIRCLE&&(t.style.rawR||(t.style.rawR=t.style.r),t.style.r=(t.style.rawR||1)/n)):(t.style.rawLineWidth&&(t.style.lineWidth=t.style.rawLineWidth,delete t.style.rawLineWidth),t.nodeName===re.CIRCLE&&t.style.rawR&&(t.style.r=t.style.rawR,delete t.style.rawR))}}])}();function TI(r,e){var t=oO(r);for(var n in e)t.has(n)&&(r.parsedStyle[n]=e[n])}function oO(r){return r.constructor.PARSED_STYLE_LIST}var OI=function(){function r(){ce(this,r),this.mixer=dm}return de(r,[{key:"calculator",value:function(t,n,i,a){return Qn(i)}}])}(),AI=function(){function r(){ce(this,r)}return de(r,[{key:"calculator",value:function(t,n,i,a,s){return i instanceof kr&&(i=null),s.sceneGraphService.updateDisplayObjectDependency(t,n,i,a),t==="clipPath"&&a.forEach(function(o){o.childNodes.length===0&&s.sceneGraphService.dirtifyToRoot(o)}),i}}])}(),kI=function(){function r(){ce(this,r),this.parser=No,this.mixer=HD}return de(r,[{key:"calculator",value:function(t,n,i,a){return i instanceof kr?i.value==="none"?UT:HT:i}}])}(),NI=function(){function r(){ce(this,r)}return de(r,[{key:"calculator",value:function(t,n,i){return i instanceof kr?[]:i}}])}();function pb(r){var e=r.parsedStyle,t=e.fontSize;return Le(t)?null:t}var cy=function(){function r(){ce(this,r),this.mixer=dm}return de(r,[{key:"calculator",value:function(t,n,i,a,s){if(Ee(i))return i;if(gn.isRelativeUnit(i.unit)){if(i.unit===we.kPercentage)return 0;if(i.unit===we.kEms){if(a.parentNode){var o=pb(a.parentNode);if(o)return o*=i.value,o}return 0}if(i.unit===we.kRems){var u;if(a!=null&&(u=a.ownerDocument)!==null&&u!==void 0&&u.documentElement){var l=pb(a.ownerDocument.documentElement);if(l)return l*=i.value,l}return 0}}else return i.value}}])}(),CI=function(){function r(){ce(this,r),this.mixer=tO}return de(r,[{key:"calculator",value:function(t,n,i){return i.map(function(a){return a.value})}}])}(),PI=function(){function r(){ce(this,r),this.mixer=tO}return de(r,[{key:"calculator",value:function(t,n,i){return i.map(function(a){return a.value})}}])}(),LI=function(){function r(){ce(this,r)}return de(r,[{key:"calculator",value:function(t,n,i,a){var s;i instanceof kr&&(i=null);var o=(s=i)===null||s===void 0?void 0:s.cloneNode(!0);return o&&(o.style.isMarker=!0),o}}])}(),DI=function(){function r(){ce(this,r),this.mixer=dm}return de(r,[{key:"calculator",value:function(t,n,i){return i.value}}])}(),II=function(){function r(){ce(this,r),this.mixer=hm(0,1)}return de(r,[{key:"calculator",value:function(t,n,i){return i.value}},{key:"postProcessor",value:function(t){var n=t.parsedStyle,i=n.offsetPath,a=n.offsetDistance;if(i){var s=i.nodeName;if(s===re.LINE||s===re.PATH||s===re.POLYLINE){var o=i.getPoint(a);o&&t.setLocalPosition(o.x,o.y)}}}}])}(),RI=function(){function r(){ce(this,r),this.mixer=hm(0,1)}return de(r,[{key:"calculator",value:function(t,n,i){return i.value}}])}(),jI=function(){function r(){ce(this,r),this.parser=rO,this.mixer=cI}return de(r,[{key:"calculator",value:function(t,n,i){return i instanceof kr&&i.value==="unset"?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Bs(0,0,0,0)}:i}}])}(),BI=de(function r(){ce(this,r),this.mixer=hI}),FI=function(r){function e(){var t;ce(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=Ge(this,e,[].concat(i)),t.mixer=hm(0,1/0),t}return We(e,r),de(e)}(cy),zI=function(){function r(){ce(this,r)}return de(r,[{key:"calculator",value:function(t,n,i,a){return i instanceof kr?i.value==="unset"?"":i.value:"".concat(i)}},{key:"postProcessor",value:function(t){t.nodeValue="".concat(t.parsedStyle.text)||""}}])}(),$I=function(){function r(){ce(this,r)}return de(r,[{key:"calculator",value:function(t,n,i,a){var s=a.getAttribute("text");if(s){var o=s;i.value==="capitalize"?o=s.charAt(0).toUpperCase()+s.slice(1):i.value==="lowercase"?o=s.toLowerCase():i.value==="uppercase"&&(o=s.toUpperCase()),a.parsedStyle.text=o}return i.value}}])}(),wh=new WeakMap;function qI(r,e,t){if(r){var n=typeof r=="string"?document.getElementById(r):r;wh.has(n)&&wh.get(n).destroy(t),wh.set(n,e)}}var gm=typeof window<"u"&&typeof window.document<"u";function GI(r){return!!r.getAttribute}function WI(r,e){for(var t=0,n=r.length;t<n;){var i=t+n>>>1;uO(r[i],e)<0?t=i+1:n=i}return t}function uO(r,e){var t=Number(r.parsedStyle.zIndex||0),n=Number(e.parsedStyle.zIndex||0);if(t===n){var i=r.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(r)-a.indexOf(e)}}return t-n}function lO(r){var e=r;do{var t,n=(t=e.parsedStyle)===null||t===void 0?void 0:t.clipPath;if(n)return e;e=e.parentElement}while(e!==null);return null}var vb="px";function VI(r,e,t){gm&&r.style&&(r.style.width=e+vb,r.style.height=t+vb)}function cO(r,e){if(gm)return document.defaultView.getComputedStyle(r,null).getPropertyValue(e)}function YI(r){var e=cO(r,"width");return e==="auto"?r.offsetWidth:parseFloat(e)}function UI(r){var e=cO(r,"height");return e==="auto"?r.offsetHeight:parseFloat(e)}var HI=1,XI={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},dy=typeof performance=="object"&&performance.now?performance:Date;function ec(r){return r.nodeName===re.FRAGMENT?!0:r.getRootNode().nodeName===re.FRAGMENT}function Qa(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"auto",e=arguments.length>1?arguments[1]:void 0,t=arguments.length>2?arguments[2]:void 0,n=!1,i=!1,a=!!e&&!e.isNone,s=!!t&&!t.isNone;return r==="visiblepainted"||r==="painted"||r==="auto"?(n=a,i=s):r==="visiblefill"||r==="fill"?n=!0:r==="visiblestroke"||r==="stroke"?i=!0:(r==="visible"||r==="all")&&(n=!0,i=!0),[n,i]}var KI=1,ZI=function(){return KI++},oi=typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:{},QI=Date.now(),JI=function(){return oi.performance&&typeof oi.performance.now=="function"?oi.performance.now():Date.now()-QI},po={},yb=Date.now(),eR=function(e){if(typeof e!="function")throw new TypeError("".concat(e," is not a function"));var t=Date.now(),n=t-yb,i=n>16?0:16-n,a=ZI();return po[a]=e,Object.keys(po).length>1||setTimeout(function(){yb=t;var s=po;po={},Object.keys(s).forEach(function(o){return s[o](JI())})},i),a},tR=function(e){delete po[e]},nR=["","webkit","moz","ms","o"],dO=function(e){return typeof e!="string"?eR:e===""?oi.requestAnimationFrame:oi["".concat(e,"RequestAnimationFrame")]},rR=function(e){return typeof e!="string"?tR:e===""?oi.cancelAnimationFrame:oi["".concat(e,"CancelAnimationFrame")]||oi["".concat(e,"CancelRequestAnimationFrame")]},iR=function(e,t){for(var n=0;e[n]!==void 0;){if(t(e[n]))return e[n];n+=1}},hO=iR(nR,function(r){return!!dO(r)}),pm=dO(hO),fO=rR(hO);oi.requestAnimationFrame=pm;oi.cancelAnimationFrame=fO;var aR=function(){function r(){ce(this,r),this.callbacks=[]}return de(r,[{key:"getCallbacksNum",value:function(){return this.callbacks.length}},{key:"tapPromise",value:function(t,n){this.callbacks.push(n)}},{key:"promise",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return Promise.all(this.callbacks.map(function(a){return a.apply(void 0,n)}))}}])}(),sR=function(){function r(){ce(this,r),this.callbacks=[]}return de(r,[{key:"tapPromise",value:function(t,n){this.callbacks.push(n)}},{key:"promise",value:function(){var e=da(Mn().mark(function n(){var i,a,s,o,u=arguments;return Mn().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!this.callbacks.length){c.next=14;break}return c.next=3,(i=this.callbacks)[0].apply(i,u);case 3:a=c.sent,s=0;case 5:if(!(s<this.callbacks.length-1)){c.next=13;break}return o=this.callbacks[s],c.next=9,o(a);case 9:a=c.sent;case 10:s++,c.next=5;break;case 13:return c.abrupt("return",a);case 14:return c.abrupt("return",null);case 15:case"end":return c.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()}])}(),Rn=function(){function r(){ce(this,r),this.callbacks=[]}return de(r,[{key:"tap",value:function(t,n){this.callbacks.push(n)}},{key:"call",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var a=arguments;this.callbacks.forEach(function(s){s.apply(void 0,a)})}}])}(),xh=function(){function r(){ce(this,r),this.callbacks=[]}return de(r,[{key:"tap",value:function(t,n){this.callbacks.push(n)}},{key:"call",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];if(this.callbacks.length){for(var a=arguments,s=this.callbacks[0].apply(void 0,a),o=0;o<this.callbacks.length-1;o++){var u=this.callbacks[o];s=u(s)}return s}return null}}])}(),oR=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],uR=/([\"\'])[^\'\"]+\1/;function lR(r){for(var e=r.fontSize,t=e===void 0?16:e,n=r.fontFamily,i=n===void 0?"sans-serif":n,a=r.fontStyle,s=a===void 0?"normal":a,o=r.fontVariant,u=o===void 0?"normal":o,l=r.fontWeight,c=l===void 0?"normal":l,d=Ee(t)&&"".concat(t,"px")||"16px",h=i.split(","),f=h.length-1;f>=0;f--){var g=h[f].trim();!uR.test(g)&&oR.indexOf(g)<0&&(g='"'.concat(g,'"')),h[f]=g}return"".concat(s," ").concat(u," ").concat(c," ").concat(d," ").concat(h.join(","))}function Eh(r,e,t){return ua(r),r[4]=Math.tan(e),r[1]=Math.tan(t),r}var Wt=ht(),cR=ht(),dR={scale:function(e){Aa(Wt,[e[0].value,e[1].value,1])},scaleX:function(e){Aa(Wt,[e[0].value,1,1])},scaleY:function(e){Aa(Wt,[1,e[0].value,1])},scaleZ:function(e){Aa(Wt,[1,1,e[0].value])},scale3d:function(e){Aa(Wt,[e[0].value,e[1].value,e[2].value])},translate:function(e){Ui(Wt,[e[0].value,e[1].value,0])},translateX:function(e){Ui(Wt,[e[0].value,0,0])},translateY:function(e){Ui(Wt,[0,e[0].value,0])},translateZ:function(e){Ui(Wt,[0,0,e[0].value])},translate3d:function(e){Ui(Wt,[e[0].value,e[1].value,e[2].value])},rotate:function(e){W0(Wt,at(Qn(e[0])))},rotateX:function(e){hT(Wt,at(Qn(e[0])))},rotateY:function(e){fT(Wt,at(Qn(e[0])))},rotateZ:function(e){W0(Wt,at(Qn(e[0])))},rotate3d:function(e){dT(Wt,at(Qn(e[3])),[e[0].value,e[1].value,e[2].value])},skew:function(e){Eh(Wt,at(e[0].value),at(e[1].value))},skewX:function(e){Eh(Wt,at(e[0].value),0)},skewY:function(e){Eh(Wt,0,at(e[0].value))},matrix:function(e){G0(Wt,e[0].value,e[1].value,0,0,e[2].value,e[3].value,0,0,0,0,1,0,e[4].value,e[5].value,0,1)},matrix3d:function(e){G0.apply(lL,[Wt].concat(pt(e.map(function(t){return t.value}))))}},hR=vt(1,1,1),fR=Ze(),mb={translate:function(e,t){fe.sceneGraphService.setLocalScale(e,hR,!1),fe.sceneGraphService.setLocalEulerAngles(e,fR,void 0,void 0,!1),fe.sceneGraphService.setLocalPosition(e,[t[0].value,t[1].value,0],!1),fe.sceneGraphService.dirtifyLocal(e,e.transformable)}};function gO(r,e){if(r.length){if(r.length===1&&mb[r[0].t]){mb[r[0].t](e,r[0].d);return}for(var t=ua(cR),n=0;n<r.length;n++){var i=r[n],a=i.t,s=i.d,o=dR[a];o&&(o(s),xT(t,t,Wt))}e.setLocalTransform(t)}else e.resetLocalTransform();return e.getLocalTransform()}var gR=function(){function r(){ce(this,r),this.parser=fI,this.mixer=EI}return de(r,[{key:"calculator",value:function(t,n,i,a){return i instanceof kr?[]:i}},{key:"postProcessor",value:function(t){gO(t.parsedStyle.transform,t)}}])}(),pR=function(){function r(){ce(this,r)}return de(r,[{key:"postProcessor",value:function(t){var n=t.parsedStyle.transformOrigin;n[0].unit===we.kPixels&&n[1].unit===we.kPixels?t.setOrigin(n[0].value,n[1].value):t.getGeometryBounds()}}])}(),vR=function(){function r(){ce(this,r)}return de(r,[{key:"calculator",value:function(t,n,i,a){return i.value}},{key:"postProcessor",value:function(t){if(t.parentNode){var n=t.parentNode,i=n.renderable,a=n.sortable;i&&(i.dirty=!0),a&&(a.dirty=!0,a.dirtyReason=Zl.Z_INDEX_CHANGED)}}}])}(),yR=function(){function r(){ce(this,r)}return de(r,[{key:"update",value:function(t,n){var i=t.cx,a=i===void 0?0:i,s=t.cy,o=s===void 0?0:s,u=t.r,l=u===void 0?0:u;return{cx:a,cy:o,hwidth:l,hheight:l}}}])}(),mR=function(){function r(){ce(this,r)}return de(r,[{key:"update",value:function(t,n){var i=t.cx,a=i===void 0?0:i,s=t.cy,o=s===void 0?0:s,u=t.rx,l=u===void 0?0:u,c=t.ry,d=c===void 0?0:c;return{cx:a,cy:o,hwidth:l,hheight:d}}}])}(),bR=function(){function r(){ce(this,r)}return de(r,[{key:"update",value:function(t){var n=t.x1,i=t.y1,a=t.x2,s=t.y2,o=Math.min(n,a),u=Math.max(n,a),l=Math.min(i,s),c=Math.max(i,s),d=u-o,h=c-l,f=d/2,g=h/2;return{cx:o+f,cy:l+g,hwidth:f,hheight:g}}}])}(),wR=function(){function r(){ce(this,r)}return de(r,[{key:"update",value:function(t){var n=t.d,i=n.rect,a=i.x,s=i.y,o=i.width,u=i.height,l=o/2,c=u/2;return{cx:a+l,cy:s+c,hwidth:l,hheight:c}}}])}(),xR=function(){function r(){ce(this,r)}return de(r,[{key:"update",value:function(t){if(t.points&&gr(t.points.points)){var n=t.points.points,i=Math.min.apply(Math,pt(n.map(function(h){return h[0]}))),a=Math.max.apply(Math,pt(n.map(function(h){return h[0]}))),s=Math.min.apply(Math,pt(n.map(function(h){return h[1]}))),o=Math.max.apply(Math,pt(n.map(function(h){return h[1]}))),u=a-i,l=o-s,c=u/2,d=l/2;return{cx:i+c,cy:s+d,hwidth:c,hheight:d}}return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),ER=function(){function r(){ce(this,r)}return de(r,[{key:"update",value:function(t,n){var i=t.x,a=i===void 0?0:i,s=t.y,o=s===void 0?0:s,u=t.src,l=t.width,c=l===void 0?0:l,d=t.height,h=d===void 0?0:d,f=c,g=h;return u&&!tt(u)&&(f||(f=u.width,t.width=f),g||(g=u.height,t.height=g)),{cx:a+f/2,cy:o+g/2,hwidth:f/2,hheight:g/2}}}])}(),MR=function(){function r(e){ce(this,r),this.globalRuntime=e}return de(r,[{key:"isReadyToMeasure",value:function(t,n){var i=t.text;return i}},{key:"update",value:function(t,n){var i,a=t.text,s=t.textAlign,o=s===void 0?"start":s,u=t.lineWidth,l=u===void 0?1:u,c=t.textBaseline,d=c===void 0?"alphabetic":c,h=t.dx,f=h===void 0?0:h,g=t.dy,v=g===void 0?0:g,p=t.x,y=p===void 0?0:p,m=t.y,w=m===void 0?0:m;if(!this.isReadyToMeasure(t,n))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var M=(n==null||(i=n.ownerDocument)===null||i===void 0||(i=i.defaultView)===null||i===void 0?void 0:i.getConfig())||{},S=M.offscreenCanvas,T=this.globalRuntime.textService.measureText(a,t,S);t.metrics=T;var A=T.width,O=T.height,N=A/2,C=O/2,P=y+N;o==="center"||o==="middle"?P+=l/2-N:(o==="right"||o==="end")&&(P+=l-N*2);var D=w-C;return d==="middle"?D+=C:d==="top"||d==="hanging"?D+=C*2:d==="alphabetic"||(d==="bottom"||d==="ideographic")&&(D+=0),f&&(P+=f),v&&(D+=v),{cx:P,cy:D,hwidth:N,hheight:C}}}])}(),SR=function(){function r(){ce(this,r)}return de(r,[{key:"update",value:function(t,n){return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),_R=function(){function r(){ce(this,r)}return de(r,[{key:"update",value:function(t,n){var i=t.x,a=i===void 0?0:i,s=t.y,o=s===void 0?0:s,u=t.width,l=u===void 0?0:u,c=t.height,d=c===void 0?0:c;return{cx:a+l/2,cy:o+d/2,hwidth:l/2,hheight:d/2}}}])}(),Ac=function(){function r(e){ce(this,r),this.eventPhase=r.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new xn,this.page=new xn,this.canvas=new xn,this.viewport=new xn,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}return de(r,[{key:"name",get:function(){return this.type}},{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewportX",get:function(){return this.viewport.x}},{key:"viewportY",get:function(){return this.viewport.y}},{key:"composedPath",value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}},{key:"propagationPath",get:function(){return this.composedPath()}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw new Error(it)}}])}(),pO=function(r){function e(){var t;ce(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=Ge(this,e,[].concat(i)),t.client=new xn,t.movement=new xn,t.offset=new xn,t.global=new xn,t.screen=new xn,t}return We(e,r),de(e,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getModifierState",value:function(n){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(n)}},{key:"initMouseEvent",value:function(){throw new Error(it)}}])}(Ac),tc=function(r){function e(){var t;ce(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=Ge(this,e,[].concat(i)),t.width=0,t.height=0,t.isPrimary=!1,t}return We(e,r),de(e,[{key:"getCoalescedEvents",value:function(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this)}}])}(pO),hy=function(r){function e(){return ce(this,e),Ge(this,e,arguments)}return We(e,r),de(e,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this)}}])}(pO),Kt=function(r){function e(t,n){var i;return ce(this,e),i=Ge(this,e,[null]),i.type=t,i.detail=n,Object.assign(i,n),i}return We(e,r),de(e)}(Ac),bb=new WeakMap,vO=function(){function r(){ce(this,r),this.emitter=new nT}return de(r,[{key:"on",value:function(t,n,i){return this.addEventListener(t,n,i),this}},{key:"addEventListener",value:function(t,n,i){var a=!1,s=!1;if(Yl(i))a=i;else if(i){var o=i.capture;a=o===void 0?!1:o;var u=i.once;s=u===void 0?!1:u}a&&(t+="capture"),n=Te(n)?n:n.handleEvent;var l=Te(n)?void 0:n;return s?this.emitter.once(t,n,l):this.emitter.on(t,n,l),this}},{key:"off",value:function(t,n,i){return t?this.removeEventListener(t,n,i):this.removeAllEventListeners(),this}},{key:"removeAllEventListeners",value:function(){var t;(t=this.emitter)===null||t===void 0||t.removeAllListeners()}},{key:"removeEventListener",value:function(t,n,i){var a;if(!this.emitter)return this;var s=Yl(i)?i:i==null?void 0:i.capture;s&&(t+="capture"),n=Te(n)?n:(a=n)===null||a===void 0?void 0:a.handleEvent;var o=Te(n)?void 0:n;return this.emitter.off(t,n,o),this}},{key:"emit",value:function(t,n){this.dispatchEvent(new Kt(t,n))}},{key:"dispatchEvent",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=bb.get(this);if(!i){var a;this.document?i=this:this.defaultView?i=this.defaultView:i=(a=this.ownerDocument)===null||a===void 0?void 0:a.defaultView,i&&bb.set(this,i)}if(i){if(t.manager=i.getEventService(),!t.manager)return!1;t.defaultPrevented=!1,t.path?t.path.length=0:t.page=[],n||(t.target=this),t.manager.dispatchEvent(t,t.type,n)}else this.emitter.emit(t.type,t);return!t.defaultPrevented}}])}(),Ct=function(r){function e(){var t;ce(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=Ge(this,e,[].concat(i)),t.shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.parentNode=null,t}return We(e,r),de(e,[{key:"textContent",get:function(){var n="";this.nodeName===re.TEXT&&(n+=this.style.text);var i=ka(this.childNodes),a;try{for(i.s();!(a=i.n()).done;){var s=a.value;s.nodeName===re.TEXT?n+=s.nodeValue:n+=s.textContent}}catch(o){i.e(o)}finally{i.f()}return n},set:function(n){var i=this;this.childNodes.slice().forEach(function(a){i.removeChild(a)}),this.nodeName===re.TEXT&&(this.style.text="".concat(n))}},{key:"getRootNode",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(n):n.composed&&this.host?this.host.getRootNode(n):this}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0}},{key:"isDefaultNamespace",value:function(n){throw new Error(it)}},{key:"lookupNamespaceURI",value:function(n){throw new Error(it)}},{key:"lookupPrefix",value:function(n){throw new Error(it)}},{key:"normalize",value:function(){throw new Error(it)}},{key:"isEqualNode",value:function(n){return this===n}},{key:"isSameNode",value:function(n){return this.isEqualNode(n)}},{key:"parent",get:function(){return this.parentNode}},{key:"parentElement",get:function(){return null}},{key:"nextSibling",get:function(){return null}},{key:"previousSibling",get:function(){return null}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null}},{key:"compareDocumentPosition",value:function(n){if(n===this)return 0;for(var i=n,a=this,s=[i],o=[a];(u=i.parentNode)!==null&&u!==void 0?u:a.parentNode;){var u;i=i.parentNode?(s.push(i.parentNode),i.parentNode):i,a=a.parentNode?(o.push(a.parentNode),a.parentNode):a}if(i!==a)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var l=s.length>o.length?s:o,c=l===s?o:s;if(l[l.length-c.length]===c[0])return l===s?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var d=l.length-c.length,h=c.length-1;h>=0;h--){var f=c[h],g=l[d+h];if(g!==f){var v=f.parentNode.childNodes;return v.indexOf(f)<v.indexOf(g)?c===s?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING:l===s?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING}}return e.DOCUMENT_POSITION_FOLLOWING}},{key:"contain",value:function(n){return this.contains(n)}},{key:"contains",value:function(n){for(var i=n;i&&this!==i;)i=i.parentNode;return!!i}},{key:"getAncestor",value:function(n){for(var i=this;n>0&&i;)i=i.parentNode,n--;return i}},{key:"forEach",value:function(n){for(var i=[this];i.length>0;){var a=i.pop(),s=n(a);if(s===!1)break;for(var o=a.childNodes.length-1;o>=0;o--)i.push(a.childNodes[o])}}}],[{key:"isNode",value:function(n){return!!n.childNodes}}])}(vO);Ct.DOCUMENT_POSITION_DISCONNECTED=1;Ct.DOCUMENT_POSITION_PRECEDING=2;Ct.DOCUMENT_POSITION_FOLLOWING=4;Ct.DOCUMENT_POSITION_CONTAINS=8;Ct.DOCUMENT_POSITION_CONTAINED_BY=16;Ct.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;var TR=2048,OR=function(){function r(e,t){var n=this;ce(this,r),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=ht(),this.tmpVec3=Ze(),this.onPointerDown=function(i){var a=n.createPointerEvent(i);if(n.dispatchEvent(a,"pointerdown"),a.pointerType==="touch")n.dispatchEvent(a,"touchstart");else if(a.pointerType==="mouse"||a.pointerType==="pen"){var s=a.button===2;n.dispatchEvent(a,s?"rightdown":"mousedown")}var o=n.trackingData(i.pointerId);o.pressTargetsByButton[i.button]=a.composedPath(),n.freeEvent(a)},this.onPointerUp=function(i){var a=dy.now(),s=n.createPointerEvent(i,void 0,void 0,n.context.config.alwaysTriggerPointerEventOnCanvas?n.rootTarget:void 0);if(n.dispatchEvent(s,"pointerup"),s.pointerType==="touch")n.dispatchEvent(s,"touchend");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var o=s.button===2;n.dispatchEvent(s,o?"rightup":"mouseup")}var u=n.trackingData(i.pointerId),l=n.findMountedTarget(u.pressTargetsByButton[i.button]),c=l;if(l&&!s.composedPath().includes(l)){for(var d=l;d&&!s.composedPath().includes(d);){if(s.currentTarget=d,n.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch")n.notifyTarget(s,"touchendoutside");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var h=s.button===2;n.notifyTarget(s,h?"rightupoutside":"mouseupoutside")}Ct.isNode(d)&&(d=d.parentNode)}delete u.pressTargetsByButton[i.button],c=d}if(c){var f,g=n.clonePointerEvent(s,"click");g.target=c,g.path=[],u.clicksByButton[i.button]||(u.clicksByButton[i.button]={clickCount:0,target:g.target,timeStamp:a});var v=n.context.renderingContext.root.ownerDocument.defaultView,p=u.clicksByButton[i.button];p.target===g.target&&a-p.timeStamp<v.getConfig().dblClickSpeed?++p.clickCount:p.clickCount=1,p.target=g.target,p.timeStamp=a,g.detail=p.clickCount,(f=s.detail)!==null&&f!==void 0&&f.preventClick||(!n.context.config.useNativeClickEvent&&(g.pointerType==="mouse"||g.pointerType==="touch")&&n.dispatchEvent(g,"click"),n.dispatchEvent(g,"pointertap")),n.freeEvent(g)}n.freeEvent(s)},this.onPointerMove=function(i){var a=n.createPointerEvent(i,void 0,void 0,n.context.config.alwaysTriggerPointerEventOnCanvas?n.rootTarget:void 0),s=a.pointerType==="mouse"||a.pointerType==="pen",o=n.trackingData(i.pointerId),u=n.findMountedTarget(o.overTargets);if(o.overTargets&&u!==a.target){var l=i.type==="mousemove"?"mouseout":"pointerout",c=n.createPointerEvent(i,l,u||void 0);if(n.dispatchEvent(c,"pointerout"),s&&n.dispatchEvent(c,"mouseout"),!a.composedPath().includes(u)){var d=n.createPointerEvent(i,"pointerleave",u||void 0);for(d.eventPhase=d.AT_TARGET;d.target&&!a.composedPath().includes(d.target);)d.currentTarget=d.target,n.notifyTarget(d),s&&n.notifyTarget(d,"mouseleave"),Ct.isNode(d.target)&&(d.target=d.target.parentNode);n.freeEvent(d)}n.freeEvent(c)}if(u!==a.target){var h=i.type==="mousemove"?"mouseover":"pointerover",f=n.clonePointerEvent(a,h);n.dispatchEvent(f,"pointerover"),s&&n.dispatchEvent(f,"mouseover");for(var g=u&&Ct.isNode(u)&&u.parentNode;g&&g!==(Ct.isNode(n.rootTarget)&&n.rootTarget.parentNode)&&g!==a.target;)g=g.parentNode;var v=!g||g===(Ct.isNode(n.rootTarget)&&n.rootTarget.parentNode);if(v){var p=n.clonePointerEvent(a,"pointerenter");for(p.eventPhase=p.AT_TARGET;p.target&&p.target!==u&&p.target!==(Ct.isNode(n.rootTarget)&&n.rootTarget.parentNode);)p.currentTarget=p.target,n.notifyTarget(p),s&&n.notifyTarget(p,"mouseenter"),Ct.isNode(p.target)&&(p.target=p.target.parentNode);n.freeEvent(p)}n.freeEvent(f)}n.dispatchEvent(a,"pointermove"),a.pointerType==="touch"&&n.dispatchEvent(a,"touchmove"),s&&(n.dispatchEvent(a,"mousemove"),n.cursor=n.getCursor(a.target)),o.overTargets=a.composedPath(),n.freeEvent(a)},this.onPointerOut=function(i){var a=n.trackingData(i.pointerId);if(a.overTargets){var s=i.pointerType==="mouse"||i.pointerType==="pen",o=n.findMountedTarget(a.overTargets),u=n.createPointerEvent(i,"pointerout",o||void 0);n.dispatchEvent(u),s&&n.dispatchEvent(u,"mouseout");var l=n.createPointerEvent(i,"pointerleave",o||void 0);for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==(Ct.isNode(n.rootTarget)&&n.rootTarget.parentNode);)l.currentTarget=l.target,n.notifyTarget(l),s&&n.notifyTarget(l,"mouseleave"),Ct.isNode(l.target)&&(l.target=l.target.parentNode);a.overTargets=null,n.freeEvent(u),n.freeEvent(l)}n.cursor=null},this.onPointerOver=function(i){var a=n.trackingData(i.pointerId),s=n.createPointerEvent(i),o=s.pointerType==="mouse"||s.pointerType==="pen";n.dispatchEvent(s,"pointerover"),o&&n.dispatchEvent(s,"mouseover"),s.pointerType==="mouse"&&(n.cursor=n.getCursor(s.target));var u=n.clonePointerEvent(s,"pointerenter");for(u.eventPhase=u.AT_TARGET;u.target&&u.target!==(Ct.isNode(n.rootTarget)&&n.rootTarget.parentNode);)u.currentTarget=u.target,n.notifyTarget(u),o&&n.notifyTarget(u,"mouseenter"),Ct.isNode(u.target)&&(u.target=u.target.parentNode);a.overTargets=s.composedPath(),n.freeEvent(s),n.freeEvent(u)},this.onPointerUpOutside=function(i){var a=n.trackingData(i.pointerId),s=n.findMountedTarget(a.pressTargetsByButton[i.button]),o=n.createPointerEvent(i);if(s){for(var u=s;u;)o.currentTarget=u,n.notifyTarget(o,"pointerupoutside"),o.pointerType==="touch"||(o.pointerType==="mouse"||o.pointerType==="pen")&&n.notifyTarget(o,o.button===2?"rightupoutside":"mouseupoutside"),Ct.isNode(u)&&(u=u.parentNode);delete a.pressTargetsByButton[i.button]}n.freeEvent(o)},this.onWheel=function(i){var a=n.createWheelEvent(i);n.dispatchEvent(a),n.freeEvent(a)},this.onClick=function(i){if(n.context.config.useNativeClickEvent){var a=n.createPointerEvent(i);n.dispatchEvent(a),n.freeEvent(a)}},this.onPointerCancel=function(i){var a=n.createPointerEvent(i,void 0,void 0,n.context.config.alwaysTriggerPointerEventOnCanvas?n.rootTarget:void 0);n.dispatchEvent(a),n.freeEvent(a)},this.globalRuntime=e,this.context=t}return de(r,[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)}},{key:"destroy",value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear()}},{key:"getScale",value:function(){var t=this.context.contextService.getBoundingClientRect(),n=1,i=1,a=this.context.contextService.getDomElement();if(a&&t){var s=a.offsetWidth,o=a.offsetHeight;s&&o&&(n=t.width/s,i=t.height/o)}return{scaleX:n,scaleY:i,bbox:t}}},{key:"client2Viewport",value:function(t){var n=this.getScale(),i=n.scaleX,a=n.scaleY,s=n.bbox;return new xn((t.x-((s==null?void 0:s.left)||0))/i,(t.y-((s==null?void 0:s.top)||0))/a)}},{key:"viewport2Client",value:function(t){var n=this.getScale(),i=n.scaleX,a=n.scaleY,s=n.bbox;return new xn((t.x+((s==null?void 0:s.left)||0))*i,(t.y+((s==null?void 0:s.top)||0))*a)}},{key:"viewport2Canvas",value:function(t){var n=t.x,i=t.y,a=this.rootTarget.defaultView,s=a.getCamera(),o=this.context.config,u=o.width,l=o.height,c=s.getPerspectiveInverse(),d=s.getWorldTransform(),h=Dn(this.tmpMatrix,d,c),f=Ln(this.tmpVec3,n/u*2-1,(1-i/l)*2-1,0);return In(f,f,h),new xn(f[0],f[1])}},{key:"canvas2Viewport",value:function(t){var n=this.rootTarget.defaultView,i=n.getCamera(),a=i.getPerspective(),s=i.getViewTransform(),o=Dn(this.tmpMatrix,a,s),u=Ln(this.tmpVec3,t.x,t.y,0);In(this.tmpVec3,this.tmpVec3,o);var l=this.context.config,c=l.width,d=l.height;return new xn((u[0]+1)/2*c,(1-(u[1]+1)/2)*d)}},{key:"setPickHandler",value:function(t){this.pickHandler=t}},{key:"addEventMapping",value:function(t,n){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:n,priority:0}),this.mappingTable[t].sort(function(i,a){return i.priority-a.priority})}},{key:"mapEvent",value:function(t){if(this.rootTarget){var n=this.mappingTable[t.type];if(n)for(var i=0,a=n.length;i<a;i++)n[i].fn(t);else console.warn("[EventService]: Event mapping not defined for ".concat(t.type))}}},{key:"dispatchEvent",value:function(t,n,i){if(!i)t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,n);else{t.eventPhase=t.AT_TARGET;var a=this.rootTarget.defaultView||null;t.currentTarget=a,this.notifyListeners(t,n)}}},{key:"propagate",value:function(t,n){if(t.target){var i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var a=i.length-1;a>=1;a--)if(t.currentTarget=i[a],this.notifyTarget(t,n),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,n),!(t.propagationStopped||t.propagationImmediatelyStopped)){var s=i.indexOf(t.currentTarget);t.eventPhase=t.BUBBLING_PHASE;for(var o=s+1;o<i.length;o++)if(t.currentTarget=i[o],this.notifyTarget(t,n),t.propagationStopped||t.propagationImmediatelyStopped)return}}}},{key:"propagationPath",value:function(t){var n=[t],i=this.rootTarget.defaultView||null;if(i&&i===t)return n.unshift(i.document),n;for(var a=0;a<TR&&t!==this.rootTarget;a++)Ct.isNode(t)&&t.parentNode&&(n.push(t.parentNode),t=t.parentNode);return i&&n.push(i),n}},{key:"hitTest",value:function(t){var n=t.viewportX,i=t.viewportY,a=this.context.config,s=a.width,o=a.height,u=a.disableHitTesting;return n<0||i<0||n>s||i>o?null:!u&&this.pickHandler(t)||this.rootTarget||null}},{key:"isNativeEventFromCanvas",value:function(t,n){var i,a=n==null?void 0:n.target;if((i=a)!==null&&i!==void 0&&i.shadowRoot&&(a=n.composedPath()[0]),a){if(a===t)return!0;if(t&&t.contains)return t.contains(a)}return n!=null&&n.composedPath?n.composedPath().indexOf(t)>-1:!1}},{key:"getExistedHTML",value:function(t){if(t.nativeEvent.composedPath)for(var n=0,i=t.nativeEvent.composedPath();n<i.length;n++){var a=i[n],s=this.nativeHTMLMap.get(a);if(s)return s}return null}},{key:"pickTarget",value:function(t){return this.hitTest({clientX:t.clientX,clientY:t.clientY,viewportX:t.viewportX,viewportY:t.viewportY,x:t.canvasX,y:t.canvasY})}},{key:"createPointerEvent",value:function(t,n,i,a){var s=this.allocateEvent(tc);this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.nativeEvent=t.nativeEvent,s.originalEvent=t;var o=this.getExistedHTML(s),u=this.context.contextService.getDomElement();return s.target=i??(o||this.isNativeEventFromCanvas(u,s.nativeEvent)&&this.pickTarget(s)||a),typeof n=="string"&&(s.type=n),s}},{key:"createWheelEvent",value:function(t){var n=this.allocateEvent(hy);this.copyWheelData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.nativeEvent=t.nativeEvent,n.originalEvent=t;var i=this.getExistedHTML(n),a=this.context.contextService.getDomElement();return n.target=i||this.isNativeEventFromCanvas(a,n.nativeEvent)&&this.pickTarget(n),n}},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}},{key:"cloneWheelEvent",value:function(t){var n=this.allocateEvent(hy);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyWheelData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=t.type,n}},{key:"clonePointerEvent",value:function(t,n){var i=this.allocateEvent(tc);return i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice(),i.type=n??i.type,i}},{key:"copyPointerData",value:function(t,n){n.pointerId=t.pointerId,n.width=t.width,n.height=t.height,n.isPrimary=t.isPrimary,n.pointerType=t.pointerType,n.pressure=t.pressure,n.tangentialPressure=t.tangentialPressure,n.tiltX=t.tiltX,n.tiltY=t.tiltY,n.twist=t.twist}},{key:"copyMouseData",value:function(t,n){n.altKey=t.altKey,n.button=t.button,n.buttons=t.buttons,n.ctrlKey=t.ctrlKey,n.metaKey=t.metaKey,n.shiftKey=t.shiftKey,n.client.copyFrom(t.client),n.movement.copyFrom(t.movement),n.canvas.copyFrom(t.canvas),n.screen.copyFrom(t.screen),n.global.copyFrom(t.global),n.offset.copyFrom(t.offset)}},{key:"copyWheelData",value:function(t,n){n.deltaMode=t.deltaMode,n.deltaX=t.deltaX,n.deltaY=t.deltaY,n.deltaZ=t.deltaZ}},{key:"copyData",value:function(t,n){n.isTrusted=t.isTrusted,n.timeStamp=dy.now(),n.type=t.type,n.detail=t.detail,n.view=t.view,n.page.copyFrom(t.page),n.viewport.copyFrom(t.viewport)}},{key:"allocateEvent",value:function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var n=this.eventPool.get(t).pop()||new t(this);return n.eventPhase=n.NONE,n.currentTarget=null,n.path=[],n.target=null,n}},{key:"freeEvent",value:function(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var n=t.constructor;this.eventPool.has(n)||this.eventPool.set(n,[]),this.eventPool.get(n).push(t)}},{key:"notifyTarget",value:function(t,n){n=n??t.type;var i=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(n,"capture"):n;this.notifyListeners(t,i),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,n)}},{key:"notifyListeners",value:function(t,n){var i=t.currentTarget.emitter,a=i._events[n];if(a)if("fn"in a)a.once&&i.removeListener(n,a.fn,void 0,!0),a.fn.call(t.currentTarget||a.context,t);else for(var s=0;s<a.length&&!t.propagationImmediatelyStopped;s++)a[s].once&&i.removeListener(n,a[s].fn,void 0,!0),a[s].fn.call(t.currentTarget||a[s].context,t)}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var n=t[t.length-1],i=t.length-2;i>=0;i--){var a=t[i];if(a===this.rootTarget||Ct.isNode(a)&&a.parentNode===n)n=t[i];else break}return n}},{key:"getCursor",value:function(t){for(var n=t;n;){var i=GI(n)&&n.getAttribute("cursor");if(i)return i;n=Ct.isNode(n)&&n.parentNode}}}])}(),vm=function(){function r(){ce(this,r)}return de(r,[{key:"getOrCreateCanvas",value:function(t,n){if(this.canvas)return this.canvas;if(t||fe.offscreenCanvas)this.canvas=t||fe.offscreenCanvas,this.context=this.canvas.getContext("2d",qe({willReadFrequently:!0},n));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",qe({willReadFrequently:!0},n)),(!this.context||!this.context.measureText)&&(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch{this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",qe({willReadFrequently:!0},n))}return this.canvas.width=10,this.canvas.height=10,this.canvas}},{key:"getOrCreateContext",value:function(t,n){return this.context?this.context:(this.getOrCreateCanvas(t,n),this.context)}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0)}catch{}try{return document.createElement("canvas")}catch{}return null}}])}(),Ps=function(r){return r[r.CAMERA_CHANGED=0]="CAMERA_CHANGED",r[r.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",r[r.NONE=2]="NONE",r}({}),AR=function(){function r(e,t){ce(this,r),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new Rn,initAsync:new aR,dirtycheck:new xh,cull:new xh,beginFrame:new Rn,beforeRender:new Rn,render:new Rn,afterRender:new Rn,endFrame:new Rn,destroy:new Rn,pick:new sR,pickSync:new xh,pointerDown:new Rn,pointerUp:new Rn,pointerMove:new Rn,pointerOut:new Rn,pointerOver:new Rn,pointerWheel:new Rn,pointerCancel:new Rn,click:new Rn},this.globalRuntime=e,this.context=t}return de(r,[{key:"init",value:function(t){var n=this,i=qe(qe({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(a){a.apply(i,n.globalRuntime)}),this.hooks.init.call(),this.hooks.initAsync.getCallbacksNum()===0?(this.inited=!0,t()):this.hooks.initAsync.promise().then(function(){n.inited=!0,t()}).catch(function(a){})}},{key:"getStats",value:function(){return this.stats}},{key:"disableDirtyRectangleRendering",value:function(){var t=this.context.config.renderer,n=t.getConfig(),i=n.enableDirtyRectangleRendering;return!i||this.context.renderingContext.renderReasons.has(Ps.CAMERA_CHANGED)}},{key:"render",value:function(t,n,i){var a=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var s=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(s.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),s.renderReasons.size&&this.inited){s.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var o=s.renderReasons.size===1&&s.renderReasons.has(Ps.CAMERA_CHANGED),u=!t.disableRenderHooks||!(t.disableRenderHooks&&o);u&&this.renderDisplayObject(s.root,t,s),this.hooks.beginFrame.call(n),u&&s.renderListCurrentFrame.forEach(function(l){a.hooks.beforeRender.call(l),a.hooks.render.call(l),a.hooks.afterRender.call(l)}),this.hooks.endFrame.call(n),s.renderListCurrentFrame=[],s.renderReasons.clear(),i()}}},{key:"renderDisplayObject",value:function(t,n,i){var a=this,s=n.renderer.getConfig(),o=s.enableDirtyCheck,u=s.enableCulling;function l(g){var v=g.renderable,p=g.sortable,y=o?v.dirty||i.dirtyRectangleRenderingDisabled?g:null:g;if(y){var m=u?a.hooks.cull.call(y,a.context.camera):y;m&&(a.stats.rendered+=1,i.renderListCurrentFrame.push(m))}v.dirty=!1,p.renderOrder=a.zIndexCounter,a.zIndexCounter+=1,a.stats.total+=1,p.dirty&&(a.sort(g,p),p.dirty=!1,p.dirtyChildren=[],p.dirtyReason=void 0)}for(var c=[t];c.length>0;){var d=c.pop();l(d);for(var h=d.sortable.sorted||d.childNodes,f=h.length-1;f>=0;f--)c.push(h[f])}}},{key:"sort",value:function(t,n){n.sorted&&n.dirtyReason!==Zl.Z_INDEX_CHANGED?n.dirtyChildren.forEach(function(i){var a=t.childNodes.indexOf(i);if(a===-1){var s=n.sorted.indexOf(i);s>=0&&n.sorted.splice(s,1)}else if(n.sorted.length===0)n.sorted.push(i);else{var o=WI(n.sorted,i);n.sorted.splice(o,0,i)}}):n.sorted=t.childNodes.slice().sort(uO)}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()}},{key:"dirtify",value:function(){this.context.renderingContext.renderReasons.add(Ps.DISPLAY_OBJECT_CHANGED)}}])}(),kR=/\[\s*(.*)=(.*)\s*\]/,NR=function(){function r(){ce(this,r)}return de(r,[{key:"selectOne",value:function(t,n){var i=this;if(t.startsWith("."))return n.find(function(u){return((u==null?void 0:u.classList)||[]).indexOf(i.getIdOrClassname(t))>-1});if(t.startsWith("#"))return n.find(function(u){return u.id===i.getIdOrClassname(t)});if(t.startsWith("[")){var a=this.getAttribute(t),s=a.name,o=a.value;return s?n.find(function(u){return n!==u&&(s==="name"?u.name===o:i.attributeToString(u,s)===o)}):null}return n.find(function(u){return n!==u&&u.nodeName===t})}},{key:"selectAll",value:function(t,n){var i=this;if(t.startsWith("."))return n.findAll(function(u){return n!==u&&((u==null?void 0:u.classList)||[]).indexOf(i.getIdOrClassname(t))>-1});if(t.startsWith("#"))return n.findAll(function(u){return n!==u&&u.id===i.getIdOrClassname(t)});if(t.startsWith("[")){var a=this.getAttribute(t),s=a.name,o=a.value;return s?n.findAll(function(u){return n!==u&&(s==="name"?u.name===o:i.attributeToString(u,s)===o)}):[]}return n.findAll(function(u){return n!==u&&u.nodeName===t})}},{key:"is",value:function(t,n){if(t.startsWith("."))return n.className===this.getIdOrClassname(t);if(t.startsWith("#"))return n.id===this.getIdOrClassname(t);if(t.startsWith("[")){var i=this.getAttribute(t),a=i.name,s=i.value;return a==="name"?n.name===s:this.attributeToString(n,a)===s}return n.nodeName===t}},{key:"getIdOrClassname",value:function(t){return t.substring(1)}},{key:"getAttribute",value:function(t){var n=t.match(kR),i="",a="";return n&&n.length>2&&(i=n[1].replace(/"/g,""),a=n[2].replace(/"/g,"")),{name:i,value:a}}},{key:"attributeToString",value:function(t,n){if(!t.getAttribute)return"";var i=t.getAttribute(n);return Le(i)?"":i.toString?i.toString():""}}])}(),He=function(r){return r.ATTR_MODIFIED="DOMAttrModified",r.INSERTED="DOMNodeInserted",r.MOUNTED="DOMNodeInsertedIntoDocument",r.REMOVED="removed",r.UNMOUNTED="DOMNodeRemovedFromDocument",r.REPARENT="reparent",r.DESTROY="destroy",r.BOUNDS_CHANGED="bounds-changed",r.CULLED="culled",r}({}),li=function(r){function e(t,n,i,a,s,o,u,l){var c;return ce(this,e),c=Ge(this,e,[null]),c.relatedNode=n,c.prevValue=i,c.newValue=a,c.attrName=s,c.attrChange=o,c.prevParsedValue=u,c.newParsedValue=l,c.type=t,c}return We(e,r),de(e)}(Ac);li.ADDITION=2;li.MODIFICATION=1;li.REMOVAL=3;function wb(r){var e=r.renderable;e&&(e.renderBoundsDirty=!0,e.boundsDirty=!0)}var CR=new li(He.REPARENT,null,"","","",0,"",""),PR=sm(),Fu=Ze(),LR=vt(1,1,1),DR=ht(),IR=sm(),Bi=Ze(),gs=ht(),Fi=an(),RR=Ze(),jR=an(),BR=Ze(),no=Ze(),Ma=Ze(),zu=ht(),xb=an(),Eb=an(),$u=an(),Mh={affectChildren:!0},FR=function(){function r(e){ce(this,r),this.pendingEvents=new Map,this.boundsChangedEvent=new Kt(He.BOUNDS_CHANGED),this.displayObjectDependencyMap=new WeakMap,this.runtime=e}return de(r,[{key:"matches",value:function(t,n){return this.runtime.sceneGraphSelector.is(t,n)}},{key:"querySelector",value:function(t,n){return this.runtime.sceneGraphSelector.selectOne(t,n)}},{key:"querySelectorAll",value:function(t,n){return this.runtime.sceneGraphSelector.selectAll(t,n)}},{key:"attach",value:function(t,n,i){var a,s=!1;t.parentNode&&(s=t.parentNode!==n,this.detach(t));var o=t.nodeName===re.FRAGMENT,u=ec(n);t.parentNode=n;var l=o?t.childNodes:[t];Ee(i)?l.forEach(function(f){n.childNodes.splice(i,0,f),f.parentNode=n}):l.forEach(function(f){n.childNodes.push(f),f.parentNode=n});var c=n,d=c.sortable;if((d!=null&&(a=d.sorted)!==null&&a!==void 0&&a.length||t.parsedStyle.zIndex)&&(d.dirtyChildren.indexOf(t)===-1&&d.dirtyChildren.push(t),d.dirty=!0,d.dirtyReason=Zl.ADDED),!u){if(o)this.dirtifyFragment(t);else{var h=t.transformable;h&&this.dirtifyWorld(t,h)}s&&t.dispatchEvent(CR)}}},{key:"detach",value:function(t){if(t.parentNode){var n,i,a=t.transformable,s=t.parentNode,o=s.sortable;(o!=null&&(n=o.sorted)!==null&&n!==void 0&&n.length||(i=t.style)!==null&&i!==void 0&&i.zIndex)&&(o.dirtyChildren.indexOf(t)===-1&&o.dirtyChildren.push(t),o.dirty=!0,o.dirtyReason=Zl.REMOVED);var u=t.parentNode.childNodes.indexOf(t);u>-1&&t.parentNode.childNodes.splice(u,1),a&&this.dirtifyWorld(t,a),t.parentNode=null}}},{key:"getOrigin",value:function(t){return t.getGeometryBounds(),t.transformable.origin}},{key:"setOrigin",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=[n,i,a]);var s=t.transformable;if(!(n[0]===s.origin[0]&&n[1]===s.origin[1]&&n[2]===s.origin[2])){var o=s.origin;o[0]=n[0],o[1]=n[1],o[2]=n[2]||0,this.dirtifyLocal(t,s)}}},{key:"rotate",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=vt(n,i,a));var s=t.transformable;if(t.parentNode===null||!t.parentNode.transformable)this.rotateLocal(t,n);else{var o=Fi;Nu(o,n[0],n[1],n[2]);var u=this.getRotation(t),l=this.getRotation(t.parentNode);Cu($u,l),oh($u,$u),ia(o,$u,o),ia(s.localRotation,o,u),ql(s.localRotation,s.localRotation),this.dirtifyLocal(t,s)}}},{key:"rotateLocal",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=vt(n,i,a));var s=t.transformable;Nu(Eb,n[0],n[1],n[2]),R1(s.localRotation,s.localRotation,Eb),this.dirtifyLocal(t,s)}},{key:"setEulerAngles",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=vt(n,i,a));var s=t.transformable;if(t.parentNode===null||!t.parentNode.transformable)this.setLocalEulerAngles(t,n);else{Nu(s.localRotation,n[0],n[1],n[2]);var o=this.getRotation(t.parentNode);Cu(xb,oh(Fi,o)),R1(s.localRotation,s.localRotation,xb),this.dirtifyLocal(t,s)}}},{key:"setLocalEulerAngles",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;typeof n=="number"&&(n=vt(n,i,a));var o=t.transformable;Nu(o.localRotation,n[0],n[1],n[2]),s&&this.dirtifyLocal(t,o)}},{key:"translateLocal",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=vt(n,i,a));var s=t.transformable;eo(n,Fu)||(pL(n,n,s.localRotation),ra(s.localPosition,s.localPosition,n),this.dirtifyLocal(t,s))}},{key:"setPosition",value:function(t,n){var i,a=t.transformable;if(Ma[0]=n[0],Ma[1]=n[1],Ma[2]=(i=n[2])!==null&&i!==void 0?i:0,!eo(this.getPosition(t),Ma)){if(ri(a.position,Ma),t.parentNode===null||!t.parentNode.transformable)ri(a.localPosition,Ma);else{var s=t.parentNode.transformable;Is(zu,s.worldTransform),ni(zu,zu),In(a.localPosition,Ma,zu)}this.dirtifyLocal(t,a)}}},{key:"setLocalPosition",value:function(t,n){var i,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=t.transformable;no[0]=n[0],no[1]=n[1],no[2]=(i=n[2])!==null&&i!==void 0?i:0,!eo(s.localPosition,no)&&(ri(s.localPosition,no),a&&this.dirtifyLocal(t,s))}},{key:"scaleLocal",value:function(t,n){var i,a=t.transformable;cL(a.localScale,a.localScale,Ln(Bi,n[0],n[1],(i=n[2])!==null&&i!==void 0?i:1)),this.dirtifyLocal(t,a)}},{key:"setLocalScale",value:function(t,n){var i,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=t.transformable;Ln(Bi,n[0],n[1],(i=n[2])!==null&&i!==void 0?i:s.localScale[2]),!eo(Bi,s.localScale)&&(ri(s.localScale,Bi),a&&this.dirtifyLocal(t,s))}},{key:"translate",value:function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof n=="number"&&(n=Ln(Bi,n,i,a)),!eo(n,Fu)&&(ra(Bi,this.getPosition(t),n),this.setPosition(t,Bi))}},{key:"setRotation",value:function(t,n,i,a,s){var o=t.transformable;if(typeof n=="number"&&(n=xL(n,i,a,s)),t.parentNode===null||!t.parentNode.transformable)this.setLocalRotation(t,n);else{var u=this.getRotation(t.parentNode);Cu(Fi,u),oh(Fi,Fi),ia(o.localRotation,Fi,n),ql(o.localRotation,o.localRotation),this.dirtifyLocal(t,o)}}},{key:"setLocalRotation",value:function(t,n,i,a,s){var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;typeof n=="number"&&(n=I1(Fi,n,i,a,s));var u=t.transformable;Cu(u.localRotation,n),o&&this.dirtifyLocal(t,u)}},{key:"setLocalSkew",value:function(t,n,i){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;typeof n=="number"&&(n=ML(IR,n,i));var s=t.transformable;EL(s.localSkew,n),a&&this.dirtifyLocal(t,s)}},{key:"dirtifyLocal",value:function(t,n){ec(t)||n.localDirtyFlag||(n.localDirtyFlag=!0,n.dirtyFlag||this.dirtifyWorld(t,n))}},{key:"dirtifyWorld",value:function(t,n){n.dirtyFlag||this.unfreezeParentToRoot(t),this.dirtifyWorldInternal(t,n),this.dirtifyToRoot(t,!0)}},{key:"dirtifyFragment",value:function(t){var n=t.transformable;n&&(n.frozen=!1,n.dirtyFlag=!0,n.localDirtyFlag=!0);var i=t.renderable;i&&(i.renderBoundsDirty=!0,i.boundsDirty=!0,i.dirty=!0);for(var a=t.childNodes.length,s=0;s<a;s++)this.dirtifyFragment(t.childNodes[s]);t.nodeName===re.FRAGMENT&&this.pendingEvents.set(t,!1)}},{key:"triggerPendingEvents",value:function(){var t=this,n=new Set,i=function(s,o){!s.isConnected||n.has(s)||s.nodeName===re.FRAGMENT||(t.boundsChangedEvent.detail=o,t.boundsChangedEvent.target=s,s.isMutationObserved?s.dispatchEvent(t.boundsChangedEvent):s.ownerDocument.defaultView.dispatchEvent(t.boundsChangedEvent,!0),n.add(s))};this.pendingEvents.forEach(function(a,s){s.nodeName!==re.FRAGMENT&&(Mh.affectChildren=a,a?s.forEach(function(o){i(o,Mh)}):i(s,Mh))}),n.clear(),this.clearPendingEvents()}},{key:"clearPendingEvents",value:function(){this.pendingEvents.clear()}},{key:"dirtifyToRoot",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=t;for(i.renderable&&(i.renderable.dirty=!0);i;)wb(i),i=i.parentNode;n&&t.forEach(function(a){wb(a)}),this.informDependentDisplayObjects(t),this.pendingEvents.set(t,n)}},{key:"updateDisplayObjectDependency",value:function(t,n,i,a){if(n&&n!==i){var s=this.displayObjectDependencyMap.get(n);if(s&&s[t]){var o=s[t].indexOf(a);s[t].splice(o,1)}}if(i){var u=this.displayObjectDependencyMap.get(i);u||(this.displayObjectDependencyMap.set(i,{}),u=this.displayObjectDependencyMap.get(i)),u[t]||(u[t]=[]),u[t].push(a)}}},{key:"informDependentDisplayObjects",value:function(t){var n=this,i=this.displayObjectDependencyMap.get(t);i&&Object.keys(i).forEach(function(a){i[a].forEach(function(s){n.dirtifyToRoot(s,!0),s.dispatchEvent(new li(He.ATTR_MODIFIED,s,n,n,a,li.MODIFICATION,n,n)),s.isCustomElement&&s.isConnected&&s.attributeChangedCallback&&s.attributeChangedCallback(a,n,n)})})}},{key:"getPosition",value:function(t){var n=t.transformable;return Fl(n.position,this.getWorldTransform(t,n))}},{key:"getRotation",value:function(t){var n=t.transformable;return zl(n.rotation,this.getWorldTransform(t,n))}},{key:"getScale",value:function(t){var n=t.transformable;return Rs(n.scaling,this.getWorldTransform(t,n))}},{key:"getWorldTransform",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.transformable;return!n.localDirtyFlag&&!n.dirtyFlag||(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.sync(t,n)),n.worldTransform}},{key:"getLocalPosition",value:function(t){return t.transformable.localPosition}},{key:"getLocalRotation",value:function(t){return t.transformable.localRotation}},{key:"getLocalScale",value:function(t){return t.transformable.localScale}},{key:"getLocalSkew",value:function(t){return t.transformable.localSkew}},{key:"calcLocalTransform",value:function(t){var n=t.localSkew[0]!==0||t.localSkew[1]!==0;if(n){Oo(t.localTransform,t.localRotation,t.localPosition,vt(1,1,1),t.origin),(t.localSkew[0]!==0||t.localSkew[1]!==0)&&(ua(gs),gs[4]=Math.tan(t.localSkew[0]),gs[1]=Math.tan(t.localSkew[1]),Dn(t.localTransform,t.localTransform,gs));var i=Oo(gs,I1(Fi,0,0,0,1),Ln(Bi,1,1,1),t.localScale,t.origin);Dn(t.localTransform,t.localTransform,i)}else{var a=t.localTransform,s=t.localPosition,o=t.localRotation,u=t.localScale,l=t.origin,c=s[0]!==0||s[1]!==0||s[2]!==0,d=o[3]!==1||o[0]!==0||o[1]!==0||o[2]!==0,h=u[0]!==1||u[1]!==1||u[2]!==1,f=l[0]!==0||l[1]!==0||l[2]!==0;!d&&!h&&!f?c?Ui(a,s):ua(a):Oo(a,o,s,u,l)}}},{key:"getLocalTransform",value:function(t){var n=t.transformable;return n.localDirtyFlag&&(this.calcLocalTransform(n),n.localDirtyFlag=!1),n.localTransform}},{key:"setLocalTransform",value:function(t,n){var i=Fl(RR,n),a=zl(jR,n),s=Rs(BR,n);this.setLocalScale(t,s,!1),this.setLocalPosition(t,i,!1),this.setLocalRotation(t,a,void 0,void 0,void 0,!1),this.dirtifyLocal(t,t.transformable)}},{key:"resetLocalTransform",value:function(t){this.setLocalScale(t,LR,!1),this.setLocalPosition(t,Fu,!1),this.setLocalEulerAngles(t,Fu,void 0,void 0,!1),this.setLocalSkew(t,PR,void 0,!1),this.dirtifyLocal(t,t.transformable)}},{key:"getTransformedGeometryBounds",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2?arguments[2]:void 0,a=this.getGeometryBounds(t,n);if(!ft.isEmpty(a)){var s=i||new ft;return s.setFromTransformedAABB(a,this.getWorldTransform(t)),s}return null}},{key:"getGeometryBounds",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=t,a=i.geometry;a.dirty&&fe.styleValueRegistry.updateGeometry(t);var s=n?a.renderBounds:a.contentBounds||null;return s||new ft}},{key:"getBounds",value:function(t){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=t,s=a.renderable;if(!s.boundsDirty&&!i&&s.bounds)return s.bounds;if(!s.renderBoundsDirty&&i&&s.renderBounds)return s.renderBounds;var o=i?s.renderBounds:s.bounds,u=this.getTransformedGeometryBounds(t,i,o),l=t.childNodes;if(l.forEach(function(h){var f=n.getBounds(h,i);f&&(u?u.add(f):(u=o||new ft,u.update(f.center,f.halfExtents)))}),u||(u=new ft),i){var c=lO(t);if(c){var d=c.parsedStyle.clipPath.getBounds(i);u?d&&(u=d.intersection(u)):u.update(d.center,d.halfExtents)}}return i?(s.renderBounds=u,s.renderBoundsDirty=!1):(s.bounds=u,s.boundsDirty=!1),u}},{key:"getLocalBounds",value:function(t){if(t.parentNode){var n=DR;t.parentNode.transformable&&(n=ni(gs,this.getWorldTransform(t.parentNode)));var i=this.getBounds(t);if(!ft.isEmpty(i)){var a=new ft;return a.setFromTransformedAABB(i,n),a}}return this.getBounds(t)}},{key:"getBoundingClientRect",value:function(t){var n,i,a=this.getGeometryBounds(t);ft.isEmpty(a)||(i=new ft,i.setFromTransformedAABB(a,this.getWorldTransform(t)));var s=(n=t.ownerDocument)===null||n===void 0||(n=n.defaultView)===null||n===void 0?void 0:n.getContextService().getBoundingClientRect();if(i){var o=i.getMin(),u=ze(o,2),l=u[0],c=u[1],d=i.getMax(),h=ze(d,2),f=h[0],g=h[1];return new Bs(l+((s==null?void 0:s.left)||0),c+((s==null?void 0:s.top)||0),f-l,g-c)}return new Bs((s==null?void 0:s.left)||0,(s==null?void 0:s.top)||0,0,0)}},{key:"dirtifyWorldInternal",value:function(t,n){var i=this;if(!n.dirtyFlag){n.dirtyFlag=!0,n.frozen=!1,t.childNodes.forEach(function(o){var u=o.transformable;u.dirtyFlag||i.dirtifyWorldInternal(o,u)});var a=t,s=a.renderable;s&&(s.renderBoundsDirty=!0,s.boundsDirty=!0,s.dirty=!0)}}},{key:"syncHierarchy",value:function(t){var n=t.transformable;if(!n.frozen){n.frozen=!0,(n.localDirtyFlag||n.dirtyFlag)&&this.sync(t,n);for(var i=t.childNodes,a=0;a<i.length;a++)this.syncHierarchy(i[a])}}},{key:"sync",value:function(t,n){if(n.localDirtyFlag&&(this.calcLocalTransform(n),n.localDirtyFlag=!1),n.dirtyFlag){var i=t.parentNode,a=i&&i.transformable;i===null||!a?Is(n.worldTransform,n.localTransform):Dn(n.worldTransform,a.worldTransform,n.localTransform),n.dirtyFlag=!1}}},{key:"unfreezeParentToRoot",value:function(t){for(var n=t.parentNode;n;){var i=n.transformable;i&&(i.frozen=!1),n=n.parentNode}}}])}(),Sa={MetricsString:"|ÉqÅ",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},Mb=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,zR=/[!%),.:;?\]}¢°·'""†‡›℃∶、。〃〆〕〗〞﹚﹜！＂％＇），．：；？！］｝～]/,$R=/[$(£¥·'"〈《「『【〔〖〝﹙﹛＄（．［｛￡￥]/,qR=/[!),.:;?\]}¢·–—'"•"、。〆〞〕〉》」︰︱︲︳﹐﹑﹒﹓﹔﹕﹖﹘﹚﹜！），．：；？︶︸︺︼︾﹀﹂﹗］｜｝､]/,GR=/[([{£¥'"‵〈《「『〔〝︴﹙﹛（｛︵︷︹︻︽︿﹁﹃﹏]/,WR=/[)\]｝〕〉》」』】〙〗〟'"｠»ヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻‐゠–〜?!‼⁇⁈⁉・、:;,。.]/,VR=/[([｛〔〈《「『【〘〖〝'"｟«—...‥〳〴〵]/,YR=/[!%),.:;?\]}¢°'"†‡℃〆〈《「『〕！％），．：；？］｝]/,UR=/[$([{£¥'"々〇〉》」〔＄（［｛｠￥￦#]/,HR=new RegExp("".concat(zR.source,"|").concat(qR.source,"|").concat(WR.source,"|").concat(YR.source)),XR=new RegExp("".concat($R.source,"|").concat(GR.source,"|").concat(VR.source,"|").concat(UR.source)),KR=function(){function r(e){var t=this;ce(this,r),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(n,i){return t.isBreakingSpace(i)?!1:!!(n&&(XR.exec(i)||HR.exec(n)))},this.trimByKinsokuShorui=function(n){var i=pt(n),a=i[i.length-2];if(!a)return n;var s=a[a.length-1];return i[i.length-2]=a.slice(0,-1),i[i.length-1]=s+i[i.length-1],i},this.runtime=e}return de(r,[{key:"measureFont",value:function(t,n){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var i={ascent:0,descent:0,fontSize:0},a=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(n),s=this.runtime.offscreenCanvasCreator.getOrCreateContext(n,{willReadFrequently:!0});s.font=t;var o=Sa.MetricsString+Sa.BaselineSymbol,u=Math.ceil(s.measureText(o).width),l=Math.ceil(s.measureText(Sa.BaselineSymbol).width),c=Sa.HeightMultiplier*l;l=l*Sa.BaselineMultiplier|0,a.width=u,a.height=c,s.fillStyle="#f00",s.fillRect(0,0,u,c),s.font=t,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(o,0,l);var d=s.getImageData(0,0,u||1,c||1).data,h=d.length,f=u*4,g=0,v=0,p=!1;for(g=0;g<l;++g){for(var y=0;y<f;y+=4)if(d[v+y]!==255){p=!0;break}if(!p)v+=f;else break}for(i.ascent=l-g,v=h-f,p=!1,g=c;g>l;--g){for(var m=0;m<f;m+=4)if(d[v+m]!==255){p=!0;break}if(!p)v-=f;else break}return i.descent=g-l,i.fontSize=i.ascent+i.descent,this.fontMetricsCache[t]=i,i}},{key:"measureText",value:function(t,n,i){var a=n.fontSize,s=a===void 0?16:a,o=n.wordWrap,u=o===void 0?!1:o,l=n.lineHeight,c=n.lineWidth,d=c===void 0?1:c,h=n.textBaseline,f=h===void 0?"alphabetic":h,g=n.textAlign,v=g===void 0?"start":g,p=n.letterSpacing,y=p===void 0?0:p,m=n.textPath;n.textPathSide,n.textPathStartOffset;var w=n.leading,M=w===void 0?0:w,S=lR(n),T=this.measureFont(S,i);T.fontSize===0&&(T.fontSize=s,T.ascent=s);var A=this.runtime.offscreenCanvasCreator.getOrCreateContext(i);A.font=S,n.isOverflowing=!1;var O=u?this.wordWrap(t,n,i):t,N=O.split(/(?:\r\n|\r|\n)/),C=new Array(N.length),P=0;if(m){m.getTotalLength();for(var D=0;D<N.length;D++)A.measureText(N[D]).width+(N[D].length-1)*y}else{for(var j=0;j<N.length;j++){var G=A.measureText(N[j]).width+(N[j].length-1)*y;C[j]=G,P=Math.max(P,G)}var V=P+d,Y=l||T.fontSize+d,$=Math.max(Y,T.fontSize+d)+(N.length-1)*(Y+M);Y+=M;var z=0;return f==="middle"?z=-$/2:f==="bottom"||f==="alphabetic"||f==="ideographic"?z=-$:(f==="top"||f==="hanging")&&(z=0),{font:S,width:V,height:$,lines:N,lineWidths:C,lineHeight:Y,maxLineWidth:P,fontProperties:T,lineMetrics:C.map(function(Z,ne){var se=0;return v==="center"||v==="middle"?se-=Z/2:(v==="right"||v==="end")&&(se-=Z),new Bs(se-d/2,z+ne*Y,Z+d,Y)})}}}},{key:"wordWrap",value:function(t,n,i){var a=this,s=this,o=n.wordWrapWidth,u=o===void 0?0:o,l=n.letterSpacing,c=l===void 0?0:l,d=n.maxLines,h=d===void 0?1/0:d,f=n.textOverflow,g=this.runtime.offscreenCanvasCreator.getOrCreateContext(i),v=u+c,p="";f==="ellipsis"?p="...":f&&f!=="clip"&&(p=f);var y=Array.from(t),m=[],w=0,M=0,S=0,T={},A=function(z){return a.getFromCache(z,c,T,g)},O=A(p);function N($,z,Z,ne){for(;A($)<ne&&z<y.length-1&&!s.isNewline(y[z+1]);)z+=1,$+=y[z];for(;A($)>ne&&z>Z;)z-=1,$=$.slice(0,-1);return{lineTxt:$,txtLastCharIndex:z}}function C($,z){if(!(O<=0||O>v)){if(!m[$]){m[$]=p;return}var Z=N(m[$],z,S+1,v-O);m[$]=Z.lineTxt+p}}for(var P=0;P<y.length;P++){var D=y[P],j=y[P-1],G=y[P+1],V=A(D);if(this.isNewline(D)){if(w+1>=h){n.isOverflowing=!0,P<y.length-1&&C(w,P-1);break}S=P-1,w+=1,M=0,m[w]="";continue}if(M>0&&M+V>v){var Y=N(m[w],P-1,S+1,v);if(Y.txtLastCharIndex!==P-1){if(m[w]=Y.lineTxt,Y.txtLastCharIndex===y.length-1)break;P=Y.txtLastCharIndex+1,D=y[P],j=y[P-1],G=y[P+1],V=A(D)}if(w+1>=h){n.isOverflowing=!0,C(w,P-1);break}if(S=P-1,w+=1,M=0,m[w]="",this.isBreakingSpace(D))continue;this.canBreakInLastChar(D)||(m=this.trimToBreakable(m),M=this.sumTextWidthByCache(m[w]||"",T)),this.shouldBreakByKinsokuShorui(D,G)&&(m=this.trimByKinsokuShorui(m),M+=A(j||""))}M+=V,m[w]=(m[w]||"")+D}return m.join(`
`)}},{key:"isBreakingSpace",value:function(t){return typeof t!="string"?!1:Sa.BreakingSpaces.indexOf(t.charCodeAt(0))>=0}},{key:"isNewline",value:function(t){return typeof t!="string"?!1:Sa.Newlines.indexOf(t.charCodeAt(0))>=0}},{key:"trimToBreakable",value:function(t){var n=pt(t),i=n[n.length-2],a=this.findBreakableIndex(i);if(a===-1||!i)return n;var s=i.slice(a,a+1),o=this.isBreakingSpace(s),u=a+1,l=a+(o?0:1);return n[n.length-1]+=i.slice(u,i.length),n[n.length-2]=i.slice(0,l),n}},{key:"canBreakInLastChar",value:function(t){return!(t&&Mb.test(t))}},{key:"sumTextWidthByCache",value:function(t,n){return t.split("").reduce(function(i,a){if(!n[a])throw Error("cannot count the word without cache");return i+n[a]},0)}},{key:"findBreakableIndex",value:function(t){for(var n=t.length-1;n>=0;n--)if(!Mb.test(t[n]))return n;return-1}},{key:"getFromCache",value:function(t,n,i,a){var s=i[t];if(typeof s!="number"){var o=t.length*n,u=a.measureText(t);s=u.width+o,i[t]=s}return s}}])}(),fe={},ZR=function(r){var e=new ER,t=new xR;return r={},Me(Me(Me(Me(Me(Me(Me(Me(Me(Me(r,re.FRAGMENT,null),re.CIRCLE,new yR),re.ELLIPSE,new mR),re.RECT,e),re.IMAGE,e),re.GROUP,new SR),re.LINE,new bR),re.TEXT,new MR(fe)),re.POLYLINE,t),re.POLYGON,t),Me(Me(Me(r,re.PATH,new wR),re.HTML,new _R),re.MESH,null)}(),QR=function(r){var e=new kI,t=new cy;return r={},Me(Me(Me(Me(Me(Me(Me(Me(Me(Me(r,be.PERCENTAGE,null),be.NUMBER,new DI),be.ANGLE,new OI),be.DEFINED_PATH,new AI),be.PAINT,e),be.COLOR,e),be.FILTER,new NI),be.LENGTH,t),be.LENGTH_PERCENTAGE,t),be.LENGTH_PERCENTAGE_12,new CI),Me(Me(Me(Me(Me(Me(Me(Me(Me(Me(r,be.LENGTH_PERCENTAGE_14,new PI),be.COORDINATE,new cy),be.OFFSET_DISTANCE,new II),be.OPACITY_VALUE,new RI),be.PATH,new jI),be.LIST_OF_POINTS,new BI),be.SHADOW_BLUR,new FI),be.TEXT,new zI),be.TEXT_TRANSFORM,new $I),be.TRANSFORM,new gR),Me(Me(Me(r,be.TRANSFORM_ORIGIN,new pR),be.Z_INDEX,new vR),be.MARKER,new LI)}(),JR=function(){return typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}};fe.CameraContribution=VT;fe.AnimationTimeline=null;fe.EasingFunction=null;fe.offscreenCanvasCreator=new vm;fe.sceneGraphSelector=new NR;fe.sceneGraphService=new FR(fe);fe.textService=new KR(fe);fe.geometryUpdaterFactory=ZR;fe.CSSPropertySyntaxFactory=QR;fe.styleValueRegistry=new _I(fe);fe.layoutRegistry=null;fe.globalThis=JR();fe.enableStyleSyntax=!0;fe.enableSizeAttenuation=!1;var e4=0,fy=new li(He.INSERTED,null,"","","",0,"",""),gy=new li(He.REMOVED,null,"","","",0,"",""),yO=new Kt(He.DESTROY),t4=function(r){function e(){var t;ce(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=Ge(this,e,[].concat(i)),t.entity=e4++,t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.cullable={strategy:wD.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.destroyed=!1,t.style={},t.computedStyle={},t.parsedStyle={},t.attributes={},t}return We(e,r),de(e,[{key:"className",get:function(){return this.getAttribute("class")||""},set:function(n){this.setAttribute("class",n)}},{key:"classList",get:function(){return this.className.split(" ").filter(function(n){return n!==""})}},{key:"tagName",get:function(){return this.nodeName}},{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"parentElement",get:function(){return this.parentNode}},{key:"nextSibling",get:function(){if(this.parentNode){var n=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[n+1]||null}return null}},{key:"previousSibling",get:function(){if(this.parentNode){var n=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[n-1]||null}return null}},{key:"cloneNode",value:function(n){throw new Error(it)}},{key:"appendChild",value:function(n,i){var a;if(n.destroyed)throw new Error(lD);return fe.sceneGraphService.attach(n,this,i),(a=this.ownerDocument)!==null&&a!==void 0&&a.defaultView&&(!ec(this)&&n.nodeName===re.FRAGMENT?this.ownerDocument.defaultView.mountFragment(n):this.ownerDocument.defaultView.mountChildren(n)),this.isMutationObserved&&(fy.relatedNode=this,n.dispatchEvent(fy)),n}},{key:"insertBefore",value:function(n,i){if(!i)this.appendChild(n);else{n.parentElement&&n.parentElement.removeChild(n);var a=this.childNodes.indexOf(i);a===-1?this.appendChild(n):this.appendChild(n,a)}return n}},{key:"replaceChild",value:function(n,i){var a=this.childNodes.indexOf(i);return this.removeChild(i),this.appendChild(n,a),i}},{key:"removeChild",value:function(n){var i;return gy.relatedNode=this,n.dispatchEvent(gy),(i=n.ownerDocument)!==null&&i!==void 0&&i.defaultView&&n.ownerDocument.defaultView.unmountChildren(n),fe.sceneGraphService.detach(n),n}},{key:"removeChildren",value:function(){for(var n=this.childNodes.length-1;n>=0;n--){var i=this.childNodes[n];this.removeChild(i)}}},{key:"destroyChildren",value:function(){for(var n=this.childNodes.length-1;n>=0;n--){var i=this.childNodes[n];i.childNodes.length>0&&i.destroyChildren(),i.destroy()}}},{key:"matches",value:function(n){return fe.sceneGraphService.matches(n,this)}},{key:"getElementById",value:function(n){return fe.sceneGraphService.querySelector("#".concat(n),this)}},{key:"getElementsByName",value:function(n){return fe.sceneGraphService.querySelectorAll('[name="'.concat(n,'"]'),this)}},{key:"getElementsByClassName",value:function(n){return fe.sceneGraphService.querySelectorAll(".".concat(n),this)}},{key:"getElementsByTagName",value:function(n){return fe.sceneGraphService.querySelectorAll(n,this)}},{key:"querySelector",value:function(n){return fe.sceneGraphService.querySelector(n,this)}},{key:"querySelectorAll",value:function(n){return fe.sceneGraphService.querySelectorAll(n,this)}},{key:"closest",value:function(n){var i=this;do{if(fe.sceneGraphService.matches(n,i))return i;i=i.parentElement}while(i!==null);return null}},{key:"find",value:function(n){var i=this,a=null;return this.forEach(function(s){return s!==i&&n(s)?(a=s,!1):!0}),a}},{key:"findAll",value:function(n){var i=this,a=[];return this.forEach(function(s){s!==i&&n(s)&&a.push(s)}),a}},{key:"after",value:function(){var n=this;if(this.parentNode){for(var i=this.parentNode.childNodes.indexOf(this),a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];s.forEach(function(u,l){var c;return(c=n.parentNode)===null||c===void 0?void 0:c.appendChild(u,i+l+1)})}}},{key:"before",value:function(){if(this.parentNode){for(var n,i=this.parentNode.childNodes.indexOf(this),a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];var u=s[0],l=s.slice(1);this.parentNode.appendChild(u,i),(n=u).after.apply(n,pt(l))}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove()}},{key:"append",value:function(){for(var n=this,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];a.forEach(function(o){return n.appendChild(o)})}},{key:"prepend",value:function(){for(var n=this,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];a.forEach(function(o,u){return n.appendChild(o,u)})}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments)}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this}},{key:"destroy",value:function(){this.destroyChildren(),this.dispatchEvent(yO),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0}},{key:"getGeometryBounds",value:function(){return fe.sceneGraphService.getGeometryBounds(this)}},{key:"getRenderBounds",value:function(){return fe.sceneGraphService.getBounds(this,!0)}},{key:"getBounds",value:function(){return fe.sceneGraphService.getBounds(this)}},{key:"getLocalBounds",value:function(){return fe.sceneGraphService.getLocalBounds(this)}},{key:"getBoundingClientRect",value:function(){return fe.sceneGraphService.getBoundingClientRect(this)}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle))}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes)}},{key:"getAttribute",value:function(n){if(typeof n!="symbol"){var i=this.attributes[n];return i}}},{key:"hasAttribute",value:function(n){return this.getAttributeNames().includes(n)}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length}},{key:"removeAttribute",value:function(n){this.setAttribute(n,null),delete this.attributes[n]}},{key:"setAttribute",value:function(n,i,a,s){this.attributes[n]=i}},{key:"getAttributeNS",value:function(n,i){throw new Error(it)}},{key:"getAttributeNode",value:function(n){throw new Error(it)}},{key:"getAttributeNodeNS",value:function(n,i){throw new Error(it)}},{key:"hasAttributeNS",value:function(n,i){throw new Error(it)}},{key:"removeAttributeNS",value:function(n,i){throw new Error(it)}},{key:"removeAttributeNode",value:function(n){throw new Error(it)}},{key:"setAttributeNS",value:function(n,i,a){throw new Error(it)}},{key:"setAttributeNode",value:function(n){throw new Error(it)}},{key:"setAttributeNodeNS",value:function(n){throw new Error(it)}},{key:"toggleAttribute",value:function(n,i){throw new Error(it)}}])}(Ct);function et(r){return!!(r!=null&&r.nodeName)}var n4=fe.globalThis.Proxy?fe.globalThis.Proxy:function(){},ei=new li(He.ATTR_MODIFIED,null,null,null,null,li.MODIFICATION,null,null),ro=Ze(),r4=an(),mt=function(r){function e(t){var n;return ce(this,e),n=Ge(this,e),n.isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=t,n.id=t.id||"",n.name=t.name||"",(t.className||t.class)&&(n.className=t.className||t.class),n.nodeName=t.type||re.GROUP,t.initialParsedStyle&&Object.assign(n.parsedStyle,t.initialParsedStyle),n.initAttributes(t.style),fe.enableStyleSyntax&&(n.style=new n4({setProperty:function(a,s){n.setAttribute(a,s)},getPropertyValue:function(a){return n.getAttribute(a)},removeProperty:function(a){n.removeAttribute(a)},item:function(){return""}},{get:function(a,s){return a[s]!==void 0?a[s]:n.getAttribute(s)},set:function(a,s,o){return n.setAttribute(s,o),!0}})),n}return We(e,r),de(e,[{key:"destroy",value:function(){q1(e,"destroy",this)([]),this.getAnimations().forEach(function(n){n.cancel()})}},{key:"cloneNode",value:function(n,i){var a=qe({},this.attributes);for(var s in a){var o=a[s];et(o)&&s!=="clipPath"&&s!=="offsetPath"&&s!=="textPath"&&(a[s]=o.cloneNode(n)),i&&(a[s]=i(s,o))}var u=new this.constructor(qe(qe({},this.config),{},{style:a}));return u.setLocalTransform(this.getLocalTransform()),n&&this.children.forEach(function(l){if(!l.style.isMarker){var c=l.cloneNode(n);u.appendChild(c)}}),u}},{key:"initAttributes",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i={forceUpdateGeometry:!0};fe.styleValueRegistry.processProperties(this,n,i),this.renderable.dirty=!0}},{key:"setAttribute",value:function(n,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;je(i)||(a||i!==this.attributes[n])&&(this.internalSetAttribute(n,i,{memoize:s}),q1(e,"setAttribute",this)([n,i]))}},{key:"internalSetAttribute",value:function(n,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=this.renderable,o=this.attributes[n],u=this.parsedStyle[n];fe.styleValueRegistry.processProperties(this,Me({},n,i),a),s.dirty=!0;var l=this.parsedStyle[n];if(this.isConnected&&(ei.relatedNode=this,ei.prevValue=o,ei.newValue=i,ei.attrName=n,ei.prevParsedValue=u,ei.newParsedValue=l,this.isMutationObserved?this.dispatchEvent(ei):(ei.target=this,this.ownerDocument.defaultView.dispatchEvent(ei,!0))),this.isCustomElement&&this.isConnected||!this.isCustomElement){var c,d;(c=(d=this).attributeChangedCallback)===null||c===void 0||c.call(d,n,o,i,u,l)}}},{key:"getBBox",value:function(){var n=this.getBounds(),i=n.getMin(),a=ze(i,2),s=a[0],o=a[1],u=n.getMax(),l=ze(u,2),c=l[0],d=l[1];return new Bs(s,o,c-s,d-o)}},{key:"setOrigin",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return fe.sceneGraphService.setOrigin(this,jn(n,i,a,!1)),this}},{key:"getOrigin",value:function(){return fe.sceneGraphService.getOrigin(this)}},{key:"setPosition",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return fe.sceneGraphService.setPosition(this,jn(n,i,a,!1)),this}},{key:"setLocalPosition",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return fe.sceneGraphService.setLocalPosition(this,jn(n,i,a,!1)),this}},{key:"translate",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return fe.sceneGraphService.translate(this,jn(n,i,a,!1)),this}},{key:"translateLocal",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return fe.sceneGraphService.translateLocal(this,jn(n,i,a,!1)),this}},{key:"getPosition",value:function(){return fe.sceneGraphService.getPosition(this)}},{key:"getLocalPosition",value:function(){return fe.sceneGraphService.getLocalPosition(this)}},{key:"scale",value:function(n,i,a){return this.scaleLocal(n,i,a)}},{key:"scaleLocal",value:function(n,i,a){return typeof n=="number"&&(i=i||n,a=a||n,n=jn(n,i,a,!1)),fe.sceneGraphService.scaleLocal(this,n),this}},{key:"setLocalScale",value:function(n,i,a){return typeof n=="number"&&(i=i||n,a=a||n,n=jn(n,i,a,!1)),fe.sceneGraphService.setLocalScale(this,n),this}},{key:"getLocalScale",value:function(){return fe.sceneGraphService.getLocalScale(this)}},{key:"getScale",value:function(){return fe.sceneGraphService.getScale(this)}},{key:"getEulerAngles",value:function(){var n=gh(ro,fe.sceneGraphService.getWorldTransform(this)),i=ze(n,3),a=i[2];return Zn(a)}},{key:"getLocalEulerAngles",value:function(){var n=gh(ro,fe.sceneGraphService.getLocalRotation(this)),i=ze(n,3),a=i[2];return Zn(a)}},{key:"setEulerAngles",value:function(n){return fe.sceneGraphService.setEulerAngles(this,0,0,n),this}},{key:"setLocalEulerAngles",value:function(n){return fe.sceneGraphService.setLocalEulerAngles(this,0,0,n),this}},{key:"rotateLocal",value:function(n,i,a){return Le(i)&&Le(a)?fe.sceneGraphService.rotateLocal(this,0,0,n):fe.sceneGraphService.rotateLocal(this,n,i,a),this}},{key:"rotate",value:function(n,i,a){return Le(i)&&Le(a)?fe.sceneGraphService.rotate(this,0,0,n):fe.sceneGraphService.rotate(this,n,i,a),this}},{key:"setRotation",value:function(n,i,a,s){return fe.sceneGraphService.setRotation(this,n,i,a,s),this}},{key:"setLocalRotation",value:function(n,i,a,s){return fe.sceneGraphService.setLocalRotation(this,n,i,a,s),this}},{key:"setLocalSkew",value:function(n,i){return fe.sceneGraphService.setLocalSkew(this,n,i),this}},{key:"getRotation",value:function(){return fe.sceneGraphService.getRotation(this)}},{key:"getLocalRotation",value:function(){return fe.sceneGraphService.getLocalRotation(this)}},{key:"getLocalSkew",value:function(){return fe.sceneGraphService.getLocalSkew(this)}},{key:"getLocalTransform",value:function(){return fe.sceneGraphService.getLocalTransform(this)}},{key:"getWorldTransform",value:function(){return fe.sceneGraphService.getWorldTransform(this)}},{key:"setLocalTransform",value:function(n){return fe.sceneGraphService.setLocalTransform(this,n),this}},{key:"resetLocalTransform",value:function(){fe.sceneGraphService.resetLocalTransform(this)}},{key:"getAnimations",value:function(){return this.activeAnimations}},{key:"animate",value:function(n,i){var a,s=(a=this.ownerDocument)===null||a===void 0?void 0:a.timeline;return s?s.play(this,n,i):null}},{key:"isVisible",value:function(){var n;return((n=this.parsedStyle)===null||n===void 0?void 0:n.visibility)!=="hidden"}},{key:"interactive",get:function(){return this.isInteractive()},set:function(n){this.style.pointerEvents=n?"auto":"none"}},{key:"isInteractive",value:function(){var n;return((n=this.parsedStyle)===null||n===void 0?void 0:n.pointerEvents)!=="none"}},{key:"isCulled",value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible)}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,pt(this.parentNode.children.map(function(n){return Number(n.style.zIndex)})))+1),this}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,pt(this.parentNode.children.map(function(n){return Number(n.style.zIndex)})))-1),this}},{key:"getConfig",value:function(){return this.config}},{key:"attr",value:function(){for(var n=this,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];var o=a[0],u=a[1];return o?Yt(o)?(Object.keys(o).forEach(function(l){n.setAttribute(l,o[l])}),this):a.length===2?(this.setAttribute(o,u),this):this.attributes[o]:this.attributes}},{key:"getMatrix",value:function(n){var i=n||this.getWorldTransform(),a=Fl(ro,i),s=ze(a,2),o=s[0],u=s[1],l=Rs(ro,i),c=ze(l,2),d=c[0],h=c[1],f=zl(r4,i),g=gh(ro,f),v=ze(g,3),p=v[0],y=v[2];return pD(p||y,o,u,d,h)}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform())}},{key:"setMatrix",value:function(n){var i=nb(n),a=ze(i,5),s=a[0],o=a[1],u=a[2],l=a[3],c=a[4];this.setEulerAngles(c).setPosition(s,o).setLocalScale(u,l)}},{key:"setLocalMatrix",value:function(n){var i=nb(n),a=ze(i,5),s=a[0],o=a[1],u=a[2],l=a[3],c=a[4];this.setLocalEulerAngles(c).setLocalPosition(s,o).setLocalScale(u,l)}},{key:"show",value:function(){this.forEach(function(n){n.style.visibility="visible"})}},{key:"hide",value:function(){this.forEach(function(n){n.style.visibility="hidden"})}},{key:"getCount",value:function(){return this.childElementCount}},{key:"getParent",value:function(){return this.parentElement}},{key:"getChildren",value:function(){return this.children}},{key:"getFirst",value:function(){return this.firstElementChild}},{key:"getLast",value:function(){return this.lastElementChild}},{key:"getChildByIndex",value:function(n){return this.children[n]||null}},{key:"add",value:function(n,i){return this.appendChild(n,i)}},{key:"set",value:function(n,i){this.config[n]=i}},{key:"get",value:function(n){return this.config[n]}},{key:"moveTo",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return this.setPosition(n,i,a),this}},{key:"move",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return this.setPosition(n,i,a),this}},{key:"setZIndex",value:function(n){return this.style.zIndex=n,this}}])}(t4);mt.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var Ii=function(r){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ce(this,e),Ge(this,e,[qe({type:re.CIRCLE},t)])}return We(e,r),de(e)}(mt);Ii.PARSED_STYLE_LIST=new Set([].concat(pt(mt.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var i4=["style"],ym=function(r){function e(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.style,a=Za(n,i4);return ce(this,e),t=Ge(this,e,[qe({style:i},a)]),t.isCustomElement=!0,t}return We(e,r),de(e)}(mt);ym.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var lu=function(r){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ce(this,e),Ge(this,e,[qe({type:re.ELLIPSE},t)])}return We(e,r),de(e)}(mt);lu.PARSED_STYLE_LIST=new Set([].concat(pt(mt.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"]));var a4=function(r){function e(){return ce(this,e),Ge(this,e,[{type:re.FRAGMENT}])}return We(e,r),de(e)}(mt);a4.PARSED_STYLE_LIST=new Set(["class","className"]);var ln=function(r){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ce(this,e),Ge(this,e,[qe({type:re.GROUP},t)])}return We(e,r),de(e)}(mt);ln.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var s4=["style"],cu=function(r){function e(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.style,a=Za(n,s4);return ce(this,e),t=Ge(this,e,[qe({type:re.HTML,style:i},a)]),t.cullable.enable=!1,t}return We(e,r),de(e,[{key:"getDomElement",value:function(){return this.parsedStyle.$el}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"getLocalBounds",value:function(){if(this.parentNode){var n=ni(ht(),this.parentNode.getWorldTransform()),i=this.getBounds();if(!ft.isEmpty(i)){var a=new ft;return a.setFromTransformedAABB(i,n),a}}return this.getBounds()}}])}(mt);cu.PARSED_STYLE_LIST=new Set([].concat(pt(mt.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var du=function(r){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ce(this,e),Ge(this,e,[qe({type:re.IMAGE},t)])}return We(e,r),de(e)}(mt);du.PARSED_STYLE_LIST=new Set([].concat(pt(mt.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var o4=["style"],Wa=function(r){function e(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.style,a=Za(n,o4);ce(this,e),t=Ge(this,e,[qe({type:re.LINE,style:qe({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},i)},a)]),t.markerStartAngle=0,t.markerEndAngle=0;var s=t.parsedStyle,o=s.markerStart,u=s.markerEnd;return o&&et(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),u&&et(u)&&(t.markerEndAngle=u.getLocalEulerAngles(),t.appendChild(u)),t.transformMarker(!0),t.transformMarker(!1),t}return We(e,r),de(e,[{key:"attributeChangedCallback",value:function(n,i,a,s,o){n==="x1"||n==="y1"||n==="x2"||n==="y2"||n==="markerStartOffset"||n==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):n==="markerStart"?(s&&et(s)&&(this.markerStartAngle=0,s.remove()),o&&et(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):n==="markerEnd"&&(s&&et(s)&&(this.markerEndAngle=0,s.remove()),o&&et(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1)))}},{key:"transformMarker",value:function(n){var i=this.parsedStyle,a=i.markerStart,s=i.markerEnd,o=i.markerStartOffset,u=i.markerEndOffset,l=i.x1,c=i.x2,d=i.y1,h=i.y2,f=n?a:s;if(!(!f||!et(f))){var g=0,v,p,y,m,w,M;n?(y=l,m=d,v=c-l,p=h-d,w=o||0,M=this.markerStartAngle):(y=c,m=h,v=l-c,p=d-h,w=u||0,M=this.markerEndAngle),g=Math.atan2(p,v),f.setLocalEulerAngles(g*180/Math.PI+M),f.setLocalPosition(y+Math.cos(g)*w,m+Math.sin(g)*w)}}},{key:"getPoint",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.parsedStyle,s=a.x1,o=a.y1,u=a.x2,l=a.y2,c=qT(s,o,u,l,n),d=c.x,h=c.y,f=In(Ze(),vt(d,h,0),i?this.getWorldTransform():this.getLocalTransform());return new xn(f[0],f[1])}},{key:"getPointAtLength",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPoint(n/this.getTotalLength(),i)}},{key:"getTotalLength",value:function(){var n=this.parsedStyle,i=n.x1,a=n.y1,s=n.x2,o=n.y2;return $T(i,a,s,o)}}])}(mt);Wa.PARSED_STYLE_LIST=new Set([].concat(pt(mt.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var u4=["style"],lr=function(r){function e(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.style,a=Za(n,u4);ce(this,e),t=Ge(this,e,[qe({type:re.PATH,style:i,initialParsedStyle:{miterLimit:4,d:qe({},YT)}},a)]),t.markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var s=t.parsedStyle,o=s.markerStart,u=s.markerEnd,l=s.markerMid;return o&&et(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&et(l)&&t.placeMarkerMid(l),u&&et(u)&&(t.markerEndAngle=u.getLocalEulerAngles(),t.appendChild(u)),t.transformMarker(!0),t.transformMarker(!1),t}return We(e,r),de(e,[{key:"attributeChangedCallback",value:function(n,i,a,s,o){n==="d"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):n==="markerStartOffset"||n==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):n==="markerStart"?(s&&et(s)&&(this.markerStartAngle=0,s.remove()),o&&et(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):n==="markerEnd"?(s&&et(s)&&(this.markerEndAngle=0,s.remove()),o&&et(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):n==="markerMid"&&this.placeMarkerMid(o)}},{key:"transformMarker",value:function(n){var i=this.parsedStyle,a=i.markerStart,s=i.markerEnd,o=i.markerStartOffset,u=i.markerEndOffset,l=n?a:s;if(!(!l||!et(l))){var c=0,d,h,f,g,v,p;if(n){var y=this.getStartTangent(),m=ze(y,2),w=m[0],M=m[1];f=M[0],g=M[1],d=w[0]-M[0],h=w[1]-M[1],v=o||0,p=this.markerStartAngle}else{var S=this.getEndTangent(),T=ze(S,2),A=T[0],O=T[1];f=O[0],g=O[1],d=A[0]-O[0],h=A[1]-O[1],v=u||0,p=this.markerEndAngle}c=Math.atan2(h,d),l.setLocalEulerAngles(c*180/Math.PI+p),l.setLocalPosition(f+Math.cos(c)*v,g+Math.sin(c)*v)}}},{key:"placeMarkerMid",value:function(n){var i=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(c){c.remove()}),n&&et(n))for(var a=1;a<i.length-1;a++){var s=ze(i[a].currentPoint,2),o=s[0],u=s[1],l=a===1?n:n.cloneNode(!0);this.markerMidList.push(l),this.appendChild(l),l.setLocalPosition(o,u)}}},{key:"getTotalLength",value:function(){return uy(this)}},{key:"getPointAtLength",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.parsedStyle.d.absolutePath,s=_3(a,n),o=s.x,u=s.y,l=In(Ze(),vt(o,u,0),i?this.getWorldTransform():this.getLocalTransform());return new xn(l[0],l[1])}},{key:"getPoint",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPointAtLength(n*uy(this),i)}},{key:"getStartTangent",value:function(){var n=this.parsedStyle.d.segments,i=[];if(n.length>1){var a=n[0].currentPoint,s=n[1].currentPoint,o=n[1].startTangent;i=[],o?(i.push([a[0]-o[0],a[1]-o[1]]),i.push([a[0],a[1]])):(i.push([s[0],s[1]]),i.push([a[0],a[1]]))}return i}},{key:"getEndTangent",value:function(){var n=this.parsedStyle.d.segments,i=n.length,a=[];if(i>1){var s=n[i-2].currentPoint,o=n[i-1].currentPoint,u=n[i-1].endTangent;a=[],u?(a.push([o[0]-u[0],o[1]-u[1]]),a.push([o[0],o[1]])):(a.push([s[0],s[1]]),a.push([o[0],o[1]]))}return a}}])}(mt);lr.PARSED_STYLE_LIST=new Set([].concat(pt(mt.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var l4=["style"],Ja=function(r){function e(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.style,a=Za(n,l4);ce(this,e),t=Ge(this,e,[qe({type:re.POLYGON,style:i,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},a)]),t.markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var s=t.parsedStyle,o=s.markerStart,u=s.markerEnd,l=s.markerMid;return o&&et(o)&&(t.markerStartAngle=o.getLocalEulerAngles(),t.appendChild(o)),l&&et(l)&&t.placeMarkerMid(l),u&&et(u)&&(t.markerEndAngle=u.getLocalEulerAngles(),t.appendChild(u)),t.transformMarker(!0),t.transformMarker(!1),t}return We(e,r),de(e,[{key:"attributeChangedCallback",value:function(n,i,a,s,o){n==="points"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):n==="markerStartOffset"||n==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):n==="markerStart"?(s&&et(s)&&(this.markerStartAngle=0,s.remove()),o&&et(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):n==="markerEnd"?(s&&et(s)&&(this.markerEndAngle=0,s.remove()),o&&et(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):n==="markerMid"&&this.placeMarkerMid(o)}},{key:"transformMarker",value:function(n){var i=this.parsedStyle,a=i.markerStart,s=i.markerEnd,o=i.markerStartOffset,u=i.markerEndOffset,l=i.points,c=l||{},d=c.points,h=n?a:s;if(!(!h||!et(h)||!d)){var f=0,g,v,p,y,m,w;if(p=d[0][0],y=d[0][1],n)g=d[1][0]-d[0][0],v=d[1][1]-d[0][1],m=o||0,w=this.markerStartAngle;else{var M=d.length;this.parsedStyle.isClosed?(g=d[M-1][0]-d[0][0],v=d[M-1][1]-d[0][1]):(p=d[M-1][0],y=d[M-1][1],g=d[M-2][0]-d[M-1][0],v=d[M-2][1]-d[M-1][1]),m=u||0,w=this.markerEndAngle}f=Math.atan2(v,g),h.setLocalEulerAngles(f*180/Math.PI+w),h.setLocalPosition(p+Math.cos(f)*m,y+Math.sin(f)*m)}}},{key:"placeMarkerMid",value:function(n){var i=this.parsedStyle.points,a=i||{},s=a.points;if(this.markerMidList.forEach(function(d){d.remove()}),this.markerMidList=[],n&&et(n)&&s)for(var o=1;o<(this.parsedStyle.isClosed?s.length:s.length-1);o++){var u=s[o][0],l=s[o][1],c=o===1?n:n.cloneNode(!0);this.markerMidList.push(c),this.appendChild(c),c.setLocalPosition(u,l)}}}])}(mt);Ja.PARSED_STYLE_LIST=new Set([].concat(pt(mt.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var c4=["style"],kc=function(r){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.style,i=Za(t,c4);return ce(this,e),Ge(this,e,[qe({type:re.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},i)])}return We(e,r),de(e,[{key:"getTotalLength",value:function(){return nI(this)}},{key:"getPointAtLength",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPoint(n/this.getTotalLength(),i)}},{key:"getPoint",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.parsedStyle.points.points;if(this.parsedStyle.points.segments.length===0){var s=[],o=0,u,l,c=this.getTotalLength();a.forEach(function(y,m){a[m+1]&&(u=[0,0],u[0]=o/c,l=$T(y[0],y[1],a[m+1][0],a[m+1][1]),o+=l,u[1]=o/c,s.push(u))}),this.parsedStyle.points.segments=s}var d=0,h=0;this.parsedStyle.points.segments.forEach(function(y,m){n>=y[0]&&n<=y[1]&&(d=(n-y[0])/(y[1]-y[0]),h=m)});var f=qT(a[h][0],a[h][1],a[h+1][0],a[h+1][1],d),g=f.x,v=f.y,p=In(Ze(),vt(g,v,0),i?this.getWorldTransform():this.getLocalTransform());return new xn(p[0],p[1])}},{key:"getStartTangent",value:function(){var n=this.parsedStyle.points.points,i=[];return i.push([n[1][0],n[1][1]]),i.push([n[0][0],n[0][1]]),i}},{key:"getEndTangent",value:function(){var n=this.parsedStyle.points.points,i=n.length-1,a=[];return a.push([n[i-1][0],n[i-1][1]]),a.push([n[i][0],n[i][1]]),a}}])}(Ja);kc.PARSED_STYLE_LIST=new Set([].concat(pt(Ja.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var Sn=function(r){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ce(this,e),Ge(this,e,[qe({type:re.RECT},t)])}return We(e,r),de(e)}(mt);Sn.PARSED_STYLE_LIST=new Set([].concat(pt(mt.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var d4=["style"],es=function(r){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.style,i=Za(t,d4);return ce(this,e),Ge(this,e,[qe({type:re.TEXT,style:qe({fill:"black"},n)},i)])}return We(e,r),de(e,[{key:"getComputedTextLength",value:function(){var n;return this.getGeometryBounds(),((n=this.parsedStyle.metrics)===null||n===void 0?void 0:n.maxLineWidth)||0}},{key:"getLineBoundingRects",value:function(){var n;return this.getGeometryBounds(),((n=this.parsedStyle.metrics)===null||n===void 0?void 0:n.lineMetrics)||[]}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing}}])}(mt);es.PARSED_STYLE_LIST=new Set([].concat(pt(mt.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textPathSide","textPathStartOffset","metrics","dx","dy"]));var h4=function(){function r(){ce(this,r),this.registry={},this.define(re.CIRCLE,Ii),this.define(re.ELLIPSE,lu),this.define(re.RECT,Sn),this.define(re.IMAGE,du),this.define(re.LINE,Wa),this.define(re.GROUP,ln),this.define(re.PATH,lr),this.define(re.POLYGON,Ja),this.define(re.POLYLINE,kc),this.define(re.TEXT,es),this.define(re.HTML,cu)}return de(r,[{key:"define",value:function(t,n){this.registry[t]=n}},{key:"get",value:function(t){return this.registry[t]}}])}(),mO=function(r){function e(){var t;ce(this,e),t=Ge(this,e),t.defaultView=null,t.ownerDocument=null,t.nodeName="document";try{t.timeline=new fe.AnimationTimeline(t)}catch{}var n={};return fm.forEach(function(i){var a=i.n,s=i.inh,o=i.d;s&&o&&(n[a]=Te(o)?o(re.GROUP):o)}),t.documentElement=new ln({id:"g-root",style:n}),t.documentElement.ownerDocument=t,t.documentElement.parentNode=t,t.childNodes=[t.documentElement],t}return We(e,r),de(e,[{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"createElement",value:function(n,i){if(n==="svg")return this.documentElement;var a=this.defaultView.customElements.get(n);a||(console.warn("Unsupported tagName: ",n),a=n==="tspan"?es:ln);var s=new a(i);return s.ownerDocument=this,s}},{key:"createElementNS",value:function(n,i,a){return this.createElement(i,a)}},{key:"cloneNode",value:function(n){throw new Error(it)}},{key:"destroy",value:function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch{}}},{key:"elementsFromBBox",value:function(n,i,a,s){var o=this.defaultView.context.rBushRoot,u=o.search({minX:n,minY:i,maxX:a,maxY:s}),l=[];return u.forEach(function(c){var d=c.displayObject,h=d.parsedStyle.pointerEvents,f=h===void 0?"auto":h,g=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(f);(!g||g&&d.isVisible())&&!d.isCulled()&&d.isInteractive()&&l.push(d)}),l.sort(function(c,d){return d.sortable.renderOrder-c.sortable.renderOrder}),l}},{key:"elementFromPointSync",value:function(n,i){var a=this.defaultView.canvas2Viewport({x:n,y:i}),s=a.x,o=a.y,u=this.defaultView.getConfig(),l=u.width,c=u.height;if(s<0||o<0||s>l||o>c)return null;var d=this.defaultView.viewport2Client({x:s,y:o}),h=d.x,f=d.y,g=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:n,y:i,viewportX:s,viewportY:o,clientX:h,clientY:f},picked:[]}),v=g.picked;return v&&v[0]||this.documentElement}},{key:"elementFromPoint",value:function(){var t=da(Mn().mark(function i(a,s){var o,u,l,c,d,h,f,g,v,p,y;return Mn().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(o=this.defaultView.canvas2Viewport({x:a,y:s}),u=o.x,l=o.y,c=this.defaultView.getConfig(),d=c.width,h=c.height,!(u<0||l<0||u>d||l>h)){w.next=4;break}return w.abrupt("return",null);case 4:return f=this.defaultView.viewport2Client({x:u,y:l}),g=f.x,v=f.y,w.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:a,y:s,viewportX:u,viewportY:l,clientX:g,clientY:v},picked:[]});case 7:return p=w.sent,y=p.picked,w.abrupt("return",y&&y[0]||this.documentElement);case 10:case"end":return w.stop()}},i,this)}));function n(i,a){return t.apply(this,arguments)}return n}()},{key:"elementsFromPointSync",value:function(n,i){var a=this.defaultView.canvas2Viewport({x:n,y:i}),s=a.x,o=a.y,u=this.defaultView.getConfig(),l=u.width,c=u.height;if(s<0||o<0||s>l||o>c)return[];var d=this.defaultView.viewport2Client({x:s,y:o}),h=d.x,f=d.y,g=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:n,y:i,viewportX:s,viewportY:o,clientX:h,clientY:f},picked:[]}),v=g.picked;return v[v.length-1]!==this.documentElement&&v.push(this.documentElement),v}},{key:"elementsFromPoint",value:function(){var t=da(Mn().mark(function i(a,s){var o,u,l,c,d,h,f,g,v,p,y;return Mn().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(o=this.defaultView.canvas2Viewport({x:a,y:s}),u=o.x,l=o.y,c=this.defaultView.getConfig(),d=c.width,h=c.height,!(u<0||l<0||u>d||l>h)){w.next=4;break}return w.abrupt("return",[]);case 4:return f=this.defaultView.viewport2Client({x:u,y:l}),g=f.x,v=f.y,w.next=7,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:a,y:s,viewportX:u,viewportY:l,clientX:g,clientY:v},picked:[]});case 7:return p=w.sent,y=p.picked,y[y.length-1]!==this.documentElement&&y.push(this.documentElement),w.abrupt("return",y);case 11:case"end":return w.stop()}},i,this)}));function n(i,a){return t.apply(this,arguments)}return n}()},{key:"appendChild",value:function(n,i){throw new Error(fs)}},{key:"insertBefore",value:function(n,i){throw new Error(fs)}},{key:"removeChild",value:function(n,i){throw new Error(fs)}},{key:"replaceChild",value:function(n,i,a){throw new Error(fs)}},{key:"append",value:function(){throw new Error(fs)}},{key:"prepend",value:function(){throw new Error(fs)}},{key:"getElementById",value:function(n){return this.documentElement.getElementById(n)}},{key:"getElementsByName",value:function(n){return this.documentElement.getElementsByName(n)}},{key:"getElementsByTagName",value:function(n){return this.documentElement.getElementsByTagName(n)}},{key:"getElementsByClassName",value:function(n){return this.documentElement.getElementsByClassName(n)}},{key:"querySelector",value:function(n){return this.documentElement.querySelector(n)}},{key:"querySelectorAll",value:function(n){return this.documentElement.querySelectorAll(n)}},{key:"find",value:function(n){return this.documentElement.find(n)}},{key:"findAll",value:function(n){return this.documentElement.findAll(n)}}])}(Ct),bO=function(){function r(e){ce(this,r),this.strategies=e}return de(r,[{key:"apply",value:function(t){var n=t.camera,i=t.renderingService,a=t.renderingContext,s=this.strategies;i.hooks.cull.tap(r.tag,function(o){if(o){var u=o.cullable;return s.length===0?u.visible=a.unculledEntities.indexOf(o.entity)>-1:u.visible=s.every(function(l){return l.isVisible(n,o)}),!o.isCulled()&&o.isVisible()?o:(o.dispatchEvent(new Kt(He.CULLED)),null)}return o}),i.hooks.afterRender.tap(r.tag,function(o){o.cullable.visibilityPlaneMask=-1})}}])}();bO.tag="Culling";var wO=function(){function r(){var e=this;ce(this,r),this.autoPreventDefault=!1,this.rootPointerEvent=new tc(null),this.rootWheelEvent=new hy(null),this.onPointerMove=function(t){var n,i=(n=e.context.renderingContext.root)===null||n===void 0||(n=n.ownerDocument)===null||n===void 0?void 0:n.defaultView;if(!(i.supportsTouchEvents&&t.pointerType==="touch")){var a=e.normalizeToPointerEvent(t,i),s=ka(a),o;try{for(s.s();!(o=s.n()).done;){var u=o.value,l=e.bootstrapEvent(e.rootPointerEvent,u,i,t);e.context.eventService.mapEvent(l)}}catch(c){s.e(c)}finally{s.f()}e.setCursor(e.context.eventService.cursor)}},this.onClick=function(t){var n,i=(n=e.context.renderingContext.root)===null||n===void 0||(n=n.ownerDocument)===null||n===void 0?void 0:n.defaultView,a=e.normalizeToPointerEvent(t,i),s=ka(a),o;try{for(s.s();!(o=s.n()).done;){var u=o.value,l=e.bootstrapEvent(e.rootPointerEvent,u,i,t);e.context.eventService.mapEvent(l)}}catch(c){s.e(c)}finally{s.f()}e.setCursor(e.context.eventService.cursor)}}return de(r,[{key:"apply",value:function(t){var n=this;this.context=t;var i=t.renderingService,a=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(s){var o=n.context.renderingService.hooks.pickSync.call({position:s,picked:[],topmost:!0}),u=o.picked;return u[0]||null}),i.hooks.pointerWheel.tap(r.tag,function(s){var o=n.normalizeWheelEvent(s);n.context.eventService.mapEvent(o)}),i.hooks.pointerDown.tap(r.tag,function(s){if(!(a.supportsTouchEvents&&s.pointerType==="touch")){var o=n.normalizeToPointerEvent(s,a);if(n.autoPreventDefault&&o[0].isNormalized){var u=s.cancelable||!("cancelable"in s);u&&s.preventDefault()}var l=ka(o),c;try{for(l.s();!(c=l.n()).done;){var d=c.value,h=n.bootstrapEvent(n.rootPointerEvent,d,a,s);n.context.eventService.mapEvent(h)}}catch(f){l.e(f)}finally{l.f()}n.setCursor(n.context.eventService.cursor)}}),i.hooks.pointerUp.tap(r.tag,function(s){if(!(a.supportsTouchEvents&&s.pointerType==="touch")){var o=n.context.contextService.getDomElement(),u=n.context.eventService.isNativeEventFromCanvas(o,s),l=u?"":"outside",c=n.normalizeToPointerEvent(s,a),d=ka(c),h;try{for(d.s();!(h=d.n()).done;){var f=h.value,g=n.bootstrapEvent(n.rootPointerEvent,f,a,s);g.type+=l,n.context.eventService.mapEvent(g)}}catch(v){d.e(v)}finally{d.f()}n.setCursor(n.context.eventService.cursor)}}),i.hooks.pointerMove.tap(r.tag,this.onPointerMove),i.hooks.pointerOver.tap(r.tag,this.onPointerMove),i.hooks.pointerOut.tap(r.tag,this.onPointerMove),i.hooks.click.tap(r.tag,this.onClick),i.hooks.pointerCancel.tap(r.tag,function(s){var o=n.normalizeToPointerEvent(s,a),u=ka(o),l;try{for(u.s();!(l=u.n()).done;){var c=l.value,d=n.bootstrapEvent(n.rootPointerEvent,c,a,s);n.context.eventService.mapEvent(d)}}catch(h){u.e(h)}finally{u.f()}n.setCursor(n.context.eventService.cursor)})}},{key:"bootstrapEvent",value:function(t,n,i,a){t.view=i,t.originalEvent=null,t.nativeEvent=a,t.pointerId=n.pointerId,t.width=n.width,t.height=n.height,t.isPrimary=n.isPrimary,t.pointerType=n.pointerType,t.pressure=n.pressure,t.tangentialPressure=n.tangentialPressure,t.tiltX=n.tiltX,t.tiltY=n.tiltY,t.twist=n.twist,this.transferMouseData(t,n);var s=this.context.eventService.client2Viewport({x:n.clientX,y:n.clientY}),o=s.x,u=s.y;t.viewport.x=o,t.viewport.y=u;var l=this.context.eventService.viewport2Canvas(t.viewport),c=l.x,d=l.y;return t.canvas.x=c,t.canvas.y=d,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=a.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=XI[t.type]||t.type),t}},{key:"normalizeWheelEvent",value:function(t){var n=this.rootWheelEvent;this.transferMouseData(n,t),n.deltaMode=t.deltaMode,n.deltaX=t.deltaX,n.deltaY=t.deltaY,n.deltaZ=t.deltaZ;var i=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),a=i.x,s=i.y;n.viewport.x=a,n.viewport.y=s;var o=this.context.eventService.viewport2Canvas(n.viewport),u=o.x,l=o.y;return n.canvas.x=u,n.canvas.y=l,n.global.copyFrom(n.canvas),n.offset.copyFrom(n.canvas),n.nativeEvent=t,n.type=t.type,n}},{key:"transferMouseData",value:function(t,n){t.isTrusted=n.isTrusted,t.srcElement=n.srcElement,t.timeStamp=dy.now(),t.type=n.type,t.altKey=n.altKey,t.metaKey=n.metaKey,t.shiftKey=n.shiftKey,t.ctrlKey=n.ctrlKey,t.button=n.button,t.buttons=n.buttons,t.client.x=n.clientX,t.client.y=n.clientY,t.movement.x=n.movementX,t.movement.y=n.movementY,t.page.x=n.pageX,t.page.y=n.pageY,t.screen.x=n.screenX,t.screen.y=n.screenY,t.relatedTarget=null}},{key:"setCursor",value:function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default")}},{key:"normalizeToPointerEvent",value:function(t,n){var i=[];if(n.isTouchEvent(t))for(var a=0;a<t.changedTouches.length;a++){var s=t.changedTouches[a];je(s.button)&&(s.button=0),je(s.buttons)&&(s.buttons=1),je(s.isPrimary)&&(s.isPrimary=t.touches.length===1&&t.type==="touchstart"),je(s.width)&&(s.width=s.radiusX||1),je(s.height)&&(s.height=s.radiusY||1),je(s.tiltX)&&(s.tiltX=0),je(s.tiltY)&&(s.tiltY=0),je(s.pointerType)&&(s.pointerType="touch"),je(s.pointerId)&&(s.pointerId=s.identifier||0),je(s.pressure)&&(s.pressure=s.force||.5),je(s.twist)&&(s.twist=0),je(s.tangentialPressure)&&(s.tangentialPressure=0),s.isNormalized=!0,s.type=t.type,i.push(s)}else if(n.isMouseEvent(t)){var o=t;je(o.isPrimary)&&(o.isPrimary=!0),je(o.width)&&(o.width=1),je(o.height)&&(o.height=1),je(o.tiltX)&&(o.tiltX=0),je(o.tiltY)&&(o.tiltY=0),je(o.pointerType)&&(o.pointerType="mouse"),je(o.pointerId)&&(o.pointerId=HI),je(o.pressure)&&(o.pressure=.5),je(o.twist)&&(o.twist=0),je(o.tangentialPressure)&&(o.tangentialPressure=0),o.isNormalized=!0,i.push(o)}else i.push(t);return i}}])}();wO.tag="Event";var f4=[re.CIRCLE,re.ELLIPSE,re.IMAGE,re.RECT,re.LINE,re.POLYLINE,re.POLYGON,re.TEXT,re.PATH,re.HTML],g4=function(){function r(){ce(this,r)}return de(r,[{key:"isVisible",value:function(t,n){var i,a=n.cullable;if(!a.enable)return!0;var s=n.getRenderBounds();if(ft.isEmpty(s))return!1;var o=t.getFrustum(),u=(i=n.parentNode)===null||i===void 0||(i=i.cullable)===null||i===void 0?void 0:i.visibilityPlaneMask;return a.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(n,s,u||hs.INDETERMINATE,o.planes),a.visible=a.visibilityPlaneMask!==hs.OUTSIDE,a.visible}},{key:"computeVisibilityWithPlaneMask",value:function(t,n,i,a){if(i===hs.OUTSIDE||i===hs.INSIDE)return i;for(var s=hs.INSIDE,o=f4.indexOf(t.nodeName)>-1,u=0,l=a.length;u<l;++u){var c=1<<u;if(i&c&&!(o&&(u===4||u===5))){var d=a[u],h=d.normal,f=d.distance;if(ii(h,n.getPositiveFarPoint(a[u]))+f<0)return hs.OUTSIDE;ii(h,n.getNegativeFarPoint(a[u]))+f<0&&(s|=c)}}return s}}])}(),xO=function(){function r(){ce(this,r),this.syncTasks=new Map,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return de(r,[{key:"apply",value:function(t){var n=this,i,a=t.renderingService,s=t.renderingContext,o=t.rBushRoot,u=s.root.ownerDocument.defaultView;this.rBush=o;var l=function(v){var p=v.target;p.renderable.dirty=!0,a.dirtify()},c=function(v){n.syncTasks.set(v.target,v.detail.affectChildren),a.dirtify()},d=function(v){var p=v.target;fe.enableSizeAttenuation&&fe.styleValueRegistry.updateSizeAttenuation(p,u.getCamera().getZoom())},h=function(v){var p=v.target,y=p.rBushNode;y.aabb&&n.rBush.remove(y.aabb),n.syncTasks.delete(p),fe.sceneGraphService.dirtifyToRoot(p),a.dirtify()};a.hooks.init.tap(r.tag,function(){u.addEventListener(He.MOUNTED,d),u.addEventListener(He.UNMOUNTED,h),u.addEventListener(He.ATTR_MODIFIED,l),u.addEventListener(He.BOUNDS_CHANGED,c)}),a.hooks.destroy.tap(r.tag,function(){u.removeEventListener(He.MOUNTED,d),u.removeEventListener(He.UNMOUNTED,h),u.removeEventListener(He.ATTR_MODIFIED,l),u.removeEventListener(He.BOUNDS_CHANGED,c),n.syncTasks.clear()});var f=(i=fe.globalThis.requestIdleCallback)!==null&&i!==void 0?i:pm.bind(fe.globalThis);a.hooks.endFrame.tap(r.tag,function(){n.isFirstTimeRendering?(n.isFirstTimeRendering=!1,n.syncing=!0,f(function(){n.syncRTree(!0),n.isFirstTimeRenderingFinished=!0})):n.syncRTree()})}},{key:"syncNode",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(t.isConnected){var i=t.rBushNode;i.aabb&&this.rBush.remove(i.aabb);var a=t.getRenderBounds();if(a){var s=t.renderable;n&&(s.dirtyRenderBounds||(s.dirtyRenderBounds=new ft),s.dirtyRenderBounds.update(a.center,a.halfExtents));var o=a.getMin(),u=ze(o,2),l=u[0],c=u[1],d=a.getMax(),h=ze(d,2),f=h[0],g=h[1];i.aabb||(i.aabb={}),i.aabb.displayObject=t,i.aabb.minX=l,i.aabb.minY=c,i.aabb.maxX=f,i.aabb.maxY=g}if(i.aabb&&!isNaN(i.aabb.maxX)&&!isNaN(i.aabb.maxX)&&!isNaN(i.aabb.minX)&&!isNaN(i.aabb.minY))return i.aabb}}},{key:"syncRTree",value:function(){var t=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!n&&(this.syncing||this.syncTasks.size===0))){this.syncing=!0;var i=[],a=new Set,s=function(u){if(!a.has(u)&&u.renderable){var l=t.syncNode(u,n);l&&(i.push(l),a.add(u))}};this.syncTasks.forEach(function(o,u){o&&u.forEach(s);for(var l=u;l;)s(l),l=l.parentElement}),this.rBush.load(i),i.length=0,this.syncing=!1}}}])}();xO.tag="Prepare";var or=function(r){return r.READY="ready",r.BEFORE_RENDER="beforerender",r.RERENDER="rerender",r.AFTER_RENDER="afterrender",r.BEFORE_DESTROY="beforedestroy",r.AFTER_DESTROY="afterdestroy",r.RESIZE="resize",r.DIRTY_RECTANGLE="dirtyrectangle",r.RENDERER_CHANGED="rendererchanged",r}({}),Sb=500,p4=.1,v4=1e3,qu=new Kt(He.MOUNTED),Gu=new Kt(He.UNMOUNTED),Sh=new Kt(or.BEFORE_RENDER),_b=new Kt(or.RERENDER),_h=new Kt(or.AFTER_RENDER),py=function(r){function e(t){var n;ce(this,e),n=Ge(this,e),n.Element=mt,n.inited=!1,n.context={};var i=t.container,a=t.canvas,s=t.renderer,o=t.width,u=t.height,l=t.background,c=t.cursor,d=t.supportsMutipleCanvasesInOneContainer,h=t.cleanUpOnDestroy,f=h===void 0?!0:h,g=t.offscreenCanvas,v=t.devicePixelRatio,p=t.requestAnimationFrame,y=t.cancelAnimationFrame,m=t.createImage,w=t.supportsTouchEvents,M=t.supportsPointerEvents,S=t.isTouchEvent,T=t.isMouseEvent,A=t.dblClickSpeed,O=o,N=u,C=v||gm&&window.devicePixelRatio||1;return C=C>=1?Math.ceil(C):1,a&&(O=o||YI(a)||a.width/C,N=u||UI(a)||a.height/C),n.customElements=new h4,n.devicePixelRatio=C,n.requestAnimationFrame=p??pm.bind(fe.globalThis),n.cancelAnimationFrame=y??fO.bind(fe.globalThis),n.supportsTouchEvents=w??"ontouchstart"in fe.globalThis,n.supportsPointerEvents=M??!!fe.globalThis.PointerEvent,n.isTouchEvent=S??function(P){return n.supportsTouchEvents&&P instanceof fe.globalThis.TouchEvent},n.isMouseEvent=T??function(P){return!fe.globalThis.MouseEvent||P instanceof fe.globalThis.MouseEvent&&(!n.supportsPointerEvents||!(P instanceof fe.globalThis.PointerEvent))},g&&(fe.offscreenCanvas=g),n.document=new mO,n.document.defaultView=n,d||qI(i,n,f),n.initRenderingContext(qe(qe({},t),{},{width:O,height:N,background:l??"transparent",cursor:c??"default",cleanUpOnDestroy:f,devicePixelRatio:C,requestAnimationFrame:n.requestAnimationFrame,cancelAnimationFrame:n.cancelAnimationFrame,supportsTouchEvents:n.supportsTouchEvents,supportsPointerEvents:n.supportsPointerEvents,isTouchEvent:n.isTouchEvent,isMouseEvent:n.isMouseEvent,dblClickSpeed:A??200,createImage:m??function(){return new window.Image}})),n.initDefaultCamera(O,N,s.clipSpaceNearZ),n.initRenderer(s,!0),n}return We(e,r),de(e,[{key:"initRenderingContext",value:function(n){this.context.config=n,this.context.renderingContext={root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}}},{key:"initDefaultCamera",value:function(n,i,a){var s=this,o=new fe.CameraContribution;o.clipSpaceNearZ=a,o.setType(rt.EXPLORING,ry.DEFAULT).setPosition(n/2,i/2,Sb).setFocalPoint(n/2,i/2,0).setOrthographic(n/-2,n/2,i/2,i/-2,p4,v4),o.canvas=this,o.eventEmitter.on(WT.UPDATED,function(){s.context.renderingContext.renderReasons.add(Ps.CAMERA_CHANGED),fe.enableSizeAttenuation&&s.getConfig().renderer.getConfig().enableSizeAttenuation&&s.updateSizeAttenuation()}),this.context.camera=o}},{key:"updateSizeAttenuation",value:function(){var n=this.getCamera().getZoom();this.document.documentElement.forEach(function(i){fe.styleValueRegistry.updateSizeAttenuation(i,n)})}},{key:"getConfig",value:function(){return this.context.config}},{key:"getRoot",value:function(){return this.document.documentElement}},{key:"getCamera",value:function(){return this.context.camera}},{key:"getContextService",value:function(){return this.context.contextService}},{key:"getEventService",value:function(){return this.context.eventService}},{key:"getRenderingService",value:function(){return this.context.renderingService}},{key:"getRenderingContext",value:function(){return this.context.renderingContext}},{key:"getStats",value:function(){return this.getRenderingService().getStats()}},{key:"ready",get:function(){var n=this;return this.readyPromise||(this.readyPromise=new Promise(function(i){n.resolveReadyPromise=function(){i(n)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise}},{key:"destroy",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,i=arguments.length>1?arguments[1]:void 0;tn.clearCache(),i||this.dispatchEvent(new Kt(or.BEFORE_DESTROY)),this.frameId&&this.cancelAnimationFrame(this.frameId);var a=this.getRoot();n&&(this.unmountChildren(a),this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),this.context.rBushRoot&&this.context.rBushRoot.clear(),i||this.dispatchEvent(new Kt(or.AFTER_DESTROY));var s=function(u){u.currentTarget=null,u.manager=null,u.target=null,u.relatedNode=null};s(qu),s(Gu),s(Sh),s(_b),s(_h),s(ei),s(fy),s(gy),s(yO)}},{key:"changeSize",value:function(n,i){this.resize(n,i)}},{key:"resize",value:function(n,i){var a=this.context.config;a.width=n,a.height=i,this.getContextService().resize(n,i);var s=this.context.camera,o=s.getProjectionMode();s.setPosition(n/2,i/2,Sb).setFocalPoint(n/2,i/2,0),o===Sr.ORTHOGRAPHIC?s.setOrthographic(n/-2,n/2,i/2,i/-2,s.getNear(),s.getFar()):s.setAspect(n/i),this.dispatchEvent(new Kt(or.RESIZE,{width:n,height:i}))}},{key:"appendChild",value:function(n,i){return this.document.documentElement.appendChild(n,i)}},{key:"insertBefore",value:function(n,i){return this.document.documentElement.insertBefore(n,i)}},{key:"removeChild",value:function(n){return this.document.documentElement.removeChild(n)}},{key:"removeChildren",value:function(){this.document.documentElement.removeChildren()}},{key:"destroyChildren",value:function(){this.document.documentElement.destroyChildren()}},{key:"render",value:function(n){var i=this;n&&(Sh.detail=n,_h.detail=n),this.dispatchEvent(Sh);var a=this.getRenderingService();a.render(this.getConfig(),n,function(){i.dispatchEvent(_b)}),this.dispatchEvent(_h)}},{key:"run",value:function(){var n=this,i=function(s,o){n.render(o),n.frameId=n.requestAnimationFrame(i)};i()}},{key:"initRenderer",value:function(n){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!n)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new rD,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new wO,new xO,new bO([new g4])),this.loadRendererContainerModule(n),this.context.contextService=new this.context.ContextService(qe(qe({},fe),this.context)),this.context.renderingService=new AR(fe,this.context),this.context.eventService=new OR(fe,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(n,a,!0)):this.context.contextService.initAsync().then(function(){i.initRenderingService(n,a)}).catch(function(s){console.error(s)})}},{key:"initRenderingService",value:function(n){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.context.renderingService.init(function(){i.inited=!0,a?s?i.requestAnimationFrame(function(){i.dispatchEvent(new Kt(or.READY))}):i.dispatchEvent(new Kt(or.READY)):i.dispatchEvent(new Kt(or.RENDERER_CHANGED)),i.readyPromise&&i.resolveReadyPromise(),a||i.getRoot().forEach(function(o){var u=o,l=u.renderable;l&&(l.renderBoundsDirty=!0,l.boundsDirty=!0,l.dirty=!0)}),i.mountChildren(i.getRoot()),n.getConfig().enableAutoRendering&&i.run()})}},{key:"loadRendererContainerModule",value:function(n){var i=this,a=n.getPlugins();a.forEach(function(s){s.context=i.context,s.init(fe)})}},{key:"setRenderer",value:function(n){var i=this.getConfig();if(i.renderer!==n){var a=i.renderer;i.renderer=n,this.destroy(!1,!0),pt((a==null?void 0:a.getPlugins())||[]).reverse().forEach(function(s){s.destroy(fe)}),this.initRenderer(n)}}},{key:"setCursor",value:function(n){var i=this.getConfig();i.cursor=n,this.getContextService().applyCursorStyle(n)}},{key:"unmountChildren",value:function(n){var i=this;n.childNodes.forEach(function(a){i.unmountChildren(a)}),this.inited&&(n.isMutationObserved?n.dispatchEvent(Gu):(Gu.target=n,this.dispatchEvent(Gu,!0)),n!==this.document.documentElement&&(n.ownerDocument=null),n.isConnected=!1),n.isCustomElement&&n.disconnectedCallback&&n.disconnectedCallback()}},{key:"mountChildren",value:function(n){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ec(n);this.inited?n.isConnected||(n.ownerDocument=this.document,n.isConnected=!0,a||(n.isMutationObserved?n.dispatchEvent(qu):(qu.target=n,this.dispatchEvent(qu,!0)))):console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",n.nodeName),n.childNodes.forEach(function(s){i.mountChildren(s,a)}),n.isCustomElement&&n.connectedCallback&&n.connectedCallback()}},{key:"mountFragment",value:function(n){this.mountChildren(n,!1)}},{key:"client2Viewport",value:function(n){return this.getEventService().client2Viewport(n)}},{key:"viewport2Client",value:function(n){return this.getEventService().viewport2Client(n)}},{key:"viewport2Canvas",value:function(n){return this.getEventService().viewport2Canvas(n)}},{key:"canvas2Viewport",value:function(n){return this.getEventService().canvas2Viewport(n)}},{key:"getPointByClient",value:function(n,i){return this.client2Viewport({x:n,y:i})}},{key:"getClientByPoint",value:function(n,i){return this.viewport2Client({x:n,y:i})}}])}(vO);/*!
 * @antv/g-camera-api
 * @description A simple implementation of Camera API.
 * @version 2.0.34
 * @date 1/17/2025, 2:05:54 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var y4=function(r){function e(){var t;ce(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=Ge(this,e,[].concat(i)),t.landmarks=[],t}return We(e,r),de(e,[{key:"rotate",value:function(n,i,a){if(this.relElevation=Ns(i),this.relAzimuth=Ns(n),this.relRoll=Ns(a),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===rt.EXPLORING){var s=Xi(an(),[1,0,0],at((this.rotateWorld?1:-1)*this.relElevation)),o=Xi(an(),[0,1,0],at((this.rotateWorld?1:-1)*this.relAzimuth)),u=Xi(an(),[0,0,1],at(this.relRoll)),l=ia(an(),o,s);l=ia(an(),l,u);var c=am(ht(),l);As(this.matrix,this.matrix,[0,0,-this.distance]),Dn(this.matrix,this.matrix,c),As(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===rt.ORBITING||this.type===rt.EXPLORING?this._getPosition():this.type===rt.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:"pan",value:function(n,i){var a=jn(n,i,0),s=yi(this.position);return ra(s,s,$l(Ze(),this.right,a[0])),ra(s,s,$l(Ze(),this.up,a[1])),this._setPosition(s),this.triggerUpdate(),this}},{key:"dolly",value:function(n){var i=this.forward,a=yi(this.position),s=n*this.dollyingStep,o=this.distance+n*this.dollyingStep;return s=Math.max(Math.min(o,this.maxDistance),this.minDistance)-this.distance,a[0]+=s*i[0],a[1]+=s*i[1],a[2]+=s*i[2],this._setPosition(a),this.type===rt.ORBITING||this.type===rt.EXPLORING?this._getDistance():this.type===rt.TRACKING&&ra(this.focalPoint,a,this.distanceVector),this.triggerUpdate(),this}},{key:"cancelLandmarkAnimation",value:function(){this.landmarkAnimationID!==void 0&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)}},{key:"createLandmark",value:function(n){var i,a,s,o,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=u.position,c=l===void 0?this.position:l,d=u.focalPoint,h=d===void 0?this.focalPoint:d,f=u.roll,g=u.zoom,v=new fe.CameraContribution;v.setType(this.type,void 0),v.setPosition(c[0],(i=c[1])!==null&&i!==void 0?i:this.position[1],(a=c[2])!==null&&a!==void 0?a:this.position[2]),v.setFocalPoint(h[0],(s=h[1])!==null&&s!==void 0?s:this.focalPoint[1],(o=h[2])!==null&&o!==void 0?o:this.focalPoint[2]),v.setRoll(f??this.roll),v.setZoom(g??this.zoom);var p={name:n,matrix:iT(v.getWorldTransform()),right:yi(v.right),up:yi(v.up),forward:yi(v.forward),position:yi(v.getPosition()),focalPoint:yi(v.getFocalPoint()),distanceVector:yi(v.getDistanceVector()),distance:v.getDistance(),dollyingStep:v.getDollyingStep(),azimuth:v.getAzimuth(),elevation:v.getElevation(),roll:v.getRoll(),relAzimuth:v.relAzimuth,relElevation:v.relElevation,relRoll:v.relRoll,zoom:v.getZoom()};return this.landmarks.push(p),p}},{key:"gotoLandmark",value:function(n){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=tt(n)?this.landmarks.find(function(P){return P.name===n}):n;if(s){var o=Ee(a)?{duration:a}:a,u=o.easing,l=u===void 0?"linear":u,c=o.duration,d=c===void 0?100:c,h=o.easingFunction,f=h===void 0?void 0:h,g=o.onfinish,v=g===void 0?void 0:g,p=o.onframe,y=p===void 0?void 0:p,m=.01;this.cancelLandmarkAnimation();var w=s.position,M=s.focalPoint,S=s.zoom,T=s.roll,A=f||fe.EasingFunction(l),O,N=function(){i.setFocalPoint(M),i.setPosition(w),i.setRoll(T),i.setZoom(S),i.computeMatrix(),i.triggerUpdate(),v==null||v()};if(d===0)return N();var C=function(D){O===void 0&&(O=D);var j=D-O;if(j>=d){N();return}var G=A(j/d),V=Ze(),Y=Ze(),$=1,z=0;U0(V,i.focalPoint,M,G),U0(Y,i.position,w,G),z=i.roll*(1-G)+T*G,$=i.zoom*(1-G)+S*G,i.setFocalPoint(V),i.setPosition(Y),i.setRoll(z),i.setZoom($);var Z=D1(V,M)+D1(Y,w);if(Z<=m&&S===void 0&&T===void 0)return N();i.computeMatrix(),i.triggerUpdate(),j<d&&(y==null||y(G),i.landmarkAnimationID=i.canvas.requestAnimationFrame(C))};this.canvas.requestAnimationFrame(C)}}}])}(VT);fe.CameraContribution=y4;/*!
 * @antv/g-web-animations-api
 * @description A simple implementation of Web Animations API.
 * @version 2.1.20
 * @date 1/17/2025, 2:07:41 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var Th=function(r){function e(t,n,i,a){var s;return ce(this,e),s=Ge(this,e,[t]),s.currentTime=i,s.timelineTime=a,s.target=n,s.type="finish",s.bubbles=!1,s.currentTarget=n,s.defaultPrevented=!1,s.eventPhase=s.AT_TARGET,s.timeStamp=Date.now(),s.currentTime=i,s.timelineTime=a,s}return We(e,r),de(e)}(Ac),m4=0,b4=function(){function r(e,t){var n;ce(this,r),this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=e,e.animation=this,this.timeline=t,this.id="".concat(m4++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number((n=this.effect)===null||n===void 0?void 0:n.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}return de(r,[{key:"pending",get:function(){return this._startTime===null&&!this._paused&&this.playbackRate!==0||this.currentTimePending}},{key:"playState",get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"}},{key:"ready",get:function(){var t=this;return this.readyPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(n,i){t.resolveReadyPromise=function(){n(t)},t.rejectReadyPromise=function(){i(new Error)}}),this.pending||this.resolveReadyPromise()),this.readyPromise}},{key:"finished",get:function(){var t=this;return this.finishedPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(n,i){t.resolveFinishedPromise=function(){n(t)},t.rejectFinishedPromise=function(){i(new Error)}}),this.playState==="finished"&&this.resolveFinishedPromise()),this.finishedPromise}},{key:"currentTime",get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(t){if(t=Number(t),!isNaN(t)){if(this.timeline.restart(),!this._paused&&this._startTime!==null){var n;this._startTime=Number((n=this.timeline)===null||n===void 0?void 0:n.currentTime)-t/this.playbackRate}this.currentTimePending=!1,this._currentTime!==t&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(t,!0),this.timeline.applyDirtiedAnimation(this))}}},{key:"startTime",get:function(){return this._startTime},set:function(t){if(t!==null){if(this.updatePromises(),t=Number(t),isNaN(t)||this._paused||this._idle)return;this._startTime=t,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(t){if(t!==this._playbackRate){this.updatePromises();var n=this.currentTime;this._playbackRate=t,this.startTime=null,this.playState!=="paused"&&this.playState!=="idle"&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),n!==null&&(this.currentTime=n),this.updatePromises()}}},{key:"_isFinished",get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)}},{key:"totalDuration",get:function(){return this._totalDuration}},{key:"_needsTick",get:function(){return this.pending||this.playState==="running"||!this._finishedFlag}},{key:"updatePromises",value:function(){var t=this.oldPlayState,n=this.pending?"pending":this.playState;return this.readyPromise&&n!==t&&(n==="idle"?(this.rejectReadyPromise(),this.readyPromise=void 0):t==="pending"?this.resolveReadyPromise():n==="pending"&&(this.readyPromise=void 0)),this.finishedPromise&&n!==t&&(n==="idle"?(this.rejectFinishedPromise(),this.finishedPromise=void 0):n==="finished"?this.resolveFinishedPromise():t==="finished"&&(this.finishedPromise=void 0)),this.oldPlayState=n,this.readyPromise||this.finishedPromise}},{key:"play",value:function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),this.timeline.animations.indexOf(this)===-1&&this.timeline.animations.push(this),this.updatePromises()}},{key:"pause",value:function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),!this._isFinished&&!this._paused&&!this._idle?this.currentTimePending=!0:this._idle&&(this.rewind(),this._idle=!1),this._startTime=null,this._paused=!0,this.updatePromises()}},{key:"finish",value:function(){this.updatePromises(),!this._idle&&(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())}},{key:"cancel",value:function(){var t=this;if(this.updatePromises(),!!this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var n=new Th(null,this,this.currentTime,null);setTimeout(function(){t.oncancel(n)})}}},{key:"reverse",value:function(){this.updatePromises();var t=this.currentTime;this.playbackRate*=-1,this.play(),t!==null&&(this.currentTime=t),this.updatePromises()}},{key:"updatePlaybackRate",value:function(t){this.playbackRate=t}},{key:"targetAnimations",value:function(){var t,n=(t=this.effect)===null||t===void 0?void 0:t.target;return n.getAnimations()}},{key:"markTarget",value:function(){var t=this.targetAnimations();t.indexOf(this)===-1&&t.push(this)}},{key:"unmarkTarget",value:function(){var t=this.targetAnimations(),n=t.indexOf(this);n!==-1&&t.splice(n,1)}},{key:"tick",value:function(t,n){!this._idle&&!this._paused&&(this._startTime===null?n&&(this.startTime=t-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((t-this._startTime)*this.playbackRate)),n&&(this.currentTimePending=!1,this.fireEvents(t))}},{key:"rewind",value:function(){if(this.playbackRate>=0)this.currentTime=0;else if(this._totalDuration<1/0)this.currentTime=this._totalDuration;else throw new Error("Unable to rewind negative playback rate animation with infinite duration")}},{key:"persist",value:function(){throw new Error(it)}},{key:"addEventListener",value:function(t,n,i){throw new Error(it)}},{key:"removeEventListener",value:function(t,n,i){throw new Error(it)}},{key:"dispatchEvent",value:function(t){throw new Error(it)}},{key:"commitStyles",value:function(){throw new Error(it)}},{key:"ensureAlive",value:function(){if(this.playbackRate<0&&this.currentTime===0){var t;this._inEffect=!!((t=this.effect)!==null&&t!==void 0&&t.update(-1))}else{var n;this._inEffect=!!((n=this.effect)!==null&&n!==void 0&&n.update(this.currentTime))}!this._inTimeline&&(this._inEffect||!this._finishedFlag)&&(this._inTimeline=!0,this.timeline.animations.push(this))}},{key:"tickCurrentTime",value:function(t,n){t!==this._currentTime&&(this._currentTime=t,this._isFinished&&!n&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())}},{key:"fireEvents",value:function(t){var n=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var i=new Th(null,this,this.currentTime,t);setTimeout(function(){n.onfinish&&n.onfinish(i)})}this._finishedFlag=!0}}else{if(this.onframe&&this.playState==="running"){var a=new Th(null,this,this.currentTime,t);this.onframe(a)}this._finishedFlag=!1}}}])}(),w4=4,x4=.001,E4=1e-7,M4=10,vo=11,Wu=1/(vo-1),S4=typeof Float32Array=="function",EO=function(e,t){return 1-3*t+3*e},MO=function(e,t){return 3*t-6*e},SO=function(e){return 3*e},nc=function(e,t,n){return((EO(t,n)*e+MO(t,n))*e+SO(t))*e},_O=function(e,t,n){return 3*EO(t,n)*e*e+2*MO(t,n)*e+SO(t)},_4=function(e,t,n,i,a){var s,o,u=0;do o=t+(n-t)/2,s=nc(o,i,a)-e,s>0?n=o:t=o;while(Math.abs(s)>E4&&++u<M4);return o},T4=function(e,t,n,i){for(var a=0;a<w4;++a){var s=_O(t,n,i);if(s===0)return t;var o=nc(t,n,i)-e;t-=o/s}return t},mm=function(e,t,n,i){if(!(e>=0&&e<=1&&n>=0&&n<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===t&&n===i)return function(u){return u};for(var a=S4?new Float32Array(vo):new Array(vo),s=0;s<vo;++s)a[s]=nc(s*Wu,e,n);var o=function(l){for(var c=0,d=1,h=vo-1;d!==h&&a[d]<=l;++d)c+=Wu;--d;var f=(l-a[d])/(a[d+1]-a[d]),g=c+f*Wu,v=_O(g,e,n);return v>=x4?T4(l,g,e,n):v===0?g:_4(l,c,c+Wu,e,n)};return function(u){return u===0||u===1?u:nc(o(u),t,i)}},O4=function(e){return e=e.replace(/([A-Z])/g,function(t){return"-".concat(t.toLowerCase())}),e.charAt(0)==="-"?e.substring(1):e},Vu=function(e){return Math.pow(e,2)},Yu=function(e){return Math.pow(e,3)},Uu=function(e){return Math.pow(e,4)},Hu=function(e){return Math.pow(e,5)},Xu=function(e){return Math.pow(e,6)},Ku=function(e){return 1-Math.cos(e*Math.PI/2)},Zu=function(e){return 1-Math.sqrt(1-e*e)},Qu=function(e){return e*e*(3*e-2)},Ju=function(e){for(var t,n=4;e<((t=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((t*3-2)/22-e,2)},el=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=ze(t,2),i=n[0],a=i===void 0?1:i,s=n[1],o=s===void 0?.5:s,u=jt(Number(a),1,10),l=jt(Number(o),.1,2);return e===0||e===1?e:-u*Math.pow(2,10*(e-1))*Math.sin((e-1-l/(Math.PI*2)*Math.asin(1/u))*(Math.PI*2)/l)},io=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=ze(t,4),a=i[0],s=a===void 0?1:a,o=i[1],u=o===void 0?100:o,l=i[2],c=l===void 0?10:l,d=i[3],h=d===void 0?0:d;s=jt(s,.1,1e3),u=jt(u,.1,1e3),c=jt(c,.1,1e3),h=jt(h,.1,1e3);var f=Math.sqrt(u/s),g=c/(2*Math.sqrt(u*s)),v=g<1?f*Math.sqrt(1-g*g):0,p=1,y=g<1?(g*f+-h)/v:-h+f,m=n?n*e/1e3:e;return g<1?m=Math.exp(-m*g*f)*(p*Math.cos(v*m)+y*Math.sin(v*m)):m=(p+y*m)*Math.exp(-m*f),e===0||e===1?e:1-m},Oh=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=t,i=ze(n,2),a=i[0],s=a===void 0?10:a,o=i[1],u=o==="start"?Math.ceil:Math.floor;return u(jt(e,0,1)*s)/s},Tb=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=ze(t,4),i=n[0],a=n[1],s=n[2],o=n[3];return mm(i,a,s,o)(e)},tl=mm(.42,0,1,1),wr=function(e){return function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;return 1-e(1-t,n,i)}},xr=function(e){return function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;return t<.5?e(t*2,n,i)/2:1-e(t*-2+2,n,i)/2}},Er=function(e){return function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;return t<.5?(1-e(1-t*2,n,i))/2:(e(t*2-1,n,i)+1)/2}},Ob={steps:Oh,"step-start":function(e){return Oh(e,[1,"start"])},"step-end":function(e){return Oh(e,[1,"end"])},linear:function(e){return e},"cubic-bezier":Tb,ease:function(e){return Tb(e,[.25,.1,.25,1])},in:tl,out:wr(tl),"in-out":xr(tl),"out-in":Er(tl),"in-quad":Vu,"out-quad":wr(Vu),"in-out-quad":xr(Vu),"out-in-quad":Er(Vu),"in-cubic":Yu,"out-cubic":wr(Yu),"in-out-cubic":xr(Yu),"out-in-cubic":Er(Yu),"in-quart":Uu,"out-quart":wr(Uu),"in-out-quart":xr(Uu),"out-in-quart":Er(Uu),"in-quint":Hu,"out-quint":wr(Hu),"in-out-quint":xr(Hu),"out-in-quint":Er(Hu),"in-expo":Xu,"out-expo":wr(Xu),"in-out-expo":xr(Xu),"out-in-expo":Er(Xu),"in-sine":Ku,"out-sine":wr(Ku),"in-out-sine":xr(Ku),"out-in-sine":Er(Ku),"in-circ":Zu,"out-circ":wr(Zu),"in-out-circ":xr(Zu),"out-in-circ":Er(Zu),"in-back":Qu,"out-back":wr(Qu),"in-out-back":xr(Qu),"out-in-back":Er(Qu),"in-bounce":Ju,"out-bounce":wr(Ju),"in-out-bounce":xr(Ju),"out-in-bounce":Er(Ju),"in-elastic":el,"out-elastic":wr(el),"in-out-elastic":xr(el),"out-in-elastic":Er(el),spring:io,"spring-in":io,"spring-out":wr(io),"spring-in-out":xr(io),"spring-out-in":Er(io)},A4=function(e){return O4(e).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()},k4=function(e){return Ob[A4(e)]||Ob.linear},N4=function(e){return e},C4=1,P4=.5,Ab=0;function kb(r,e){return function(t){if(t>=1)return 1;var n=1/r;return t+=e*n,t-t%n}}var nl="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",L4=new RegExp("cubic-bezier\\(".concat(nl,",").concat(nl,",").concat(nl,",").concat(nl,"\\)")),D4=/steps\(\s*(\d+)\s*\)/,I4=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function bm(r){var e=L4.exec(r);if(e)return mm.apply(void 0,pt(e.slice(1).map(Number)));var t=D4.exec(r);if(t)return kb(Number(t[1]),Ab);var n=I4.exec(r);return n?kb(Number(n[1]),{start:C4,middle:P4,end:Ab}[n[2]]):k4(r)}function R4(r){return Math.abs(j4(r)/(r.playbackRate||1))}function j4(r){var e;return r.duration===0||r.iterations===0?0:(r.duration==="auto"?0:Number(r.duration))*((e=r.iterations)!==null&&e!==void 0?e:1)}var TO=0,wm=1,Nc=2,OO=3;function B4(r,e,t){if(e===null)return TO;var n=t.endTime;return e<Math.min(t.delay,n)?wm:e>=Math.min(t.delay+r+t.endDelay,n)?Nc:OO}function F4(r,e,t,n,i){switch(n){case wm:return e==="backwards"||e==="both"?0:null;case OO:return t-i;case Nc:return e==="forwards"||e==="both"?r:null;case TO:return null}}function z4(r,e,t,n,i){var a=i;return r===0?e!==wm&&(a+=t):a+=n/r,a}function $4(r,e,t,n,i,a){var s=r===1/0?e%1:r%1;return s===0&&t===Nc&&n!==0&&(i!==0||a===0)&&(s=1),s}function q4(r,e,t,n){return r===Nc&&e===1/0?1/0:t===1?Math.floor(n)-1:Math.floor(n)}function G4(r,e,t){var n=r;if(r!=="normal"&&r!=="reverse"){var i=e;r==="alternate-reverse"&&(i+=1),n="normal",i!==1/0&&i%2!==0&&(n="reverse")}return n==="normal"?t:1-t}function W4(r,e,t){var n=B4(r,e,t),i=F4(r,t.fill,e,n,t.delay);if(i===null)return null;var a=t.duration==="auto"?0:t.duration,s=z4(a,n,t.iterations,i,t.iterationStart),o=$4(s,t.iterationStart,n,t.iterations,i,a),u=q4(n,t.iterations,o,s),l=G4(t.direction,u,o);return t.currentIteration=u,t.progress=l,t.easingFunction(l)}function V4(r,e,t){var n=Y4(r,e),i=U4(n,t);return function(a,s){if(s!==null)i.filter(function(u){return s>=u.applyFrom&&s<u.applyTo}).forEach(function(u){var l=s-u.startOffset,c=u.endOffset-u.startOffset,d=c===0?0:l/c;a.setAttribute(u.property,u.interpolation(d),!1,!1)});else for(var o in n)AO(o)&&a.setAttribute(o,null)}}function AO(r){return r!=="offset"&&r!=="easing"&&r!=="composite"&&r!=="computedOffset"}function Y4(r,e){for(var t={},n=0;n<r.length;n++)for(var i in r[n])if(AO(i)){var a={offset:r[n].offset,computedOffset:r[n].computedOffset,easing:r[n].easing,easingFunction:bm(r[n].easing)||e.easingFunction,value:r[n][i]};t[i]=t[i]||[],t[i].push(a)}return t}function U4(r,e){var t=[];for(var n in r)for(var i=r[n],a=0;a<i.length-1;a++){var s=a,o=a+1,u=i[s].computedOffset,l=i[o].computedOffset,c=u,d=l;a===0&&(c=-1/0,l===0&&(o=s)),a===i.length-2&&(d=1/0,u===1&&(s=o)),t.push({applyFrom:c,applyTo:d,startOffset:i[s].computedOffset,endOffset:i[o].computedOffset,easingFunction:i[s].easingFunction,property:n,interpolation:H4(n,i[s].value,i[o].value,e)})}return t.sort(function(h,f){return h.startOffset-f.startOffset}),t}var Nb=function(e,t,n){return function(i){var a=kO(e,t,i);return Ee(a)?a:n(a)}};function H4(r,e,t,n){var i=sO[r];if(i&&i.syntax&&i.int){var a=fe.styleValueRegistry.getPropertySyntax(i.syntax);if(a){var s=a.parser,o=s?s(e,n):e,u=s?s(t,n):t,l=a.mixer(o,u,n);if(l){var c=Nb.apply(void 0,pt(l));return function(d){return d===0?e:d===1?t:c(d)}}}}return Nb(!1,!0,function(d){return d?t:e})}function kO(r,e,t){if(typeof r=="number"&&typeof e=="number")return r*(1-t)+e*t;if(typeof r=="boolean"&&typeof e=="boolean"||typeof r=="string"&&typeof e=="string")return t<.5?r:e;if(Array.isArray(r)&&Array.isArray(e)){for(var n=r.length,i=e.length,a=Math.max(n,i),s=[],o=0;o<a;o++)s.push(kO(r[o<n?o:n-1],e[o<i?o:i-1],t));return s}throw new Error("Mismatched interpolation arguments ".concat(r,":").concat(e))}var X4=function(){function r(){ce(this,r),this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=N4,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}return de(r,[{key:"easing",get:function(){return this._easing},set:function(t){this.easingFunction=bm(t),this._easing=t}}])}();function K4(r){var e=[];for(var t in r)if(!(t in["easing","offset","composite"])){var n=r[t];Array.isArray(n)||(n=[n]);for(var i=n.length,a=0;a<i;a++){if(!e[a]){var s={};"offset"in r&&(s.offset=Number(r.offset)),"easing"in r&&(s.easing=r.easing),"composite"in r&&(s.composite=r.composite),e[a]=s}n[a]!==void 0&&n[a]!==null&&(e[a][t]=n[a])}}return e.sort(function(o,u){return(o.computedOffset||0)-(u.computedOffset||0)}),e}function Cb(r,e){if(r===null)return[];Array.isArray(r)||(r=K4(r));for(var t=r.map(function(u){var l={};e!=null&&e.composite&&(l.composite="auto");for(var c in u){var d=u[c];if(c==="offset"){if(d!==null){if(d=Number(d),!isFinite(d))throw new Error("Keyframe offsets must be numbers.");if(d<0||d>1)throw new Error("Keyframe offsets must be between 0 and 1.");l.computedOffset=d}}else if(c==="composite"&&["replace","add","accumulate","auto"].indexOf(d)===-1)throw new Error("".concat(d," compositing is not supported"));l[c]=d}return l.offset===void 0&&(l.offset=null),l.easing===void 0&&(l.easing=(e==null?void 0:e.easing)||"linear"),l.composite===void 0&&(l.composite="auto"),l}),n=!0,i=-1/0,a=0;a<t.length;a++){var s=t[a].offset;if(Le(s))n=!1;else{if(s<i)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");i=s}}t=t.filter(function(u){return Number(u.offset)>=0&&Number(u.offset)<=1});function o(){var u,l=t,c=l.length;if(t[c-1].computedOffset=Number((u=t[c-1].offset)!==null&&u!==void 0?u:1),c>1){var d;t[0].computedOffset=Number((d=t[0].offset)!==null&&d!==void 0?d:0)}for(var h=0,f=Number(t[0].computedOffset),g=1;g<c;g++){var v=t[g].computedOffset;if(!Le(v)&&!Le(f)){for(var p=1;p<g-h;p++)t[h+p].computedOffset=f+(Number(v)-f)*p/(g-h);h=g,f=Number(v)}}}return n||o(),t}var Z4="backwards|forwards|both|none".split("|"),Q4="reverse|alternate|alternate-reverse".split("|");function J4(r,e){var t=new X4;return typeof r=="number"&&!isNaN(r)?t.duration=r:r!==void 0&&Object.keys(r).forEach(function(n){if(r[n]!==void 0&&r[n]!==null&&r[n]!=="auto"){if((typeof t[n]=="number"||n==="duration")&&(typeof r[n]!="number"||isNaN(r[n]))||n==="fill"&&Z4.indexOf(r[n])===-1||n==="direction"&&Q4.indexOf(r[n])===-1)return;t[n]=r[n]}}),t}function e5(r,e){return r=t5(r??{duration:"auto"}),J4(r)}function t5(r){return typeof r=="number"&&(isNaN(r)?r={duration:"auto"}:r={duration:r}),r}var n5=function(){function r(e,t,n){var i=this;ce(this,r),this.composite="replace",this.iterationComposite="replace",this.target=e,this.timing=e5(n),this.timing.effect=this,this.timing.activeDuration=R4(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=Cb(t,this.timing),this.interpolations=V4(this.normalizedKeyframes,this.timing,this.target);var a=fe.globalThis.Proxy;this.computedTiming=a?new a(this.timing,{get:function(o,u){return u==="duration"?o.duration==="auto"?0:o.duration:u==="fill"?o.fill==="auto"?"none":o.fill:u==="localTime"?i.animation&&i.animation.currentTime||null:u==="currentIteration"?!i.animation||i.animation.playState!=="running"?null:o.currentIteration||0:u==="progress"?!i.animation||i.animation.playState!=="running"?null:o.progress||0:o[u]},set:function(){return!0}}):this.timing}return de(r,[{key:"applyInterpolations",value:function(){this.interpolations(this.target,Number(this.timeFraction))}},{key:"update",value:function(t){return t===null?!1:(this.timeFraction=W4(this.timing.activeDuration,t,this.timing),this.timeFraction!==null)}},{key:"getKeyframes",value:function(){return this.normalizedKeyframes}},{key:"setKeyframes",value:function(t){this.normalizedKeyframes=Cb(t)}},{key:"getComputedTiming",value:function(){return this.computedTiming}},{key:"getTiming",value:function(){return this.timing}},{key:"updateTiming",value:function(t){var n=this;Object.keys(t||{}).forEach(function(i){n.timing[i]=t[i]})}}])}();function Pb(r,e){return Number(r.id)-Number(e.id)}var r5=function(){function r(e){var t=this;ce(this,r),this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(n){t.currentTime=n,t.discardAnimations(),t.animations.length===0?t.timelineTicking=!1:t.requestAnimationFrame(t.webAnimationsNextTick)},this.processRafCallbacks=function(n){var i=t.rafCallbacks;t.rafCallbacks=[],n<Number(t.currentTime)&&(n=Number(t.currentTime)),t.animations.sort(Pb),t.animations=t.tick(n,!0,t.animations)[0],i.forEach(function(a){a[1](n)}),t.applyPendingEffects()},this.document=e}return de(r,[{key:"getAnimations",value:function(){return this.discardAnimations(),this.animations.slice()}},{key:"isTicking",value:function(){return this.inTick}},{key:"play",value:function(t,n,i){var a=new n5(t,n,i),s=new b4(a,this);return this.animations.push(s),this.restartWebAnimationsNextTick(),s.updatePromises(),s.play(),s.updatePromises(),s}},{key:"applyDirtiedAnimation",value:function(t){var n=this;if(!this.inTick){t.markTarget();var i=t.targetAnimations();i.sort(Pb);var a=this.tick(Number(this.currentTime),!1,i.slice())[1];a.forEach(function(s){var o=n.animations.indexOf(s);o!==-1&&n.animations.splice(o,1)}),this.applyPendingEffects()}}},{key:"restart",value:function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame}},{key:"destroy",value:function(){this.document.defaultView.cancelAnimationFrame(this.frameId)}},{key:"applyPendingEffects",value:function(){this.pendingEffects.forEach(function(t){t==null||t.applyInterpolations()}),this.pendingEffects=[]}},{key:"updateAnimationsPromises",value:function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(t){return t.updatePromises()})}},{key:"discardAnimations",value:function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(t){return t.playState!=="finished"&&t.playState!=="idle"})}},{key:"restartWebAnimationsNextTick",value:function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))}},{key:"rAF",value:function(t){var n=this.rafId++;return this.rafCallbacks.length===0&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([n,t]),n}},{key:"requestAnimationFrame",value:function(t){var n=this;return this.rAF(function(i){n.updateAnimationsPromises(),t(i),n.updateAnimationsPromises()})}},{key:"tick",value:function(t,n,i){var a=this,s,o;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=t,this.ticking=!1;var u=[],l=[],c=[],d=[];return i.forEach(function(h){h.tick(t,n),h._inEffect?(l.push(h.effect),h.markTarget()):(u.push(h.effect),h.unmarkTarget()),h._needsTick&&(a.ticking=!0);var f=h._inEffect||h._needsTick;h._inTimeline=f,f?c.push(h):d.push(h)}),(s=this.pendingEffects).push.apply(s,u),(o=this.pendingEffects).push.apply(o,l),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[c,d]}}])}();fe.EasingFunction=bm;fe.AnimationTimeline=r5;const i5={duration:500},a5={duration:1e3,easing:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",iterations:1,fill:"both"};var Mt;(function(r){r.NodeAdded="NodeAdded",r.NodeUpdated="NodeUpdated",r.NodeRemoved="NodeRemoved",r.EdgeAdded="EdgeAdded",r.EdgeUpdated="EdgeUpdated",r.EdgeRemoved="EdgeRemoved",r.ComboAdded="ComboAdded",r.ComboUpdated="ComboUpdated",r.ComboRemoved="ComboRemoved"})(Mt||(Mt={}));var Xn;(function(r){r.DRAW="draw",r.COLLAPSE="collapse",r.EXPAND="expand",r.TRANSFORM="transform"})(Xn||(Xn={}));var Ai;(function(r){r.CLICK="canvas:click",r.DBLCLICK="canvas:dblclick",r.POINTER_OVER="canvas:pointerover",r.POINTER_LEAVE="canvas:pointerleave",r.POINTER_ENTER="canvas:pointerenter",r.POINTER_MOVE="canvas:pointermove",r.POINTER_OUT="canvas:pointerout",r.POINTER_DOWN="canvas:pointerdown",r.POINTER_UP="canvas:pointerup",r.CONTEXT_MENU="canvas:contextmenu",r.DRAG_START="canvas:dragstart",r.DRAG="canvas:drag",r.DRAG_END="canvas:dragend",r.DRAG_ENTER="canvas:dragenter",r.DRAG_OVER="canvas:dragover",r.DRAG_LEAVE="canvas:dragleave",r.DROP="canvas:drop",r.WHEEL="canvas:wheel"})(Ai||(Ai={}));var Pa;(function(r){r.CLICK="combo:click",r.DBLCLICK="combo:dblclick",r.POINTER_OVER="combo:pointerover",r.POINTER_LEAVE="combo:pointerleave",r.POINTER_ENTER="combo:pointerenter",r.POINTER_MOVE="combo:pointermove",r.POINTER_OUT="combo:pointerout",r.POINTER_DOWN="combo:pointerdown",r.POINTER_UP="combo:pointerup",r.CONTEXT_MENU="combo:contextmenu",r.DRAG_START="combo:dragstart",r.DRAG="combo:drag",r.DRAG_END="combo:dragend",r.DRAG_ENTER="combo:dragenter",r.DRAG_OVER="combo:dragover",r.DRAG_LEAVE="combo:dragleave",r.DROP="combo:drop"})(Pa||(Pa={}));var ae;(function(r){r.CLICK="click",r.DBLCLICK="dblclick",r.POINTER_OVER="pointerover",r.POINTER_LEAVE="pointerleave",r.POINTER_ENTER="pointerenter",r.POINTER_MOVE="pointermove",r.POINTER_OUT="pointerout",r.POINTER_DOWN="pointerdown",r.POINTER_UP="pointerup",r.CONTEXT_MENU="contextmenu",r.DRAG_START="dragstart",r.DRAG="drag",r.DRAG_END="dragend",r.DRAG_ENTER="dragenter",r.DRAG_OVER="dragover",r.DRAG_LEAVE="dragleave",r.DROP="drop",r.KEY_DOWN="keydown",r.KEY_UP="keyup",r.WHEEL="wheel"})(ae||(ae={}));var Ss;(function(r){r.KEY_DOWN="keydown",r.KEY_UP="keyup"})(Ss||(Ss={}));var rc;(function(r){r.CLICK="edge:click",r.DBLCLICK="edge:dblclick",r.POINTER_OVER="edge:pointerover",r.POINTER_LEAVE="edge:pointerleave",r.POINTER_ENTER="edge:pointerenter",r.POINTER_MOVE="edge:pointermove",r.POINTER_OUT="edge:pointerout",r.POINTER_DOWN="edge:pointerdown",r.POINTER_UP="edge:pointerup",r.CONTEXT_MENU="edge:contextmenu",r.DRAG_ENTER="edge:dragenter",r.DRAG_OVER="edge:dragover",r.DRAG_LEAVE="edge:dragleave",r.DROP="edge:drop"})(rc||(rc={}));var ve;(function(r){r.BEFORE_CANVAS_INIT="beforecanvasinit",r.AFTER_CANVAS_INIT="aftercanvasinit",r.BEFORE_SIZE_CHANGE="beforesizechange",r.AFTER_SIZE_CHANGE="aftersizechange",r.BEFORE_ELEMENT_CREATE="beforeelementcreate",r.AFTER_ELEMENT_CREATE="afterelementcreate",r.BEFORE_ELEMENT_UPDATE="beforeelementupdate",r.AFTER_ELEMENT_UPDATE="afterelementupdate",r.BEFORE_ELEMENT_DESTROY="beforeelementdestroy",r.AFTER_ELEMENT_DESTROY="afterelementdestroy",r.BEFORE_ELEMENT_TRANSLATE="beforeelementtranslate",r.AFTER_ELEMENT_TRANSLATE="afterelementtranslate",r.BEFORE_DRAW="beforedraw",r.AFTER_DRAW="afterdraw",r.BEFORE_RENDER="beforerender",r.AFTER_RENDER="afterrender",r.BEFORE_ANIMATE="beforeanimate",r.AFTER_ANIMATE="afteranimate",r.BEFORE_LAYOUT="beforelayout",r.AFTER_LAYOUT="afterlayout",r.BEFORE_STAGE_LAYOUT="beforestagelayout",r.AFTER_STAGE_LAYOUT="afterstagelayout",r.BEFORE_TRANSFORM="beforetransform",r.AFTER_TRANSFORM="aftertransform",r.BATCH_START="batchstart",r.BATCH_END="batchend",r.BEFORE_DESTROY="beforedestroy",r.AFTER_DESTROY="afterdestroy",r.BEFORE_RENDERER_CHANGE="beforerendererchange",r.AFTER_RENDERER_CHANGE="afterrendererchange"})(ve||(ve={}));var Yi;(function(r){r.UNDO="undo",r.REDO="redo",r.CANCEL="cancel",r.ADD="add",r.CLEAR="clear",r.CHANGE="change"})(Yi||(Yi={}));var Or;(function(r){r.CLICK="node:click",r.DBLCLICK="node:dblclick",r.POINTER_OVER="node:pointerover",r.POINTER_LEAVE="node:pointerleave",r.POINTER_ENTER="node:pointerenter",r.POINTER_MOVE="node:pointermove",r.POINTER_OUT="node:pointerout",r.POINTER_DOWN="node:pointerdown",r.POINTER_UP="node:pointerup",r.CONTEXT_MENU="node:contextmenu",r.DRAG_START="node:dragstart",r.DRAG="node:drag",r.DRAG_END="node:dragend",r.DRAG_ENTER="node:dragenter",r.DRAG_OVER="node:dragover",r.DRAG_LEAVE="node:dragleave",r.DROP="node:drop"})(Or||(Or={}));const ut="combo",ur="tree";var $o;(function(r){r.NODE="node",r.EDGE="edge",r.COMBO="combo",r.THEME="theme",r.PALETTE="palette",r.LAYOUT="layout",r.BEHAVIOR="behavior",r.PLUGIN="plugin",r.ANIMATION="animation",r.TRANSFORM="transform",r.SHAPE="shape"})($o||($o={}));const vy={animation:{},behavior:{},combo:{},edge:{},layout:{},node:{},palette:{},theme:{},plugin:{},transform:{},shape:{}};function ki(r,e){var t;const n=(t=vy[r])===null||t===void 0?void 0:t[e];if(n)return n}const s5="5.0.42",o5="G6";function _i(r){return`[${o5} v${s5}] ${r}`}const di={mute:!1,debug:r=>{console.debug(_i(r))},info:r=>{console.info(_i(r))},warn:r=>{console.warn(_i(r))},error:r=>{console.error(_i(r))}};function NO(r){const{theme:e}=r;if(!e)return{};const t=ki($o.THEME,e);return t||(di.warn(`The theme of ${e} is not registered.`),{})}function xm(r,e){if(Array.isArray(r)&&r.length===0)return null;const t=Array.isArray(r)?r[0]:r,n=Array.isArray(r)?r.slice(1):e||[];return new Proxy(t,{get(i,a){return typeof i[a]=="function"&&!["onframe","onfinish"].includes(a)?(...s)=>{i[a](...s),n.forEach(o=>{var u;return(u=o[a])===null||u===void 0?void 0:u.call(o,...s)})}:a==="finished"?Promise.all([t.finished,...n.map(s=>s.finished)]):Reflect.get(i,a)},set(i,a,s){return["onframe","onfinish"].includes(a)||n.forEach(o=>{o[a]=s}),Reflect.set(i,a,s)}})}function yy(r){const e=r.reduce((n,i)=>(Object.entries(i).forEach(([a,s])=>{n[a]===void 0?n[a]=[s]:n[a].push(s)}),n),{});Object.entries(e).forEach(([n,i])=>{(i.length!==r.length||i.some(a=>Le(a))||i.every(a=>!["sourceNode","targetNode","childrenNode"].includes(n)&&Bt(a,i[0])))&&delete e[n]});const t=Object.entries(e).reduce((n,[i,a])=>(a.forEach((s,o)=>{n[o]?n[o][i]=s:n[o]={[i]:s}}),n),[]);return r.length!==0&&t.length===0&&t.push({_:0},{_:0}),t}function qo(r){switch(r){case"opacity":return 1;case"x":case"y":case"z":case"zIndex":return 0;case"visibility":return"visible";case"collapsed":return!1;case"states":return[];default:return}}function CO(r,e){const{animation:t}=r;if(t===!1||e===!1)return!1;const n=Object.assign({},i5);return Yt(t)&&Object.assign(n,t),Yt(e)&&Object.assign(n,e),n}function u5(r){if(typeof r=="string"){const e=ki($o.ANIMATION,r);return e||(di.warn(`The animation of ${r} is not registered.`),[])}return r}function l5(r,e,t,n){var i,a;const{animation:s}=r;if(s===!1||n===!1)return[];const o=(i=r==null?void 0:r[e])===null||i===void 0?void 0:i.animation;if(o===!1)return[];const u=o==null?void 0:o[t];if(u===!1)return[];const l=(a=NO(r)[e])===null||a===void 0?void 0:a.animation,c=(h=[])=>u5(h).map(f=>Object.assign(Object.assign(Object.assign(Object.assign({},a5),Yt(s)&&s),f),Yt(n)&&n));if(u)return c(u);if(!l)return[];const d=l[t];return d===!1?[]:c(d)}function PO(r,e,t,n=[]){if(!n&&r===0&&e===0&&t===0)return null;if(Array.isArray(n)){let a=-1;const s=[];for(let o=0;o<n.length;o++){const u=n[o];if(u[0]==="translate"){if(u[1]===r&&u[2]===e)return null;a=o,s.push(["translate",r,e])}else if(u[0]==="translate3d"){if(u[1]===r&&u[2]===e&&u[3]===t)return null;a=o,s.push(["translate3d",r,e,t??0])}else s.push(u)}return a===-1&&s.splice(0,0,Ee(t)?["translate3d",r,e,t??0]:["translate",r,e]),s.length===0?null:s}const i=n?n.replace(/translate(3d)?\([^)]*\)/g,""):"";return t===0?`translate(${r}, ${e})${i}`:`translate3d(${r}, ${e}, ${t})${i}`}var c5=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const d5=(r,e,t)=>{if(!t.length)return null;const[n,i]=e,a=l=>{var c;if(l){const d=r.getShape(l);if(!d)return null;const h=`get${Vl(l)}Style`,f=((c=r==null?void 0:r[h])===null||c===void 0?void 0:c.bind(r))||(p=>p),g=(f==null?void 0:f(n))||{},v=(f==null?void 0:f(i))||{};return{shape:d,fromStyle:g,toStyle:v}}else return{shape:r,fromStyle:n,toStyle:i}};let s;const o=t.map(l=>{var{fields:c,shape:d,states:h}=l,f=c5(l,["fields","shape","states"]);const g=a(d);if(!g)return null;const{shape:v,fromStyle:p,toStyle:y}=g,m=[{},{}];if(c.forEach(M=>{var S,T;Object.assign(m[0],{[M]:(S=p[M])!==null&&S!==void 0?S:qo(M)}),Object.assign(m[1],{[M]:(T=y[M])!==null&&T!==void 0?T:qo(M)})}),m.some(M=>Object.keys(M).some(S=>["x","y","z"].includes(S)))){const{x:M=0,y:S=0,z:T,transform:A=""}=v.attributes||{};m.forEach(O=>{var N,C,P;O.transform=PO((N=O.x)!==null&&N!==void 0?N:M,(C=O.y)!==null&&C!==void 0?C:S,(P=O.z)!==null&&P!==void 0?P:T,A)})}const w=v.animate(yy(m),f);return d===void 0&&(s=w),w}).filter(Boolean),u=s||(o==null?void 0:o[0]);return u?xm(u,o.filter(l=>l!==l)):null},h5=[{fields:["opacity"]}],f5=[{fields:["x","y"]}],LO=[{fields:["x","y"]}],g5=LO,DO=[{fields:["sourceNode","targetNode"]}],p5=DO,IO=[{fields:["childrenNode","x","y"]}],v5=IO;function y5(r){return"source"in r&&"target"in r}function m5(r){return r.length===2}function zs(r){return r instanceof Float32Array?!0:Array.isArray(r)&&(r.length===2||r.length===3)?r.every(e=>typeof e=="number"):!1}function ci(r,e,t){return r>=e&&r<=t}function hi(r=0){if(Array.isArray(r)){const[e=0,t=e,n=e,i=t]=r;return[e,t,n,i]}return[r,r,r,r]}function b5(r=0){const e=hi(r);return e[0]+e[2]}function fi(r){return r.max[0]-r.min[0]}function gi(r){return r.max[1]-r.min[1]}function pa(r){return[fi(r),gi(r)]}function Zi(r,e){const t=zs(r)?Em(r):r.getShape("key").getBounds();return e?va(t,e):t}function Em(r){const[e,t,n=0]=r,i=new ft;return i.setMinMax([e,t,n],[e,t,n]),i}function va(r,e){const[t,n,i,a]=hi(e),[s,o,u]=r.min,[l,c,d]=r.max,h=new ft;return h.setMinMax([s-a,o-t,u],[l+n,c+i,d]),h}function hu(r){if(r.length===0)return new ft;if(r.length===1)return r[0];const e=new ft;e.setMinMax(r[0].min,r[0].max);for(let t=1;t<r.length;t++){const n=r[t];e.setMinMax([Math.min(e.min[0],n.min[0]),Math.min(e.min[1],n.min[1]),Math.min(e.min[2],n.min[2])],[Math.max(e.max[0],n.max[0]),Math.max(e.max[1],n.max[1]),Math.max(e.max[2],n.max[2])])}return e}function w5(r,e){const[t,n]=r.min,[i,a]=r.max,[s,o]=e.min,[u,l]=e.max;return t>=s&&i<=u&&n>=o&&a<=l}function $r(r,e){return ci(r[0],e.min[0],e.max[0])&&ci(r[1],e.min[1],e.max[1])}function RO(r,e,t=!1){const{min:[n,i],max:[a,s]}=e,o=(r[1]===i||r[1]===s)&&(t||ci(r[0],n,a)),u=(r[0]===n||r[0]===a)&&(t||ci(r[1],i,s));return o||u}function x5(r,e){return!$r(r,e)}function ic(r,e){const{center:t}=e;return r[0]===t[0]&&r[1]===t[1]}function Co(r,e){const[t,n]=r,[i,a]=e.min,[s,o]=e.max,u=t-i,l=s-t,c=n-a,d=o-n,h=Math.min(u,l,c,d);return h===u?"left":h===l?"right":h===c?"top":h===d?"bottom":"left"}function Ba(r,e){const t=la(r);if($r(r,e))switch(Co(r,e)){case"left":t[0]=e.min[0];break;case"right":t[0]=e.max[0];break;case"top":t[1]=e.min[1];break;case"bottom":t[1]=e.max[1];break}else{const[n,i]=r,[a,s]=e.min,[o,u]=e.max;t[0]=ci(n,a,o)?n:n<a?a:o,t[1]=ci(i,s,u)?i:i<s?s:u}return t}function E5(r,e){const{center:t}=r,[n,i]=pa(r),a=e==="up"||e==="down"?t[0]:e==="right"?t[0]-n/6:t[0]+n/6,s=e==="left"||e==="right"?t[1]:e==="down"?t[1]-i/6:t[1]+i/6;return[a,s]}function M5(r,e){let[t,n]=pa(r);return[t,n]=e==="up"||e==="down"?[t,n]:[n,t],(Math.pow(n,2)-Math.pow(Math.sqrt(Math.pow(t/2,2)+Math.pow(n,2))-t/2,2))/(2*n)}function S5(r){const{min:[e,t],max:[n,i]}=r,a=[e,i],s=[n,i],o=[n,t],u=[e,t];return[[a,s],[s,o],[o,u],[u,a]]}var _5=function(e,t){return e===t},Lb=function(){function r(e,t){t===void 0&&(t=null),this.value=e,this.next=t}return r.prototype.toString=function(e){return e?e(this.value):"".concat(this.value)},r}(),T5=function(){function r(e){e===void 0&&(e=_5),this.head=null,this.tail=null,this.compare=e}return r.prototype.prepend=function(e){var t=new Lb(e,this.head);return this.head=t,this.tail||(this.tail=t),this},r.prototype.append=function(e){var t=new Lb(e);return this.head?(this.tail.next=t,this.tail=t,this):(this.head=t,this.tail=t,this)},r.prototype.delete=function(e){if(!this.head)return null;for(var t=null;this.head&&this.compare(this.head.value,e);)t=this.head,this.head=this.head.next;var n=this.head;if(n!==null)for(;n.next;)this.compare(n.next.value,e)?(t=n.next,n.next=n.next.next):n=n.next;return this.compare(this.tail.value,e)&&(this.tail=n),t},r.prototype.find=function(e){var t=e.value,n=t===void 0?void 0:t,i=e.callback,a=i===void 0?void 0:i;if(!this.head)return null;for(var s=this.head;s;){if(a&&a(s.value)||n!==void 0&&this.compare(s.value,n))return s;s=s.next}return null},r.prototype.deleteTail=function(){var e=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,e;for(var t=this.head;t.next;)t.next.next?t=t.next:t.next=null;return this.tail=t,e},r.prototype.deleteHead=function(){if(!this.head)return null;var e=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),e},r.prototype.fromArray=function(e){var t=this;return e.forEach(function(n){return t.append(n)}),this},r.prototype.toArray=function(){for(var e=[],t=this.head;t;)e.push(t),t=t.next;return e},r.prototype.reverse=function(){for(var e=this.head,t=null,n=null;e;)n=e.next,e.next=t,t=e,e=n;this.tail=this.head,this.head=t},r.prototype.toString=function(e){return e===void 0&&(e=void 0),this.toArray().map(function(t){return t.toString(e)}).toString()},r}(),O5=function(e,t,n){t===void 0&&(t=[]);var i=t.filter(function(u){return u.source===e||u.target===e});if(n==="target"){var a=function(l){return l.source===e};return i.filter(a).map(function(u){return u.target})}if(n==="source"){var s=function(l){return l.target===e};return i.filter(s).map(function(u){return u.source})}var o=function(l){return l.source===e?l.target:l.source};return i.map(o)},A5=function(e,t){return t.filter(function(n){return n.source===e})},k5=function(e,t){return t.filter(function(n){return n.source===e||n.target===e})},N5=function(e){var t={},n=e.nodes,i=n===void 0?[]:n,a=e.edges,s=a===void 0?[]:a;return i.forEach(function(o){t[o.id]={degree:0,inDegree:0,outDegree:0}}),s.forEach(function(o){t[o.source].degree++,t[o.source].outDegree++,t[o.target].degree++,t[o.target].inDegree++}),t},C5={}.toString,Mm=function(r,e){return C5.call(r)==="[object "+e+"]"};const jO=function(r){return Mm(r,"Function")},BO=function(r){return Array.isArray?Array.isArray(r):Mm(r,"Array")},P5=function(r){var e=typeof r;return r!==null&&e==="object"||e==="function"};function L5(r,e){if(r){var t;if(BO(r))for(var n=0,i=r.length;n<i&&(t=e(r[n],n),t!==!1);n++);else if(P5(r)){for(var a in r)if(r.hasOwnProperty(a)&&(t=e(r[a],a),t===!1))break}}}const D5=function(r){return Mm(r,"String")};var I5=Object.values?function(r){return Object.values(r)}:function(r){var e=[];return L5(r,function(t,n){jO(r)&&n==="prototype"||e.push(t)}),e};const R5=function(r,e){if(!jO(r))throw new TypeError("Expected a function");var t=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var a=e.apply(this,n),s=t.cache;if(s.has(a))return s.get(a);var o=r.apply(this,n);return s.set(a,o),o};return t.cache=new Map,t};var rl;R5(function(r,e){e===void 0&&(e={});var t=e.fontSize,n=e.fontFamily,i=e.fontWeight,a=e.fontStyle,s=e.fontVariant;return rl||(rl=document.createElement("canvas").getContext("2d")),rl.font=[a,s,i,t+"px",n].join(" "),rl.measureText(D5(r)?r:"").width},function(r,e){return e===void 0&&(e={}),ZL([r],I5(e)).join("")});var j5=function(e,t,n){for(var i=1/0,a,s=0;s<t.length;s++){var o=t[s].id;!n[o]&&e[o]<=i&&(i=e[o],a=t[s])}return a},B5=function(e,t,n,i){var a=e.nodes,s=a===void 0?[]:a,o=e.edges,u=o===void 0?[]:o,l={},c={},d={};s.forEach(function(m,w){var M=m.id;c[M]=1/0,M===t&&(c[M]=0)});for(var h=s.length,f=function(w){var M=j5(c,s,l),S=M.id;if(l[S]=!0,c[S]===1/0)return"continue";var T=[];n?T=A5(S,u):T=k5(S,u),T.forEach(function(A){var O=A.target,N=A.source,C=O===S?N:O,P=i&&A[i]?A[i]:1;c[C]>c[M.id]+P?(c[C]=c[M.id]+P,d[C]=[M.id]):c[C]===c[M.id]+P&&d[C].push(M.id)})},g=0;g<h;g++)f();d[t]=[t];var v={};for(var p in c)c[p]!==1/0&&FO(t,p,d,v);var y={};for(var p in v)y[p]=v[p][0];return{length:c,path:y,allPath:v}};function FO(r,e,t,n){if(r===e)return[r];if(n[e])return n[e];for(var i=[],a=0,s=t[e];a<s.length;a++){var o=s[a],u=FO(r,o,t,n);if(!u)return;for(var l=0,c=u;l<c.length;l++){var d=c[l];BO(d)?i.push(Cn(Cn([],d,!0),[e],!1)):i.push([d,e])}}return n[e]=i,n[e]}var zO=function(e,t,n,i,a){var s=B5(e,t,i,a),o=s.length,u=s.path,l=s.allPath;return{length:o[n],path:u[n],allPath:l[n]}},Db;(function(r){r.EuclideanDistance="euclideanDistance"})(Db||(Db={}));var F5=function(e,t,n){typeof t!="number"&&(t=1e-6),typeof n!="number"&&(n=.85);for(var i=1,a=0,s=1e3,o=e.nodes,u=o===void 0?[]:o,l=e.edges,c=l===void 0?[]:l,d=u.length,h,f={},g={},v=0;v<d;++v){var p=u[v],y=p.id;f[y]=1/d,g[y]=1/d}for(var m=N5(e);s>0&&i>t;){a=0;for(var v=0;v<d;++v){var p=u[v],y=p.id;if(h=0,m[p.id].inDegree===0)f[y]=0;else{for(var w=O5(y,c,"source"),M=0;M<w.length;++M){var S=w[M],T=m[S].outDegree;T>0&&(h+=g[S]/T)}f[y]=n*h,a+=f[y]}}a=(1-a)/d,i=0;for(var v=0;v<d;++v){var p=u[v],y=p.id;h=f[y]+a,i+=Math.abs(h-g[y]),g[y]=h}s-=1}return g};(function(){function r(e){e===void 0&&(e=10),this.linkedList=new T5,this.maxStep=e}return Object.defineProperty(r.prototype,"length",{get:function(){return this.linkedList.toArray().length},enumerable:!1,configurable:!0}),r.prototype.isEmpty=function(){return!this.linkedList.head},r.prototype.isMaxStack=function(){return this.toArray().length>=this.maxStep},r.prototype.peek=function(){return this.isEmpty()?null:this.linkedList.head.value},r.prototype.push=function(e){this.linkedList.prepend(e),this.length>this.maxStep&&this.linkedList.deleteTail()},r.prototype.pop=function(){var e=this.linkedList.deleteHead();return e?e.value:null},r.prototype.toArray=function(){return this.linkedList.toArray().map(function(e){return e.value})},r.prototype.clear=function(){for(;!this.isEmpty();)this.pop()},r})();function Q(r){if(r.id!==void 0)return r.id;if(r.source!==void 0&&r.target!==void 0)return`${r.source}-${r.target}`;throw new Error(_i("The datum does not have available id."))}function il(r){return r.combo}function $O(r,e){const t={nodes:(r.nodes||[]).map(Q),edges:(r.edges||[]).map(Q),combos:(r.combos||[]).map(Q)};return e?Object.values(t).flat():t}const qO=(r,e,t)=>{var n;switch(t.type){case"degree":{const i=new Map;return(n=r.nodes)===null||n===void 0||n.forEach(a=>{const s=e(Q(a),t.direction).length;i.set(Q(a),s)}),i}case"betweenness":return z5(r,t.directed,t.weightPropertyName);case"closeness":return $5(r,t.directed,t.weightPropertyName);case"eigenvector":return G5(r,t.directed);case"pagerank":return q5(r,t.epsilon,t.linkProb);default:return GO(r)}},GO=r=>{var e;const t=new Map;return(e=r.nodes)===null||e===void 0||e.forEach(n=>{t.set(Q(n),0)}),t},z5=(r,e,t)=>{const n=GO(r),{nodes:i=[]}=r;return i.forEach(a=>{i.forEach(s=>{if(a!==s){const{allPath:o}=zO(r,Q(a),Q(s),e,t),u=o.length;o.flat().forEach(l=>{l!==Q(a)&&l!==Q(s)&&n.set(l,n.get(l)+1/u)})}})}),n},$5=(r,e,t)=>{const n=new Map,{nodes:i=[]}=r;return i.forEach(a=>{const s=i.reduce((o,u)=>{if(a!==u){const{length:l}=zO(r,Q(a),Q(u),e,t);o+=l}return o},0);n.set(Q(a),1/s)}),n},q5=(r,e,t)=>{var n;const i=new Map,a=F5(r,e,t);return(n=r.nodes)===null||n===void 0||n.forEach(s=>{i.set(Q(s),a[Q(s)])}),i},G5=(r,e)=>{const{nodes:t=[]}=r,n=W5(r,e),i=V5(n,t.length),a=new Map;return t.forEach((s,o)=>{a.set(Q(s),i[o])}),a},W5=(r,e)=>{const{nodes:t=[],edges:n=[]}=r,i=Array(t.length).fill(null).map(()=>Array(t.length).fill(0));return n.forEach(({source:a,target:s})=>{const o=t.findIndex(l=>Q(l)===a),u=t.findIndex(l=>Q(l)===s);e?i[o][u]=1:(i[o][u]=1,i[u][o]=1)}),i},V5=(r,e,t=100,n=1e-6)=>{let i=Array(e).fill(1),a=1/0;for(let s=0;s<t&&a>n;s++){const o=Array(e).fill(0);for(let l=0;l<e;l++)for(let c=0;c<e;c++)o[l]+=r[l][c]*i[c];const u=Math.sqrt(o.reduce((l,c)=>l+c*c,0));for(let l=0;l<e;l++)o[l]/=u;a=Math.sqrt(o.reduce((l,c,d)=>l+(c-i[d])*c,0)),i=o}return i};function aa(r,e,t,n=Bt){const i=new Map(r.map(h=>[t(h),h])),a=new Map(e.map(h=>[t(h),h])),s=new Set(i.keys()),o=new Set(a.keys()),u=[],l=[],c=[],d=[];return o.forEach(h=>{s.has(h)?n(i.get(h),a.get(h))?d.push(a.get(h)):l.push(a.get(h)):u.push(a.get(h))}),s.forEach(h=>{o.has(h)||c.push(i.get(h))}),{enter:u,exit:c,keep:d,update:l}}function Va(r,e,t){const n=i=>{t&&!t(i)||(i.style.visibility=e)};r.forEach(i=>{n(i)})}function Y5(r,e,t){const n={},i=a=>(a in n||(n[a]=0),`${e}-${a}-${n[a]++}`);return t.map(a=>typeof a=="string"?{type:a,key:i(a)}:typeof a=="function"?a.call(r):a.key?a:Object.assign(Object.assign({},a),{key:i(a.type)}))}class Sm{constructor(e){this.extensions=[],this.extensionMap={},this.context=e}setExtensions(e){const t=Y5(this.context.graph,this.category,e),{enter:n,update:i,exit:a,keep:s}=aa(this.extensions,t,o=>o.key);this.createExtensions(n),this.updateExtensions([...i,...s]),this.destroyExtensions(a),this.extensions=t}createExtension(e){const{category:t}=this,{key:n,type:i}=e,a=ki(t,i);if(!a)return di.warn(`The extension ${i} of ${t} is not registered.`);const s=new a(this.context,e);this.extensionMap[n]=s}createExtensions(e){e.forEach(t=>this.createExtension(t))}updateExtension(e){const{key:t}=e,n=this.extensionMap[t];n&&n.update(e)}updateExtensions(e){e.forEach(t=>this.updateExtension(t))}destroyExtension(e){const t=this.extensionMap[e];t&&(t.destroy(),delete this.extensionMap[e])}destroyExtensions(e){e.forEach(({key:t})=>this.destroyExtension(t))}destroy(){Object.values(this.extensionMap).forEach(e=>e.destroy()),this.context={},this.extensions=[],this.extensionMap={}}}class _m{constructor(e,t){this.events=[],this.destroyed=!1,this.context=e,this.options=t}update(e){this.options=Object.assign(this.options,e)}destroy(){this.context={},this.options={},this.destroyed=!0}}class pr extends _m{}class Cc extends pr{constructor(e,t){super(e,Object.assign({},Cc.defaultOptions,t)),this.isOverlapping=(n,i)=>i.some(a=>n.intersects(a)),this.occupiedBounds=[],this.detectLabelCollision=n=>{const i=this.context.viewport,a={show:[],hide:[]};return this.occupiedBounds=[],n.forEach(s=>{const o=s.getShape("label").getRenderBounds();i.isInViewport(o,!0)&&!this.isOverlapping(o,this.occupiedBounds)?(a.show.push(s),this.occupiedBounds.push(va(o,this.options.padding))):a.hide.push(s)}),a},this.hideLabelIfExceedViewport=(n,i)=>{const{exit:a}=aa(n,i,s=>s.id);a==null||a.forEach(this.hideLabel)},this.nodeCentralities=new Map,this.sortNodesByCentrality=(n,i)=>{const{model:a}=this.context,s=a.getData(),o=a.getRelatedEdgesData.bind(a);return n.map(l=>(this.nodeCentralities.has(l.id)||(this.nodeCentralities=qO(s,o,i)),{node:l,centrality:this.nodeCentralities.get(l.id)})).sort((l,c)=>c.centrality-l.centrality).map(l=>l.node)},this.sortLabelElementsInView=n=>{const{sort:i,sortNode:a,sortCombo:s,sortEdge:o}=this.options,{model:u}=this.context;if(Te(i))return n.sort((v,p)=>i(u.getElementDataById(v.id),u.getElementDataById(p.id)));const{node:l=[],edge:c=[],combo:d=[]}=_c(n,v=>v.type),h=Te(s)?d.sort((v,p)=>s(...u.getComboData([v.id,p.id]))):d,f=Te(a)?l.sort((v,p)=>a(...u.getNodeData([v.id,p.id]))):this.sortNodesByCentrality(l,a),g=Te(o)?c.sort((v,p)=>o(...u.getEdgeData([v.id,p.id]))):c;return[...h,...f,...g]},this.labelElementsInView=[],this.isFirstRender=!0,this.onToggleVisibility=n=>{var i;if(((i=n.data)===null||i===void 0?void 0:i.stage)==="zIndex")return;if(!this.validate(n)){this.hiddenElements.size>0&&(this.hiddenElements.forEach(this.showLabel),this.hiddenElements.clear());return}const a=this.isFirstRender?this.getLabelElements():this.getLabelElementsInView();this.hideLabelIfExceedViewport(this.labelElementsInView,a),this.labelElementsInView=a;const s=this.sortLabelElementsInView(this.labelElementsInView),{show:o,hide:u}=this.detectLabelCollision(s);for(let l=o.length-1;l>=0;l--)this.showLabel(o[l]);u.forEach(this.hideLabel)},this.hiddenElements=new Map,this.hideLabel=n=>{const i=n.getShape("label");i&&Va(i,"hidden"),this.hiddenElements.set(n.id,n)},this.showLabel=n=>{const i=n.getShape("label");i&&Va(i,"visible"),n.toFront(),this.hiddenElements.delete(n.id)},this.onTransform=AT(this.onToggleVisibility,this.options.throttle,{leading:!0}),this.enableToggle=!0,this.toggle=n=>{this.enableToggle&&this.onToggleVisibility(n)},this.onBeforeRender=()=>{this.enableToggle=!1},this.onAfterRender=n=>{this.onToggleVisibility(n),this.enableToggle=!0},this.bindEvents()}update(e){this.unbindEvents(),super.update(e),this.bindEvents(),this.onToggleVisibility({})}getLabelElements(){const{elementMap:e}=this.context.element,t=[];for(const n in e){const i=e[n];i.isVisible()&&i.getShape("label")&&t.push(i)}return t}getLabelElementsInView(){const e=this.context.viewport;return this.getLabelElements().filter(t=>e.isInViewport(t.getShape("key").getRenderBounds()))}bindEvents(){const{graph:e}=this.context;e.on(ve.BEFORE_RENDER,this.onBeforeRender),e.on(ve.AFTER_RENDER,this.onAfterRender),e.on(ve.AFTER_DRAW,this.toggle),e.on(ve.AFTER_LAYOUT,this.toggle),e.on(ve.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){const{graph:e}=this.context;e.off(ve.BEFORE_RENDER,this.onBeforeRender),e.off(ve.AFTER_RENDER,this.onAfterRender),e.off(ve.AFTER_DRAW,this.toggle),e.off(ve.AFTER_LAYOUT,this.toggle),e.off(ve.AFTER_TRANSFORM,this.onTransform)}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}destroy(){this.unbindEvents(),super.destroy()}}Cc.defaultOptions={enable:!0,throttle:100,padding:0,sortNode:{type:"degree"}};const Ib=[0,0,0];function $e(r,e){return r.map((t,n)=>t+e[n])}function ot(r,e){return r.map((t,n)=>t-e[n])}function wi(r,e){return typeof e=="number"?r.map(t=>t*e):r.map((t,n)=>t*e[n])}function qr(r,e){return typeof e=="number"?r.map(t=>t/e):r.map((t,n)=>t/e[n])}function U5(r,e){return r.reduce((t,n,i)=>t+n*e[i],0)}function H5(r,e){const t=Go(r),n=Go(e);return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]}function Qi(r,e){return r.map(t=>t*e)}function yt(r,e){return Math.sqrt(r.reduce((t,n,i)=>t+Math.pow(n-e[i]||0,2),0))}function ac(r,e){return r.reduce((t,n,i)=>t+Math.abs(n-e[i]),0)}function Oi(r){const e=r.reduce((t,n)=>t+Math.pow(n,2),0);return r.map(t=>t/Math.sqrt(e))}function Tm(r,e,t=!1){const n=r[0]*e[1]-r[1]*e[0];let i=Math.acos(wi(r,e).reduce((a,s)=>a+s,0)/(yt(r,Ib)*yt(e,Ib)));return t&&n<0&&(i=2*Math.PI-i),i}function Pc(r,e=!0){return e?[-r[1],r[0]]:[r[1],-r[0]]}function X5(r,e){return r.map(t=>t%e)}function Ya(r){return[r[0],r[1]]}function Go(r){return m5(r)?[r[0],r[1],0]:r}function WO(r){const[e,t]=r;return!e&&!t?0:Math.atan2(t,e)}function VO(r,e){const[t,n]=r,[i,a]=e,s=ot(t,n),o=ot(i,a);return H5(s,o).every(u=>u===0)}function Om(r,e,t=!1){if(VO(r,e))return;const[n,i]=r,[a,s]=e,o=((n[0]-a[0])*(a[1]-s[1])-(n[1]-a[1])*(a[0]-s[0]))/((n[0]-i[0])*(a[1]-s[1])-(n[1]-i[1])*(a[0]-s[0])),u=s[0]-a[0]?(n[0]-a[0]+o*(i[0]-n[0]))/(s[0]-a[0]):(n[1]-a[1]+o*(i[1]-n[1]))/(s[1]-a[1]);if(!(!t&&(!ci(o,0,1)||!ci(u,0,1))))return[n[0]+o*(i[0]-n[0]),n[1]+o*(i[1]-n[1])]}function YO(r){if(Array.isArray(r))return ci(r[0],0,1)&&ci(r[1],0,1)?r:[.5,.5];const e=r.split("-"),t=e.includes("left")?0:e.includes("right")?1:.5,n=e.includes("top")?0:e.includes("bottom")?1:.5;return[t,n]}function on(r){const{x:e=0,y:t=0,z:n=0}=r.style||{};return[+e,+t,+n]}function K5(r){const{x:e,y:t,z:n}=r.style||{};return e!==void 0||t!==void 0||n!==void 0}function Z5(r,e){const[t,n]=e,{min:i,max:a}=r;return[i[0]+t*(a[0]-i[0]),i[1]+n*(a[1]-i[1])]}function xi(r,e="center"){const t=YO(e);return Z5(r,t)}function En(r){var e;return[r.x,r.y,(e=r.z)!==null&&e!==void 0?e:0]}function Br(r){var e;return{x:r[0],y:r[1],z:(e=r[2])!==null&&e!==void 0?e:0}}function ao(r,e=0){return r.map(t=>parseFloat(t.toFixed(e)))}function sa(r,e,t,n=!1){if(Bt(r,e))return r;const i=n?ot(r,e):ot(e,r),a=Oi(i),s=[a[0]*t,a[1]*t];return $e(Ya(r),s)}function UO(r,e){return r[1]===e[1]}function Q5(r,e){return r[0]===e[0]}function J5(r,e){return UO(r,e)||Q5(r,e)}function HO(r,e,t){return VO([r,e],[e,t])}function XO(r,e){return[2*e[0]-r[0],2*e[1]-r[1]]}function KO(r,e,t,n=!0,i=!1){for(let a=0;a<t.length;a++){let s=t[a],o=t[(a+1)%t.length];n&&(s=$e(e,s),o=$e(e,o));const u=i?XO(r,e):r,l=Om([e,u],[s,o]);if(l)return{point:l,line:[s,o]}}return{point:e,line:void 0}}function e6(r,e,t,n){const i=r[0],a=r[1];let s=!1;t===void 0&&(t=0),n===void 0&&(n=e.length);const o=n-t;for(let u=0,l=o-1;u<o;l=u++){const c=e[u+t][0],d=e[u+t][1],h=e[l+t][0],f=e[l+t][1];d>a!=f>a&&i<(h-c)*(a-d)/(f-d)+c&&(s=!s)}return s}function t6(r,e,t=!1){const n=xi(e,"center"),i=[xi(e,"left-top"),xi(e,"right-top"),xi(e,"right-bottom"),xi(e,"left-bottom")];return KO(r,n,i,!1,t).point}function Lc(r,e,t=!1){const n=e.center,i=t?XO(r,n):r,a=ot(i,e.center),s=Math.atan2(a[1],a[0]);if(isNaN(s))return n;const o=fi(e)/2,u=gi(e)/2,l=n[0]+o*Math.cos(s),c=n[1]+u*Math.sin(s);return[l,c]}function n6(r,e){let t=1/0,n=[r[0],e[0]];return r.forEach(i=>{e.forEach(a=>{const s=yt(i,a);s<t&&(t=s,n=[i,a])})}),n}function r6(r,e){let t=1/0,n=[[0,0],[0,0]];return e.forEach(i=>{const a=i6(r,i);a<t&&(t=a,n=i)}),n}function i6(r,e){const t=ZO(r,e);return yt(r,t)}function ZO(r,e){const[t,n]=e[0],[i,a]=e[1],[s,o]=r,u=i-t,l=a-n;if(u===0&&l===0)return[t,n];let c=((s-t)*u+(o-n)*l)/(u*u+l*l);c>1?c=1:c<0&&(c=0);const d=t+c*u,h=n+c*l;return[d,h]}function a6(r){const e=r.reduce((t,n)=>$e(t,n),[0,0]);return qr(e,r.length)}function Am(r,e=!0){const t=a6(r);return r.sort(([n,i],[a,s])=>{const o=Math.atan2(i-t[1],n-t[0]),u=Math.atan2(s-t[1],a-t[0]);return e?u-o:o-u})}function Rb(r,e){return[r,[r[0],e[1]],e,[e[0],r[1]]]}const jb=r=>r.map(e=>tt(e)?e.toLocaleLowerCase():e);class Ws{constructor(e){this.map=new Map,this.recordKey=new Set,this.onKeyDown=t=>{t!=null&&t.key&&(this.recordKey.add(t.key),this.trigger(t))},this.onKeyUp=t=>{t!=null&&t.key&&this.recordKey.delete(t.key)},this.onWheel=t=>{this.triggerExtendKey(ae.WHEEL,t)},this.onDrag=t=>{this.triggerExtendKey(ae.DRAG,t)},this.onFocus=()=>{this.recordKey.clear()},this.emitter=e,this.bindEvents()}bind(e,t){e.length!==0&&this.map.set(e,t)}unbind(e,t){this.map.forEach((n,i)=>{Bt(i,e)&&(!t||t===n)&&this.map.delete(i)})}unbindAll(){this.map.clear()}match(e){const t=jb(Array.from(this.recordKey)).sort(),n=jb(e).sort();return Bt(t,n)}bindEvents(){var e;const{emitter:t}=this;t.on(ae.KEY_DOWN,this.onKeyDown),t.on(ae.KEY_UP,this.onKeyUp),t.on(ae.WHEEL,this.onWheel),t.on(ae.DRAG,this.onDrag),(e=globalThis.addEventListener)===null||e===void 0||e.call(globalThis,"focus",this.onFocus)}trigger(e){this.map.forEach((t,n)=>{this.match(n)&&t(e)})}triggerExtendKey(e,t){this.map.forEach((n,i)=>{i.includes(e)&&Bt(Array.from(this.recordKey),i.filter(a=>a!==e))&&n(t)})}destroy(){var e;this.unbindAll(),this.emitter.off(ae.KEY_DOWN,this.onKeyDown),this.emitter.off(ae.KEY_UP,this.onKeyUp),this.emitter.off(ae.WHEEL,this.onWheel),this.emitter.off(ae.DRAG,this.onDrag),(e=globalThis.removeEventListener)===null||e===void 0||e.call(globalThis,"blur",this.onFocus)}}class fu extends pr{constructor(e,t){super(e,Gn({},fu.defaultOptions,t)),this.shortcut=new Ws(e.graph),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.clearStates=this.clearStates.bind(this),this.bindEvents()}onPointerDown(e){if(!this.validate(e)||!this.isKeydown()||this.startPoint)return;const{canvas:t,graph:n}=this.context,i=Object.assign({},this.options.style);this.options.style.lineWidth&&(i.lineWidth=+this.options.style.lineWidth/n.getZoom()),this.rectShape=new Sn({id:"g6-brush-select",style:i}),t.appendChild(this.rectShape),this.startPoint=[e.canvas.x,e.canvas.y]}onPointerMove(e){var t;if(!this.startPoint)return;const{immediately:n,mode:i}=this.options;this.endPoint=sc(e),(t=this.rectShape)===null||t===void 0||t.attr({x:Math.min(this.endPoint[0],this.startPoint[0]),y:Math.min(this.endPoint[1],this.startPoint[1]),width:Math.abs(this.endPoint[0]-this.startPoint[0]),height:Math.abs(this.endPoint[1]-this.startPoint[1])}),n&&i==="default"&&this.updateElementsStates(Rb(this.startPoint,this.endPoint))}onPointerUp(e){if(this.startPoint){if(!this.endPoint){this.clearBrush();return}this.endPoint=sc(e),this.updateElementsStates(Rb(this.startPoint,this.endPoint)),this.clearBrush()}}clearStates(){this.endPoint||this.clearElementsStates()}clearElementsStates(){const{graph:e}=this.context,t=Object.values(e.getData()).reduce((n,i)=>Object.assign({},n,i.reduce((a,s)=>(a[Q(s)]=[],a),{})),{});e.setElementState(t,this.options.animation)}updateElementsStates(e){const{graph:t}=this.context,{enableElements:n,state:i,mode:a,onSelect:s}=this.options,o=this.selector(t,e,n);let u={};switch(a){case"union":o.forEach(l=>{u[l]=[...t.getElementState(l),i]});break;case"diff":o.forEach(l=>{const c=t.getElementState(l);u[l]=c.includes(i)?c.filter(d=>d!==i):[...c,i]});break;case"intersect":o.forEach(l=>{const c=t.getElementState(l);u[l]=c.includes(i)?[i]:[]});break;case"default":default:o.forEach(l=>{u[l]=[i]});break}Te(s)&&(u=s(u)),t.setElementState(u,this.options.animation)}selector(e,t,n){if(!n||n.length===0)return[];const i=[],a=e.getData();if(n.forEach(s=>{a[`${s}s`].forEach(o=>{const u=Q(o);e.getElementVisibility(u)!=="hidden"&&e6(e.getElementPosition(u),t)&&i.push(u)})}),n.includes("edge")){const s=a.edges;s==null||s.forEach(o=>{const{source:u,target:l}=o;i.includes(u)&&i.includes(l)&&i.push(Q(o))})}return i}clearBrush(){var e;(e=this.rectShape)===null||e===void 0||e.remove(),this.rectShape=void 0,this.startPoint=void 0,this.endPoint=void 0}isKeydown(){const{trigger:e}=this.options,t=Array.isArray(e)?e:[e];return this.shortcut.match(t.filter(n=>n!=="drag"))}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}bindEvents(){const{graph:e}=this.context;e.on(ae.POINTER_DOWN,this.onPointerDown),e.on(ae.POINTER_MOVE,this.onPointerMove),e.on(ae.POINTER_UP,this.onPointerUp),e.on(Ai.CLICK,this.clearStates)}unbindEvents(){const{graph:e}=this.context;e.off(ae.POINTER_DOWN,this.onPointerDown),e.off(ae.POINTER_MOVE,this.onPointerMove),e.off(ae.POINTER_UP,this.onPointerUp),e.off(Ai.CLICK,this.clearStates)}update(e){this.unbindEvents(),this.options=Gn(this.options,e),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}fu.defaultOptions={animation:!1,enable:!0,enableElements:["node","combo","edge"],immediately:!1,mode:"default",state:"selected",trigger:["shift"],style:{width:0,height:0,lineWidth:1,fill:"#1677FF",stroke:"#1677FF",fillOpacity:.1,zIndex:2,pointerEvents:"none"}};const sc=r=>[r.canvas.x,r.canvas.y],Ni=.8,Ua=["node","edge","combo"];function Ls(r,e,t,n,i=0){n==="TB"&&e(r,i);const a=t(r);if(a)for(const s of a)Ls(s,e,t,n,i+1);n==="BT"&&e(r,i)}function s6(r,e,t){const n=[[r,0]];for(;n.length;){const[i,a]=n.shift();e(i,a);const s=t(i);if(s)for(const o of s)n.push([o,a+1])}}function QO(r,e,t,n,i="both"){if(e==="combo"||e==="node")return Ah(r,t,n,i);const a=r.getEdgeData(t);if(!a)return[];const s=Ah(r,a.source,n-1,i),o=Ah(r,a.target,n-1,i);return Array.from(new Set([...s,...o,t]))}function Ah(r,e,t,n="both"){const i=new Set,a=new Set,s=new Set;return s6(e,(o,u)=>{u>t||(s.add(o),r.getRelatedEdgesData(o,n).forEach(l=>{const c=Q(l);!a.has(c)&&u<t&&(s.add(c),a.add(c))}))},o=>r.getRelatedEdgesData(o,n).map(u=>u.source===o?u.target:u.source).filter(u=>i.has(u)?!1:(i.add(u),!0))),Array.from(s)}function kh(r){return r.states||[]}var al=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})};class Dc extends pr{constructor(e,t){super(e,Object.assign({},Dc.defaultOptions,t)),this.onClickSelect=n=>al(this,void 0,void 0,function*(){var i,a;this.validate(n)&&(yield this.updateState(n),(a=(i=this.options).onClick)===null||a===void 0||a.call(i,n))}),this.onClickCanvas=n=>al(this,void 0,void 0,function*(){var i,a;this.validate(n)&&(yield this.clearState(),(a=(i=this.options).onClick)===null||a===void 0||a.call(i,n))}),this.shortcut=new Ws(e.graph),this.bindEvents()}bindEvents(){const{graph:e}=this.context;this.unbindEvents(),Ua.forEach(t=>{e.on(`${t}:${ae.CLICK}`,this.onClickSelect)}),e.on(Ai.CLICK,this.onClickCanvas)}get isMultipleSelect(){const{multiple:e,trigger:t}=this.options;return e&&this.shortcut.match(t)}getNeighborIds(e){const{target:t,targetType:n}=e,{graph:i}=this.context,{degree:a}=this.options;return QO(i,n,t.id,typeof a=="function"?a(e):a).filter(s=>s!==t.id)}updateState(e){return al(this,void 0,void 0,function*(){const{state:t,unselectedState:n,neighborState:i,animation:a}=this.options;if(!t&&!i&&!n)return;const{target:s}=e,{graph:o}=this.context,u=o.getElementData(s.id),l=kh(u).includes(t)?"unselect":"select",c={},d=this.isMultipleSelect,h=[s.id],f=this.getNeighborIds(e);if(d)if(Object.assign(c,this.getDataStates()),l==="select"){const g=(v,p)=>{v.forEach(y=>{const m=new Set(o.getElementState(y));m.add(p),m.delete(n),c[y]=Array.from(m)})};g(h,t),g(f,i),n&&Object.keys(c).forEach(v=>{const p=c[v];!p.includes(t)&&!p.includes(i)&&!p.includes(n)&&c[v].push(n)})}else{const g=c[s.id];c[s.id]=g.filter(v=>v!==t&&v!==i),g.includes(n)||c[s.id].push(n),f.forEach(v=>{c[v]=c[v].filter(p=>p!==i),c[v].includes(t)||c[v].push(n)})}else if(l==="select"){Object.assign(c,this.getClearStates(!!n));const g=(v,p)=>{v.forEach(y=>{c[y]||(c[y]=o.getElementState(y)),c[y].push(p)})};g(h,t),g(f,i),n&&Object.keys(c).forEach(v=>{!h.includes(v)&&!f.includes(v)&&c[v].push(n)})}else Object.assign(c,this.getClearStates());yield o.setElementState(c,a)})}getDataStates(){const{graph:e}=this.context,{nodes:t,edges:n,combos:i}=e.getData(),a={};return[...t,...n,...i].forEach(s=>{a[Q(s)]=kh(s)}),a}getClearStates(e=!1){const{graph:t}=this.context,{state:n,unselectedState:i,neighborState:a}=this.options,s=new Set([n,i,a]),{nodes:o,edges:u,combos:l}=t.getData(),c={};return[...o,...u,...l].forEach(d=>{const h=kh(d),f=h.filter(g=>!s.has(g));(e||f.length!==h.length)&&(c[Q(d)]=f)}),c}clearState(){return al(this,void 0,void 0,function*(){const{graph:e}=this.context;yield e.setElementState(this.getClearStates(),this.options.animation)})}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}unbindEvents(){const{graph:e}=this.context;Ua.forEach(t=>{e.off(`${t}:${ae.CLICK}`,this.onClickSelect)}),e.off(Ai.CLICK,this.onClickCanvas)}destroy(){this.unbindEvents(),super.destroy()}}Dc.defaultOptions={animation:!0,enable:!0,multiple:!1,trigger:["shift"],state:"selected",neighborState:"selected",unselectedState:void 0,degree:0};function Jn(r){var e;return!!(!((e=r.style)===null||e===void 0)&&e.collapsed)}function oc(r,e){if(!r.startsWith(e))return!1;const t=r[e.length];return t>="A"&&t<="Z"}function o6(r,e){return`${e}${Vl(r)}`}function u6(r,e,t=!0){if(!e||!oc(r,e))return r;const n=r.slice(e.length);return t?jL(n):n}function Qt(r,e){const t=Object.entries(r).reduce((n,[i,a])=>(i==="className"||i==="class"||oc(i,e)&&Object.assign(n,{[u6(i,e)]:a}),n),{});if("opacity"in r){const n=o6("opacity",e),i=r.opacity;if(n in r){const a=r[n];Object.assign(t,{opacity:i*a})}else Object.assign(t,{opacity:i})}return t}function my(r,e){const t=e.length;return Object.keys(r).reduce((n,i)=>{if(i.startsWith(e)){const a=i.slice(t);n[a]=r[i]}return n},{})}function JO(r,e){const t=typeof e=="string"?[e]:e,n={};return Object.keys(r).forEach(i=>{t.find(a=>i.startsWith(a))||(n[i]=r[i])}),n}function hr(r=0){if(typeof r=="number")return[r,r,r];const[e,t=e,n=e]=r;return[e,t,n]}var l6=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};function Bb(r,e){const{datum:t,graph:n}=e;return typeof r=="function"?r.call(n,t):Object.fromEntries(Object.entries(r).map(([i,a])=>typeof a=="function"?[i,a.call(n,t)]:[i,a]))}function yn(r,e){const t=(r==null?void 0:r.style)||{},n=(e==null?void 0:e.style)||{};for(const i in t)i in n||(n[i]=t[i]);return Object.assign({},r,e,{style:n})}function c6(r){return l6(r,["x","y","z","class","className","transform","transformOrigin","zIndex","visibility"])}function d6(r,e){const t=hr(r);let n={};return e.text&&!e.fontSize&&(n={fontSize:Math.min(...t)*.5}),e.src&&(!e.width||!e.height)&&(n={width:t[0]*.5,height:t[1]*.5}),n}function Fb(r){if(r)return typeof r=="string"||typeof r=="function"||Array.isArray(r)?{type:"group",field:e=>e.id,color:r,invert:!1}:r}function h6(r,e){if(!e)return{};const{type:t,color:n,field:i,invert:a}=e,s=u=>{const l=typeof n=="string"?ki("palette",n):n;if(typeof l=="function"){const c={};return u.forEach(([d,h])=>{c[d]=l(a?1-h:h)}),c}else if(Array.isArray(l)){const c=a?[...l].reverse():l,d={};return u.forEach(([h,f])=>{d[h]=c[f%l.length]}),d}return{}},o=(u,l)=>{var c;return typeof u=="string"?(c=l.data)===null||c===void 0?void 0:c[u]:u==null?void 0:u(l)};if(t==="group"){const u=_c(r,h=>{if(!i)return"default";const f=o(i,h);return f?String(f):"default"}),l=Object.keys(u),c=s(l.map((h,f)=>[h,f])),d={};return Object.entries(u).forEach(([h,f])=>{f.forEach(g=>{d[Q(g)]=c[h]})}),d}else if(t==="value"){const[u,l]=r.reduce(([d,h],f)=>{const g=o(i,f);if(typeof g!="number")throw new Error(_i(`Palette field ${i} is not a number`));return[Math.min(d,g),Math.max(h,g)]},[1/0,-1/0]),c=l-u;return s(r.map(d=>[d.id,(o(i,d)-u)/c]))}}function eA(r){const e=typeof r=="string"?ki("palette",r):r;if(typeof e!="function")return e}function tA(r,e){let t=2*r;return typeof e=="string"?t=r*Number(e.replace("%",""))/100:typeof e=="number"&&(t=e),isNaN(t)&&(t=2*r),t}function nA(r,e,t=1,n=!1){const i=n?t:1,a=(r.max[0]-r.min[0])*i;return tA(a,e)}function f6(r,e,t=1){const n=yt(r[0],r[1])*t;return tA(n,e)}class gu extends ym{constructor(e){zb(e.style),super(e),this.shapeMap={},this.animateMap={},this.render(this.attributes,this),this.setVisibility(),this.bindEvents()}get parsedAttributes(){return this.attributes}upsert(e,t,n,i,a){var s,o,u,l,c,d,h,f;const g=this.shapeMap[e];if(n===!1){g&&((s=a==null?void 0:a.beforeDestroy)===null||s===void 0||s.call(a,g),i.removeChild(g),delete this.shapeMap[e],(o=a==null?void 0:a.afterDestroy)===null||o===void 0||o.call(a,g));return}const v=typeof t=="string"?ki($o.SHAPE,t):t;if(!v)throw new Error(_i(`Shape ${t} not found`));if(!g||g.destroyed||!(g instanceof v)){g&&((u=a==null?void 0:a.beforeDestroy)===null||u===void 0||u.call(a,g),g==null||g.destroy(),(l=a==null?void 0:a.afterDestroy)===null||l===void 0||l.call(a,g)),(c=a==null?void 0:a.beforeCreate)===null||c===void 0||c.call(a);const p=new v({className:e,style:n});return i.appendChild(p),this.shapeMap[e]=p,(d=a==null?void 0:a.afterCreate)===null||d===void 0||d.call(a,p),p}return(h=a==null?void 0:a.beforeUpdate)===null||h===void 0||h.call(a,g),Ty(g,n),(f=a==null?void 0:a.afterUpdate)===null||f===void 0||f.call(a,g),g}update(e={}){const t=Object.assign({},this.attributes,e);zb(t),uB(this,t),this.render(t,this),this.setVisibility()}bindEvents(){}getGraphicStyle(e){return c6(e)}get compositeShapes(){return[["badges","badge-"],["ports","port-"]]}animate(e,t){if(e.length===0)return null;const n=[];if(e[0].x!==void 0||e[0].y!==void 0||e[0].z!==void 0){const{x:a=0,y:s=0,z:o=0}=this.attributes;e.forEach(u=>{const{x:l=a,y:c=s,z:d=o}=u;Object.assign(u,{transform:d?[["translate3d",l,c,d]]:[["translate",l,c]]})})}const i=super.animate(e,t);if(i&&(Nh(this,i),n.push(i)),Array.isArray(e)&&e.length>0){const a=["transform","transformOrigin","x","y","z","zIndex"];if(Object.keys(e[0]).some(s=>!a.includes(s))){Object.entries(this.shapeMap).forEach(([o,u])=>{const l=`get${Vl(o)}Style`,c=this[l];if(Te(c)){const d=e.map(f=>c.call(this,Object.assign(Object.assign({},this.attributes),f))),h=u.animate(yy(d),t);h&&(Nh(u,h),n.push(h))}});const s=(o,u)=>{if(!ti(o)){const l=`get${Vl(u)}Style`,c=this[l];if(Te(c)){const d=e.map(h=>c.call(this,Object.assign(Object.assign({},this.attributes),h)));Object.entries(d[0]).map(([h])=>{const f=d.map(v=>v[h]),g=o[h];if(g){const v=g.animate(yy(f),t);v&&(Nh(g,v),n.push(v))}})}}};this.compositeShapes.forEach(([o,u])=>{const l=my(this.shapeMap,u);s(l,o)})}}return xm(n)}getShape(e){return this.shapeMap[e]}setVisibility(){const{visibility:e}=this.attributes;Va(this,e)}destroy(){this.shapeMap={},this.animateMap={},super.destroy()}}function Nh(r,e){e==null||e.finished.then(()=>{const t=r.activeAnimations.findIndex(n=>n===e);t>-1&&r.activeAnimations.splice(t,1)})}function zb(r){if(!r)return{};if("x"in r||"y"in r||"z"in r){const{x:e=0,y:t=0,z:n,transform:i}=r,a=PO(e,t,n,i);a&&(r.transform=a)}return r}var g6=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class ya extends gu{constructor(e){super(yn({style:ya.defaultStyleProps},e))}isTextStyle(e){return oc(e,"label")}isBackgroundStyle(e){return oc(e,"background")}getTextStyle(e){const t=this.getGraphicStyle(e),n=g6(t,["padding"]);return JO(n,"background")}getBackgroundStyle(e){if(e.background===!1)return!1;const t=this.getGraphicStyle(e),{wordWrap:n,wordWrapWidth:i,padding:a}=t,s=Qt(t,"background"),{min:[o,u],center:[l,c],halfExtents:[d,h]}=this.shapeMap.text.getGeometryBounds(),[f,g,v,p]=hi(a),y=d*2+p+g,{width:m,height:w}=s;m&&w?Object.assign(s,{x:l-Number(m)/2,y:c-Number(w)/2}):Object.assign(s,{x:o-p,y:u-f,width:n?Math.min(y,i+p+g):y,height:h*2+f+v});const{radius:M}=s;if(typeof M=="string"&&M.endsWith("%")){const S=Number(M.replace("%",""))/100;s.radius=Math.min(+s.width,+s.height)*S}return s}render(e=this.parsedAttributes,t=this){this.upsert("text",es,this.getTextStyle(e),t),this.upsert("background",Sn,this.getBackgroundStyle(e),t)}getGeometryBounds(){return(this.getShape("background")||this.getShape("text")).getGeometryBounds()}}ya.defaultStyleProps={padding:0,fontSize:12,fontFamily:"system-ui, sans-serif",wordWrap:!0,maxLines:1,wordWrapWidth:128,textOverflow:"...",textBaseline:"middle",backgroundOpacity:.75,backgroundZIndex:-1,backgroundLineWidth:0};class Vs extends gu{constructor(e){super(yn({style:Vs.defaultStyleProps},e))}getBadgeStyle(e){return this.getGraphicStyle(e)}render(e=this.parsedAttributes,t=this){this.upsert("label",ya,this.getBadgeStyle(e),t)}getGeometryBounds(){const e=this.getShape("label");return(e.getShape("background")||e.getShape("text")).getGeometryBounds()}}Vs.defaultStyleProps={padding:[2,4,2,4],fontSize:10,wordWrap:!1,backgroundRadius:"50%",backgroundOpacity:1};function p6(r,e=!0){const t=[];return r.forEach((n,i)=>{t.push([i===0?"M":"L",...n])}),e&&t.push(["Z"]),t}const $b={M:["x","y"],m:["dx","dy"],H:["x"],h:["dx"],V:["y"],v:["dy"],L:["x","y"],l:["dx","dy"],Z:[],z:[],C:["x1","y1","x2","y2","x","y"],c:["dx1","dy1","dx2","dy2","dx","dy"],S:["x2","y2","x","y"],s:["dx2","dy2","dx","dy"],Q:["x1","y1","x","y"],q:["dx1","dy1","dx","dy"],T:["x","y"],t:["dx","dy"],A:["rx","ry","rotation","large-arc","sweep","x","y"],a:["rx","ry","rotation","large-arc","sweep","dx","dy"]};function v6(r){const e=r.replace(/[\n\r]/g,"").replace(/-/g," -").replace(/(\d*\.)(\d+)(?=\.)/g,"$1$2 ").trim().split(/\s*,|\s+/),t=[];let n="",i={};for(;e.length>0;){let a=e.shift();a in $b?n=a:e.unshift(a),i={type:n},$b[n].forEach(u=>{a=e.shift(),i[u]=a}),n==="M"?n="L":n==="m"&&(n="l");const[s,...o]=Object.values(i);t.push([s,...o.map(Number)])}return t}function y6(r){const e=[];return(typeof r=="string"?v6(r):r).forEach(n=>{const i=n[0];if(i==="Z"){e.push(e[0]);return}if(i!=="A")for(let a=1;a<n.length;a=a+2)e.push([n[a],n[a+1],0]);else{const a=n.length;e.push([n[a-2],n[a-1],0])}}),e}const rA=r=>{if(r.length<2)return[["M",0,0],["L",0,0]];const e=r[0],t=r[1],n=r[r.length-1],i=r[r.length-2];r.unshift(i,n),r.push(e,t);const a=[["M",n[0],n[1]]];for(let s=1;s<r.length-2;s+=1){const[o,u]=r[s-1],[l,c]=r[s],[d,h]=r[s+1],[f,g]=s!==r.length-2?r[s+2]:[d,h],v=l+(d-o)/6,p=c+(h-u)/6,y=d-(f-l)/6,m=h-(g-c)/6;a.push(["C",v,p,y,m,d,h])}return a};function m6(r,e,t,n,i,a,s){const[o,u]=xi(r,e),l={textAlign:e==="left"?"right":e==="right"?"left":"center",textBaseline:e==="top"?"bottom":e==="bottom"?"top":"middle",transform:[["translate",o+t,u+n]]};if(e==="center"||!i)return l;const c=y6(a);if(!c||c.length<=3)return l;const d=c.map((g,v)=>{const p=g,y=c[(v+1)%c.length];return Bt(p,y)?null:[p,y]}).filter(Boolean),h=r6([o,u],d),f=ZO([o,u],h);if(f&&h&&(l.transform=[["translate",f[0]+t,f[1]+n]],s)){const g=Math.atan((h[0][1]-h[1][1])/(h[0][0]-h[1][0]));l.transform.push(["rotate",g/Math.PI*180]),l.textAlign="center",(e==="right"||e==="left")&&(g>0?l.textBaseline=e==="right"?"bottom":"top":l.textBaseline=e==="right"?"top":"bottom")}return l}var b6=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class pu extends gu{constructor(e){super(yn({style:pu.defaultStyleProps},e))}getLabelStyle(e){if(!e.label||!e.d||e.d.length===0)return!1;const t=Qt(this.getGraphicStyle(e),"label"),{maxWidth:n,offsetX:i,offsetY:a,autoRotate:s,placement:o,closeToPath:u}=t,l=b6(t,["maxWidth","offsetX","offsetY","autoRotate","placement","closeToPath"]),c=this.shapeMap.key,d=c==null?void 0:c.getRenderBounds();return Object.assign(m6(d,o,i,a,u,e.d,s),{wordWrapWidth:nA(d,n)},l)}getKeyStyle(e){return this.getGraphicStyle(e)}render(e,t){this.upsert("key",lr,this.getKeyStyle(e),t),this.upsert("label",ya,this.getLabelStyle(e),t)}}pu.defaultStyleProps={label:!0,labelPlacement:"bottom",labelCloseToPath:!0,labelAutoRotate:!0,labelOffsetX:0,labelOffsetY:0};function w6(r){const e=[],t=n=>{n!=null&&n.children.length&&n.children.forEach(i=>{e.push(i),t(i)})};return t(r),e}function x6(r){const e=[];let t=r.parentNode;for(;t;)e.push(t),t=t.parentNode;return e}let km=class extends du{constructor(e){super(e),this.onMounted=()=>{this.handleRadius()},this.onAttrModified=()=>{this.handleRadius()},xs=this,this.isMutationObserved=!0,this.addEventListener(He.MOUNTED,this.onMounted),this.addEventListener(He.ATTR_MODIFIED,this.onAttrModified)}handleRadius(){const{radius:e,clipPath:t,width:n=0,height:i=0}=this.attributes;if(e&&n&&i){const[a,s]=this.getBounds().min,o={x:a,y:s,radius:e,width:n,height:i};if(t)Object.assign(this.parsedStyle.clipPath.style,o);else{const u=new Sn({style:o});this.style.clipPath=u}}else t&&(this.style.clipPath=null)}};const by=new WeakMap;let xs=null;const Nm=r=>{if(xs&&x6(xs).includes(r)){const e=by.get(r);e?e.includes(xs)||e.push(xs):by.set(r,[xs])}},Cm=r=>{const e=by.get(r);e&&e.forEach(t=>t.handleRadius())};class iA extends gu{constructor(e){super(e)}isImage(){const{src:e}=this.attributes;return!!e}getIconStyle(e=this.attributes){const{width:t=0,height:n=0}=e,i=this.getGraphicStyle(e);return this.isImage()?Object.assign({x:-t/2,y:-n/2},i):Object.assign({textBaseline:"middle",textAlign:"center"},i)}render(e=this.attributes,t=this){this.upsert("icon",this.isImage()?km:es,this.getIconStyle(e),t)}}class aA extends gu{get context(){return this.config.context}get parsedAttributes(){return this.attributes}onframe(){}animate(e,t){const n=super.animate(e,t);return n&&(n.onframe=()=>this.onframe(),n.finished.then(()=>this.onframe())),n}}var sl=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Wr extends aA{constructor(e){super(yn({style:Wr.defaultStyleProps},e)),this.type="node"}getSize(e=this.attributes){const{size:t}=e;return hr(t)}getKeyStyle(e){const t=this.getGraphicStyle(e);return Object.assign(JO(t,["label","halo","icon","badge","port"]))}getLabelStyle(e){if(e.label===!1||!e.labelText)return!1;const t=Qt(this.getGraphicStyle(e),"label"),{placement:n,maxWidth:i,offsetX:a,offsetY:s}=t,o=sl(t,["placement","maxWidth","offsetX","offsetY"]),u=this.getShape("key").getLocalBounds();return Object.assign(rw(u,n,a,s),{wordWrapWidth:nA(u,i)},o)}getHaloStyle(e){if(e.halo===!1)return!1;const t=this.getKeyStyle(e),{fill:n}=t,i=sl(t,["fill"]),a=Qt(this.getGraphicStyle(e),"halo");return Object.assign(Object.assign(Object.assign({},i),{stroke:n}),a)}getIconStyle(e){if(e.icon===!1||!e.iconText&&!e.iconSrc)return!1;const t=Qt(this.getGraphicStyle(e),"icon");return Object.assign(d6(e.size,t),t)}getBadgesStyle(e){var t;const n=my(this.shapeMap,"badge-"),i={};if(Object.keys(n).forEach(d=>{i[d]=!1}),e.badge===!1||!(!((t=e.badges)===null||t===void 0)&&t.length))return i;const{badges:a=[],badgePalette:s,opacity:o=1}=e,u=sl(e,["badges","badgePalette","opacity"]),l=eA(s),c=Qt(this.getGraphicStyle(u),"badge");return a.forEach((d,h)=>{i[h]=Object.assign(Object.assign({backgroundFill:l?l[h%(l==null?void 0:l.length)]:void 0,opacity:o},c),this.getBadgeStyle(d))}),i}getBadgeStyle(e){const t=this.getShape("key"),{placement:n="top",offsetX:i,offsetY:a}=e,s=sl(e,["placement","offsetX","offsetY"]),o=rw(t.getLocalBounds(),n,i,a,!0);return Object.assign(Object.assign({},o),s)}getPortsStyle(e){var t;const n=this.getPorts(),i={};if(Object.keys(n).forEach(o=>{i[o]=!1}),e.port===!1||!(!((t=e.ports)===null||t===void 0)&&t.length))return i;const a=Qt(this.getGraphicStyle(e),"port"),{ports:s=[]}=e;return s.forEach((o,u)=>{const l=o.key||u,c=Object.assign(Object.assign({},a),o);if(TA(c))i[l]=!1;else{const[d,h]=this.getPortXY(e,o);i[l]=Object.assign({transform:[["translate",d,h]]},c)}}),i}getPortXY(e,t){const{placement:n="left"}=t,i=this.getShape("key");return Rm(E6(this.context,i),n)}getPorts(){return my(this.shapeMap,"port-")}getCenter(){return this.getShape("key").getBounds().center}getIntersectPoint(e,t=!1){const n=this.getShape("key").getBounds();return t6(e,n,t)}drawHaloShape(e,t){const n=this.getHaloStyle(e),i=this.getShape("key");this.upsert("halo",i.constructor,n,t)}drawIconShape(e,t){const n=this.getIconStyle(e);this.upsert("icon",iA,n,t),Nm(this)}drawBadgeShapes(e,t){const n=this.getBadgesStyle(e);Object.keys(n).forEach(i=>{const a=n[i];this.upsert(`badge-${i}`,Vs,a,t)})}drawPortShapes(e,t){const n=this.getPortsStyle(e);Object.keys(n).forEach(i=>{const a=n[i],s=`port-${i}`;this.upsert(s,Ii,a,t)})}drawLabelShape(e,t){const n=this.getLabelStyle(e);this.upsert("label",ya,n,t)}_drawKeyShape(e,t){return this.drawKeyShape(e,t)}render(e=this.parsedAttributes,t=this){this._drawKeyShape(e,t),this.getShape("key")&&(this.drawHaloShape(e,t),this.drawIconShape(e,t),this.drawBadgeShapes(e,t),this.drawLabelShape(e,t),this.drawPortShapes(e,t))}update(e){super.update(e),e&&("x"in e||"y"in e||"z"in e)&&Cm(this)}onframe(){this.drawBadgeShapes(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this)}}Wr.defaultStyleProps={x:0,y:0,size:32,droppable:!0,draggable:!0,port:!0,ports:[],portZIndex:2,portLinkToCenter:!1,badge:!0,badges:[],badgeZIndex:3,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloStrokeOpacity:.25,haloPointerEvents:"none",haloZIndex:-1,icon:!0,iconZIndex:1,label:!0,labelIsBillboard:!0,labelMaxWidth:"200%",labelPlacement:"bottom",labelWordWrap:!1,labelZIndex:0};function E6(r,e){if(!r)return e.getLocalBounds();const t=r.canvas.getLayer(),n=e.cloneNode();Va(n,"hidden"),t.appendChild(n);const i=n.getLocalBounds();return n.destroy(),i}let vu=class sA extends Wr{constructor(e){super(yn({style:sA.defaultStyleProps},e))}drawKeyShape(e,t){return this.upsert("key",Ii,this.getKeyStyle(e),t)}getKeyStyle(e){const t=super.getKeyStyle(e);return Object.assign(Object.assign({},t),{r:Math.min(...this.getSize(e))/2})}getIconStyle(e){const t=super.getIconStyle(e),{r:n}=this.getShape("key").attributes,i=n*2*Ni;return t?Object.assign({width:i,height:i},t):!1}getIntersectPoint(e,t=!1){const n=this.getShape("key").getBounds();return Lc(e,n,t)}};vu.defaultStyleProps={size:32};class Ic extends Wr{constructor(e){super(e)}get parsedAttributes(){return this.attributes}drawKeyShape(e,t){return this.upsert("key",Ja,this.getKeyStyle(e),t)}getKeyStyle(e){const t=super.getKeyStyle(e);return Object.assign(Object.assign({},t),{points:this.getPoints(e)})}getIntersectPoint(e,t=!1){var n,i;const{points:a}=this.getShape("key").attributes,s=[+(((n=this.attributes)===null||n===void 0?void 0:n.x)||0),+(((i=this.attributes)===null||i===void 0?void 0:i.y)||0)];return KO(e,s,a,!0,t).point}}class M6 extends Ic{constructor(e){super(e)}getPoints(e){const[t,n]=this.getSize(e);return sB(t,n)}}var S6=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Rc extends vu{constructor(e){super(yn({style:Rc.defaultStyleProps},e))}parseOuterR(){const{size:e}=this.parsedAttributes;return Math.min(...hr(e))/2}parseInnerR(){const{innerR:e}=this.parsedAttributes;return tt(e)?parseInt(e)/100*this.parseOuterR():e}drawDonutShape(e,t){const{donuts:n}=e;if(!(n!=null&&n.length))return;const i=n.map(d=>Ee(d)?{value:d}:d),a=Qt(this.getGraphicStyle(e),"donut"),s=eA(e.donutPalette);if(!s)return;const o=i.reduce((d,h)=>{var f;return d+((f=h.value)!==null&&f!==void 0?f:0)},0),u=this.parseOuterR(),l=this.parseInnerR();let c=0;i.forEach((d,h)=>{const{value:f=0,color:g=s[h%s.length]}=d,v=S6(d,["value","color"]),p=(o===0?1/i.length:f/o)*360;this.upsert(`round${h}`,lr,Object.assign(Object.assign(Object.assign({},a),{d:O6(u,l,c,c+p),fill:g}),v),t),c+=p})}render(e,t=this){super.render(e,t),this.drawDonutShape(e,t)}}Rc.defaultStyleProps={innerR:"50%",donuts:[],donutPalette:"tableau"};const ol=(r,e,t,n)=>[r+Math.sin(n)*t,e-Math.cos(n)*t],_6=(r,e,t,n)=>n<=0||t<=n?[["M",r-t,e],["A",t,t,0,1,1,r+t,e],["A",t,t,0,1,1,r-t,e],["Z"]]:[["M",r-t,e],["A",t,t,0,1,1,r+t,e],["A",t,t,0,1,1,r-t,e],["Z"],["M",r+n,e],["A",n,n,0,1,0,r-n,e],["A",n,n,0,1,0,r+n,e],["Z"]],T6=(r,e,t,n,i,a)=>{const[s,o]=[i/360*2*Math.PI,a/360*2*Math.PI],u=[ol(r,e,n,s),ol(r,e,t,s),ol(r,e,t,o),ol(r,e,n,o)],l=o-s>Math.PI?1:0;return[["M",u[0][0],u[0][1]],["L",u[1][0],u[1][1]],["A",t,t,0,l,1,u[2][0],u[2][1]],["L",u[3][0],u[3][1]],["A",n,n,0,l,0,u[0][0],u[0][1]],["Z"]]},O6=(r=0,e=0,t,n)=>{const[i,a]=[0,0];return Math.abs(t-n)%360<1e-6?_6(i,a,r,e):T6(i,a,r,e,t,n)};class jc extends Wr{constructor(e){super(yn({style:jc.defaultStyleProps},e))}drawKeyShape(e,t){return this.upsert("key",lu,this.getKeyStyle(e),t)}getKeyStyle(e){const t=super.getKeyStyle(e),[n,i]=this.getSize(e);return Object.assign(Object.assign({},t),{rx:n/2,ry:i/2})}getIconStyle(e){const t=super.getIconStyle(e),{rx:n,ry:i}=this.getShape("key").attributes,a=Math.min(+n,+i)*2*Ni;return t?Object.assign({width:a,height:a},t):!1}getIntersectPoint(e,t=!1){const n=this.getShape("key").getBounds();return Lc(e,n,t)}}jc.defaultStyleProps={size:[45,35]};class A6 extends Ic{constructor(e){super(e)}getOuterR(e){return e.outerR||Math.min(...this.getSize(e))/2}getPoints(e){return lB(this.getOuterR(e))}getIconStyle(e){const t=super.getIconStyle(e),n=this.getOuterR(e)*Ni;return t?Object.assign({width:n,height:n},t):!1}}/*!
 * @antv/g-plugin-canvas-path-generator
 * @description A G plugin of path generator with Canvas2D API
 * @version 2.1.15
 * @date 1/17/2025, 2:06:42 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */function k6(r,e){var t=e.cx,n=t===void 0?0:t,i=e.cy,a=i===void 0?0:i,s=e.r;r.arc(n,a,s,0,Math.PI*2,!1)}function N6(r,e){var t=e.cx,n=t===void 0?0:t,i=e.cy,a=i===void 0?0:i,s=e.rx,o=e.ry;if(r.ellipse)r.ellipse(n,a,s,o,0,0,Math.PI*2,!1);else{var u=s>o?s:o,l=s>o?1:s/o,c=s>o?o/s:1;r.save(),r.scale(l,c),r.arc(n,a,u,0,Math.PI*2)}}function C6(r,e){var t=e.x1,n=e.y1,i=e.x2,a=e.y2,s=e.markerStart,o=e.markerEnd,u=e.markerStartOffset,l=e.markerEndOffset,c=0,d=0,h=0,f=0,g=0,v,p;s&&et(s)&&u&&(v=i-t,p=a-n,g=Math.atan2(p,v),c=Math.cos(g)*(u||0),d=Math.sin(g)*(u||0)),o&&et(o)&&l&&(v=t-i,p=n-a,g=Math.atan2(p,v),h=Math.cos(g)*(l||0),f=Math.sin(g)*(l||0)),r.moveTo(t+c,n+d),r.lineTo(i+h,a+f)}function P6(r,e){var t=e.markerStart,n=e.markerEnd,i=e.markerStartOffset,a=e.markerEndOffset,s=e.d,o=s.absolutePath,u=s.segments,l=0,c=0,d=0,h=0,f=0,g,v;if(t&&et(t)&&i){var p=t.parentNode.getStartTangent(),y=ze(p,2),m=y[0],w=y[1];g=m[0]-w[0],v=m[1]-w[1],f=Math.atan2(v,g),l=Math.cos(f)*(i||0),c=Math.sin(f)*(i||0)}if(n&&et(n)&&a){var M=n.parentNode.getEndTangent(),S=ze(M,2),T=S[0],A=S[1];g=T[0]-A[0],v=T[1]-A[1],f=Math.atan2(v,g),d=Math.cos(f)*(a||0),h=Math.sin(f)*(a||0)}for(var O=0;O<o.length;O++){var N=o[O],C=N[0],P=o[O+1],D=O===0&&(l!==0||c!==0),j=(O===o.length-1||P&&(P[0]==="M"||P[0]==="Z"))&&d!==0&&h!==0,G=D?[l,c]:[0,0],V=ze(G,2),Y=V[0],$=V[1],z=j?[d,h]:[0,0],Z=ze(z,2),ne=Z[0],se=Z[1];switch(C){case"M":r.moveTo(N[1]+Y,N[2]+$);break;case"L":r.lineTo(N[1]+ne,N[2]+se);break;case"Q":r.quadraticCurveTo(N[1],N[2],N[3]+ne,N[4]+se);break;case"C":r.bezierCurveTo(N[1],N[2],N[3],N[4],N[5]+ne,N[6]+se);break;case"A":{var oe=u[O].arcParams,Ne=oe.cx,K=oe.cy,W=oe.rx,ee=oe.ry,le=oe.startAngle,xe=oe.endAngle,Ce=oe.xRotation,Ve=oe.sweepFlag;if(r.ellipse)r.ellipse(Ne,K,W,ee,Ce,le,xe,!!(1-Ve));else{var Tt=W>ee?W:ee,dn=W>ee?1:W/ee,Ot=W>ee?ee/W:1;r.translate(Ne,K),r.rotate(Ce),r.scale(dn,Ot),r.arc(0,0,Tt,le,xe,!!(1-Ve)),r.scale(1/dn,1/Ot),r.rotate(-Ce),r.translate(-Ne,-K)}j&&r.lineTo(N[6]+d,N[7]+h);break}case"Z":r.closePath();break}}}function L6(r,e){var t=e.markerStart,n=e.markerEnd,i=e.markerStartOffset,a=e.markerEndOffset,s=e.points.points,o=s.length,u=s[0][0],l=s[0][1],c=s[o-1][0],d=s[o-1][1],h=0,f=0,g=0,v=0,p=0,y,m;t&&et(t)&&i&&(y=s[1][0]-s[0][0],m=s[1][1]-s[0][1],p=Math.atan2(m,y),h=Math.cos(p)*(i||0),f=Math.sin(p)*(i||0)),n&&et(n)&&a&&(y=s[o-1][0]-s[0][0],m=s[o-1][1]-s[0][1],p=Math.atan2(m,y),g=Math.cos(p)*(a||0),v=Math.sin(p)*(a||0)),r.moveTo(u+(h||g),l+(f||v));for(var w=1;w<o-1;w++){var M=s[w];r.lineTo(M[0],M[1])}r.lineTo(c,d)}function D6(r,e){var t=e.markerStart,n=e.markerEnd,i=e.markerStartOffset,a=e.markerEndOffset,s=e.points.points,o=s.length,u=s[0][0],l=s[0][1],c=s[o-1][0],d=s[o-1][1],h=0,f=0,g=0,v=0,p=0,y,m;t&&et(t)&&i&&(y=s[1][0]-s[0][0],m=s[1][1]-s[0][1],p=Math.atan2(m,y),h=Math.cos(p)*(i||0),f=Math.sin(p)*(i||0)),n&&et(n)&&a&&(y=s[o-2][0]-s[o-1][0],m=s[o-2][1]-s[o-1][1],p=Math.atan2(m,y),g=Math.cos(p)*(a||0),v=Math.sin(p)*(a||0)),r.moveTo(u+h,l+f);for(var w=1;w<o-1;w++){var M=s[w];r.lineTo(M[0],M[1])}r.lineTo(c+g,d+v)}function I6(r,e){var t=e.x,n=t===void 0?0:t,i=e.y,a=i===void 0?0:i,s=e.radius,o=e.width,u=e.height,l=o,c=u,d=s&&s.some(function(S){return S!==0});if(!d)r.rect(n,a,l,c);else{var h=o>0?1:-1,f=u>0?1:-1,g=h+f===0,v=s.map(function(S){return jt(S,0,Math.min(Math.abs(l)/2,Math.abs(c)/2))}),p=ze(v,4),y=p[0],m=p[1],w=p[2],M=p[3];r.moveTo(h*y+n,a),r.lineTo(l-h*m+n,a),m!==0&&r.arc(l-h*m+n,f*m+a,m,-f*Math.PI/2,h>0?0:Math.PI,g),r.lineTo(l+n,c-f*w+a),w!==0&&r.arc(l-h*w+n,c-f*w+a,w,h>0?0:Math.PI,f>0?Math.PI/2:1.5*Math.PI,g),r.lineTo(h*M+n,c+a),M!==0&&r.arc(h*M+n,c-f*M+a,M,f>0?Math.PI/2:-Math.PI/2,h>0?Math.PI:0,g),r.lineTo(n,f*y+a),y!==0&&r.arc(h*y+n,f*y+a,y,h>0?Math.PI:0,f>0?Math.PI*1.5:Math.PI/2,g)}}var R6=function(r){function e(){var t;ce(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=Ge(this,e,[].concat(i)),t.name="canvas-path-generator",t}return We(e,r),de(e,[{key:"init",value:function(){var n,i=(n={},Me(Me(Me(Me(Me(Me(Me(Me(Me(Me(n,re.CIRCLE,k6),re.ELLIPSE,N6),re.RECT,I6),re.LINE,C6),re.POLYLINE,D6),re.POLYGON,L6),re.PATH,P6),re.TEXT,void 0),re.GROUP,void 0),re.IMAGE,void 0),Me(Me(Me(n,re.HTML,void 0),re.MESH,void 0),re.FRAGMENT,void 0));this.context.pathGeneratorFactory=i}},{key:"destroy",value:function(){delete this.context.pathGeneratorFactory}}])}(ga);/*!
 * @antv/g-plugin-canvas-picker
 * @description A G plugin for picking in canvas
 * @version 2.1.17
 * @date 1/17/2025, 2:08:48 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var j6=Ze(),B6=Ze(),F6=Ze(),z6=ht(),oA=function(){function r(){var e=this;ce(this,r),this.isHit=function(t,n,i,a){var s=e.context.pointInPathPickerFactory[t.nodeName];if(s){var o=ni(z6,i),u=In(B6,Ln(F6,n[0],n[1],0),o);if(s(t,new xn(u[0],u[1]),a,e.isPointInPath,e.context,e.runtime))return!0}return!1},this.isPointInPath=function(t,n){var i=e.runtime.offscreenCanvasCreator.getOrCreateContext(e.context.config.offscreenCanvas),a=e.context.pathGeneratorFactory[t.nodeName];return a&&(i.beginPath(),a(i,t.parsedStyle),i.closePath()),i.isPointInPath(n.x,n.y)}}return de(r,[{key:"apply",value:function(t,n){var i,a=this,s=t.renderingService,o=t.renderingContext;this.context=t,this.runtime=n;var u=(i=o.root)===null||i===void 0?void 0:i.ownerDocument;s.hooks.pick.tapPromise(r.tag,function(){var l=da(Mn().mark(function c(d){return Mn().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",a.pick(u,d));case 1:case"end":return f.stop()}},c)}));return function(c){return l.apply(this,arguments)}}()),s.hooks.pickSync.tap(r.tag,function(l){return a.pick(u,l)})}},{key:"pick",value:function(t,n){var i=n.topmost,a=n.position,s=a.x,o=a.y,u=Ln(j6,s,o,0),l=t.elementsFromBBox(u[0],u[1],u[0],u[1]),c=[],d=ka(l),h;try{for(d.s();!(h=d.n()).done;){var f=h.value,g=f.getWorldTransform(),v=this.isHit(f,u,g,!1);if(v){var p=lO(f);if(p){var y=p.parsedStyle.clipPath,m=this.isHit(y,u,y.getWorldTransform(),!0);if(m){if(i)return n.picked=[f],n;c.push(f)}}else{if(i)return n.picked=[f],n;c.push(f)}}}}catch(w){d.e(w)}finally{d.f()}return n.picked=c,n}}])}();oA.tag="CanvasPicker";function $6(r,e,t){var n=r.parsedStyle,i=n.cx,a=i===void 0?0:i,s=n.cy,o=s===void 0?0:s,u=n.r,l=n.fill,c=n.stroke,d=n.lineWidth,h=d===void 0?1:d,f=n.increasedLineWidthForHitTesting,g=f===void 0?0:f,v=n.pointerEvents,p=v===void 0?"auto":v,y=(h+g)/2,m=Ti(a,o,e.x,e.y),w=Qa(p,l,c),M=ze(w,2),S=M[0],T=M[1];return S&&T||t?m<=u+y:S?m<=u:T?m>=u-y&&m<=u+y:!1}function ul(r,e,t,n){return r/(t*t)+e/(n*n)}function q6(r,e,t){var n=r.parsedStyle,i=n.cx,a=i===void 0?0:i,s=n.cy,o=s===void 0?0:s,u=n.rx,l=n.ry,c=n.fill,d=n.stroke,h=n.lineWidth,f=h===void 0?1:h,g=n.increasedLineWidthForHitTesting,v=g===void 0?0:g,p=n.pointerEvents,y=p===void 0?"auto":p,m=e.x,w=e.y,M=Qa(y,c,d),S=ze(M,2),T=S[0],A=S[1],O=(f+v)/2,N=(m-a)*(m-a),C=(w-o)*(w-o);return T&&A||t?ul(N,C,u+O,l+O)<=1:T?ul(N,C,u,l)<=1:A?ul(N,C,u-O,l-O)>=1&&ul(N,C,u+O,l+O)<=1:!1}function La(r,e,t,n,i,a){return i>=r&&i<=r+t&&a>=e&&a<=e+n}function G6(r,e,t,n,i,a,s){var o=i/2;return La(r-o,e-o,t,i,a,s)||La(r+t-o,e-o,i,n,a,s)||La(r+o,e+n-o,t,i,a,s)||La(r-o,e+o,i,n,a,s)}function ll(r,e,t,n,i,a,s,o){var u=(Math.atan2(o-e,s-r)+Math.PI*2)%(Math.PI*2),l={x:r+t*Math.cos(u),y:e+t*Math.sin(u)};return Ti(l.x,l.y,s,o)<=a/2}function Ji(r,e,t,n,i,a,s){var o=Math.min(r,t),u=Math.max(r,t),l=Math.min(e,n),c=Math.max(e,n),d=i/2;return a>=o-d&&a<=u+d&&s>=l-d&&s<=c+d?U3(r,e,t,n,a,s)<=i/2:!1}function uA(r,e,t,n,i){var a=r.length;if(a<2)return!1;for(var s=0;s<a-1;s++){var o=r[s][0],u=r[s][1],l=r[s+1][0],c=r[s+1][1];if(Ji(o,u,l,c,e,t,n))return!0}if(i){var d=r[0],h=r[a-1];if(Ji(d[0],d[1],h[0],h[1],e,t,n))return!0}return!1}var W6=1e-6;function Ch(r){return Math.abs(r)<W6?0:r<0?-1:1}function V6(r,e,t){return(t[0]-r[0])*(e[1]-r[1])===(e[0]-r[0])*(t[1]-r[1])&&Math.min(r[0],e[0])<=t[0]&&t[0]<=Math.max(r[0],e[0])&&Math.min(r[1],e[1])<=t[1]&&t[1]<=Math.max(r[1],e[1])}function lA(r,e,t){var n=!1,i=r.length;if(i<=2)return!1;for(var a=0;a<i;a++){var s=r[a],o=r[(a+1)%i];if(V6(s,o,[e,t]))return!0;Ch(s[1]-t)>0!=Ch(o[1]-t)>0&&Ch(e-(t-s[1])*(s[0]-o[0])/(s[1]-o[1])-s[0])<0&&(n=!n)}return n}function qb(r,e,t){for(var n=!1,i=0;i<r.length;i++){var a=r[i];if(n=lA(a,e,t),n)break}return n}function Y6(r,e,t){var n=r.parsedStyle,i=n.x1,a=n.y1,s=n.x2,o=n.y2,u=n.lineWidth,l=u===void 0?1:u,c=n.increasedLineWidthForHitTesting,d=c===void 0?0:c,h=n.pointerEvents,f=h===void 0?"auto":h,g=n.fill,v=n.stroke,p=Qa(f,g,v),y=ze(p,2),m=y[1];return!m&&!t||!l?!1:Ji(i,a,s,o,l+d,e.x,e.y)}function U6(r,e,t,n,i){for(var a=!1,s=e/2,o=0;o<r.length;o++){var u=r[o],l=u.currentPoint,c=u.params,d=u.prePoint,h=u.box;if(!(h&&!La(h.x-s,h.y-s,h.width+e,h.height+e,t,n)))switch(u.command){case"L":case"Z":if(a=Ji(d[0],d[1],l[0],l[1],e,t,n),a)return!0;break;case"Q":var f=eD(d[0],d[1],c[1],c[2],c[3],c[4],t,n);if(a=f<=e/2,a)return!0;break;case"C":var g=Q1(d[0],d[1],c[1],c[2],c[3],c[4],c[5],c[6],t,n,i);if(a=g<=e/2,a)return!0;break;case"A":u.cubicParams||(u.cubicParams=um(d[0],d[1],c[1],c[2],c[3],c[4],c[5],c[6],c[7],void 0));for(var v=u.cubicParams,p=d,y=0;y<v.length;y+=6){var m=Q1(p[0],p[1],v[y],v[y+1],v[y+2],v[y+3],v[y+4],v[y+5],t,n,i);if(p=[v[y+4],v[y+5]],a=m<=e/2,a)return!0}break}}return a}function H6(r,e,t,n,i,a){var s=r.parsedStyle,o=s.lineWidth,u=o===void 0?1:o,l=s.increasedLineWidthForHitTesting,c=l===void 0?0:l,d=s.stroke,h=s.fill,f=s.d,g=s.pointerEvents,v=g===void 0?"auto":g,p=f.segments,y=f.hasArc,m=f.polylines,w=f.polygons,M=Qa(v,(w==null?void 0:w.length)&&h,d),S=ze(M,2),T=S[0],A=S[1],O=uy(r),N=!1;return T||t?(y?N=n(r,e):N=qb(w,e.x,e.y)||qb(m,e.x,e.y),N):((A||t)&&(N=U6(p,u+c,e.x,e.y,O)),N)}function X6(r,e,t){var n=r.parsedStyle,i=n.stroke,a=n.fill,s=n.lineWidth,o=s===void 0?1:s,u=n.increasedLineWidthForHitTesting,l=u===void 0?0:u,c=n.points,d=n.pointerEvents,h=d===void 0?"auto":d,f=Qa(h,a,i),g=ze(f,2),v=g[0],p=g[1],y=!1;return(p||t)&&(y=uA(c.points,o+l,e.x,e.y,!0)),!y&&(v||t)&&(y=lA(c.points,e.x,e.y)),y}function K6(r,e,t){var n=r.parsedStyle,i=n.lineWidth,a=i===void 0?1:i,s=n.increasedLineWidthForHitTesting,o=s===void 0?0:s,u=n.points,l=n.pointerEvents,c=l===void 0?"auto":l,d=n.fill,h=n.stroke,f=Qa(c,d,h),g=ze(f,2),v=g[1];return!v&&!t||!a?!1:uA(u.points,a+o,e.x,e.y,!1)}function Z6(r,e,t,n,i){var a=r.parsedStyle,s=a.radius,o=a.fill,u=a.stroke,l=a.lineWidth,c=l===void 0?1:l,d=a.increasedLineWidthForHitTesting,h=d===void 0?0:d,f=a.x,g=f===void 0?0:f,v=a.y,p=v===void 0?0:v,y=a.width,m=a.height,w=a.pointerEvents,M=w===void 0?"auto":w,S=Qa(M,o,u),T=ze(S,2),A=T[0],O=T[1],N=s&&s.some(function(j){return j!==0}),C=c+h;if(N){var D=!1;return(O||t)&&(D=Q6(g,p,y,m,s.map(function(j){return jt(j,0,Math.min(Math.abs(y)/2,Math.abs(m)/2))}),C,e.x,e.y)),!D&&(A||t)&&(D=n(r,e)),D}else{var P=C/2;if(A&&O||t)return La(g-P,p-P,y+P,m+P,e.x,e.y);if(A)return La(g,p,y,m,e.x,e.y);if(O)return G6(g,p,y,m,C,e.x,e.y)}return!1}function Q6(r,e,t,n,i,a,s,o){var u=ze(i,4),l=u[0],c=u[1],d=u[2],h=u[3];return Ji(r+l,e,r+t-c,e,a,s,o)||Ji(r+t,e+c,r+t,e+n-d,a,s,o)||Ji(r+t-d,e+n,r+h,e+n,a,s,o)||Ji(r,e+n-h,r,e+l,a,s,o)||ll(r+t-c,e+c,c,1.5*Math.PI,2*Math.PI,a,s,o)||ll(r+t-d,e+n-d,d,0,.5*Math.PI,a,s,o)||ll(r+h,e+n-h,h,.5*Math.PI,Math.PI,a,s,o)||ll(r+l,e+l,l,Math.PI,1.5*Math.PI,a,s,o)}function J6(r,e,t,n,i,a){var s=r.parsedStyle,o=s.pointerEvents,u=o===void 0?"auto":o,l=s.x,c=l===void 0?0:l,d=s.y,h=d===void 0?0:d,f=s.width,g=s.height;if(u==="non-transparent-pixel"){var v=i.config.offscreenCanvas,p=a.offscreenCanvasCreator.getOrCreateCanvas(v),y=a.offscreenCanvasCreator.getOrCreateContext(v,{willReadFrequently:!0});p.width=f,p.height=g,i.defaultStyleRendererFactory[re.IMAGE].render(y,qe(qe({},r.parsedStyle),{},{x:0,y:0}),r,void 0,void 0,void 0);var m=y.getImageData(e.x-c,e.y-h,1,1).data;return m.every(function(w){return w!==0})}return!0}function ej(r,e,t,n){var i=r.getGeometryBounds();return e.x>=i.min[0]&&e.y>=i.min[1]&&e.x<=i.max[0]&&e.y<=i.max[1]}var tj=function(r){function e(){var t;ce(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=Ge(this,e,[].concat(i)),t.name="canvas-picker",t}return We(e,r),de(e,[{key:"init",value:function(){var n,i=(n={},Me(Me(Me(Me(Me(Me(Me(Me(Me(Me(n,re.CIRCLE,$6),re.ELLIPSE,q6),re.RECT,Z6),re.LINE,Y6),re.POLYLINE,K6),re.POLYGON,X6),re.PATH,H6),re.TEXT,ej),re.GROUP,null),re.IMAGE,J6),Me(Me(n,re.HTML,null),re.MESH,null));this.context.pointInPathPickerFactory=i,this.addRenderingPlugin(new oA)}},{key:"destroy",value:function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()}}])}(ga);function Qr(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var nj=0;function rj(r){return"__private_"+nj+++"_"+r}/*!
 * @antv/g-plugin-image-loader
 * @description A G plugin for loading image
 * @version 2.1.17
 * @date 1/17/2025, 2:07:09 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var ij=function(){function r(){ce(this,r),this.cacheStore=new Map}return de(r,[{key:"onRefAdded",value:function(t){}},{key:"has",value:function(t){return this.cacheStore.has(t)}},{key:"put",value:function(t,n,i){return this.cacheStore.has(t)?!1:(this.cacheStore.set(t,{value:n,counter:new Set([i])}),this.onRefAdded(i),!0)}},{key:"get",value:function(t,n){var i=this.cacheStore.get(t);return i?(i.counter.has(n)||(i.counter.add(n),this.onRefAdded(n)),i.value):null}},{key:"update",value:function(t,n,i){var a=this.cacheStore.get(t);return a?(a.value=qe(qe({},a.value),n),a.counter.has(i)||(a.counter.add(i),this.onRefAdded(i)),!0):!1}},{key:"release",value:function(t,n){var i=this.cacheStore.get(t);return i?(i.counter.delete(n),i.counter.size<=0&&this.cacheStore.delete(t),!0):!1}},{key:"releaseRef",value:function(t){var n=this;Array.from(this.cacheStore.keys()).forEach(function(i){n.release(i,t)})}},{key:"getSize",value:function(){return this.cacheStore.size}},{key:"clear",value:function(){this.cacheStore.clear()}}])}(),Ph=[],Lh=[],wy=function(){function r(){ce(this,r)}return de(r,null,[{key:"stop",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:r.api;r.rafId&&(t.cancelAnimationFrame(r.rafId),r.rafId=null)}},{key:"executeTask",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:r.api;Ph.length<=0&&Lh.length<=0||(Lh.forEach(function(n){return n()}),Lh=Ph.splice(0,r.TASK_NUM_PER_FRAME),r.rafId=t.requestAnimationFrame(function(){r.executeTask(t)}))}},{key:"sliceImage",value:function(t,n,i,a){for(var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:r.api,u=t.naturalWidth||t.width,l=t.naturalHeight||t.height,c=n-s,d=i-s,h=Math.ceil(u/c),f=Math.ceil(l/d),g={tileSize:[n,i],gridSize:[f,h],tiles:Array(f).fill(null).map(function(){return Array(h).fill(null)})},v=function(m){for(var w=function(T){Ph.push(function(){var A=T*c,O=m*d,N=[Math.min(n,u-A),Math.min(i,l-O)],C=N[0],P=N[1],D=o.createCanvas();D.width=n,D.height=i;var j=D.getContext("2d");j.drawImage(t,A,O,C,P,0,0,C,P),g.tiles[m][T]={x:A,y:O,tileX:T,tileY:m,data:D},a()})},M=0;M<h;M++)w(M)},p=0;p<f;p++)v(p);return r.stop(),r.executeTask(),g}}])}();wy.TASK_NUM_PER_FRAME=10;var ir=new ij;ir.onRefAdded=function(e){var t=this;e.addEventListener(He.DESTROY,function(){t.releaseRef(e)},{once:!0})};var Pm=function(){function r(e,t){ce(this,r),this.gradientCache={},this.patternCache={},this.context=e,this.runtime=t}return de(r,[{key:"getImageSync",value:function(t,n,i){var a=tt(t)?t:t.src;if(ir.has(a)){var s=ir.get(a,n);if(s.img.complete)return i==null||i(s),s}return this.getOrCreateImage(t,n).then(function(o){i==null||i(o)}).catch(function(){}),null}},{key:"getOrCreateImage",value:function(t,n){var i=this,a=tt(t)?t:t.src;if(!tt(t)&&!ir.has(a)){var s={img:t,size:[t.naturalWidth||t.width,t.naturalHeight||t.height],tileSize:cl(t)};ir.put(a,s,n)}if(ir.has(a)){var o=ir.get(a,n);return o.img.complete?Promise.resolve(o):new Promise(function(u,l){o.img.addEventListener("load",function(){o.size=[o.img.naturalWidth||o.img.width,o.img.naturalHeight||o.img.height],o.tileSize=cl(o.img),u(o)}),o.img.addEventListener("error",function(c){l(c)})})}return new Promise(function(u,l){var c=i.context.config.createImage();if(c){var d={img:c,size:[0,0],tileSize:cl(c)};ir.put(a,d,n),c.onload=function(){d.size=[c.naturalWidth||c.width,c.naturalHeight||c.height],d.tileSize=cl(d.img),u(d)},c.onerror=function(h){l(h)},c.crossOrigin="Anonymous",c.src=a}})}},{key:"createDownSampledImage",value:function(){var e=da(Mn().mark(function n(i,a){var s,o,u,l,c,d,h,f,g,v,p,y,m,w;return Mn().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,this.getOrCreateImage(i,a);case 2:if(s=S.sent,!(typeof s.downSamplingRate<"u")){S.next=5;break}return S.abrupt("return",s);case 5:if(o=this.context.config.enableLargeImageOptimization,u=typeof o=="boolean"?{}:o,l=u.maxDownSampledImageSize,c=l===void 0?2048:l,d=u.downSamplingRateThreshold,h=d===void 0?.5:d,f=this.runtime.globalThis.createImageBitmap,g=ze(s.size,2),v=g[0],p=g[1],y=s.img,m=Math.min((c+c)/(v+p),Math.max(.01,Math.min(h,.5))),w=qe(qe({},s),{},{downSamplingRate:m}),ir.update(s.img.src,w,a),!f){S.next=25;break}return S.prev=14,S.next=17,f(s.img,{resizeWidth:v*m,resizeHeight:p*m});case 17:y=S.sent,S.next=23;break;case 20:S.prev=20,S.t0=S.catch(14),m=1;case 23:S.next=26;break;case 25:m=1;case 26:return w=qe(qe({},this.getImageSync(i,a)),{},{downSampled:y,downSamplingRate:m}),ir.update(s.img.src,w,a),S.abrupt("return",w);case 29:case"end":return S.stop()}},n,this,[[14,20]])}));function t(n,i){return e.apply(this,arguments)}return t}()},{key:"createImageTiles",value:function(){var e=da(Mn().mark(function n(i,a,s,o){var u,l,c,d,h;return Mn().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.getOrCreateImage(i,o);case 2:return u=g.sent,l=o.ownerDocument.defaultView,c=l.requestAnimationFrame,d=l.cancelAnimationFrame,wy.api={requestAnimationFrame:c,cancelAnimationFrame:d,createCanvas:function(){return vm.createCanvas()}},h=qe(qe({},u),wy.sliceImage(u.img,u.tileSize[0],u.tileSize[0],s)),ir.update(u.img.src,h,o),g.abrupt("return",h);case 8:case"end":return g.stop()}},n,this)}));function t(n,i,a,s){return e.apply(this,arguments)}return t}()},{key:"releaseImage",value:function(t,n){ir.release(tt(t)?t:t.src,n)}},{key:"releaseImageRef",value:function(t){ir.releaseRef(t)}},{key:"getOrCreatePatternSync",value:function(t,n,i,a,s,o,u){var l=this.generatePatternKey(n);if(l&&this.patternCache[l])return this.patternCache[l];var c=n.image,d=n.repetition,h=n.transform,f,g=!1;if(tt(c)){var v=this.getImageSync(c,t,u);f=v==null?void 0:v.img}else a?(f=a,g=!0):f=c;var p=f&&i.createPattern(f,d);if(p){var y;h?y=gO(aO(h),new mt({})):y=ua(ht()),g&&uT(y,y,[1/s,1/s,1]),p.setTransform({a:y[0],b:y[1],c:y[4],d:y[5],e:y[12]+o[0],f:y[13]+o[1]})}return l&&p&&(this.patternCache[l]=p),p}},{key:"getOrCreateGradient",value:function(t,n){var i=this.generateGradientKey(t),a=t.type,s=t.steps,o=t.min,u=t.width,l=t.height,c=t.angle,d=t.cx,h=t.cy,f=t.size;if(this.gradientCache[i])return this.gradientCache[i];var g=null;if(a===Ki.LinearGradient){var v=RD(o,u,l,c),p=v.x1,y=v.y1,m=v.x2,w=v.y2;g=n.createLinearGradient(p,y,m,w)}else if(a===Ki.RadialGradient){var M=jD(o,u,l,d,h,f),S=M.x,T=M.y,A=M.r;g=n.createRadialGradient(S,T,0,S,T,A)}return g&&(s.forEach(function(O){var N=O.offset,C=O.color;if(N.unit===we.kPercentage){var P;(P=g)===null||P===void 0||P.addColorStop(N.value/100,C.toString())}}),this.gradientCache[i]=g),this.gradientCache[i]}},{key:"generateGradientKey",value:function(t){var n=t.type,i=t.min,a=t.width,s=t.height,o=t.steps,u=t.angle,l=t.cx,c=t.cy,d=t.size;return"gradient-".concat(n,"-").concat((u==null?void 0:u.toString())||0,"-").concat((l==null?void 0:l.toString())||0,"-").concat((c==null?void 0:c.toString())||0,"-").concat((d==null?void 0:d.toString())||0,"-").concat(i[0],"-").concat(i[1],"-").concat(a,"-").concat(s,"-").concat(o.map(function(h){var f=h.offset,g=h.color;return"".concat(f).concat(g)}).join("-"))}},{key:"generatePatternKey",value:function(t){var n=t.image,i=t.repetition;if(tt(n))return"pattern-".concat(n,"-").concat(i);if(n.nodeName==="rect")return"pattern-".concat(n.entity,"-").concat(i)}}])}();Pm.isSupportTile=!!vm.createCanvas();function cl(r){if(!r.complete)return[0,0];var e=r.naturalWidth||r.width,t=r.naturalHeight||r.height,n=256;return[256,512].forEach(function(i){var a=Math.ceil(t/i),s=Math.ceil(e/i);a*s<1e3&&(n=i)}),[n,n]}var cA=function(){function r(){ce(this,r)}return de(r,[{key:"apply",value:function(t){var n=t.renderingService,i=t.renderingContext,a=t.imagePool,s=i.root.ownerDocument.defaultView,o=function(d,h,f){var g=d.parsedStyle,v=g.width,p=g.height;v&&!p?d.setAttribute("height",f/h*v):!v&&p&&d.setAttribute("width",h/f*p)},u=function(d){var h=d.target,f=h.nodeName,g=h.attributes;if(f===re.IMAGE){var v=g.src,p=g.keepAspectRatio;a.getImageSync(v,h,function(y){var m=y.img,w=m.width,M=m.height;p&&o(h,w,M),h.renderable.dirty=!0,n.dirtify()})}},l=function(d){var h=d.target,f=d.attrName,g=d.prevValue,v=d.newValue;h.nodeName!==re.IMAGE||f!=="src"||(g!==v&&a.releaseImage(g,h),tt(v)&&a.getOrCreateImage(v,h).then(function(p){var y=p.img,m=y.width,w=y.height;h.attributes.keepAspectRatio&&o(h,m,w),h.renderable.dirty=!0,n.dirtify()}).catch(function(){}))};n.hooks.init.tap(r.tag,function(){s.addEventListener(He.MOUNTED,u),s.addEventListener(He.ATTR_MODIFIED,l)}),n.hooks.destroy.tap(r.tag,function(){s.removeEventListener(He.MOUNTED,u),s.removeEventListener(He.ATTR_MODIFIED,l)})}}])}();cA.tag="LoadImage";var aj=function(r){function e(){var t;ce(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=Ge(this,e,[].concat(i)),t.name="image-loader",t}return We(e,r),de(e,[{key:"init",value:function(n){this.context.imagePool=new Pm(this.context,n),this.addRenderingPlugin(new cA)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(ga);/*!
 * @antv/g-plugin-canvas-renderer
 * @description A G plugin of renderer implementation with Canvas2D API
 * @version 2.2.17
 * @date 1/17/2025, 2:07:56 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var Gt=rj("renderState"),dA=function(){function r(e){ce(this,r),this.removedRBushNodeAABBs=[],this.renderQueue=[],Object.defineProperty(this,Gt,{writable:!0,value:{restoreStack:[],prevObject:null,currentContext:new Map}}),this.clearFullScreenLastFrame=!1,this.clearFullScreen=!1,this.vpMatrix=ht(),this.dprMatrix=ht(),this.tmpMat4=ht(),this.vec3a=Ze(),this.vec3b=Ze(),this.vec3c=Ze(),this.vec3d=Ze(),this.canvasRendererPluginOptions=e}return de(r,[{key:"apply",value:function(t,n){var i=this;this.context=t;var a=this.context,s=a.config,o=a.camera,u=a.renderingService,l=a.renderingContext,c=a.rBushRoot,d=a.pathGeneratorFactory,h=s.renderer.getConfig().enableRenderingOptimization;s.renderer.getConfig().enableDirtyCheck=!1,s.renderer.getConfig().enableDirtyRectangleRendering=!1,this.rBush=c,this.pathGeneratorFactory=d;var f=t.contextService,g=l.root.ownerDocument.defaultView,v=function(w){var M=w.target,S=M.rBushNode;S.aabb&&i.removedRBushNodeAABBs.push(S.aabb)},p=function(w){var M=w.target,S=M.rBushNode;S.aabb&&i.removedRBushNodeAABBs.push(S.aabb)};u.hooks.init.tap(r.tag,function(){g.addEventListener(He.UNMOUNTED,v),g.addEventListener(He.CULLED,p);var m=f.getDPR(),w=s.width,M=s.height,S=f.getContext();i.clearRect(S,0,0,w*m,M*m,s.background)}),u.hooks.destroy.tap(r.tag,function(){g.removeEventListener(He.UNMOUNTED,v),g.removeEventListener(He.CULLED,p),i.renderQueue=[],i.removedRBushNodeAABBs=[],Qr(i,Gt)[Gt]={restoreStack:[],prevObject:null,currentContext:null}}),u.hooks.beginFrame.tap(r.tag,function(){var m,w=f.getContext(),M=f.getDPR(),S=s.width,T=s.height,A=i.canvasRendererPluginOptions,O=A.dirtyObjectNumThreshold,N=A.dirtyObjectRatioThreshold,C=u.getStats(),P=C.total,D=C.rendered,j=D/P;i.clearFullScreen=i.clearFullScreenLastFrame||!((m=g.context.renderingPlugins[1])!==null&&m!==void 0&&m.isFirstTimeRenderingFinished)||u.disableDirtyRectangleRendering()||D>O&&j>N,w&&(typeof w.resetTransform=="function"?w.resetTransform():w.setTransform(1,0,0,1,0,0),i.clearFullScreen&&i.clearRect(w,0,0,S*M,T*M,s.background))});var y=function(w,M){for(var S=[w];S.length>0;){var T=S.pop();T.isVisible()&&!T.isCulled()&&(h?i.renderDisplayObjectOptimized(T,M,i.context,Qr(i,Gt)[Gt],n):i.renderDisplayObject(T,M,i.context,Qr(i,Gt)[Gt],n));for(var A=T.sortable.sorted||T.childNodes,O=A.length-1;O>=0;O--)S.push(A[O])}};u.hooks.endFrame.tap(r.tag,function(){if(l.root.childNodes.length===0){i.clearFullScreenLastFrame=!0;return}h=s.renderer.getConfig().enableRenderingOptimization,Qr(i,Gt)[Gt]={restoreStack:[],prevObject:null,currentContext:Qr(i,Gt)[Gt].currentContext},Qr(i,Gt)[Gt].currentContext.clear(),i.clearFullScreenLastFrame=!1;var m=f.getContext(),w=f.getDPR();if(Aa(i.dprMatrix,[w,w,1]),Dn(i.vpMatrix,i.dprMatrix,o.getOrthoMatrix()),i.clearFullScreen)h?(m.save(),y(l.root,m),m.restore()):y(l.root,m),i.removedRBushNodeAABBs=[];else{var M=i.safeMergeAABB.apply(i,[i.mergeDirtyAABBs(i.renderQueue)].concat(pt(i.removedRBushNodeAABBs.map(function(W){var ee=W.minX,le=W.minY,xe=W.maxX,Ce=W.maxY,Ve=new ft;return Ve.setMinMax([ee,le,0],[xe,Ce,0]),Ve}))));if(i.removedRBushNodeAABBs=[],ft.isEmpty(M)){i.renderQueue=[];return}var S=i.convertAABB2Rect(M),T=S.x,A=S.y,O=S.width,N=S.height,C=In(i.vec3a,[T,A,0],i.vpMatrix),P=In(i.vec3b,[T+O,A,0],i.vpMatrix),D=In(i.vec3c,[T,A+N,0],i.vpMatrix),j=In(i.vec3d,[T+O,A+N,0],i.vpMatrix),G=Math.min(C[0],P[0],j[0],D[0]),V=Math.min(C[1],P[1],j[1],D[1]),Y=Math.max(C[0],P[0],j[0],D[0]),$=Math.max(C[1],P[1],j[1],D[1]),z=Math.floor(G),Z=Math.floor(V),ne=Math.ceil(Y-G),se=Math.ceil($-V);m.save(),i.clearRect(m,z,Z,ne,se,s.background),m.beginPath(),m.rect(z,Z,ne,se),m.clip(),m.setTransform(i.vpMatrix[0],i.vpMatrix[1],i.vpMatrix[4],i.vpMatrix[5],i.vpMatrix[12],i.vpMatrix[13]);var oe=s.renderer.getConfig(),Ne=oe.enableDirtyRectangleRenderingDebug;Ne&&g.dispatchEvent(new Kt(or.DIRTY_RECTANGLE,{dirtyRect:{x:z,y:Z,width:ne,height:se}}));var K=i.searchDirtyObjects(M);K.sort(function(W,ee){return W.sortable.renderOrder-ee.sortable.renderOrder}).forEach(function(W){W&&W.isVisible()&&!W.isCulled()&&i.renderDisplayObject(W,m,i.context,Qr(i,Gt)[Gt],n)}),m.restore(),i.renderQueue.forEach(function(W){i.saveDirtyAABB(W)}),i.renderQueue=[]}Qr(i,Gt)[Gt].restoreStack.forEach(function(){m.restore()}),Qr(i,Gt)[Gt].restoreStack=[]}),u.hooks.render.tap(r.tag,function(m){i.clearFullScreen||i.renderQueue.push(m)})}},{key:"clearRect",value:function(t,n,i,a,s,o){t.clearRect(n,i,a,s),o&&(t.fillStyle=o,t.fillRect(n,i,a,s))}},{key:"renderDisplayObjectOptimized",value:function(t,n,i,a,s){var o=t.nodeName,u=!1,l=!1,c=this.context.styleRendererFactory[o],d=this.pathGeneratorFactory[o],h=t.parsedStyle.clipPath;if(h){u=!a.prevObject||!V0(h.getWorldTransform(),a.prevObject.getWorldTransform()),u&&(this.applyWorldTransform(n,h),a.prevObject=null);var f=this.pathGeneratorFactory[h.nodeName];f&&(n.save(),l=!0,n.beginPath(),f(n,h.parsedStyle),n.closePath(),n.clip())}if(c){u=!a.prevObject||!V0(t.getWorldTransform(),a.prevObject.getWorldTransform()),u&&this.applyWorldTransform(n,t);var g=!a.prevObject;if(!g){var v=a.prevObject.nodeName;o===re.TEXT?g=v!==re.TEXT:o===re.IMAGE?g=v!==re.IMAGE:g=v===re.TEXT||v===re.IMAGE}c.applyStyleToContext(n,t,g,a),a.prevObject=t}d&&(n.beginPath(),d(n,t.parsedStyle),o!==re.LINE&&o!==re.PATH&&o!==re.POLYLINE&&n.closePath()),c&&c.drawToContext(n,t,Qr(this,Gt)[Gt],this,s),l&&n.restore(),t.renderable.dirty=!1}},{key:"renderDisplayObject",value:function(t,n,i,a,s){var o=t.nodeName,u=a.restoreStack[a.restoreStack.length-1];u&&!(t.compareDocumentPosition(u)&Ct.DOCUMENT_POSITION_CONTAINS)&&(n.restore(),a.restoreStack.pop());var l=this.context.styleRendererFactory[o],c=this.pathGeneratorFactory[o],d=t.parsedStyle.clipPath;if(d){this.applyWorldTransform(n,d);var h=this.pathGeneratorFactory[d.nodeName];h&&(n.save(),a.restoreStack.push(t),n.beginPath(),h(n,d.parsedStyle),n.closePath(),n.clip())}l&&(this.applyWorldTransform(n,t),n.save(),this.applyAttributesToContext(n,t)),c&&(n.beginPath(),c(n,t.parsedStyle),o!==re.LINE&&o!==re.PATH&&o!==re.POLYLINE&&n.closePath()),l&&(l.render(n,t.parsedStyle,t,i,this,s),n.restore()),t.renderable.dirty=!1}},{key:"applyAttributesToContext",value:function(t,n){var i=n.parsedStyle,a=i.stroke,s=i.fill,o=i.opacity,u=i.lineDash,l=i.lineDashOffset;u&&t.setLineDash(u),Le(l)||(t.lineDashOffset=l),Le(o)||(t.globalAlpha*=o),!Le(a)&&!Array.isArray(a)&&!a.isNone&&(t.strokeStyle=n.attributes.stroke),!Le(s)&&!Array.isArray(s)&&!s.isNone&&(t.fillStyle=n.attributes.fill)}},{key:"convertAABB2Rect",value:function(t){var n=t.getMin(),i=t.getMax(),a=Math.floor(n[0]),s=Math.floor(n[1]),o=Math.ceil(i[0]),u=Math.ceil(i[1]),l=o-a,c=u-s;return{x:a,y:s,width:l,height:c}}},{key:"mergeDirtyAABBs",value:function(t){var n=new ft;return t.forEach(function(i){var a=i.getRenderBounds();n.add(a);var s=i.renderable.dirtyRenderBounds;s&&n.add(s)}),n}},{key:"searchDirtyObjects",value:function(t){var n=t.getMin(),i=ze(n,2),a=i[0],s=i[1],o=t.getMax(),u=ze(o,2),l=u[0],c=u[1],d=this.rBush.search({minX:a,minY:s,maxX:l,maxY:c});return d.map(function(h){var f=h.displayObject;return f})}},{key:"saveDirtyAABB",value:function(t){var n=t.renderable;n.dirtyRenderBounds||(n.dirtyRenderBounds=new ft);var i=t.getRenderBounds();i&&n.dirtyRenderBounds.update(i.center,i.halfExtents)}},{key:"applyWorldTransform",value:function(t,n,i){i?(Is(this.tmpMat4,n.getLocalTransform()),Dn(this.tmpMat4,i,this.tmpMat4),Dn(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(Is(this.tmpMat4,n.getWorldTransform()),Dn(this.tmpMat4,this.vpMatrix,this.tmpMat4)),t.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])}},{key:"safeMergeAABB",value:function(){for(var t=new ft,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return i.forEach(function(s){t.add(s)}),t}}])}();dA.tag="CanvasRenderer";function uc(r,e,t,n,i,a,s){var o,u;if(r.image.nodeName==="rect"){var l=r.image.parsedStyle,c=l.width,d=l.height;u=n.contextService.getDPR();var h=n.config.offscreenCanvas;o=a.offscreenCanvasCreator.getOrCreateCanvas(h),o.width=c*u,o.height=d*u;var f=a.offscreenCanvasCreator.getOrCreateContext(h),g={restoreStack:[],prevObject:null,currentContext:new Map};r.image.forEach(function(p){i.renderDisplayObject(p,f,n,g,a)}),g.restoreStack.forEach(function(){f.restore()})}var v=s.getOrCreatePatternSync(e,r,t,o,u,e.getGeometryBounds().min,function(){e.renderable.dirty=!0,n.renderingService.dirtify()});return v}function lc(r,e,t,n){var i;if(r.type===Ki.LinearGradient||r.type===Ki.RadialGradient){var a=e.getGeometryBounds(),s=a&&a.halfExtents[0]*2||1,o=a&&a.halfExtents[1]*2||1,u=a&&a.min||[0,0];i=n.getOrCreateGradient(qe(qe({type:r.type},r.value),{},{min:u,width:s,height:o}),t)}return i}var dl=["shadowBlur","shadowOffsetX","shadowOffsetY"],Gb=["lineCap","lineJoin","miterLimit"],Ht={globalAlpha:1,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",filter:"none",globalCompositeOperation:"source-over",strokeStyle:"#000",strokeOpacity:1,lineWidth:1,lineDash:[],lineDashOffset:0,lineCap:"butt",lineJoin:"miter",miterLimit:10,fillStyle:"#000",fillOpacity:1},Wb={};function Dt(r,e,t,n){var i=n.has(e)?n.get(e):Ht[e];return i!==t&&(e==="lineDash"?r.setLineDash(t):r[e]=t,n.set(e,t)),i}var sj=function(){function r(e){ce(this,r),this.imagePool=e}return de(r,[{key:"applyAttributesToContext",value:function(t,n){}},{key:"render",value:function(t,n,i,a,s,o){}},{key:"applyCommonStyleToContext",value:function(t,n,i,a){var s=i?Wb:a.prevObject.parsedStyle,o=n.parsedStyle;(i||o.opacity!==s.opacity)&&Dt(t,"globalAlpha",Le(o.opacity)?Ht.globalAlpha:o.opacity,a.currentContext),(i||o.blend!==s.blend)&&Dt(t,"globalCompositeOperation",Le(o.blend)?Ht.globalCompositeOperation:o.blend,a.currentContext)}},{key:"applyStrokeFillStyleToContext",value:function(t,n,i,a){var s=i?Wb:a.prevObject.parsedStyle,o=n.parsedStyle,u=o.lineWidth,l=u===void 0?Ht.lineWidth:u,c=o.fill&&!o.fill.isNone,d=o.stroke&&!o.stroke.isNone&&l>0;if(d){if(i||n.attributes.stroke!==a.prevObject.attributes.stroke){var h=!Le(o.stroke)&&!Array.isArray(o.stroke)&&!o.stroke.isNone?n.attributes.stroke:Ht.strokeStyle;Dt(t,"strokeStyle",h,a.currentContext)}(i||o.lineWidth!==s.lineWidth)&&Dt(t,"lineWidth",Le(o.lineWidth)?Ht.lineWidth:o.lineWidth,a.currentContext),(i||o.lineDash!==s.lineDash)&&Dt(t,"lineDash",o.lineDash||Ht.lineDash,a.currentContext),(i||o.lineDashOffset!==s.lineDashOffset)&&Dt(t,"lineDashOffset",Le(o.lineDashOffset)?Ht.lineDashOffset:o.lineDashOffset,a.currentContext);for(var f=0;f<Gb.length;f++){var g=Gb[f];(i||o[g]!==s[g])&&Dt(t,g,Le(o[g])?Ht[g]:o[g],a.currentContext)}}if(c&&(i||n.attributes.fill!==a.prevObject.attributes.fill)){var v=!Le(o.fill)&&!Array.isArray(o.fill)&&!o.fill.isNone?n.attributes.fill:Ht.fillStyle;Dt(t,"fillStyle",v,a.currentContext)}}},{key:"applyStyleToContext",value:function(t,n,i,a){var s=n.nodeName;this.applyCommonStyleToContext(t,n,i,a),s===re.IMAGE||this.applyStrokeFillStyleToContext(t,n,i,a)}},{key:"applyShadowAndFilterStyleToContext",value:function(t,n,i,a){var s=n.parsedStyle;if(i){Dt(t,"shadowColor",s.shadowColor.toString(),a.currentContext);for(var o=0;o<dl.length;o++){var u=dl[o];Dt(t,u,s[u]||Ht[u],a.currentContext)}}s.filter&&s.filter.length&&Dt(t,"filter",n.attributes.filter,a.currentContext)}},{key:"clearShadowAndFilterStyleForContext",value:function(t,n,i,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(n){Dt(t,"shadowColor",Ht.shadowColor,a.currentContext);for(var o=0;o<dl.length;o++){var u=dl[o];Dt(t,u,Ht[u],a.currentContext)}}if(i)if(n&&s){var l=t.filter;!Le(l)&&l.indexOf("drop-shadow")>-1&&Dt(t,"filter",l.replace(/drop-shadow\([^)]*\)/,"").trim()||Ht.filter,a.currentContext)}else Dt(t,"filter",Ht.filter,a.currentContext)}},{key:"fillToContext",value:function(t,n,i,a,s){var o=this,u=n.parsedStyle,l=u.fill,c=u.fillRule,d=null;if(Array.isArray(l)&&l.length>0)l.forEach(function(f){var g=Dt(t,"fillStyle",lc(f,n,t,o.imagePool),i.currentContext);d=d??g,c?t.fill(c):t.fill()});else{if(Ga(l)){var h=uc(l,n,t,n.ownerDocument.defaultView.context,a,s,this.imagePool);h&&(t.fillStyle=h,d=!0)}c?t.fill(c):t.fill()}d!==null&&Dt(t,"fillStyle",d,i.currentContext)}},{key:"strokeToContext",value:function(t,n,i,a,s){var o=this,u=n.parsedStyle.stroke,l=null;if(Array.isArray(u)&&u.length>0)u.forEach(function(h){var f=Dt(t,"strokeStyle",lc(h,n,t,o.imagePool),i.currentContext);l=l??f,t.stroke()});else{if(Ga(u)){var c=uc(u,n,t,n.ownerDocument.defaultView.context,a,s,this.imagePool);if(c){var d=Dt(t,"strokeStyle",c,i.currentContext);l=l??d}}t.stroke()}l!==null&&Dt(t,"strokeStyle",l,i.currentContext)}},{key:"drawToContext",value:function(t,n,i,a,s){var o,u=n.nodeName,l=n.parsedStyle,c=l.opacity,d=c===void 0?Ht.globalAlpha:c,h=l.fillOpacity,f=h===void 0?Ht.fillOpacity:h,g=l.strokeOpacity,v=g===void 0?Ht.strokeOpacity:g,p=l.lineWidth,y=p===void 0?Ht.lineWidth:p,m=l.fill&&!l.fill.isNone,w=l.stroke&&!l.stroke.isNone&&y>0;if(!(!m&&!w)){var M=!Le(l.shadowColor)&&l.shadowBlur>0,S=l.shadowType==="inner",T=((o=l.fill)===null||o===void 0?void 0:o.alpha)===0,A=!!(l.filter&&l.filter.length),O=M&&w&&(u===re.PATH||u===re.LINE||u===re.POLYLINE||T||S),N=null;if(m){O||this.applyShadowAndFilterStyleToContext(t,n,M,i);var C=d*f;N=Dt(t,"globalAlpha",C,i.currentContext),this.fillToContext(t,n,i,a,s),O||this.clearShadowAndFilterStyleForContext(t,M,A,i)}if(w){var P=!1,D=d*v,j=Dt(t,"globalAlpha",D,i.currentContext);if(N=m?N:j,O&&(this.applyShadowAndFilterStyleToContext(t,n,M,i),P=!0,S)){var G=t.globalCompositeOperation;t.globalCompositeOperation="source-atop",this.strokeToContext(t,n,i,a,s),t.globalCompositeOperation=G,this.clearShadowAndFilterStyleForContext(t,M,A,i,!0)}this.strokeToContext(t,n,i,a,s),P&&this.clearShadowAndFilterStyleForContext(t,M,A,i)}N!==null&&Dt(t,"globalAlpha",N,i.currentContext)}}}])}(),Lm=function(r){function e(){return ce(this,e),Ge(this,e,arguments)}return We(e,r),de(e,[{key:"render",value:function(n,i,a,s,o,u){var l=i.fill,c=i.fillRule,d=i.opacity,h=d===void 0?1:d,f=i.fillOpacity,g=f===void 0?1:f,v=i.stroke,p=i.strokeOpacity,y=p===void 0?1:p,m=i.lineWidth,w=m===void 0?1:m,M=i.lineCap,S=i.lineJoin,T=i.shadowType,A=i.shadowColor,O=i.shadowBlur,N=i.filter,C=i.miterLimit,P=l&&!l.isNone,D=v&&!v.isNone&&w>0,j=(l==null?void 0:l.alpha)===0,G=!!(N&&N.length),V=!Le(A)&&O>0,Y=a.nodeName,$=T==="inner",z=D&&V&&(Y===re.PATH||Y===re.LINE||Y===re.POLYLINE||j||$);P&&(n.globalAlpha=h*g,z||cc(a,n,V),hA(n,a,l,c,s,o,u,this.imagePool),z||this.clearShadowAndFilter(n,G,V)),D&&(n.globalAlpha=h*y,n.lineWidth=w,Le(C)||(n.miterLimit=C),Le(M)||(n.lineCap=M),Le(S)||(n.lineJoin=S),z&&($&&(n.globalCompositeOperation="source-atop"),cc(a,n,!0),$&&(xy(n,a,v,s,o,u,this.imagePool),n.globalCompositeOperation=Ht.globalCompositeOperation,this.clearShadowAndFilter(n,G,!0))),xy(n,a,v,s,o,u,this.imagePool))}},{key:"clearShadowAndFilter",value:function(n,i,a){if(a&&(n.shadowColor="transparent",n.shadowBlur=0),i){var s=n.filter;!Le(s)&&s.indexOf("drop-shadow")>-1&&(n.filter=s.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}}}])}(sj);function cc(r,e,t){var n=r.parsedStyle,i=n.filter,a=n.shadowColor,s=n.shadowBlur,o=n.shadowOffsetX,u=n.shadowOffsetY;i&&i.length&&(e.filter=r.style.filter),t&&(e.shadowColor=a.toString(),e.shadowBlur=s||0,e.shadowOffsetX=o||0,e.shadowOffsetY=u||0)}function hA(r,e,t,n,i,a,s,o){var u=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1;Array.isArray(t)?t.forEach(function(l){r.fillStyle=lc(l,e,r,o),u||(n?r.fill(n):r.fill())}):(Ga(t)&&(r.fillStyle=uc(t,e,r,i,a,s,o)),u||(n?r.fill(n):r.fill()))}function xy(r,e,t,n,i,a,s){var o=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1;Array.isArray(t)?t.forEach(function(u){r.strokeStyle=lc(u,e,r,s),o||r.stroke()}):(Ga(t)&&(r.strokeStyle=uc(t,e,r,n,i,a,s)),o||r.stroke())}function oj(r,e){var t=ze(r,4),n=t[0],i=t[1],a=t[2],s=t[3],o=ze(e,4),u=o[0],l=o[1],c=o[2],d=o[3],h=Math.max(n,u),f=Math.max(i,l),g=Math.min(n+a,u+c),v=Math.min(i+s,l+d);return g<=h||v<=f?null:[h,f,g-h,v-f]}function uj(r,e){var t=In(Ze(),[r[0],r[1],0],e),n=In(Ze(),[r[0]+r[2],r[1],0],e),i=In(Ze(),[r[0],r[1]+r[3],0],e),a=In(Ze(),[r[0]+r[2],r[1]+r[3],0],e);return[Math.min(t[0],n[0],i[0],a[0]),Math.min(t[1],n[1],i[1],a[1]),Math.max(t[0],n[0],i[0],a[0])-Math.min(t[0],n[0],i[0],a[0]),Math.max(t[1],n[1],i[1],a[1])-Math.min(t[1],n[1],i[1],a[1])]}var lj=function(r){function e(){return ce(this,e),Ge(this,e,arguments)}return We(e,r),de(e,[{key:"renderDownSampled",value:function(n,i,a,s){var o=s.src,u=s.imageCache;if(!u.downSampled){this.imagePool.createDownSampledImage(o,a).then(function(l){a.renderable.dirty=!0,a.ownerDocument.defaultView.context.renderingService.dirtify()}).catch(function(){});return}n.drawImage(u.downSampled,Math.floor(s.drawRect[0]),Math.floor(s.drawRect[1]),Math.ceil(s.drawRect[2]),Math.ceil(s.drawRect[3]))}},{key:"renderTile",value:function(n,i,a,s){var o=s.src,u=s.imageCache,l=s.imageRect,c=s.drawRect,d=u.size,h=n.getTransform(),f=h.a,g=h.b,v=h.c,p=h.d,y=h.e,m=h.f;if(n.resetTransform(),!(u!=null&&u.gridSize)){this.imagePool.createImageTiles(o,[],function(){a.renderable.dirty=!0,a.ownerDocument.defaultView.context.renderingService.dirtify()},a).catch(function(){});return}for(var w=[d[0]/l[2],d[1]/l[3]],M=[u.tileSize[0]/w[0],u.tileSize[1]/w[1]],S=[Math.floor((c[0]-l[0])/M[0]),Math.ceil((c[0]+c[2]-l[0])/M[0])],T=S[0],A=S[1],O=[Math.floor((c[1]-l[1])/M[1]),Math.ceil((c[1]+c[3]-l[1])/M[1])],N=O[0],C=O[1],P=N;P<=C;P++)for(var D=T;D<=A;D++){var j=u.tiles[P][D];if(j){var G=[Math.floor(l[0]+j.tileX*M[0]),Math.floor(l[1]+j.tileY*M[1]),Math.ceil(M[0]),Math.ceil(M[1])];n.drawImage(j.data,G[0],G[1],G[2],G[3])}}n.setTransform(f,g,v,p,y,m)}},{key:"render",value:function(n,i,a){var s=i.x,o=s===void 0?0:s,u=i.y,l=u===void 0?0:u,c=i.width,d=i.height,h=i.src,f=i.shadowColor,g=i.shadowBlur,v=this.imagePool.getImageSync(h,a),p=v==null?void 0:v.img,y=c,m=d;if(p){y||(y=p.width),m||(m=p.height);var w=!Le(f)&&g>0;cc(a,n,w);try{var M=a.ownerDocument.defaultView.getContextService().getDomElement(),S=M.width,T=M.height,A=n.getTransform(),O=A.a,N=A.b,C=A.c,P=A.d,D=A.e,j=A.f,G=aT(O,C,0,0,N,P,0,0,0,0,1,0,D,j,0,1),V=uj([o,l,y,m],G),Y=oj([0,0,S,T],V);if(!Y)return;if(!a.ownerDocument.defaultView.getConfig().enableLargeImageOptimization){e.renderFull(n,i,a,{image:p,drawRect:[o,l,y,m]});return}var $=V[2]/v.size[0];if($<(v.downSamplingRate||.5)){this.renderDownSampled(n,i,a,{src:h,imageCache:v,drawRect:[o,l,y,m]});return}if(!Pm.isSupportTile){e.renderFull(n,i,a,{image:p,drawRect:[o,l,y,m]});return}this.renderTile(n,i,a,{src:h,imageCache:v,imageRect:V,drawRect:Y})}catch{}}}},{key:"drawToContext",value:function(n,i,a,s,o){this.render(n,i.parsedStyle,i)}}],[{key:"renderFull",value:function(n,i,a,s){n.drawImage(s.image,Math.floor(s.drawRect[0]),Math.floor(s.drawRect[1]),Math.ceil(s.drawRect[2]),Math.ceil(s.drawRect[3]))}}])}(Lm),cj=function(r){function e(){return ce(this,e),Ge(this,e,arguments)}return We(e,r),de(e,[{key:"render",value:function(n,i,a,s,o,u){a.getBounds();var l=i.lineWidth,c=l===void 0?1:l,d=i.textAlign,h=d===void 0?"start":d,f=i.textBaseline,g=f===void 0?"alphabetic":f,v=i.lineJoin,p=v===void 0?"miter":v,y=i.miterLimit,m=y===void 0?10:y,w=i.letterSpacing,M=w===void 0?0:w,S=i.stroke,T=i.fill,A=i.fillRule,O=i.fillOpacity,N=O===void 0?1:O,C=i.strokeOpacity,P=C===void 0?1:C,D=i.opacity,j=D===void 0?1:D,G=i.metrics,V=i.x,Y=V===void 0?0:V,$=i.y,z=$===void 0?0:$,Z=i.dx,ne=i.dy,se=i.shadowColor,oe=i.shadowBlur,Ne=G.font,K=G.lines,W=G.height,ee=G.lineHeight,le=G.lineMetrics;n.font=Ne,n.lineWidth=c,n.textAlign=h==="middle"?"center":h;var xe=g;xe==="alphabetic"&&(xe="bottom"),n.lineJoin=p,Le(m)||(n.miterLimit=m);var Ce=z;g==="middle"?Ce+=-W/2-ee/2:g==="bottom"||g==="alphabetic"||g==="ideographic"?Ce+=-W:(g==="top"||g==="hanging")&&(Ce+=-ee);var Ve=Y+(Z||0);Ce+=ne||0,K.length===1&&(xe==="bottom"?(xe="middle",Ce-=.5*W):xe==="top"&&(xe="middle",Ce+=.5*W)),n.textBaseline=xe;var Tt=!Le(se)&&oe>0;cc(a,n,Tt);for(var dn=0;dn<K.length;dn++){var Ot=c/2+Ve;Ce+=ee,!Le(S)&&!S.isNone&&c&&this.drawLetterSpacing(n,a,K[dn],le[dn],h,Ot,Ce,M,T,A,N,S,P,j,!0,s,o,u),Le(T)||this.drawLetterSpacing(n,a,K[dn],le[dn],h,Ot,Ce,M,T,A,N,S,P,j,!1,s,o,u)}}},{key:"drawLetterSpacing",value:function(n,i,a,s,o,u,l,c,d,h,f,g,v,p,y,m,w,M){if(c===0){y?this.strokeText(n,i,a,u,l,g,v,m,w,M):this.fillText(n,i,a,u,l,d,h,f,p,m,w,M);return}var S=n.textAlign;n.textAlign="left";var T=u;o==="center"||o==="middle"?T=u-s.width/2:(o==="right"||o==="end")&&(T=u-s.width);for(var A=Array.from(a),O=n.measureText(a).width,N=0,C=0;C<A.length;++C){var P=A[C];y?this.strokeText(n,i,P,T,l,g,v,m,w,M):this.fillText(n,i,P,T,l,d,h,f,p,m,w,M),N=n.measureText(a.substring(C+1)).width,T+=O-N+c,O=N}n.textAlign=S}},{key:"fillText",value:function(n,i,a,s,o,u,l,c,d,h,f,g){hA(n,i,u,l,h,f,g,this.imagePool,!0);var v,p=!Le(c)&&c!==1;p&&(v=n.globalAlpha,n.globalAlpha=c*d),n.fillText(a,s,o),p&&(n.globalAlpha=v)}},{key:"strokeText",value:function(n,i,a,s,o,u,l,c,d,h){xy(n,i,u,c,d,h,this.imagePool,!0);var f,g=!Le(l)&&l!==1;g&&(f=n.globalAlpha,n.globalAlpha=l),n.strokeText(a,s,o),g&&(n.globalAlpha=f)}},{key:"drawToContext",value:function(n,i,a,s,o){this.render(n,i.parsedStyle,i,i.ownerDocument.defaultView.context,s,o)}}])}(Lm),dj=function(r){function e(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ce(this,e),t=Ge(this,e),t.name="canvas-renderer",t.options=n,t}return We(e,r),de(e,[{key:"init",value:function(){var n,i=qe({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),a=this.context.imagePool,s=new Lm(a),o=(n={},Me(Me(Me(Me(Me(Me(Me(Me(Me(Me(n,re.CIRCLE,s),re.ELLIPSE,s),re.RECT,s),re.IMAGE,new lj(a)),re.TEXT,new cj(a)),re.LINE,s),re.POLYLINE,s),re.POLYGON,s),re.PATH,s),re.GROUP,void 0),Me(Me(Me(n,re.HTML,void 0),re.MESH,void 0),re.FRAGMENT,void 0));this.context.defaultStyleRendererFactory=o,this.context.styleRendererFactory=o,this.addRenderingPlugin(new dA(i))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory}}])}(ga);/*!
 * @antv/g-plugin-dom-interaction
 * @description A G plugin
 * @version 2.1.20
 * @date 1/17/2025, 2:06:55 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var fA=function(){function r(){ce(this,r)}return de(r,[{key:"apply",value:function(t,n){var i=this,a=t.renderingService,s=t.renderingContext,o=t.config;this.context=t;var u=s.root.ownerDocument.defaultView,l=function(O){a.hooks.pointerMove.call(O)},c=function(O){a.hooks.pointerUp.call(O)},d=function(O){a.hooks.pointerDown.call(O)},h=function(O){a.hooks.pointerOver.call(O)},f=function(O){a.hooks.pointerOut.call(O)},g=function(O){a.hooks.pointerCancel.call(O)},v=function(O){a.hooks.pointerWheel.call(O)},p=function(O){a.hooks.click.call(O)},y=function(O){n.globalThis.document.addEventListener("pointermove",l,!0),O.addEventListener("pointerdown",d,!0),O.addEventListener("pointerleave",f,!0),O.addEventListener("pointerover",h,!0),n.globalThis.addEventListener("pointerup",c,!0),n.globalThis.addEventListener("pointercancel",g,!0)},m=function(O){O.addEventListener("touchstart",d,!0),O.addEventListener("touchend",c,!0),O.addEventListener("touchmove",l,!0),O.addEventListener("touchcancel",g,!0)},w=function(O){n.globalThis.document.addEventListener("mousemove",l,!0),O.addEventListener("mousedown",d,!0),O.addEventListener("mouseout",f,!0),O.addEventListener("mouseover",h,!0),n.globalThis.addEventListener("mouseup",c,!0)},M=function(O){n.globalThis.document.removeEventListener("pointermove",l,!0),O.removeEventListener("pointerdown",d,!0),O.removeEventListener("pointerleave",f,!0),O.removeEventListener("pointerover",h,!0),n.globalThis.removeEventListener("pointerup",c,!0),n.globalThis.removeEventListener("pointercancel",g,!0)},S=function(O){O.removeEventListener("touchstart",d,!0),O.removeEventListener("touchend",c,!0),O.removeEventListener("touchmove",l,!0),O.removeEventListener("touchcancel",g,!0)},T=function(O){n.globalThis.document.removeEventListener("mousemove",l,!0),O.removeEventListener("mousedown",d,!0),O.removeEventListener("mouseout",f,!0),O.removeEventListener("mouseover",h,!0),n.globalThis.removeEventListener("mouseup",c,!0)};a.hooks.init.tap(r.tag,function(){var A=i.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(A.style.msContentZooming="none",A.style.msTouchAction="none"):u.supportsPointerEvents&&(A.style.touchAction="none"),u.supportsPointerEvents?y(A):w(A),u.supportsTouchEvents&&m(A),o.useNativeClickEvent&&A.addEventListener("click",p,!0),A.addEventListener("wheel",v,{passive:!0,capture:!0})}),a.hooks.destroy.tap(r.tag,function(){var A=i.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(A.style.msContentZooming="",A.style.msTouchAction=""):u.supportsPointerEvents&&(A.style.touchAction=""),u.supportsPointerEvents?M(A):T(A),u.supportsTouchEvents&&S(A),o.useNativeClickEvent&&A.removeEventListener("click",p,!0),A.removeEventListener("wheel",v,!0)})}}])}();fA.tag="DOMInteraction";var hj=function(r){function e(){var t;ce(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=Ge(this,e,[].concat(i)),t.name="dom-interaction",t}return We(e,r),de(e,[{key:"init",value:function(){this.addRenderingPlugin(new fA)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(ga);/*!
 * @antv/g-plugin-html-renderer
 * @description A G plugin for rendering HTML
 * @version 2.1.20
 * @date 1/17/2025, 2:07:05 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var fj="g-canvas-camera",gA=function(){function r(){ce(this,r),this.displayObjectHTMLElementMap=new WeakMap}return de(r,[{key:"joinTransformMatrix",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return"matrix(".concat([t[0],t[1],t[4],t[5],t[12]+n[0],t[13]+n[1]].join(","),")")}},{key:"apply",value:function(t,n){var i=this,a=t.camera,s=t.renderingContext,o=t.renderingService;this.context=t;var u=s.root.ownerDocument.defaultView,l=u.context.eventService.nativeHTMLMap,c=function(y,m){m.style.transform=i.joinTransformMatrix(y.getWorldTransform(),y.getOrigin())},d=function(y){var m=y.target;if(m.nodeName===re.HTML){i.$camera||(i.$camera=i.createCamera(a));var w=i.getOrCreateEl(m);i.$camera.appendChild(w),Object.keys(m.attributes).forEach(function(M){i.updateAttribute(M,m)}),c(m,w),l.set(w,m)}},h=function(y){var m=y.target;if(m.nodeName===re.HTML&&i.$camera){var w=i.getOrCreateEl(m);w&&(w.remove(),l.delete(w))}},f=function(y){var m=y.target;if(m.nodeName===re.HTML){var w=y.attrName;i.updateAttribute(w,m)}},g=function(y){var m=y.target,w=m.nodeName===re.FRAGMENT?m.childNodes:[m];w.forEach(function(M){if(M.nodeName===re.HTML){var S=i.getOrCreateEl(M);c(M,S)}})},v=function(){if(i.$camera){var y=i.context.config,m=y.width,w=y.height;i.$camera.parentElement.style.width="".concat(m||0,"px"),i.$camera.parentElement.style.height="".concat(w||0,"px")}};o.hooks.init.tap(r.tag,function(){u.addEventListener(or.RESIZE,v),u.addEventListener(He.MOUNTED,d),u.addEventListener(He.UNMOUNTED,h),u.addEventListener(He.ATTR_MODIFIED,f),u.addEventListener(He.BOUNDS_CHANGED,g)}),o.hooks.endFrame.tap(r.tag,function(){i.$camera&&s.renderReasons.has(Ps.CAMERA_CHANGED)&&(i.$camera.style.transform=i.joinTransformMatrix(a.getOrthoMatrix()))}),o.hooks.destroy.tap(r.tag,function(){i.$camera&&i.$camera.remove(),u.removeEventListener(or.RESIZE,v),u.removeEventListener(He.MOUNTED,d),u.removeEventListener(He.UNMOUNTED,h),u.removeEventListener(He.ATTR_MODIFIED,f),u.removeEventListener(He.BOUNDS_CHANGED,g)})}},{key:"createCamera",value:function(t){var n=this.context.config,i=n.document,a=n.width,s=n.height,o=this.context.contextService.getDomElement(),u=o.parentNode;if(u){var l=fj,c=u.querySelector("#".concat(l));if(!c){var d=(i||document).createElement("div");d.style.overflow="hidden",d.style.pointerEvents="none",d.style.position="absolute",d.style.left="0px",d.style.top="0px",d.style.width="".concat(a||0,"px"),d.style.height="".concat(s||0,"px");var h=(i||document).createElement("div");c=h,h.id=l,h.style.position="absolute",h.style.left="".concat(o.offsetLeft||0,"px"),h.style.top="".concat(o.offsetTop||0,"px"),h.style.transformOrigin="left top",h.style.transform=this.joinTransformMatrix(t.getOrthoMatrix()),h.style.pointerEvents="none",h.style.width="100%",h.style.height="100%",d.appendChild(h),u.appendChild(d)}return c}return null}},{key:"getOrCreateEl",value:function(t){var n=this.context.config.document,i=this.displayObjectHTMLElementMap.get(t);return i||(i=(n||document).createElement("div"),t.parsedStyle.$el=i,this.displayObjectHTMLElementMap.set(t,i),t.id&&(i.id=t.id),t.name&&i.setAttribute("name",t.name),t.className&&(i.className=t.className),i.style.position="absolute",i.style["will-change"]="transform",i.style.transform=this.joinTransformMatrix(t.getWorldTransform(),t.getOrigin())),i}},{key:"updateAttribute",value:function(t,n){var i=this.getOrCreateEl(n);switch(t){case"innerHTML":var a=n.parsedStyle.innerHTML;tt(a)?i.innerHTML=a:(i.innerHTML="",i.appendChild(a));break;case"x":i.style.left="".concat(n.parsedStyle.x,"px");break;case"y":i.style.top="".concat(n.parsedStyle.y,"px");break;case"transformOrigin":var s=n.parsedStyle.transformOrigin;i.style["transform-origin"]="".concat(s[0].buildCSSText(null,null,"")," ").concat(s[1].buildCSSText(null,null,""));break;case"width":var o=n.parsedStyle.width;i.style.width=Ee(o)?"".concat(o,"px"):o.toString();break;case"height":var u=n.parsedStyle.height;i.style.height=Ee(u)?"".concat(u,"px"):u.toString();break;case"zIndex":var l=n.parsedStyle.zIndex;i.style["z-index"]="".concat(l);break;case"visibility":var c=n.parsedStyle.visibility;i.style.visibility=c;break;case"pointerEvents":var d=n.parsedStyle.pointerEvents,h=d===void 0?"auto":d;i.style.pointerEvents=h;break;case"opacity":var f=n.parsedStyle.opacity;i.style.opacity="".concat(f);break;case"fill":var g=n.parsedStyle.fill,v="";Ql(g)?g.isNone?v="transparent":v=n.getAttribute("fill"):Array.isArray(g)?v=n.getAttribute("fill"):Ga(g),i.style.background=v;break;case"stroke":var p=n.parsedStyle.stroke,y="";Ql(p)?p.isNone?y="transparent":y=n.getAttribute("stroke"):Array.isArray(p)?y=n.getAttribute("stroke"):Ga(p),i.style["border-color"]=y,i.style["border-style"]="solid";break;case"lineWidth":var m=n.parsedStyle.lineWidth;i.style["border-width"]="".concat(m||0,"px");break;case"lineDash":i.style["border-style"]="dashed";break;case"filter":var w=n.style.filter;i.style.filter=w;break;default:!Le(n.style[t])&&n.style[t]!==""&&(i.style[t]=n.style[t])}}}])}();gA.tag="HTMLRendering";var gj=function(r){function e(){var t;ce(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=Ge(this,e,[].concat(i)),t.name="html-renderer",t}return We(e,r),de(e,[{key:"init",value:function(){this.addRenderingPlugin(new gA)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(ga);/*!
 * @antv/g-canvas
 * @description A renderer implemented by Canvas 2D API
 * @version 2.0.38
 * @date 1/17/2025, 2:09:35 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var pj=function(){function r(e){ce(this,r),this.renderingContext=e.renderingContext,this.canvasConfig=e.config}return de(r,[{key:"init",value:function(){var t=this.canvasConfig,n=t.container,i=t.canvas;if(i)this.$canvas=i,n&&i.parentElement!==n&&n.appendChild(i),this.$container=i.parentElement,this.canvasConfig.container=this.$container;else if(n&&(this.$container=tt(n)?document.getElementById(n):n,this.$container)){var a=document.createElement("canvas");this.$container.appendChild(a),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=a}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height)}},{key:"getContext",value:function(){return this.context}},{key:"getDomElement",value:function(){return this.$canvas}},{key:"getDPR",value:function(){return this.dpr}},{key:"getBoundingClientRect",value:function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()}},{key:"destroy",value:function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)}},{key:"resize",value:function(t,n){var i=this.canvasConfig.devicePixelRatio;this.dpr=i,this.$canvas&&(this.$canvas.width=this.dpr*t,this.$canvas.height=this.dpr*n,VI(this.$canvas,t,n)),this.renderingContext.renderReasons.add(Ps.CAMERA_CHANGED)}},{key:"applyCursorStyle",value:function(t){this.$container&&this.$container.style&&(this.$container.style.cursor=t)}},{key:"toDataURL",value:function(){var e=da(Mn().mark(function n(){var i,a,s,o=arguments;return Mn().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return i=o.length>0&&o[0]!==void 0?o[0]:{},a=i.type,s=i.encoderOptions,l.abrupt("return",this.context.canvas.toDataURL(a,s));case 3:case"end":return l.stop()}},n,this)}));function t(){return e.apply(this,arguments)}return t}()}])}(),vj=function(r){function e(){var t;ce(this,e);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t=Ge(this,e,[].concat(i)),t.name="canvas-context-register",t}return We(e,r),de(e,[{key:"init",value:function(){this.context.ContextService=pj}},{key:"destroy",value:function(){delete this.context.ContextService}}])}(ga),Bc=function(r){function e(t){var n;return ce(this,e),n=Ge(this,e,[t]),n.registerPlugin(new vj),n.registerPlugin(new aj),n.registerPlugin(new R6),n.registerPlugin(new dj),n.registerPlugin(new hj),n.registerPlugin(new tj),n.registerPlugin(new gj),n}return We(e,r),de(e)}(iD),yj=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Fc extends Wr{constructor(e){super(Object.assign(Object.assign({},e),{style:Object.assign({},Fc.defaultStyleProps,e.style)})),this.rootPointerEvent=new tc(null),this.forwardEvents=t=>{const n=this.context.canvas,i=n.context.renderingContext.root.ownerDocument.defaultView;this.normalizeToPointerEvent(t,i).forEach(s=>{const o=this.bootstrapEvent(this.rootPointerEvent,s,i,t);jo(n.context.eventService,"mappingTable.pointerupoutside",[]),n.context.eventService.mapEvent(o)})}}get eventService(){return this.context.canvas.context.eventService}get events(){return[ae.CLICK,ae.POINTER_DOWN,ae.POINTER_MOVE,ae.POINTER_UP,ae.POINTER_OVER,ae.POINTER_LEAVE]}getDomElement(){return this.getShape("key").getDomElement()}render(e=this.parsedAttributes,t=this){this.drawKeyShape(e,t),this.drawPortShapes(e,t)}getKeyStyle(e){const t=$a(e,["dx","dy","innerHTML","pointerEvents","cursor"]),{dx:n=0,dy:i=0}=t,a=yj(t,["dx","dy"]),[s,o]=this.getSize(e);return Object.assign(Object.assign({x:n,y:i},a),{width:s,height:o})}drawKeyShape(e,t){const n=this.getKeyStyle(e),{x:i,y:a,width:s=0,height:o=0}=n,u=this.upsert("key-container",Sn,{x:i,y:a,width:s,height:o,opacity:0},t);return this.upsert("key",cu,n,u)}connectedCallback(){if(!(this.context.canvas.getRenderer("main")instanceof Bc))return;const n=this.getDomElement();this.events.forEach(i=>{n.addEventListener(i,this.forwardEvents)})}attributeChangedCallback(e,t,n){e==="zIndex"&&t!==n&&(this.getDomElement().style.zIndex=n)}destroy(){const e=this.getDomElement();this.events.forEach(t=>{e.removeEventListener(t,this.forwardEvents)}),super.destroy()}normalizeToPointerEvent(e,t){const n=[];if(t.isTouchEvent(e))for(let i=0;i<e.changedTouches.length;i++){const a=e.changedTouches[i];je(a.button)&&(a.button=0),je(a.buttons)&&(a.buttons=1),je(a.isPrimary)&&(a.isPrimary=e.touches.length===1&&e.type==="touchstart"),je(a.width)&&(a.width=a.radiusX||1),je(a.height)&&(a.height=a.radiusY||1),je(a.tiltX)&&(a.tiltX=0),je(a.tiltY)&&(a.tiltY=0),je(a.pointerType)&&(a.pointerType="touch"),je(a.pointerId)&&(a.pointerId=a.identifier||0),je(a.pressure)&&(a.pressure=a.force||.5),je(a.twist)&&(a.twist=0),je(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,a.type=e.type,n.push(a)}else if(t.isMouseEvent(e)){const i=e;je(i.isPrimary)&&(i.isPrimary=!0),je(i.width)&&(i.width=1),je(i.height)&&(i.height=1),je(i.tiltX)&&(i.tiltX=0),je(i.tiltY)&&(i.tiltY=0),je(i.pointerType)&&(i.pointerType="mouse"),je(i.pointerId)&&(i.pointerId=1),je(i.pressure)&&(i.pressure=.5),je(i.twist)&&(i.twist=0),je(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,n.push(i)}else n.push(e);return n}transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.ctrlKey=t.ctrlKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.screen.x=t.screenX,e.screen.y=t.screenY,e.relatedTarget=null}bootstrapEvent(e,t,n,i){e.view=n,e.originalEvent=null,e.nativeEvent=i,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t);const{x:a,y:s}=this.getViewportXY(t);e.viewport.x=a,e.viewport.y=s;const[o,u]=this.context.canvas.getCanvasByViewport([a,s]);return e.canvas.x=o,e.canvas.y=u,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.isTrusted=i.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e}getViewportXY(e){let t,n;const{offsetX:i,offsetY:a,clientX:s,clientY:o}=e;if(!Le(i)&&!Le(a))t=i,n=a;else{const u=this.eventService.client2Viewport({x:s,y:o});t=u.x,n=u.y}return{x:t,y:n}}onframe(){super.onframe();const{opacity:e}=this.attributes;this.getDomElement().style.opacity=`${e}`}}Fc.defaultStyleProps={size:[160,80],halo:!1,icon:!1,label:!1,pointerEvents:"auto"};var Vb=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};let pA=class vA extends Wr{constructor(e){super(yn({style:vA.defaultStyleProps},e))}getKeyStyle(e){const[t,n]=this.getSize(e),i=super.getKeyStyle(e),{fillOpacity:a,opacity:s=a}=i,o=Vb(i,["fillOpacity","opacity"]);return Object.assign(Object.assign({opacity:s},o),{width:t,height:n,x:-t/2,y:-n/2})}getHaloStyle(e){if(e.halo===!1)return!1;const t=this.getShape("key").attributes;Vb(t,["fill","stroke"]);const n=Qt(this.getGraphicStyle(e),"halo"),i=Number(n.lineWidth),[a,s]=$e(this.getSize(e),[i,i]);return Object.assign(Object.assign({},n),{width:a,height:s,fill:"transparent",x:-a/2,y:-s/2})}getIconStyle(e){const t=super.getIconStyle(e),[n,i]=this.getSize(e);return t?Object.assign({width:n*Ni,height:i*Ni},t):!1}drawKeyShape(e,t){const n=this.upsert("key",km,this.getKeyStyle(e),t);return Nm(this),n}drawHaloShape(e,t){this.upsert("halo",Sn,this.getHaloStyle(e),t)}update(e){super.update(e),e&&("x"in e||"y"in e||"z"in e)&&Cm(this)}};pA.defaultStyleProps={size:32};class mj extends Wr{constructor(e){super(e)}getKeyStyle(e){const[t,n]=this.getSize(e);return Object.assign(Object.assign({},super.getKeyStyle(e)),{width:t,height:n,x:-t/2,y:-n/2})}getIconStyle(e){const t=super.getIconStyle(e),{width:n,height:i}=this.getShape("key").attributes;return t?Object.assign({width:n*Ni,height:i*Ni},t):!1}drawKeyShape(e,t){return this.upsert("key",Sn,this.getKeyStyle(e),t)}}class bj extends Ic{constructor(e){super(e)}getInnerR(e){return e.innerR||this.getOuterR(e)*3/8}getOuterR(e){return Math.min(...this.getSize(e))/2}getPoints(e){return nB(this.getOuterR(e),this.getInnerR(e))}getIconStyle(e){const t=super.getIconStyle(e),n=this.getInnerR(e)*2*Ni;return t?Object.assign({width:n,height:n},t):!1}getPortXY(e,t){const{placement:n="top"}=t,i=this.getShape("key").getLocalBounds(),a=rB(this.getOuterR(e),this.getInnerR(e));return Rm(i,n,a,!1)}}class zc extends Ic{constructor(e){super(yn({style:zc.defaultStyleProps},e))}getPoints(e){const{direction:t}=e,[n,i]=this.getSize(e);return iB(n,i,t)}getPortXY(e,t){const{direction:n}=e,{placement:i="top"}=t,a=this.getShape("key").getLocalBounds(),[s,o]=this.getSize(e),u=aB(s,o,n);return Rm(a,i,u,!1)}getIconStyle(e){const{icon:t,iconText:n,iconSrc:i,direction:a}=e;if(t===!1||ti(n||i))return!1;const s=Qt(this.getGraphicStyle(e),"icon"),o=this.getShape("key").getLocalBounds(),[u,l]=E5(o,a),c=M5(o,a)*2*Ni;return Object.assign({x:u,y:l,width:c,height:c},s)}}zc.defaultStyleProps={size:40,direction:"up"};var Yb=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Ys extends Wr{constructor(e){super(yn({style:Ys.defaultStyleProps},e)),this.type="combo",this.updateComboPosition(this.parsedAttributes)}getKeySize(e){const{collapsed:t,childrenNode:n=[]}=e;return n.length===0?this.getEmptyKeySize(e):t?this.getCollapsedKeySize(e):this.getExpandedKeySize(e)}getEmptyKeySize(e){const{padding:t,collapsedSize:n}=e,[i,a,s,o]=hi(t);return $e(hr(n),[o+a,i+s,0])}getCollapsedKeySize(e){return hr(e.collapsedSize)}getExpandedKeySize(e){const t=this.getContentBBox(e);return[fi(t),gi(t),0]}getContentBBox(e){const{childrenNode:t=[],padding:n}=e,i=t.map(s=>this.context.element.getElement(s)).filter(Boolean);if(i.length===0){const s=new ft,{x:o=0,y:u=0,size:l}=e,[c,d]=hr(l);return s.setMinMax([o-c/2,u-d/2,0],[o+c/2,u+d/2,0]),s}const a=hu(i.map(s=>s.getBounds()));return n?va(a,n):a}drawCollapsedMarkerShape(e,t){const n=this.getCollapsedMarkerStyle(e);this.upsert("collapsed-marker",iA,n,t),Nm(this)}getCollapsedMarkerStyle(e){if(!e.collapsed||!e.collapsedMarker)return!1;const t=Qt(this.getGraphicStyle(e),"collapsedMarker"),{type:n}=t,i=Yb(t,["type"]),a=this.getShape("key"),[s,o]=xi(a.getLocalBounds(),"center"),u=Object.assign(Object.assign({},i),{x:s,y:o});if(n){const l=this.getCollapsedMarkerText(n,e);Object.assign(u,{text:l})}return u}getCollapsedMarkerText(e,t){const{childrenData:n=[]}=t,{model:i}=this.context;return e==="descendant-count"?i.getDescendantsData(this.id).length.toString():e==="child-count"?n.length.toString():e==="node-count"?i.getDescendantsData(this.id).filter(a=>i.getElementType(Q(a))==="node").length.toString():Te(e)?e(n):""}getComboPosition(e){const{x:t=0,y:n=0,collapsed:i,childrenData:a=[]}=e;if(a.length===0)return[+t,+n,0];if(i){const{model:s}=this.context,o=s.getDescendantsData(this.id).filter(u=>!s.isCombo(Q(u)));if(o.length>0&&o.some(K5)){const u=o.reduce((l,c)=>$e(l,on(c)),[0,0,0]);return qr(u,o.length)}return[+t,+n,0]}return this.getContentBBox(e).center}getComboStyle(e){const[t,n]=this.getComboPosition(e);return{x:t,y:n,transform:[["translate",t,n]]}}updateComboPosition(e){const t=this.getComboStyle(e);Object.assign(this.style,t);const{x:n,y:i}=t;this.context.model.syncNodeLikeDatum({id:this.id,style:{x:n,y:i}}),Cm(this)}render(e,t=this){super.render(e,t),this.drawCollapsedMarkerShape(e,t)}update(e={}){super.update(e),this.updateComboPosition(this.parsedAttributes)}onframe(){super.onframe(),this.attributes.collapsed||this.updateComboPosition(this.parsedAttributes),this.drawKeyShape(this.parsedAttributes,this)}animate(e,t){const n=super.animate(this.attributes.collapsed?e:e.map(i=>{var a=Yb(i,["x","y","z","transform"]);return a}),t);return n&&new Proxy(n,{set:(i,a,s)=>(a==="currentTime"&&Promise.resolve().then(()=>this.onframe()),Reflect.set(i,a,s))})}}Ys.defaultStyleProps={childrenNode:[],droppable:!0,draggable:!0,collapsed:!1,collapsedSize:32,collapsedMarker:!0,collapsedMarkerZIndex:1,collapsedMarkerFontSize:12,collapsedMarkerTextAlign:"center",collapsedMarkerTextBaseline:"middle",collapsedMarkerType:"child-count"};class wj extends Ys{constructor(e){super(e)}drawKeyShape(e,t){return this.upsert("key",Ii,this.getKeyStyle(e),t)}getKeyStyle(e){const{collapsed:t}=e,n=super.getKeyStyle(e),[i]=this.getKeySize(e);return Object.assign(Object.assign(Object.assign({},n),t&&Qt(n,"collapsed")),{r:i/2})}getCollapsedKeySize(e){const[t,n]=hr(e.collapsedSize),i=Math.max(t,n)/2;return[i*2,i*2,0]}getExpandedKeySize(e){const t=this.getContentBBox(e),[n,i]=pa(t),a=Math.sqrt(Math.pow(n,2)+Math.pow(i,2))/2;return[a*2,a*2,0]}getIntersectPoint(e,t=!1){const n=this.getShape("key").getBounds();return Lc(e,n,t)}}class xj extends Ys{constructor(e){super(e)}drawKeyShape(e,t){return this.upsert("key",Sn,this.getKeyStyle(e),t)}getKeyStyle(e){const t=super.getKeyStyle(e),[n,i]=this.getKeySize(e);return Object.assign(Object.assign(Object.assign({},t),e.collapsed&&Qt(t,"collapsed")),{width:n,height:i,x:-n/2,y:-i/2})}}const Ej={padding:10};function Ub(r,e,t,n,i,a){const{padding:s}=Object.assign(Ej,a),o=Zi(t,s),u=Zi(n,s),l=[r,...i,e];let c=null;const d=[];for(let h=0,f=l.length;h<f-1;h++){const g=h+1,v=l[h],p=l[g],y=J5(v,p);let m=null;if(h===0)if(g===f-1)if(o.intersects(u))m=Dh(v,p,o,u);else if(!ic(v,o)&&!ic(p,u)){const w=Ba(v,o),M=Ba(p,u);m=Xb(w,M,$n(w,M)),m.points.unshift(w),m.points.push(M)}else y||(m=Sj(v,p,o,u));else $r(p,o)?m=Dh(v,p,o,Zi(p,s),c):y||(m=Cl(v,p,o));else g===f-1?$r(v,u)?m=Dh(v,p,Zi(v,s),u,c):y||(m=yA(v,p,u,c)):y||(m=Xb(v,p,c));m?(d.push(...m.points),c=m.direction):c=$n(v,p),g<f-1&&d.push(p)}return d.map(Ya)}const Mj={N:"S",S:"N",W:"E",E:"W"},Hb={N:-Math.PI/2,S:Math.PI/2,E:0,W:Math.PI};function $n(r,e){const[t,n]=r,[i,a]=e;return t===i?n>a?"N":"S":n===a?t>i?"W":"E":null}function Ey(r,e){return e==="N"||e==="S"?gi(r):fi(r)}function Xb(r,e,t){const n=[r[0],e[1]],i=[e[0],r[1]],a=$n(r,n),s=$n(r,i),o=t?Mj[t]:null,u=a===t||a!==o&&s!==t?n:i;return{points:[u],direction:$n(u,e)}}function Cl(r,e,t){if(ic(r,t)){const n=Wo(r,e,t);return{points:[n],direction:$n(n,e)}}else{const n=Ba(r,t),a=["left","right"].includes(Co(r,t))?[e[0],n[1]]:[n[0],e[1]];return{points:[a],direction:$n(a,e)}}}function yA(r,e,t,n){const i=ic(e,t)?e:Ba(e,t),a=[[i[0],r[1]],[r[0],i[1]]],s=a.filter(u=>x5(u,t)&&!RO(u,t,!0)),o=s.filter(u=>$n(u,r)!==n);if(o.length>0){const u=o.find(l=>$n(r,l)===n)||o[0];return{points:[u],direction:$n(u,e)}}else{const u=kL(a,s)[0],l=sa(e,u,Ey(t,n)/2);return{points:[Wo(l,r,t),l],direction:$n(l,e)}}}function Sj(r,e,t,n){let i=Cl(r,e,t);const a=Go(i.points[0]);if($r(a,n)){i=Cl(e,r,n);const s=Go(i.points[0]);if($r(s,t)){const o=sa(r,a,Ey(t,$n(r,a))/2),u=sa(e,s,Ey(n,$n(e,s))/2),l=[(o[0]+u[0])/2,(o[1]+u[1])/2],c=Cl(r,l,t),d=yA(l,e,n,c.direction);i.points=[c.points[0],d.points[0]],i.direction=d.direction}}return i}function Dh(r,e,t,n,i){const s=hu([t,n]),o=yt(e,s.center)>yt(r,s.center),[u,l]=o?[e,r]:[r,e],c=gi(s)+fi(s);let d;if(i){const g=[u[0]+c*Math.cos(Hb[i]),u[1]+c*Math.sin(Hb[i])];d=sa(Ba(g,s),g,.01)}else d=sa(Ba(u,s),u,-.01);let h=Wo(d,l,s),f=[ao(d,2),ao(h,2)];if(Bt(ao(d),ao(h))){const g=Tm(ot(d,u),[1,0,0])+Math.PI/2;h=[l[0]+c*Math.cos(g),l[1]+c*Math.sin(g),0],h=ao(sa(Ba(h,s),l,-.01),2);const v=Wo(d,h,s);f=[d,v,h]}return{points:o?f.reverse():f,direction:$n(o?d:h,e)}}function Wo(r,e,t){let n=[r[0],e[1]];return $r(n,t)&&(n=[e[0],r[1]]),n}function mA(r,e,t,n,i){let u=typeof e=="number"?e:.5;e==="start"&&(u=0),e==="end"&&(u=.99);const l=En(r.getPoint(u)),c=En(r.getPoint(u+.01));let d=e==="start"?"left":e==="end"?"right":"center";if(UO(l,c)||!t){const[y,m]=Kb(r,u,n,i);return{transform:[["translate",y,m]],textAlign:d}}let h=Math.atan2(c[1]-l[1],c[0]-l[0]);c[0]<l[0]&&(d=d==="center"?d:d==="left"?"right":"left",n*=-1,h+=Math.PI);const[g,v]=Kb(r,u,n,i,h),p=[["translate",g,v],["rotate",h/Math.PI*180]];return{textAlign:d,transform:p}}function _j(r,e,t,n,i){var a,s;const o=((a=r.badge)===null||a===void 0?void 0:a.getGeometryBounds().halfExtents[0])*2||0,u=((s=r.label)===null||s===void 0?void 0:s.getGeometryBounds().halfExtents[0])*2||0;return mA(r.key,t,!0,(u?(u/2+o/2)*(e==="suffix"?1:-1):0)+n,i)}function Kb(r,e,t,n,i){const[a,s]=En(r.getPoint(e));let o=t,u=n;return i&&(o=t*Math.cos(i)-n*Math.sin(i),u=t*Math.sin(i)+n*Math.cos(i)),[a+o,s+u]}function My(r,e,t,n){if(Bt(r,e))return r;const i=ot(e,r),a=[r[0]+t*i[0],r[1]+t*i[1]],s=Oi(Pc(i,!1));return a[0]+=n*s[0],a[1]+=n*s[1],a}function Tj(r){return Ee(r)?[r,-r]:r}function Oj(r){return Ee(r)?[r,1-r]:r}function Aj(r,e,t){return[["M",r[0],r[1]],["Q",t[0],t[1],e[0],e[1]]]}function bA(r,e,t){return[["M",r[0],r[1]],["C",t[0][0],t[0][1],t[1][0],t[1][1],e[0],e[1]]]}function Dm(r,e=0,t=!1){const n=r[0],i=r[r.length-1],a=r.slice(1,r.length-1),s=[["M",n[0],n[1]]];return a.forEach((o,u)=>{const l=a[u-1]||n,c=a[u+1]||i;if(!HO(l,o,c)&&e){const[d,h]=kj(l,o,c,e);s.push(["L",d[0],d[1]],["Q",o[0],o[1],h[0],h[1]],["L",h[0],h[1]])}else s.push(["L",o[0],o[1]])}),s.push(["L",i[0],i[1]]),t&&s.push(["Z"]),s}function kj(r,e,t,n){const i=ac(r,e),a=ac(t,e),s=Math.min(n,Math.min(i,a)/2),o=[e[0]-s/i*(e[0]-r[0]),e[1]-s/i*(e[1]-r[1])],u=[e[0]-s/a*(e[0]-t[0]),e[1]-s/a*(e[1]-t[1])];return[o,u]}const Nj=r=>{const e=Math.PI/2,t=gi(r)/2,n=fi(r)/2,i=Math.atan2(t,n)/2,a=Math.atan2(n,t)/2;return{top:[-e-a,-e+a],"top-right":[-e+a,-i],"right-top":[-e+a,-i],right:[-i,i],"bottom-right":[i,e-a],"right-bottom":[i,e-a],bottom:[e-a,e+a],"bottom-left":[e+a,Math.PI-i],"left-bottom":[e+a,Math.PI-i],left:[Math.PI-i,Math.PI+i],"top-left":[Math.PI+i,-e-a],"left-top":[Math.PI+i,-e-a]}};function wA(r,e,t,n,i){const a=Zi(r),s=r.getCenter();let o=n&&ha(n),u=i&&ha(i);if(!o||!u){const l=Nj(a),c=l[e][0],d=l[e][1],[h,f]=pa(a),g=Math.max(h,f),v=$e(s,[g*Math.cos(c),g*Math.sin(c),0]),p=$e(s,[g*Math.cos(d),g*Math.sin(d),0]);o=_y(r,v),u=_y(r,p),t||([o,u]=[u,o])}return[o,u]}function Cj(r,e,t,n,i,a){const s=r.getPorts()[i||a],o=r.getPorts()[a||i];let[u,l]=wA(r,e,t,s,o);const c=Pj(r,u,l,n);return s&&(u=Vo(s,c[0])),o&&(l=Vo(o,c[c.length-1])),bA(u,l,c)}function Pj(r,e,t,n){const i=r.getCenter();if(Bt(e,t)){const a=ot(e,i),s=[n*Math.sign(a[0])||n/2,n*Math.sign(a[1])||-n/2,0];return[$e(e,s),$e(t,wi(s,[1,-1,1]))]}return[sa(i,e,yt(i,e)+n),sa(i,t,yt(i,t)+n)]}function Lj(r,e,t,n,i,a,s){const o=jm(r),u=o[a||s],l=o[s||a];let[c,d]=wA(r,t,n,u,l);const h=Dj(r,c,d,i);return u&&(c=Vo(u,h[0])),l&&(d=Vo(l,h[h.length-1])),Dm([c,...h,d],e)}function Dj(r,e,t,n){const i=[],a=Zi(r);if(Bt(e,t))switch(Co(e,a)){case"left":i.push([e[0]-n,e[1]]),i.push([e[0]-n,e[1]+n]),i.push([e[0],e[1]+n]);break;case"right":i.push([e[0]+n,e[1]]),i.push([e[0]+n,e[1]+n]),i.push([e[0],e[1]+n]);break;case"top":i.push([e[0],e[1]-n]),i.push([e[0]+n,e[1]-n]),i.push([e[0]+n,e[1]]);break;case"bottom":i.push([e[0],e[1]+n]),i.push([e[0]+n,e[1]+n]),i.push([e[0]+n,e[1]]);break}else{const s=Co(e,a),o=Co(t,a);if(s===o){const u=s;let l,c;switch(u){case"left":l=Math.min(e[0],t[0])-n,i.push([l,e[1]]),i.push([l,t[1]]);break;case"right":l=Math.max(e[0],t[0])+n,i.push([l,e[1]]),i.push([l,t[1]]);break;case"top":c=Math.min(e[1],t[1])-n,i.push([e[0],c]),i.push([t[0],c]);break;case"bottom":c=Math.max(e[1],t[1])+n,i.push([e[0],c]),i.push([t[0],c]);break}}else{const u=(h,f)=>({left:[f[0]-n,f[1]],right:[f[0]+n,f[1]],top:[f[0],f[1]-n],bottom:[f[0],f[1]+n]})[h],l=u(s,e),c=u(o,t),d=Wo(l,c,a);i.push(l,d,c)}}return i}function Sy(r,e){const t=new Set,n=new Set,i=new Set;return r.forEach(a=>{e(a).forEach(o=>{t.add(o),r.includes(o.source)&&r.includes(o.target)?n.add(o):i.add(o)})}),{edges:Array.from(t),internal:Array.from(n),external:Array.from(i)}}function Zb(r,e){const t=[];let n=r;for(;n;){t.push(n);const i=e(Q(n));if(i)n=i;else break}if(t.some(i=>{var a;return(a=i.style)===null||a===void 0?void 0:a.collapsed})){const i=t.reverse().findIndex(Jn);return t[i]||t.at(-1)}return r}function Ij(r,e){return e||(r<4?10:r===4?12:r*2.5)}const Rj=(r,e)=>{const t=Math.max(r,e)/2;return[["M",-r/2,0],["A",t,t,0,1,0,2*t-r/2,0],["A",t,t,0,1,0,-r/2,0],["Z"]]},xA=(r,e)=>[["M",-r/2,0],["L",r/2,-e/2],["L",r/2,e/2],["Z"]],jj=(r,e)=>[["M",-r/2,0],["L",0,-e/2],["L",r/2,0],["L",0,e/2],["Z"]],Bj=(r,e)=>[["M",-r/2,0],["L",r/2,-e/2],["L",4*r/5-r/2,0],["L",r/2,e/2],["Z"]],Fj=(r,e)=>[["M",-r/2,-e/2],["L",r/2,-e/2],["L",r/2,e/2],["L",-r/2,e/2],["Z"]],zj=(r,e)=>{const t=r/2,n=r/7,i=r-n;return[["M",-t,0],["L",0,-e/2],["L",0,e/2],["Z"],["M",i-t,-e/2],["L",i+n-t,-e/2],["L",i+n-t,e/2],["L",i-t,e/2],["Z"]]},$j=(r,e)=>[["M",r/2,-e/2],["L",-r/2,0],["L",r/2,0],["L",-r/2,0],["L",r/2,e/2]],qj=Object.freeze(Object.defineProperty({__proto__:null,circle:Rj,diamond:jj,rect:Fj,simple:$j,triangle:xA,triangleRect:zj,vee:Bj},Symbol.toStringTag,{value:"Module"}));var hl=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class ma extends aA{constructor(e){super(yn({style:ma.defaultStyleProps},e)),this.type="edge"}get sourceNode(){const{sourceNode:e}=this.parsedAttributes;return this.context.element.getElement(e)}get targetNode(){const{targetNode:e}=this.parsedAttributes;return this.context.element.getElement(e)}getKeyStyle(e){const t=this.getGraphicStyle(e),{loop:n}=t,i=hl(t,["loop"]),{sourceNode:a,targetNode:s}=this,u={d:n&&Qj(a,s)?this.getLoopPath(e):this.getKeyPath(e)};return lr.PARSED_STYLE_LIST.forEach(l=>{l in i&&(u[l]=i[l])}),u}getLoopPath(e){const{sourcePort:t,targetPort:n}=e,i=this.sourceNode,a=Zi(i),s=Math.max(fi(a),gi(a)),{placement:o,clockwise:u,dist:l=s}=Qt(this.getGraphicStyle(e),"loop");return Cj(i,o,u,l,t,n)}getEndpoints(e,t=!0,n=[]){const{sourcePort:i,targetPort:a}=e,{sourceNode:s,targetNode:o}=this,[u,l]=eB(s,o,i,a);if(!t){const f=u?ha(u):s.getCenter(),g=l?ha(l):o.getCenter();return[f,g]}const c=typeof n=="function"?n():n,d=nw(u||s,c[0]||l||o),h=nw(l||o,c[c.length-1]||u||s);return[d,h]}getHaloStyle(e){if(e.halo===!1)return!1;const t=this.getKeyStyle(e),n=Qt(this.getGraphicStyle(e),"halo");return Object.assign(Object.assign({},t),n)}getLabelStyle(e){if(e.label===!1||!e.labelText)return!1;const t=Qt(this.getGraphicStyle(e),"label"),{placement:n,offsetX:i,offsetY:a,autoRotate:s,maxWidth:o}=t,u=hl(t,["placement","offsetX","offsetY","autoRotate","maxWidth"]),l=mA(this.shapeMap.key,n,s,i,a),c=this.shapeMap.key.getLocalBounds(),d=f6([c.min,c.max],o);return Object.assign({wordWrapWidth:d},l,u)}getBadgeStyle(e){if(e.badge===!1||!e.badgeText)return!1;const t=Qt(e,"badge"),{offsetX:n,offsetY:i,placement:a}=t,s=hl(t,["offsetX","offsetY","placement"]);return Object.assign(s,_j(this.shapeMap,a,e.labelPlacement,n,i))}drawArrow(e,t){var n;const i=t==="start",s=e[t==="start"?"startArrow":"endArrow"],o=this.shapeMap.key;if(s){const u=this.getArrowStyle(e,i),[l,c,d]=i?["markerStart","markerStartOffset","startArrowOffset"]:["markerEnd","markerEndOffset","endArrowOffset"],h=o.parsedStyle[l];if(h)h.attr(u);else{const f=u.src?du:lr,g=new f({style:u});o.style[l]=g}o.style[c]=e[d]||u.width/2+ +u.lineWidth}else{const u=i?"markerStart":"markerEnd";(n=o.style[u])===null||n===void 0||n.destroy(),o.style[u]=null}}getArrowStyle(e,t){const n=this.getShape("key").attributes,i=t?"startArrow":"endArrow",a=Qt(this.getGraphicStyle(e),i),{size:s,type:o}=a,u=hl(a,["size","type"]),[l,c]=hr(Ij(n.lineWidth,s)),h=(Te(o)?o:qj[o]||xA)(l,c);return Object.assign($a(n,["stroke","strokeOpacity","fillOpacity"]),{width:l,height:c},Object.assign({},h&&{d:h,fill:o==="simple"?"":n.stroke}),u)}drawLabelShape(e,t){const n=this.getLabelStyle(e);this.upsert("label",ya,n,t)}drawHaloShape(e,t){const n=this.getHaloStyle(e);this.upsert("halo",lr,n,t)}drawBadgeShape(e,t){const n=this.getBadgeStyle(e);this.upsert("badge",Vs,n,t)}drawSourceArrow(e){this.drawArrow(e,"start")}drawTargetArrow(e){this.drawArrow(e,"end")}drawKeyShape(e,t){const n=this.getKeyStyle(e);return this.upsert("key",lr,n,t)}render(e=this.parsedAttributes,t=this){this.drawKeyShape(e,t),this.getShape("key")&&(this.drawSourceArrow(e),this.drawTargetArrow(e),this.drawLabelShape(e,t),this.drawHaloShape(e,t),this.drawBadgeShape(e,t))}onframe(){this.drawKeyShape(this.parsedAttributes,this),this.drawSourceArrow(this.parsedAttributes),this.drawTargetArrow(this.parsedAttributes),this.drawHaloShape(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this),this.drawBadgeShape(this.parsedAttributes,this)}animate(e,t){const n=super.animate(e,t);return n&&new Proxy(n,{set:(i,a,s)=>(a==="currentTime"&&Promise.resolve().then(()=>this.onframe()),Reflect.set(i,a,s))})}}ma.defaultStyleProps={badge:!0,badgeOffsetX:0,badgeOffsetY:0,badgePlacement:"suffix",isBillboard:!0,label:!0,labelAutoRotate:!0,labelIsBillboard:!0,labelMaxWidth:"80%",labelOffsetX:4,labelOffsetY:0,labelPlacement:"center",labelTextBaseline:"middle",labelWordWrap:!1,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloPointerEvents:"none",haloStrokeOpacity:.25,haloZIndex:-1,loop:!0,startArrow:!1,startArrowLineDash:0,startArrowLineJoin:"round",startArrowLineWidth:1,startArrowTransformOrigin:"center",startArrowType:"vee",endArrow:!1,endArrowLineDash:0,endArrowLineJoin:"round",endArrowLineWidth:1,endArrowTransformOrigin:"center",endArrowType:"vee",loopPlacement:"top",loopClockwise:!0};class ts extends ma{constructor(e){super(yn({style:ts.defaultStyleProps},e))}getKeyPath(e){const[t,n]=this.getEndpoints(e),{controlPoints:i,curvePosition:a,curveOffset:s}=e,o=this.getControlPoints(t,n,Oj(a),Tj(s),i);return bA(t,n,o)}getControlPoints(e,t,n,i,a){return(a==null?void 0:a.length)===2?a:[My(e,t,n[0],i[0]),My(e,t,n[1],i[1])]}}ts.defaultStyleProps={curvePosition:.5,curveOffset:20};class $c extends ts{constructor(e){super(yn({style:$c.defaultStyleProps},e))}getControlPoints(e,t,n,i){const a=t[0]-e[0];return[[e[0]+a*n[0]+i[0],e[1]],[t[0]-a*n[1]+i[1],t[1]]]}}$c.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};class qc extends ts{constructor(e){super(yn({style:qc.defaultStyleProps},e))}get ref(){return this.context.model.getRootsData()[0]}getEndpoints(e){if(this.sourceNode.id===this.ref.id)return super.getEndpoints(e);const t=on(this.ref),n=this.sourceNode.getIntersectPoint(t,!0),i=this.targetNode.getIntersectPoint(t);return[n,i]}toRadialCoordinate(e){const t=on(this.ref),n=yt(e,t),i=WO(ot(e,t));return[n,i]}getControlPoints(e,t,n,i){const[a,s]=this.toRadialCoordinate(e),[o]=this.toRadialCoordinate(t),u=o-a;return[[e[0]+(u*n[0]+i[0])*Math.cos(s),e[1]+(u*n[0]+i[0])*Math.sin(s)],[t[0]-(u*n[1]-i[0])*Math.cos(s),t[1]-(u*n[1]-i[0])*Math.sin(s)]]}}qc.defaultStyleProps={curvePosition:.5,curveOffset:20};class Gc extends ts{constructor(e){super(yn({style:Gc.defaultStyleProps},e))}getControlPoints(e,t,n,i){const a=t[1]-e[1];return[[e[0],e[1]+a*n[0]+i[0]],[t[0],t[1]-a*n[1]+i[1]]]}}Gc.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};let EA=class MA extends ma{constructor(e){super(yn({style:MA.defaultStyleProps},e))}getKeyPath(e){const[t,n]=this.getEndpoints(e);return[["M",t[0],t[1]],["L",n[0],n[1]]]}};EA.defaultStyleProps={};const Gj={enableObstacleAvoidance:!1,offset:10,maxAllowedDirectionChange:Math.PI/2,maximumLoops:3e3,gridSize:5,startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{right:{stepX:1,stepY:0},left:{stepX:-1,stepY:0},bottom:{stepX:0,stepY:1},top:{stepX:0,stepY:-1}},penalties:{0:0,90:0},distFunc:ac},mi=r=>`${Math.round(r[0])}|||${Math.round(r[1])}`;function Da(r,e){const t=n=>Math.round(n/e);return Ee(r)?t(r):r.map(t)}function Wj(r,e){const t=Math.abs(r-e);return t>Math.PI?2*Math.PI-t:t}function Qb(r,e){const t=e[0]-r[0],n=e[1]-r[1];return!t&&!n?0:Math.atan2(n,t)}function SA(r,e,t,n){const i=Qb(r,e),a=t[mi(r)],o=Qb(a||n,r);return Wj(o,i)}const Vj=(r,e)=>{const{offset:t,gridSize:n}=e,i={};return r.forEach(a=>{if(!a||a.destroyed||!a.isVisible())return;const s=va(a.getRenderBounds(),t);for(let o=Da(s.min[0],n);o<=Da(s.max[0],n);o+=1)for(let u=Da(s.min[1],n);u<=Da(s.max[1],n);u+=1)i[`${o}|||${u}`]=!0}),i};function Jb(r,e,t){return Math.min(...e.map(n=>t(r,n)))}function Yj(r,e,t){let n=r[0],i=t(r[0],e);for(let a=0;a<r.length;a++){const s=r[a],o=t(s,e);o<i&&(n=s,i=o)}return n}const ew=(r,e,t,n)=>{if(!e)return[r];const{directionMap:i,offset:a}=n,s=va(e.getRenderBounds(),a),o=Object.keys(i).reduce((u,l)=>{if(t.includes(l)){const c=i[l],[d,h]=pa(s),f=[r[0]+c.stepX*d,r[1]+c.stepY*h],g=S5(s);for(let v=0;v<g.length;v++){const p=Om([r,f],g[v]);p&&RO(p,s)&&u.push(p)}}return u},[]);return $r(r,s)||o.push(r),o.map(u=>Da(u,n.gridSize))},Uj=(r,e,t,n,i,a,s)=>{const o=[];let u=[a[0]===n[0]?n[0]:r[0]*s,a[1]===n[1]?n[1]:r[1]*s];o.unshift(u);let l=r,c=e[mi(l)];for(;c;){const f=c,g=l;SA(f,g,e,t)&&(u=[f[0]===g[0]?u[0]:f[0]*s,f[1]===g[1]?u[1]:f[1]*s],o.unshift(u)),c=e[mi(f)],l=f}const d=i.map(f=>[f[0]*s,f[1]*s]),h=Yj(d,u,ac);return o.unshift(h),o};function Hj(r,e,t,n){const i=Ya(r.getCenter()),a=Ya(e.getCenter()),s=Object.assign(Gj,n),{gridSize:o}=s,u=s.enableObstacleAvoidance?t:[r,e],l=Vj(u,s),c=Da(i,o),d=Da(a,o),h=ew(i,r,s.startDirections,s),f=ew(a,e,s.endDirections,s);h.forEach(O=>delete l[mi(O)]),f.forEach(O=>delete l[mi(O)]);const g={},v={},p={},y={},m={},w=new Xj;for(let O=0;O<h.length;O++){const N=h[O],C=mi(N);g[C]=N,y[C]=0,m[C]=Jb(N,f,s.distFunc),w.add({id:C,value:m[C]})}const M=f.map(O=>mi(O));let S=s.maximumLoops,T,A=1/0;for(const[O,N]of Object.entries(g))m[O]<=A&&(A=m[O],T=N);for(;Object.keys(g).length>0&&S>0;){const O=w.minId(!1);if(O)T=g[O];else break;const N=mi(T);if(M.includes(N))return Uj(T,p,c,a,h,d,o);delete g[N],w.remove(N),v[N]=!0;for(const C of Object.values(s.directionMap)){const P=$e(T,[C.stepX,C.stepY]),D=mi(P);if(v[D])continue;const j=SA(T,P,p,c);if(j>s.maxAllowedDirectionChange||l[D])continue;g[D]||(g[D]=P);const G=s.penalties[j],V=s.distFunc(T,P)+(isNaN(G)?o:G),Y=y[N]+V,$=y[D];$&&Y>=$||(p[D]=T,y[D]=Y,m[D]=Y+Jb(P,f,s.distFunc),w.add({id:D,value:m[D]}))}S-=1}return[]}class Xj{constructor(){this.arr=[],this.map={},this.arr=[],this.map={}}_innerAdd(e,t){let n=0,i=t-1;for(;i-n>1;){const a=Math.floor((n+i)/2);if(this.arr[a].value>e.value)i=a;else if(this.arr[a].value<e.value)n=a;else{this.arr.splice(a,0,e),this.map[e.id]=!0;return}}this.arr.splice(i,0,e),this.map[e.id]=!0}add(e){delete this.map[e.id];const t=this.arr.length;if(!t||this.arr[t-1].value<e.value){this.arr.push(e),this.map[e.id]=!0;return}this._innerAdd(e,t)}remove(e){this.map[e]&&delete this.map[e]}_clearAndGetMinId(){let e;for(let t=this.arr.length-1;t>=0;t--)this.map[this.arr[t].id]?e=this.arr[t].id:this.arr.splice(t,1);return e}_findFirstId(){for(;this.arr.length;){const e=this.arr.shift();if(this.map[e.id])return e.id}}minId(e){return e?this._clearAndGetMinId():this._findFirstId()}}class Wc extends ma{constructor(e){super(yn({style:Wc.defaultStyleProps},e))}getControlPoints(e){const{router:t}=e,{sourceNode:n,targetNode:i}=this,[a,s]=this.getEndpoints(e,!1);let o=[];if(!t)o=e.controlPoints;else if(t.type==="shortest-path"){const u=this.context.element.getNodes();o=Hj(n,i,u,t),o.length||(o=Ub(a,s,n,i,e.controlPoints,{padding:t.offset}))}else t.type==="orth"&&(o=Ub(a,s,n,i,e.controlPoints,t));return o}getPoints(e){const t=this.getControlPoints(e),[n,i]=this.getEndpoints(e,!0,t);return[n,...t,i]}getKeyPath(e){const t=this.getPoints(e);return Dm(t,e.radius)}getLoopPath(e){const{sourcePort:t,targetPort:n,radius:i}=e,a=this.sourceNode,s=Zi(a),o=Math.max(fi(s),gi(s))/4,{placement:u,clockwise:l,dist:c=o}=Qt(this.getGraphicStyle(e),"loop");return Lj(a,i,u,l,c,t,n)}}Wc.defaultStyleProps={radius:0,controlPoints:[],router:!1};class Vc extends ma{constructor(e){super(yn({style:Vc.defaultStyleProps},e))}getKeyPath(e){const{curvePosition:t,curveOffset:n}=e,[i,a]=this.getEndpoints(e),s=e.controlPoint||My(i,a,t,n);return Aj(i,a,s)}}Vc.defaultStyleProps={curvePosition:.5,curveOffset:30};var Kj=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};function yu(r){return r instanceof Wr&&r.type==="node"}function _A(r){return r instanceof ma}function Im(r){return r instanceof Ys}function Zj(r){return yu(r)||_A(r)||Im(r)}function Qj(r,e){return!r||!e?!1:r===e}const Jj={top:[.5,0],right:[1,.5],bottom:[.5,1],left:[0,.5],default:[.5,.5]};function Rm(r,e,t=Jj,n=!0){const i=[.5,.5],a=tt(e)?Fn(t,e.toLocaleLowerCase(),i):e;if(!n&&tt(e))return a;const[s,o]=a||i;return[r.min[0]+fi(r)*s,r.min[1]+gi(r)*o]}function jm(r){if(!r)return{};const e=r.getPorts();return(r.attributes.ports||[]).forEach((n,i)=>{var a;const{key:s,placement:o}=n;TA(n)&&(e[a=s||i]||(e[a]=xi(r.getShape("key").getBounds(),o)))}),e}function TA(r){const{r:e}=r;return!e||Number(e)===0}function ha(r){return zs(r)?r:r.getPosition()}function eB(r,e,t,n){const i=tw(r,e,t,n),a=tw(e,r,n,t);return[i,a]}function tw(r,e,t,n){const i=jm(r);if(t)return i[t];const a=Object.values(i);if(a.length===0)return;const s=a.map(l=>ha(l)),o=tB(e,n),[u]=n6(s,o);return a.find(l=>ha(l)===u)}function tB(r,e){const t=jm(r);if(e)return[ha(t[e])];const n=Object.values(t);return n.length>0?n.map(i=>ha(i)):[r.getCenter()]}function nw(r,e){return Im(r)||yu(r)?_y(r,e):Vo(r,e)}function Vo(r,e){if(!r||!e)return[0,0,0];if(zs(r))return r;if(r.attributes.linkToCenter)return r.getPosition();const t=zs(e)?e:yu(e)?e.getCenter():e.getPosition();return Lc(t,r.getBounds())}function _y(r,e){if(!r||!e)return[0,0,0];const t=zs(e)?e:yu(e)?e.getCenter():e.getPosition();return r.getIntersectPoint(t)||r.getCenter()}function rw(r,e="bottom",t=0,n=0,i=!1){const a=e.split("-"),[s,o]=xi(r,e),u=a.includes("left")?"right":a.includes("right")?"left":"center";let l=a.includes("top")?"bottom":a.includes("bottom")?"top":"middle";return i&&(l=l==="top"?"bottom":l==="bottom"?"top":l),{transform:[["translate",s+t,o+n]],textBaseline:l,textAlign:u}}function nB(r,e){return[[0,-r],[e*Math.cos(3*Math.PI/10),-e*Math.sin(3*Math.PI/10)],[r*Math.cos(Math.PI/10),-r*Math.sin(Math.PI/10)],[e*Math.cos(Math.PI/10),e*Math.sin(Math.PI/10)],[r*Math.cos(3*Math.PI/10),r*Math.sin(3*Math.PI/10)],[0,e],[-r*Math.cos(3*Math.PI/10),r*Math.sin(3*Math.PI/10)],[-e*Math.cos(Math.PI/10),e*Math.sin(Math.PI/10)],[-r*Math.cos(Math.PI/10),-r*Math.sin(Math.PI/10)],[-e*Math.cos(3*Math.PI/10),-e*Math.sin(3*Math.PI/10)]]}function rB(r,e){const t={};return t.top=[0,-r],t.left=[-r*Math.cos(Math.PI/10),-r*Math.sin(Math.PI/10)],t["left-bottom"]=[-r*Math.cos(3*Math.PI/10),r*Math.sin(3*Math.PI/10)],t.bottom=[0,e],t["right-bottom"]=[r*Math.cos(3*Math.PI/10),r*Math.sin(3*Math.PI/10)],t.right=t.default=[r*Math.cos(Math.PI/10),-r*Math.sin(Math.PI/10)],t}function iB(r,e,t){const n=e/2,i=r/2,a={up:[[-i,n],[i,n],[0,-n]],left:[[-i,0],[i,n],[i,-n]],right:[[-i,n],[-i,-n],[i,0]],down:[[-i,-n],[i,-n],[0,n]]};return a[t]||a.up}function aB(r,e,t){const n=e/2,i=r/2,a={};return t==="down"?(a.bottom=a.default=[0,n],a.right=[i,-n],a.left=[-i,-n]):t==="left"?(a.top=[i,-n],a.bottom=[i,n],a.left=a.default=[-i,0]):t==="right"?(a.top=[-i,-n],a.bottom=[-i,n],a.right=a.default=[i,0]):(a.left=[-i,n],a.top=a.default=[0,-n],a.right=[i,n]),a}function sB(r,e){return[[0,-e/2],[r/2,0],[0,e/2],[-r/2,0]]}function oB(r){return Fn(r,["style","visibility"])!=="hidden"}function uB(r,e){const{zIndex:t,transform:n,transformOrigin:i,visibility:a,cursor:s,clipPath:o,component:u}=e,l=Kj(e,["zIndex","transform","transformOrigin","visibility","cursor","clipPath","component"]);Object.assign(r.attributes,l),n&&r.setAttribute("transform",n),Ee(t)&&r.setAttribute("zIndex",t),i&&r.setAttribute("transformOrigin",i),a&&r.setAttribute("visibility",a),s&&r.setAttribute("cursor",s),o&&r.setAttribute("clipPath",o),u&&r.setAttribute("component",u)}function Ty(r,e){"update"in r?r.update(e):r.attr(e)}function lB(r){return[[0,r],[r*Math.sqrt(3)/2,r/2],[r*Math.sqrt(3)/2,-r/2],[0,-r],[-r*Math.sqrt(3)/2,-r/2],[-r*Math.sqrt(3)/2,r/2]]}function cB(r){jo(r,"__to_be_destroyed__",!0)}function Yc(r){return Fn(r,"__to_be_destroyed__",!1)}var dB=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})};class Uc extends pr{constructor(e,t){super(e,Object.assign({},Uc.defaultOptions,t)),this.onCollapseExpand=n=>dB(this,void 0,void 0,function*(){if(!this.validate(n))return;const{target:i}=n;if(!Zj(i))return;const a=i.id,{model:s,graph:o}=this.context,u=s.getElementDataById(a);if(!u)return!1;const{onCollapse:l,onExpand:c,animation:d,align:h}=this.options;Jn(u)?(yield o.expandElement(a,{animation:d,align:h}),c==null||c(a)):(yield o.collapseElement(a,{animation:d,align:h}),l==null||l(a))}),this.bindEvents()}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}bindEvents(){const{graph:e}=this.context,{trigger:t}=this.options;e.on(`node:${t}`,this.onCollapseExpand),e.on(`combo:${t}`,this.onCollapseExpand)}unbindEvents(){const{graph:e}=this.context,{trigger:t}=this.options;e.off(`node:${t}`,this.onCollapseExpand),e.off(`combo:${t}`,this.onCollapseExpand)}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}destroy(){this.unbindEvents(),super.destroy()}}Uc.defaultOptions={enable:!0,animation:!0,trigger:ae.DBLCLICK,align:!0};var fl=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})};const hB="g6-create-edge-assist-edge-id",gl="g6-create-edge-assist-node-id";class Hc extends pr{constructor(e,t){super(e,Object.assign({},Hc.defaultOptions,t)),this.drop=n=>fl(this,void 0,void 0,function*(){const{targetType:i}=n;["combo","node"].includes(i)&&this.source?yield this.handleCreateEdge(n):yield this.cancelEdge()}),this.handleCreateEdge=n=>fl(this,void 0,void 0,function*(){var i,a,s;if(!this.validate(n))return;const{graph:o,canvas:u,batch:l,element:c}=this.context,{style:d}=this.options;if(this.source){this.createEdge(n),yield this.cancelEdge();return}l.startBatch(),u.setCursor("crosshair"),this.source=this.getSelectedNodeIDs([n.target.id])[0];const h=o.getElementData(this.source);o.addNodeData([{id:gl,style:{visibility:"hidden",ports:[{key:"port-1",placement:[.5,.5]}],x:(i=h.style)===null||i===void 0?void 0:i.x,y:(a=h.style)===null||a===void 0?void 0:a.y}}]),o.addEdgeData([{id:hB,source:this.source,target:gl,style:Object.assign({pointerEvents:"none"},d)}]),yield(s=c.draw({animation:!1}))===null||s===void 0?void 0:s.finished}),this.updateAssistEdge=n=>fl(this,void 0,void 0,function*(){var i;if(!this.source)return;const{model:a,element:s}=this.context;a.translateNodeTo(gl,[n.canvas.x,n.canvas.y]),yield(i=s.draw({animation:!1,silence:!0}))===null||i===void 0?void 0:i.finished}),this.createEdge=n=>{var i,a;const{graph:s}=this.context,{style:o,onFinish:u,onCreate:l}=this.options;if(((i=n.target)===null||i===void 0?void 0:i.id)===void 0||this.source===void 0)return;const d=(a=this.getSelectedNodeIDs([n.target.id]))===null||a===void 0?void 0:a[0],h=`${this.source}-${d}-${KL()}`,f=l({id:h,source:this.source,target:d,style:o});s.addEdgeData([f]),u(f)},this.cancelEdge=()=>fl(this,void 0,void 0,function*(){var n;if(!this.source)return;const{graph:i,element:a,batch:s}=this.context;i.removeNodeData([gl]),this.source=void 0,yield(n=a.draw({animation:!1}))===null||n===void 0?void 0:n.finished,s.endBatch()}),this.bindEvents()}update(e){super.update(e),this.bindEvents()}bindEvents(){const{graph:e}=this.context,{trigger:t}=this.options;this.unbindEvents(),t==="click"?(e.on(Or.CLICK,this.handleCreateEdge),e.on(Pa.CLICK,this.handleCreateEdge),e.on(Ai.CLICK,this.cancelEdge),e.on(rc.CLICK,this.cancelEdge)):(e.on(Or.DRAG_START,this.handleCreateEdge),e.on(Pa.DRAG_START,this.handleCreateEdge),e.on(ae.POINTER_UP,this.drop)),e.on(ae.POINTER_MOVE,this.updateAssistEdge)}getSelectedNodeIDs(e){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(t=>t.id).concat(e)))}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}unbindEvents(){const{graph:e}=this.context;e.off(Or.CLICK,this.handleCreateEdge),e.off(Pa.CLICK,this.handleCreateEdge),e.off(Ai.CLICK,this.cancelEdge),e.off(rc.CLICK,this.cancelEdge),e.off(Or.DRAG_START,this.handleCreateEdge),e.off(Pa.DRAG_START,this.handleCreateEdge),e.off(ae.POINTER_UP,this.drop),e.off(ae.POINTER_MOVE,this.updateAssistEdge)}destroy(){this.unbindEvents(),super.destroy()}}Hc.defaultOptions={animation:!0,enable:!0,style:{},trigger:"drag",onCreate:r=>r,onFinish:()=>{}};var iw=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})};class Xc extends pr{constructor(e,t){super(e,Object.assign({},Xc.defaultOptions,t)),this.isDragging=!1,this.onDragStart=n=>{this.validate(n)&&(this.isDragging=!0,this.context.canvas.setCursor("grabbing"))},this.onDrag=n=>{if(!this.isDragging)return;const{x:i,y:a}=n.movement;i|a&&this.translate([i,a],!1)},this.onDragEnd=()=>{var n,i;this.isDragging=!1,this.context.canvas.setCursor(this.defaultCursor),(i=(n=this.options).onFinish)===null||i===void 0||i.call(n)},this.invokeOnFinish=su(()=>{var n,i;(i=(n=this.options).onFinish)===null||i===void 0||i.call(n)},300),this.shortcut=new Ws(e.graph),this.bindEvents(),this.defaultCursor=this.context.canvas.getConfig().cursor||"default"}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}bindEvents(){const{trigger:e}=this.options;if(Yt(e)){const{up:t=[],down:n=[],left:i=[],right:a=[]}=e;this.shortcut.bind(t,s=>this.onTranslate([0,1],s)),this.shortcut.bind(n,s=>this.onTranslate([0,-1],s)),this.shortcut.bind(i,s=>this.onTranslate([1,0],s)),this.shortcut.bind(a,s=>this.onTranslate([-1,0],s))}else{const{graph:t}=this.context;t.on(ae.DRAG_START,this.onDragStart),t.on(ae.DRAG,this.onDrag),t.on(ae.DRAG_END,this.onDragEnd)}}onTranslate(e,t){return iw(this,void 0,void 0,function*(){if(!this.validate(t))return;const{sensitivity:n}=this.options,i=n*-1;yield this.translate(wi(e,i),this.options.animation),this.invokeOnFinish()})}translate(e,t){return iw(this,void 0,void 0,function*(){e=this.clampByDirection(e),e=this.clampByRange(e),yield this.context.graph.translateBy(e,t)})}clampByDirection([e,t]){const{direction:n}=this.options;return n==="x"?t=0:n==="y"&&(e=0),[e,t]}clampByRange([e,t]){const{viewport:n,canvas:i}=this.context,[a,s]=i.getSize(),[o,u,l,c]=hi(this.options.range),d=[s*o,a*u,s*l,a*c],h=va(Em(n.getCanvasCenter()),d),f=ot(n.getViewportCenter(),[e,t,0]);if(!$r(f,h)){const{min:[g,v],max:[p,y]}=h;(f[0]<g&&e>0||f[0]>p&&e<0)&&(e=0),(f[1]<v&&t>0||f[1]>y&&t<0)&&(t=0)}return[e,t]}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return typeof t=="function"?t(e):!!t}unbindEvents(){this.shortcut.unbindAll();const{graph:e}=this.context;e.off(ae.DRAG_START,this.onDragStart),e.off(ae.DRAG,this.onDrag),e.off(ae.DRAG_END,this.onDragEnd)}destroy(){this.shortcut.destroy(),this.unbindEvents(),this.context.canvas.setCursor(this.defaultCursor),super.destroy()}}Xc.defaultOptions={enable:r=>"targetType"in r?r.targetType==="canvas":!0,sensitivity:10,direction:"both",range:1/0};var aw=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})};class mu extends pr{constructor(e,t){super(e,Object.assign({},mu.defaultOptions,t)),this.enable=!1,this.enableElements=["node","combo"],this.target=[],this.shadowOrigin=[0,0],this.hiddenEdges=[],this.isDragging=!1,this.onDrop=n=>aw(this,void 0,void 0,function*(){var i;if(this.options.dropEffect!=="link")return;const{model:a,element:s}=this.context,o=n.target.id;this.target.forEach(u=>{const l=a.getParentData(u,ut);l&&Q(l)===o&&a.refreshComboData(o),a.setParent(u,o,ut)}),yield(i=s==null?void 0:s.draw({animation:!0}))===null||i===void 0?void 0:i.finished}),this.setCursor=n=>{if(this.isDragging)return;const{type:i}=n,{canvas:a}=this.context,{cursor:s}=this.options;i===ae.POINTER_ENTER?a.setCursor((s==null?void 0:s.grab)||"grab"):a.setCursor((s==null?void 0:s.default)||"default")},this.onDragStart=this.onDragStart.bind(this),this.onDrag=this.onDrag.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.onDrop=this.onDrop.bind(this),this.bindEvents()}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}bindEvents(){const{graph:e,canvas:t}=this.context,n=t.getLayer().getContextService().$canvas;n&&(n.addEventListener("blur",this.onDragEnd),n.addEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(i=>{e.on(`${i}:${ae.DRAG_START}`,this.onDragStart),e.on(`${i}:${ae.DRAG}`,this.onDrag),e.on(`${i}:${ae.DRAG_END}`,this.onDragEnd),e.on(`${i}:${ae.POINTER_ENTER}`,this.setCursor),e.on(`${i}:${ae.POINTER_LEAVE}`,this.setCursor)}),["link"].includes(this.options.dropEffect)&&(e.on(Pa.DROP,this.onDrop),e.on(Ai.DROP,this.onDrop))}getSelectedNodeIDs(e){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(t=>t.id).concat(e)))}getDelta(e){const t=this.context.graph.getZoom();return qr([e.dx,e.dy],t)}onDragStart(e){var t;if(this.enable=this.validate(e),!this.enable)return;const{batch:n,canvas:i,graph:a}=this.context;i.setCursor(((t=this.options.cursor)===null||t===void 0?void 0:t.grabbing)||"grabbing"),this.isDragging=!0,n.startBatch();const s=e.target.id;a.getElementState(s).includes(this.options.state)?this.target=this.getSelectedNodeIDs([s]):this.target=[s],this.hideEdge(),this.context.graph.frontElement(this.target),this.options.shadow&&this.createShadow(this.target)}onDrag(e){if(!this.enable)return;const t=this.getDelta(e);this.options.shadow?this.moveShadow(t):this.moveElement(this.target,t)}onDragEnd(){var e,t,n;if(this.enable=!1,this.options.shadow){if(!this.shadow)return;this.shadow.style.visibility="hidden";const{x:s=0,y:o=0}=this.shadow.attributes,[u,l]=ot([+s,+o],this.shadowOrigin);this.moveElement(this.target,[u,l])}this.showEdges(),(t=(e=this.options).onFinish)===null||t===void 0||t.call(e,this.target);const{batch:i,canvas:a}=this.context;i.endBatch(),a.setCursor(((n=this.options.cursor)===null||n===void 0?void 0:n.grab)||"grab"),this.isDragging=!1,this.target=[]}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}moveElement(e,t){return aw(this,void 0,void 0,function*(){const{graph:n,model:i}=this.context,{dropEffect:a}=this.options;a==="move"&&e.forEach(s=>i.refreshComboData(s)),n.translateElementBy(Object.fromEntries(e.map(s=>[s,t])),!1)})}moveShadow(e){if(!this.shadow)return;const{x:t=0,y:n=0}=this.shadow.attributes,[i,a]=e;this.shadow.attr({x:+t+i,y:+n+a})}createShadow(e){const t=Qt(this.options,"shadow"),n=hu(e.map(l=>this.context.element.getElement(l).getBounds())),[i,a]=n.min;this.shadowOrigin=[i,a];const[s,o]=pa(n),u={width:s,height:o,x:i,y:a};this.shadow?this.shadow.attr(Object.assign(Object.assign(Object.assign({},t),u),{visibility:"visible"})):(this.shadow=new Sn({style:Object.assign(Object.assign(Object.assign({$layer:"transient"},t),u),{pointerEvents:"none"})}),this.context.canvas.appendChild(this.shadow))}showEdges(){this.options.shadow||this.hiddenEdges.length===0||(this.context.graph.showElement(this.hiddenEdges),this.hiddenEdges=[])}hideEdge(){const{hideEdge:e,shadow:t}=this.options;if(e==="none"||t)return;const{graph:n}=this.context;e==="all"?this.hiddenEdges=n.getEdgeData().map(Q):this.hiddenEdges=Array.from(new Set(this.target.map(i=>n.getRelatedEdgesData(i,e).map(Q)).flat())),n.hideElement(this.hiddenEdges)}unbindEvents(){const{graph:e,canvas:t}=this.context,n=t.getLayer().getContextService().$canvas;n&&(n.removeEventListener("blur",this.onDragEnd),n.removeEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(i=>{e.off(`${i}:${ae.DRAG_START}`,this.onDragStart),e.off(`${i}:${ae.DRAG}`,this.onDrag),e.off(`${i}:${ae.DRAG_END}`,this.onDragEnd),e.off(`${i}:${ae.POINTER_ENTER}`,this.setCursor),e.off(`${i}:${ae.POINTER_LEAVE}`,this.setCursor)}),e.off(`combo:${ae.DROP}`,this.onDrop),e.off(`canvas:${ae.DROP}`,this.onDrop)}destroy(){var e;this.unbindEvents(),(e=this.shadow)===null||e===void 0||e.destroy(),super.destroy()}}mu.defaultOptions={animation:!0,enable:r=>["node","combo"].includes(r.targetType),dropEffect:"move",state:"selected",hideEdge:"none",shadow:!1,shadowZIndex:100,shadowFill:"#F3F9FF",shadowFillOpacity:.5,shadowStroke:"#1890FF",shadowStrokeOpacity:.9,shadowLineDash:[5,5],cursor:{default:"default",grab:"grab",grabbing:"grabbing"}};var fB="*",Kc=function(){function r(){this._events={}}return r.prototype.on=function(e,t,n){return this._events[e]||(this._events[e]=[]),this._events[e].push({callback:t,once:!!n}),this},r.prototype.once=function(e,t){return this.on(e,t,!0)},r.prototype.emit=function(e){for(var t=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var a=this._events[e]||[],s=this._events[fB]||[],o=function(u){for(var l=u.length,c=0;c<l;c++)if(u[c]){var d=u[c],h=d.callback,f=d.once;f&&(u.splice(c,1),u.length===0&&delete t._events[e],l--,c--),h.apply(t,n)}};o(a),o(s)},r.prototype.off=function(e,t){if(!e)this._events={};else if(!t)delete this._events[e];else{for(var n=this._events[e]||[],i=n.length,a=0;a<i;a++)n[a].callback===t&&(n.splice(a,1),i--,a--);n.length===0&&delete this._events[e]}return this},r.prototype.getEvents=function(){return this._events},r}();function Oy(r,e,t,n){for(;r.length;){const i=r.shift();if(t(i))return!0;e.add(i.id),n(i.id).forEach(s=>{e.has(s.id)||(e.add(s.id),r.push(s))})}return!1}function dc(r,e,t,n){if(t(r))return!0;e.add(r.id);for(const a of n(r.id))if(!e.has(a.id)&&dc(a,e,t,n))return!0;return!1}const sw=()=>!0;class gB{constructor(e){xt(this,"graph");xt(this,"nodeFilter");xt(this,"edgeFilter");xt(this,"cacheEnabled");xt(this,"inEdgesMap",new Map);xt(this,"outEdgesMap",new Map);xt(this,"bothEdgesMap",new Map);xt(this,"allNodesMap",new Map);xt(this,"allEdgesMap",new Map);xt(this,"clearCache",()=>{this.inEdgesMap.clear(),this.outEdgesMap.clear(),this.bothEdgesMap.clear(),this.allNodesMap.clear(),this.allEdgesMap.clear()});xt(this,"refreshCache",()=>{this.clearCache(),this.updateCache(this.graph.getAllNodes().map(e=>e.id))});xt(this,"updateCache",e=>{const t=new Set;e.forEach(n=>{const i=this.bothEdgesMap.get(n);if(i&&i.forEach(a=>t.add(a.id)),!this.hasNode(n))this.inEdgesMap.delete(n),this.outEdgesMap.delete(n),this.bothEdgesMap.delete(n),this.allNodesMap.delete(n);else{const a=this.graph.getRelatedEdges(n,"in").filter(this.edgeFilter),s=this.graph.getRelatedEdges(n,"out").filter(this.edgeFilter),o=Array.from(new Set([...a,...s]));o.forEach(u=>t.add(u.id)),this.inEdgesMap.set(n,a),this.outEdgesMap.set(n,s),this.bothEdgesMap.set(n,o),this.allNodesMap.set(n,this.graph.getNode(n))}}),t.forEach(n=>{this.hasEdge(n)?this.allEdgesMap.set(n,this.graph.getEdge(n)):this.allEdgesMap.delete(n)})});xt(this,"handleGraphChanged",e=>{const t=new Set;e.changes.forEach(n=>{switch(n.type){case"NodeAdded":t.add(n.value.id);break;case"NodeDataUpdated":t.add(n.id);break;case"EdgeAdded":t.add(n.value.source),t.add(n.value.target);break;case"EdgeUpdated":(n.propertyName==="source"||n.propertyName==="target")&&(t.add(n.oldValue),t.add(n.newValue));break;case"EdgeDataUpdated":if(e.graph.hasEdge(n.id)){const i=e.graph.getEdge(n.id);t.add(i.source),t.add(i.target)}break;case"EdgeRemoved":t.add(n.value.source),t.add(n.value.target);break;case"NodeRemoved":t.add(n.value.id);break}}),this.updateCache(t)});this.graph=e.graph;const t=e.nodeFilter||sw,n=e.edgeFilter||sw;this.nodeFilter=t,this.edgeFilter=i=>{const{source:a,target:s}=this.graph.getEdgeDetail(i.id);return!t(a)||!t(s)?!1:n(i,a,s)},e.cache==="auto"?(this.cacheEnabled=!0,this.startAutoCache()):e.cache==="manual"?this.cacheEnabled=!0:this.cacheEnabled=!1}startAutoCache(){this.refreshCache(),this.graph.on("changed",this.handleGraphChanged)}stopAutoCache(){this.graph.off("changed",this.handleGraphChanged)}checkNodeExistence(e){this.getNode(e)}hasNode(e){if(!this.graph.hasNode(e))return!1;const t=this.graph.getNode(e);return this.nodeFilter(t)}areNeighbors(e,t){return this.checkNodeExistence(e),this.getNeighbors(t).some(n=>n.id===e)}getNode(e){const t=this.graph.getNode(e);if(!this.nodeFilter(t))throw new Error("Node not found for id: "+e);return t}getRelatedEdges(e,t){return this.checkNodeExistence(e),this.cacheEnabled?t==="in"?this.inEdgesMap.get(e):t==="out"?this.outEdgesMap.get(e):this.bothEdgesMap.get(e):this.graph.getRelatedEdges(e,t).filter(this.edgeFilter)}getDegree(e,t){return this.getRelatedEdges(e,t).length}getSuccessors(e){const n=this.getRelatedEdges(e,"out").map(i=>this.getNode(i.target));return Array.from(new Set(n))}getPredecessors(e){const n=this.getRelatedEdges(e,"in").map(i=>this.getNode(i.source));return Array.from(new Set(n))}getNeighbors(e){const t=this.getPredecessors(e),n=this.getSuccessors(e);return Array.from(new Set([...t,...n]))}hasEdge(e){if(!this.graph.hasEdge(e))return!1;const t=this.graph.getEdge(e);return this.edgeFilter(t)}getEdge(e){const t=this.graph.getEdge(e);if(!this.edgeFilter(t))throw new Error("Edge not found for id: "+e);return t}getEdgeDetail(e){const t=this.getEdge(e);return{edge:t,source:this.getNode(t.source),target:this.getNode(t.target)}}hasTreeStructure(e){return this.graph.hasTreeStructure(e)}getRoots(e){return this.graph.getRoots(e).filter(this.nodeFilter)}getChildren(e,t){return this.checkNodeExistence(e),this.graph.getChildren(e,t).filter(this.nodeFilter)}getParent(e,t){this.checkNodeExistence(e);const n=this.graph.getParent(e,t);return!n||!this.nodeFilter(n)?null:n}getAllNodes(){return this.cacheEnabled?Array.from(this.allNodesMap.values()):this.graph.getAllNodes().filter(this.nodeFilter)}getAllEdges(){return this.cacheEnabled?Array.from(this.allEdgesMap.values()):this.graph.getAllEdges().filter(this.edgeFilter)}bfs(e,t,n="out"){const i={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];Oy([this.getNode(e)],new Set,t,i)}dfs(e,t,n="out"){const i={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];dc(this.getNode(e),new Set,t,i)}}let cn=class OA extends Kc{constructor(t){super();xt(this,"nodeMap",new Map);xt(this,"edgeMap",new Map);xt(this,"inEdgesMap",new Map);xt(this,"outEdgesMap",new Map);xt(this,"bothEdgesMap",new Map);xt(this,"treeIndices",new Map);xt(this,"changes",[]);xt(this,"batchCount",0);xt(this,"onChanged",()=>{});xt(this,"batch",t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()});t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}commit(){const t=this.changes;this.changes=[];const n={graph:this,changes:t};this.emit("changed",n),this.onChanged(n)}reduceChanges(t){let n=[];return t.forEach(i=>{switch(i.type){case"NodeRemoved":{let a=!1;n=n.filter(s=>{if(s.type==="NodeAdded"){const o=s.value.id===i.value.id;return o&&(a=!0),!o}else{if(s.type==="NodeDataUpdated")return s.id!==i.value.id;if(s.type==="TreeStructureChanged")return s.nodeId!==i.value.id}return!0}),a||n.push(i);break}case"EdgeRemoved":{let a=!1;n=n.filter(s=>{if(s.type==="EdgeAdded"){const o=s.value.id===i.value.id;return o&&(a=!0),!o}else if(s.type==="EdgeDataUpdated"||s.type==="EdgeUpdated")return s.id!==i.value.id;return!0}),a||n.push(i);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const a=n.findIndex(o=>o.type===i.type&&o.id===i.id&&(i.propertyName===void 0||o.propertyName===i.propertyName)),s=n[a];s?i.propertyName!==void 0?s.newValue=i.newValue:(n.splice(a,1),n.push(i)):n.push(i);break}case"TreeStructureDetached":{n=n.filter(a=>a.type==="TreeStructureAttached"||a.type==="TreeStructureChanged"?a.treeKey!==i.treeKey:!0),n.push(i);break}case"TreeStructureChanged":{const a=n.find(s=>s.type==="TreeStructureChanged"&&s.treeKey===i.treeKey&&s.nodeId===i.nodeId);a?a.newParentId=i.newParentId:n.push(i);break}default:n.push(i);break}}),n}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,n){return this.getNeighbors(n).some(i=>i.id===t)}getNode(t){const n=this.nodeMap.get(t);if(!n)throw new Error("Node not found for id: "+t);return n}getRelatedEdges(t,n){if(this.checkNodeExistence(t),n==="in"){const i=this.inEdgesMap.get(t);return Array.from(i)}else if(n==="out"){const i=this.outEdgesMap.get(t);return Array.from(i)}else{const i=this.bothEdgesMap.get(t);return Array.from(i)}}getDegree(t,n){return this.getRelatedEdges(t,n).length}getSuccessors(t){const i=this.getRelatedEdges(t,"out").map(a=>this.getNode(a.target));return Array.from(new Set(i))}getPredecessors(t){const i=this.getRelatedEdges(t,"in").map(a=>this.getNode(a.source));return Array.from(new Set(i))}getNeighbors(t){const n=this.getPredecessors(t),i=this.getSuccessors(t);return Array.from(new Set([...n,...i]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach(n=>{n.childrenMap.set(t.id,new Set)}),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch(()=>{for(const n of t)this.doAddNode(n)})}addNode(t){this.addNodes([t])}doRemoveNode(t){const n=this.getNode(t),i=this.bothEdgesMap.get(t);i==null||i.forEach(a=>this.doRemoveEdge(a.id)),this.nodeMap.delete(t),this.treeIndices.forEach(a=>{var o,u;(o=a.childrenMap.get(t))==null||o.forEach(l=>{a.parentMap.delete(l.id)});const s=a.parentMap.get(t);s&&((u=a.childrenMap.get(s.id))==null||u.delete(n)),a.parentMap.delete(t),a.childrenMap.delete(t)}),this.bothEdgesMap.delete(t),this.inEdgesMap.delete(t),this.outEdgesMap.delete(t),this.changes.push({type:"NodeRemoved",value:n})}removeNodes(t){this.batch(()=>{t.forEach(n=>this.doRemoveNode(n))})}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,n,i){const a=this.getNode(t);this.batch(()=>{const s=a.data[n],o=i;a.data[n]=o,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:n,oldValue:s,newValue:o})})}mergeNodeData(t,n){this.batch(()=>{Object.entries(n).forEach(([i,a])=>{this.updateNodeDataProperty(t,i,a)})})}updateNodeData(...t){const n=t[0],i=this.getNode(n);if(typeof t[1]=="string"){this.updateNodeDataProperty(n,t[1],t[2]);return}let a;if(typeof t[1]=="function"){const s=t[1];a=s(i.data)}else typeof t[1]=="object"&&(a=t[1]);this.batch(()=>{const s=i.data,o=a;i.data=a,this.changes.push({type:"NodeDataUpdated",id:n,oldValue:s,newValue:o})})}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const n=this.getEdge(t);return{edge:n,source:this.getNode(n.source),target:this.getNode(n.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const n=this.inEdgesMap.get(t.target),i=this.outEdgesMap.get(t.source),a=this.bothEdgesMap.get(t.source),s=this.bothEdgesMap.get(t.target);n.add(t),i.add(t),a.add(t),s.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch(()=>{for(const n of t)this.doAddEdge(n)})}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const n=this.getEdge(t),i=this.outEdgesMap.get(n.source),a=this.inEdgesMap.get(n.target),s=this.bothEdgesMap.get(n.source),o=this.bothEdgesMap.get(n.target);i.delete(n),a.delete(n),s.delete(n),o.delete(n),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:n})}removeEdges(t){this.batch(()=>{t.forEach(n=>this.doRemoveEdge(n))})}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,n){const i=this.getEdge(t);this.checkNodeExistence(n);const a=i.source,s=n;this.outEdgesMap.get(a).delete(i),this.bothEdgesMap.get(a).delete(i),this.outEdgesMap.get(s).add(i),this.bothEdgesMap.get(s).add(i),i.source=n,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:a,newValue:s})})}updateEdgeTarget(t,n){const i=this.getEdge(t);this.checkNodeExistence(n);const a=i.target,s=n;this.inEdgesMap.get(a).delete(i),this.bothEdgesMap.get(a).delete(i),this.inEdgesMap.get(s).add(i),this.bothEdgesMap.get(s).add(i),i.target=n,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:a,newValue:s})})}updateEdgeDataProperty(t,n,i){const a=this.getEdge(t);this.batch(()=>{const s=a.data[n],o=i;a.data[n]=o,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:n,oldValue:s,newValue:o})})}updateEdgeData(...t){const n=t[0],i=this.getEdge(n);if(typeof t[1]=="string"){this.updateEdgeDataProperty(n,t[1],t[2]);return}let a;if(typeof t[1]=="function"){const s=t[1];a=s(i.data)}else typeof t[1]=="object"&&(a=t[1]);this.batch(()=>{const s=i.data,o=a;i.data=a,this.changes.push({type:"EdgeDataUpdated",id:n,oldValue:s,newValue:o})})}mergeEdgeData(t,n){this.batch(()=>{Object.entries(n).forEach(([i,a])=>{this.updateEdgeDataProperty(t,i,a)})})}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch(()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})}))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch(()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})})}addTree(t,n){this.batch(()=>{this.attachTreeStructure(n);const i=[],a=Array.isArray(t)?t:[t];for(;a.length;){const s=a.shift();i.push(s),s.children&&a.push(...s.children)}this.addNodes(i),i.forEach(s=>{var o;(o=s.children)==null||o.forEach(u=>{this.setParent(u.id,s.id,n)})})})}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter(n=>!this.getParent(n.id,t))}getChildren(t,n){this.checkNodeExistence(t),this.checkTreeExistence(n);const a=this.treeIndices.get(n).childrenMap.get(t);return Array.from(a||[])}getParent(t,n){return this.checkNodeExistence(t),this.checkTreeExistence(n),this.treeIndices.get(n).parentMap.get(t)||null}getAncestors(t,n){const i=[];let a=this.getNode(t),s;for(;s=this.getParent(a.id,n);)i.push(s),a=s;return i}setParent(t,n,i){var c,d;this.checkTreeExistence(i);const a=this.treeIndices.get(i);if(!a)return;const s=this.getNode(t),o=a.parentMap.get(t);if((o==null?void 0:o.id)===n)return;if(n==null){o&&((c=a.childrenMap.get(o.id))==null||c.delete(s)),a.parentMap.delete(t);return}const u=this.getNode(n);a.parentMap.set(t,u),o&&((d=a.childrenMap.get(o.id))==null||d.delete(s));let l=a.childrenMap.get(u.id);l||(l=new Set,a.childrenMap.set(u.id,l)),l.add(s),this.batch(()=>{this.changes.push({type:"TreeStructureChanged",treeKey:i,nodeId:t,oldParentId:o==null?void 0:o.id,newParentId:u.id})})}dfsTree(t,n,i){const a=s=>this.getChildren(s,i);return dc(this.getNode(t),new Set,n,a)}bfsTree(t,n,i){const a=s=>this.getChildren(s,i);return Oy([this.getNode(t)],new Set,n,a)}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,n,i="out"){const a={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[i];return Oy([this.getNode(t)],new Set,n,a)}dfs(t,n,i="out"){const a={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[i];return dc(this.getNode(t),new Set,n,a)}clone(){const t=this.getAllNodes().map(a=>({...a,data:{...a.data}})),n=this.getAllEdges().map(a=>({...a,data:{...a.data}})),i=new OA({nodes:t,edges:n});return this.treeIndices.forEach(({parentMap:a,childrenMap:s},o)=>{const u=new Map;a.forEach((c,d)=>{u.set(d,i.getNode(c.id))});const l=new Map;s.forEach((c,d)=>{l.set(d,new Set(Array.from(c).map(h=>i.getNode(h.id))))}),i.treeIndices.set(o,{parentMap:u,childrenMap:l})}),i}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}createView(t){return new gB({graph:this,...t})}};class Zc{constructor(e,t){this.context=e,this.options=t||{}}}var pB=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})},vB=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};function yB(r){const{type:e}=r;return["compact-box","mindmap","dendrogram","indented"].includes(e)}function mB(r){return!Array.isArray(r)&&(r==null?void 0:r.preLayout)}function Pl(r){const{nodes:e,edges:t}=r,n={nodes:[],edges:[],combos:[]};return e.forEach(i=>{const a=i.data._isCombo?n.combos:n.nodes,{x:s,y:o,z:u=0}=i.data;a==null||a.push({id:i.id,style:{x:s,y:o,z:u}})}),t.forEach(i=>{const{id:a,source:s,target:o,data:{points:u=[],controlPoints:l=u.slice(1,u.length-1)}}=i;n.edges.push({id:a,source:s,target:o,style:Object.assign({},l!=null&&l.length?{controlPoints:l.map(En)}:{})})}),n}function bB(r,e){class t extends Zc{constructor(i,a){if(super(i,a),this.instance=new r({}),this.id=this.instance.id,"stop"in this.instance&&"tick"in this.instance){const s=this.instance;this.stop=s.stop.bind(s),this.tick=o=>{const u=s.tick(o);return Pl(u)}}}execute(i,a){return pB(this,void 0,void 0,function*(){return Pl(yield this.instance.execute(this.graphData2LayoutModel(i),this.transformOptions(Gn({},this.options,a))))})}transformOptions(i){const{onTick:a}=i;return a&&(i.onTick=s=>a(Pl(s))),i}graphData2LayoutModel(i){const{nodes:a=[],edges:s=[],combos:o=[]}=i,u=a.map(f=>{const g=Q(f),{data:v,style:p,combo:y}=f,m=vB(f,["data","style","combo"]),w={id:g,data:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},v),{data:v}),y?{parentId:y}:{}),{style:p}),m)};return p!=null&&p.x&&Object.assign(w.data,{x:p.x}),p!=null&&p.y&&Object.assign(w.data,{y:p.y}),p!=null&&p.z&&Object.assign(w.data,{z:p.z}),w}),l=new Map(u.map(f=>[f.id,f])),c=s.filter(f=>{const{source:g,target:v}=f;return l.has(g)&&l.has(v)}).map(f=>{const{source:g,target:v,data:p,style:y}=f;return{id:Q(f),source:g,target:v,data:Object.assign({},p),style:Object.assign({},y)}}),d=o.map(f=>({id:Q(f),data:Object.assign({_isCombo:!0},f.data),style:Object.assign({},f.style)})),h=new cn({nodes:[...u,...d],edges:c});return e.model.model.hasTreeStructure(ut)&&(h.attachTreeStructure(ut),u.forEach(f=>{const g=e.model.model.getParent(f.id,ut);g&&h.hasNode(g.id)&&h.setParent(f.id,g.id,ut)})),h}}return t}function Ih(r,e,...t){if(e in r)return r[e](...t);if("instance"in r){const n=r.instance;if(e in n)return n[e](...t)}return null}function ow(r,e){if(e in r)return r[e];if("instance"in r){const t=r.instance;if(e in t)return t[e]}return null}var wB=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})};class xB extends mu{get forceLayoutInstance(){return this.context.layout.getLayoutInstance().find(e=>["d3-force","d3-force-3d"].includes(e==null?void 0:e.id))}validate(e){return this.context.layout?this.forceLayoutInstance?super.validate(e):(di.warn("DragElementForce only works with d3-force or d3-force-3d layout"),!1):!1}moveElement(e,t){return wB(this,void 0,void 0,function*(){const n=this.forceLayoutInstance;this.context.graph.getNodeData(e).forEach((i,a)=>{const{x:s=0,y:o=0}=i.style||{};n&&Ih(n,"setFixedPosition",e[a],[...$e([+s,+o],t)])})})}onDragStart(e){if(this.enable=this.validate(e),!this.enable)return;this.target=this.getSelectedNodeIDs([e.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target);const t=this.forceLayoutInstance;t&&ow(t,"simulation").alphaTarget(.3).restart(),this.context.graph.getNodeData(this.target).forEach(n=>{const{x:i=0,y:a=0}=n.style||{};t&&Ih(t,"setFixedPosition",Q(n),[+i,+a])})}onDrag(e){if(!this.enable)return;const t=this.getDelta(e);this.moveElement(this.target,t)}onDragEnd(){const e=this.forceLayoutInstance;e&&ow(e,"simulation").alphaTarget(0),!this.options.fixed&&this.context.graph.getNodeData(this.target).forEach(t=>{e&&Ih(e,"setFixedPosition",Q(t),[null,null,null])})}}var uw=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})};class Qc extends pr{constructor(e,t){super(e,Object.assign({},Qc.defaultOptions,t)),this.isZoomEvent=n=>!!(n.data&&"scale"in n.data),this.relatedEdgeToUpdate=new Set,this.zoom=this.context.graph.getZoom(),this.fixElementSize=n=>uw(this,void 0,void 0,function*(){if(!this.validate(n))return;const{graph:i}=this.context,{state:a,nodeFilter:s,edgeFilter:o,comboFilter:u}=this.options,l=(a?i.getElementDataByState("node",a):i.getNodeData()).filter(s),c=(a?i.getElementDataByState("edge",a):i.getEdgeData()).filter(o),d=(a?i.getElementDataByState("combo",a):i.getComboData()).filter(u),h=this.isZoomEvent(n)?this.zoom=Math.max(.01,Math.min(n.data.scale,10)):this.zoom,f=[...l,...d];f.length>0&&f.forEach(g=>this.fixNodeLike(g,h)),this.updateRelatedEdges(),c.length>0&&c.forEach(g=>this.fixEdge(g,h))}),this.cachedStyles=new Map,this.getOriginalFieldValue=(n,i,a)=>{var s;const o=this.cachedStyles.get(n)||[],u=((s=o.find(l=>l.shape===i))===null||s===void 0?void 0:s.style)||{};return a in u||(u[a]=i.attributes[a],this.cachedStyles.set(n,[...o.filter(l=>l.shape!==i),{shape:i,style:u}])),u[a]},this.scaleEntireElement=(n,i,a)=>{i.setLocalScale(1/a);const s=this.cachedStyles.get(n)||[];s.push({shape:i}),this.cachedStyles.set(n,s)},this.scaleSpecificShapes=(n,i,a)=>{const s=w6(n);(Array.isArray(a)?a:[a]).forEach(u=>{const{shape:l,fields:c}=u,d=typeof l=="function"?l(s):n.getShape(l);if(d){if(!c){this.scaleEntireElement(n.id,d,i);return}c.forEach(h=>{const f=this.getOriginalFieldValue(n.id,d,h);Ee(f)&&(d.style[h]=f/i)})}})},this.skipIfExceedViewport=n=>{const{viewport:i}=this.context;return!(i!=null&&i.isInViewport(n.getRenderBounds(),!1,30))},this.fixNodeLike=(n,i)=>{const a=Q(n),{element:s,model:o}=this.context,u=s.getElement(a);if(!u||this.skipIfExceedViewport(u))return;o.getRelatedEdgesData(a).forEach(d=>this.relatedEdgeToUpdate.add(Q(d)));const c=this.options[u.type];if(!c){this.scaleEntireElement(a,u,i);return}this.scaleSpecificShapes(u,i,c)},this.fixEdge=(n,i)=>{const a=Q(n),s=this.context.element.getElement(a);if(!s||this.skipIfExceedViewport(s))return;const o=this.options.edge;if(!o){s.style.transformOrigin="center",this.scaleEntireElement(a,s,i);return}this.scaleSpecificShapes(s,i,o)},this.updateRelatedEdges=()=>{const{element:n}=this.context;this.relatedEdgeToUpdate.size>0&&this.relatedEdgeToUpdate.forEach(i=>{const a=n.getElement(i);a==null||a.update({})}),this.relatedEdgeToUpdate.clear()},this.resetTransform=n=>uw(this,void 0,void 0,function*(){var i;!((i=n.data)===null||i===void 0)&&i.firstRender||(this.options.reset?this.restoreCachedStyles():this.fixElementSize({data:{scale:this.zoom}}))}),this.bindEvents()}restoreCachedStyles(){if(this.cachedStyles.size>0){this.cachedStyles.forEach(i=>{i.forEach(({shape:a,style:s})=>{if(ti(s))a.setLocalScale(1);else{if(this.options.state)return;Object.entries(s).forEach(([o,u])=>a.style[o]=u)}})});const{graph:e,element:t}=this.context,n=Object.keys(Object.fromEntries(this.cachedStyles)).filter(i=>i&&e.getElementType(i)==="node");if(n.length>0){const i=new Set;n.forEach(a=>{e.getRelatedEdgesData(a).forEach(s=>i.add(Q(s)))}),i.forEach(a=>{const s=t==null?void 0:t.getElement(a);s==null||s.update({})})}}}bindEvents(){const{graph:e}=this.context;e.on(ve.AFTER_DRAW,this.resetTransform),e.on(ve.AFTER_TRANSFORM,this.fixElementSize)}unbindEvents(){const{graph:e}=this.context;e.off(ve.AFTER_DRAW,this.resetTransform),e.off(ve.AFTER_TRANSFORM,this.fixElementSize)}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}destroy(){this.unbindEvents(),super.destroy()}}Qc.defaultOptions={enable:r=>r.data.scale<1,nodeFilter:()=>!0,edgeFilter:()=>!0,comboFilter:()=>!0,edge:[{shape:"key",fields:["lineWidth"]},{shape:"halo",fields:["lineWidth"]},{shape:"label"}],reset:!1};var EB=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})};class Jc extends pr{constructor(e,t){super(e,Object.assign({},Jc.defaultOptions,t)),this.focus=n=>EB(this,void 0,void 0,function*(){if(!this.validate(n))return;const{graph:i}=this.context;yield i.focusElement(n.target.id,this.options.animation)}),this.bindEvents()}bindEvents(){const{graph:e}=this.context;this.unbindEvents(),Ua.forEach(t=>{e.on(`${t}:${ae.CLICK}`,this.focus)})}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}unbindEvents(){const{graph:e}=this.context;Ua.forEach(t=>{e.off(`${t}:${ae.CLICK}`,this.focus)})}destroy(){this.unbindEvents(),super.destroy()}}Jc.defaultOptions={animation:{easing:"ease-in",duration:500},enable:!0};class ed extends pr{constructor(e,t){super(e,Object.assign({},ed.defaultOptions,t)),this.isFrozen=!1,this.toggleFrozen=n=>{this.isFrozen=n.type==="dragstart"},this.hoverElement=n=>{if(!this.validate(n))return;const i=n.type===ae.POINTER_ENTER;this.updateElementsState(n,i);const{onHover:a,onHoverEnd:s}=this.options;i?a==null||a(n):s==null||s(n)},this.updateElementsState=(n,i)=>{if(!this.options.state&&!this.options.inactiveState)return;const{graph:a}=this.context,{state:s,animation:o,inactiveState:u}=this.options,l=this.getActiveIds(n),c={};if(s&&Object.assign(c,this.getElementsState(l,s,i)),u){const d=$O(a.getData(),!0).filter(h=>!l.includes(h));Object.assign(c,this.getElementsState(d,u,i))}a.setElementState(c,o)},this.getElementsState=(n,i,a)=>{const{graph:s}=this.context,o={};return n.forEach(u=>{const l=s.getElementState(u);a?o[u]=l.includes(i)?l:[...l,i]:o[u]=l.filter(c=>c!==i)}),o},this.bindEvents()}bindEvents(){const{graph:e}=this.context;this.unbindEvents(),Ua.forEach(n=>{e.on(`${n}:${ae.POINTER_ENTER}`,this.hoverElement),e.on(`${n}:${ae.POINTER_LEAVE}`,this.hoverElement)});const t=this.context.canvas.document;t.addEventListener(`${ae.DRAG_START}`,this.toggleFrozen),t.addEventListener(`${ae.DRAG_END}`,this.toggleFrozen)}getActiveIds(e){const{graph:t}=this.context,{degree:n,direction:i}=this.options,a=e.target.id;return n?QO(t,e.targetType,a,typeof n=="function"?n(e):n,i):[a]}validate(e){if(this.destroyed||this.isFrozen||Yc(e.target)||this.context.graph.isCollapsingExpanding)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}unbindEvents(){const{graph:e}=this.context;Ua.forEach(n=>{e.off(`${n}:${ae.POINTER_ENTER}`,this.hoverElement),e.off(`${n}:${ae.POINTER_LEAVE}`,this.hoverElement)});const t=this.context.canvas.document;t.removeEventListener(`${ae.DRAG_START}`,this.toggleFrozen),t.removeEventListener(`${ae.DRAG_END}`,this.toggleFrozen)}destroy(){this.unbindEvents(),super.destroy()}}ed.defaultOptions={animation:!1,enable:!0,degree:0,direction:"both",state:"active",inactiveState:void 0};class MB extends fu{onPointerDown(e){if(!super.validate(e)||!super.isKeydown()||this.points)return;const{canvas:t}=this.context;this.pathShape=new lr({id:"g6-lasso-select",style:this.options.style}),t.appendChild(this.pathShape),this.points=[sc(e)]}onPointerMove(e){var t;if(!this.points)return;const{immediately:n,mode:i}=this.options;this.points.push(sc(e)),(t=this.pathShape)===null||t===void 0||t.setAttribute("d",p6(this.points)),n&&i==="default"&&this.points.length>2&&super.updateElementsStates(this.points)}onPointerUp(){if(this.points){if(this.points.length<2){this.clearLasso();return}super.updateElementsStates(this.points),this.clearLasso()}}clearLasso(){var e;(e=this.pathShape)===null||e===void 0||e.remove(),this.pathShape=void 0,this.points=void 0}}class td extends pr{constructor(e,t){super(e,Object.assign({},td.defaultOptions,t)),this.hiddenShapes=[],this.isVisible=!0,this.setElementsVisibility=(n,i,a)=>{n.filter(Boolean).forEach(s=>{i==="hidden"&&!s.isVisible()?this.hiddenShapes.push(s):i==="visible"&&this.hiddenShapes.includes(s)?this.hiddenShapes.splice(this.hiddenShapes.indexOf(s),1):Va(s,i,a)})},this.filterShapes=(n,i)=>{if(Te(i))return s=>!i(n,s);const a=i==null?void 0:i[n];return s=>s.className?!(a!=null&&a.includes(s.className)):!0},this.hideShapes=n=>{if(!this.validate(n)||!this.isVisible)return;const{element:i}=this.context,{shapes:a={}}=this.options;this.setElementsVisibility(i.getNodes(),"hidden",this.filterShapes("node",a)),this.setElementsVisibility(i.getEdges(),"hidden",this.filterShapes("edge",a)),this.setElementsVisibility(i.getCombos(),"hidden",this.filterShapes("combo",a)),this.isVisible=!1},this.showShapes=su(n=>{if(!this.validate(n)||this.isVisible)return;const{element:i}=this.context;this.setElementsVisibility(i.getNodes(),"visible"),this.setElementsVisibility(i.getEdges(),"visible"),this.setElementsVisibility(i.getCombos(),"visible"),this.isVisible=!0},this.options.debounce),this.bindEvents()}bindEvents(){const{graph:e}=this.context;e.on(ve.BEFORE_TRANSFORM,this.hideShapes),e.on(ve.AFTER_TRANSFORM,this.showShapes)}unbindEvents(){const{graph:e}=this.context;e.off(ve.BEFORE_TRANSFORM,this.hideShapes),e.off(ve.AFTER_TRANSFORM,this.showShapes)}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}td.defaultOptions={enable:!0,debounce:200,shapes:r=>r==="node"};var lw=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})};class nd extends pr{constructor(e,t){super(e,Object.assign({},nd.defaultOptions,t)),this.onWheel=n=>lw(this,void 0,void 0,function*(){this.options.preventDefault&&n.preventDefault();const i=n.deltaX,a=n.deltaY;yield this.scroll([-i,-a],n)}),this.shortcut=new Ws(e.graph),this.bindEvents()}update(e){super.update(e),this.bindEvents()}bindEvents(){var e,t;const{trigger:n}=this.options;if(this.shortcut.unbindAll(),Yt(n)){(e=this.graphDom)===null||e===void 0||e.removeEventListener(ae.WHEEL,this.onWheel);const{up:i=[],down:a=[],left:s=[],right:o=[]}=n;this.shortcut.bind(i,u=>this.scroll([0,-10],u)),this.shortcut.bind(a,u=>this.scroll([0,10],u)),this.shortcut.bind(s,u=>this.scroll([-10,0],u)),this.shortcut.bind(o,u=>this.scroll([10,0],u))}else(t=this.graphDom)===null||t===void 0||t.addEventListener(ae.WHEEL,this.onWheel,{passive:!1})}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}formatDisplacement(e){const{sensitivity:t}=this.options;return e=wi(e,t),e=this.clampByDirection(e),e=this.clampByRange(e),e}clampByDirection([e,t]){const{direction:n}=this.options;return n==="x"?t=0:n==="y"&&(e=0),[e,t]}clampByRange([e,t]){const{viewport:n,canvas:i}=this.context,[a,s]=i.getSize(),[o,u,l,c]=hi(this.options.range),d=[s*o,a*u,s*l,a*c],h=va(Em(n.getCanvasCenter()),d),f=ot(n.getViewportCenter(),[e,t,0]);if(!$r(f,h)){const{min:[g,v],max:[p,y]}=h;(f[0]<g&&e>0||f[0]>p&&e<0)&&(e=0),(f[1]<v&&t>0||f[1]>y&&t<0)&&(t=0)}return[e,t]}scroll(e,t){return lw(this,void 0,void 0,function*(){if(!this.validate(t))return;const{onFinish:n}=this.options,i=this.context.graph,a=this.formatDisplacement(e);yield i.translateBy(a,!1),n==null||n()})}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}destroy(){var e;this.shortcut.destroy(),(e=this.graphDom)===null||e===void 0||e.removeEventListener(ae.WHEEL,this.onWheel),super.destroy()}}nd.defaultOptions={enable:!0,sensitivity:1,preventDefault:!0,range:1/0};var cw=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})};class rd extends pr{constructor(e,t){super(e,Object.assign({},rd.defaultOptions,t)),this.zoom=(n,i,a)=>cw(this,void 0,void 0,function*(){if(!this.validate(i))return;const{graph:s}=this.context;let o;"viewport"in i&&(o=En(i.viewport));const{sensitivity:u,onFinish:l}=this.options,c=1+jt(n,-50,50)*u/100,d=s.getZoom();yield s.zoomTo(d*c,a,o),l==null||l()}),this.onReset=()=>cw(this,void 0,void 0,function*(){yield this.context.graph.zoomTo(1,this.options.animation)}),this.preventDefault=n=>{this.options.preventDefault&&n.preventDefault()},this.shortcut=new Ws(e.graph),this.bindEvents()}update(e){super.update(e),this.bindEvents()}bindEvents(){var e;const{trigger:t}=this.options;if(this.shortcut.unbindAll(),Array.isArray(t)&&((e=this.context.canvas.getContainer())===null||e===void 0||e.addEventListener(ae.WHEEL,this.preventDefault),this.shortcut.bind([...t,ae.WHEEL],n=>{const{deltaX:i,deltaY:a}=n;this.zoom(-(a??i),n,!1)})),typeof t=="object"){const{zoomIn:n=[],zoomOut:i=[],reset:a=[]}=t;this.shortcut.bind(n,s=>this.zoom(10,s,this.options.animation)),this.shortcut.bind(i,s=>this.zoom(-10,s,this.options.animation)),this.shortcut.bind(a,this.onReset)}}validate(e){if(this.destroyed)return!1;const{enable:t}=this.options;return Te(t)?t(e):!!t}destroy(){var e;this.shortcut.destroy(),(e=this.context.canvas.getContainer())===null||e===void 0||e.removeEventListener(ae.WHEEL,this.preventDefault),super.destroy()}}rd.defaultOptions={animation:{duration:200},enable:!0,sensitivity:1,trigger:[],preventDefault:!0};var Rh,dw;function ba(){if(dw)return Rh;dw=1;function r(e,t,n,i){return i===void 0&&(i="height"),n==="center"?(e[i]+t[i])/2:e.height}return Rh={assign:Object.assign,getHeight:r},Rh}var jh,hw;function AA(){if(hw)return jh;hw=1;var r=ba(),e=18,t=e*2,n=e,i={getId:function(u){return u.id||u.name},getPreH:function(u){return u.preH||0},getPreV:function(u){return u.preV||0},getHGap:function(u){return u.hgap||n},getVGap:function(u){return u.vgap||n},getChildren:function(u){return u.children},getHeight:function(u){return u.height||t},getWidth:function(u){var l=u.label||" ";return u.width||l.split("").length*e}};function a(o,u){var l=this;if(l.vgap=l.hgap=0,o instanceof a)return o;l.data=o;var c=u.getHGap(o),d=u.getVGap(o);return l.preH=u.getPreH(o),l.preV=u.getPreV(o),l.width=u.getWidth(o),l.height=u.getHeight(o),l.width+=l.preH,l.height+=l.preV,l.id=u.getId(o),l.x=l.y=0,l.depth=0,l.children||(l.children=[]),l.addGap(c,d),l}r.assign(a.prototype,{isRoot:function(){return this.depth===0},isLeaf:function(){return this.children.length===0},addGap:function(u,l){var c=this;c.hgap+=u,c.vgap+=l,c.width+=2*u,c.height+=2*l},eachNode:function(u){for(var l=this,c=[l],d;d=c.shift();)u(d),c=d.children.concat(c)},DFTraverse:function(u){this.eachNode(u)},BFTraverse:function(u){for(var l=this,c=[l],d;d=c.shift();)u(d),c=c.concat(d.children)},getBoundingBox:function(){var u={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode(function(l){u.left=Math.min(u.left,l.x),u.top=Math.min(u.top,l.y),u.width=Math.max(u.width,l.x+l.width),u.height=Math.max(u.height,l.y+l.height)}),u},translate:function(u,l){u===void 0&&(u=0),l===void 0&&(l=0),this.eachNode(function(c){c.x+=u,c.y+=l,c.x+=c.preH,c.y+=c.preV})},right2left:function(){var u=this,l=u.getBoundingBox();u.eachNode(function(c){c.x=c.x-(c.x-l.left)*2-c.width}),u.translate(l.width,0)},bottom2top:function(){var u=this,l=u.getBoundingBox();u.eachNode(function(c){c.y=c.y-(c.y-l.top)*2-c.height}),u.translate(0,l.height)}});function s(o,u,l){u===void 0&&(u={}),u=r.assign({},i,u);var c=new a(o,u),d=[c],h;if(!l&&!o.collapsed){for(;h=d.shift();)if(!h.data.collapsed){var f=u.getChildren(h.data),g=f?f.length:0;if(h.children=new Array(g),f&&g)for(var v=0;v<g;v++){var p=new a(f[v],u);h.children[v]=p,d.push(p),p.parent=h,p.depth=h.depth+1}}}return c}return jh=s,jh}var Bh,fw;function id(){if(fw)return Bh;fw=1;var r=AA(),e=function(){function t(i,a){a===void 0&&(a={});var s=this;s.options=a,s.rootNode=r(i,a)}var n=t.prototype;return n.execute=function(){throw new Error("please override this method")},t}();return Bh=e,Bh}var Fh,gw;function SB(){if(gw)return Fh;gw=1;function r(s,o,u,l){l===void 0&&(l=[]);var c=this;c.w=s||0,c.h=o||0,c.y=u||0,c.x=0,c.c=l||[],c.cs=l.length,c.prelim=0,c.mod=0,c.shift=0,c.change=0,c.tl=null,c.tr=null,c.el=null,c.er=null,c.msel=0,c.mser=0}r.fromNode=function(s,o){if(!s)return null;var u=[];return s.children.forEach(function(l){u.push(r.fromNode(l,o))}),o?new r(s.height,s.width,s.x,u):new r(s.width,s.height,s.y,u)};function e(s,o,u){u?s.y+=o:s.x+=o,s.children.forEach(function(l){e(l,o,u)})}function t(s,o){var u=o?s.y:s.x;return s.children.forEach(function(l){u=Math.min(t(l,o),u)}),u}function n(s,o){var u=t(s,o);e(s,-u,o)}function i(s,o,u){u?o.y=s.x:o.x=s.x,s.c.forEach(function(l,c){i(l,o.children[c],u)})}function a(s,o,u){u===void 0&&(u=0),o?(s.x=u,u+=s.width):(s.y=u,u+=s.height),s.children.forEach(function(l){a(l,o,u)})}return Fh=function(s,o){o===void 0&&(o={});var u=o.isHorizontal;function l(O){if(O.cs===0){c(O);return}l(O.c[0]);for(var N=T(v(O.c[0].el),0,null),C=1;C<O.cs;++C){l(O.c[C]);var P=v(O.c[C].er);d(O,C,N),N=T(P,C,N)}m(O),c(O)}function c(O){O.cs===0?(O.el=O,O.er=O,O.msel=O.mser=0):(O.el=O.c[0].el,O.msel=O.c[0].msel,O.er=O.c[O.cs-1].er,O.mser=O.c[O.cs-1].mser)}function d(O,N,C){for(var P=O.c[N-1],D=P.mod,j=O.c[N],G=j.mod;P!==null&&j!==null;){v(P)>C.low&&(C=C.nxt);var V=D+P.prelim+P.w-(G+j.prelim);V>0&&(G+=V,h(O,N,C.index,V));var Y=v(P),$=v(j);Y<=$&&(P=g(P),P!==null&&(D+=P.mod)),Y>=$&&(j=f(j),j!==null&&(G+=j.mod))}!P&&j?p(O,N,j,G):P&&!j&&y(O,N,P,D)}function h(O,N,C,P){O.c[N].mod+=P,O.c[N].msel+=P,O.c[N].mser+=P,M(O,N,C,P)}function f(O){return O.cs===0?O.tl:O.c[0]}function g(O){return O.cs===0?O.tr:O.c[O.cs-1]}function v(O){return O.y+O.h}function p(O,N,C,P){var D=O.c[0].el;D.tl=C;var j=P-C.mod-O.c[0].msel;D.mod+=j,D.prelim-=j,O.c[0].el=O.c[N].el,O.c[0].msel=O.c[N].msel}function y(O,N,C,P){var D=O.c[N].er;D.tr=C;var j=P-C.mod-O.c[N].mser;D.mod+=j,D.prelim-=j,O.c[N].er=O.c[N-1].er,O.c[N].mser=O.c[N-1].mser}function m(O){O.prelim=(O.c[0].prelim+O.c[0].mod+O.c[O.cs-1].mod+O.c[O.cs-1].prelim+O.c[O.cs-1].w)/2-O.w/2}function w(O,N){N+=O.mod,O.x=O.prelim+N,S(O);for(var C=0;C<O.cs;C++)w(O.c[C],N)}function M(O,N,C,P){if(C!==N-1){var D=N-C;O.c[C+1].shift+=P/D,O.c[N].shift-=P/D,O.c[N].change-=P-P/D}}function S(O){for(var N=0,C=0,P=0;P<O.cs;P++)N+=O.c[P].shift,C+=N+O.c[P].change,O.c[P].mod+=C}function T(O,N,C){for(;C!==null&&O>=C.low;)C=C.nxt;return{low:O,index:N,nxt:C}}a(s,u);var A=r.fromNode(s,u);return l(A),w(A,0),i(A,s,u),n(s,u),s},Fh}var zh,pw;function kA(){if(pw)return zh;pw=1;var r=AA();return zh=function(e,t){for(var n=r(e.data,t,!0),i=r(e.data,t,!0),a=e.children.length,s=Math.round(a/2),o=t.getSide||function(d,h){return h<s?"right":"left"},u=0;u<a;u++){var l=e.children[u],c=o(l,u);c==="right"?i.children.push(l):n.children.push(l)}return n.eachNode(function(d){d.isRoot()||(d.side="left")}),i.eachNode(function(d){d.isRoot()||(d.side="right")}),{left:n,right:i}},zh}var $h,vw;function Bm(){if(vw)return $h;vw=1;var r=kA(),e=["LR","RL","TB","BT","H","V"],t=["LR","RL","H"],n=function(o){return t.indexOf(o)>-1},i=e[0];$h=function(s,o,u){var l=o.direction||i;if(o.isHorizontal=n(l),e.indexOf(l)===-1)throw new TypeError("Invalid direction: "+l);if(l===e[0])u(s,o);else if(l===e[1])u(s,o),s.right2left();else if(l===e[2])u(s,o);else if(l===e[3])u(s,o),s.bottom2top();else if(l===e[4]||l===e[5]){var c=r(s,o),d=c.left,h=c.right;u(d,o),u(h,o),o.isHorizontal?d.right2left():d.bottom2top(),h.translate(d.x-h.x,d.y-h.y),s.x=d.x,s.y=h.y;var f=s.getBoundingBox();o.isHorizontal?f.top<0&&s.translate(0,-f.top):f.left<0&&s.translate(-f.left,0)}var g=o.fixedRoot;return g===void 0&&(g=!0),g&&s.translate(-(s.x+s.width/2+s.hgap),-(s.y+s.height/2+s.vgap)),a(s,o),s};function a(s,o){if(o.radial){var u=o.isHorizontal?["x","y"]:["y","x"],l=u[0],c=u[1],d={x:1/0,y:1/0},h={x:-1/0,y:-1/0},f=0;s.DFTraverse(function(p){f++;var y=p.x,m=p.y;d.x=Math.min(d.x,y),d.y=Math.min(d.y,m),h.x=Math.max(h.x,y),h.y=Math.max(h.y,m)});var g=h[c]-d[c];if(g===0)return;var v=Math.PI*2/f;s.DFTraverse(function(p){var y=(p[c]-d[c])/g*(Math.PI*2-v)+v,m=p[l]-s[l];p.x=Math.cos(y)*m,p.y=Math.sin(y)*m})}}return $h}var qh,yw;function _B(){if(yw)return qh;yw=1;function r(l,c){l.prototype=Object.create(c.prototype),l.prototype.constructor=l,e(l,c)}function e(l,c){return e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(d,h){return d.__proto__=h,d},e(l,c)}var t=id(),n=SB(),i=Bm(),a=ba(),s=function(l){function c(){return l.apply(this,arguments)||this}r(c,l);var d=c.prototype;return d.execute=function(){var f=this;return i(f.rootNode,f.options,n)},c}(t),o={};function u(l,c){return c=a.assign({},o,c),new s(l,c).execute()}return qh=u,qh}var Gh,mw;function TB(){if(mw)return Gh;mw=1;var r=ba();function e(i,a){a===void 0&&(a=[]);var s=this;s.x=s.y=0,s.leftChild=s.rightChild=null,s.height=0,s.children=a}var t={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function n(i,a,s){s?(a.x=i.x,a.y=i.y):(a.x=i.y,a.y=i.x),i.children.forEach(function(o,u){n(o,a.children[u],s)})}return Gh=function(i,a){a===void 0&&(a={}),a=r.assign({},t,a);var s=0;function o(h){if(!h)return null;h.width=0,h.depth&&h.depth>s&&(s=h.depth);var f=h.children,g=f.length,v=new e(h.height,[]);return f.forEach(function(p,y){var m=o(p);v.children.push(m),y===0&&(v.leftChild=m),y===g-1&&(v.rightChild=m)}),v.originNode=h,v.isLeaf=h.isLeaf(),v}function u(h){if(h.isLeaf||h.children.length===0)h.drawingDepth=s;else{var f=h.children.map(function(v){return u(v)}),g=Math.min.apply(null,f);h.drawingDepth=g-1}return h.drawingDepth}var l;function c(h){h.x=h.drawingDepth*a.rankSep,h.isLeaf?(h.y=0,l&&(h.y=l.y+l.height+a.nodeSep,h.originNode.parent!==l.originNode.parent&&(h.y+=a.subTreeSep)),l=h):(h.children.forEach(function(f){c(f)}),h.y=(h.leftChild.y+h.rightChild.y)/2)}var d=o(i);return u(d),c(d),n(d,i,a.isHorizontal),i},Gh}var Wh,bw;function OB(){if(bw)return Wh;bw=1;function r(l,c){l.prototype=Object.create(c.prototype),l.prototype.constructor=l,e(l,c)}function e(l,c){return e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(d,h){return d.__proto__=h,d},e(l,c)}var t=id(),n=TB(),i=Bm(),a=ba(),s=function(l){function c(){return l.apply(this,arguments)||this}r(c,l);var d=c.prototype;return d.execute=function(){var f=this;return f.rootNode.width=0,i(f.rootNode,f.options,n)},c}(t),o={};function u(l,c){return c=a.assign({},o,c),new s(l,c).execute()}return Wh=u,Wh}var Vh,ww;function AB(){if(ww)return Vh;ww=1;var r=ba();function e(t,n,i,a,s){var o=(typeof i=="function"?i(t):i)*t.depth;if(!a)try{if(t.id===t.parent.children[0].id){t.x+=o,t.y=n?n.y:0;return}}catch{}if(t.x+=o,n){if(t.y=n.y+r.getHeight(n,t,s),n.parent&&t.parent.id!==n.parent.id){var u=n.parent,l=u.y+r.getHeight(u,t,s);t.y=l>t.y?l:t.y}}else t.y=0}return Vh=function(t,n,i,a){var s=null;t.eachNode(function(o){e(o,s,n,i,a),s=o})},Vh}var Yh,xw;function kB(){if(xw)return Yh;xw=1;function r(d,h){d.prototype=Object.create(h.prototype),d.prototype.constructor=d,e(d,h)}function e(d,h){return e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(f,g){return f.__proto__=g,f},e(d,h)}var t=id(),n=AB(),i=kA(),a=ba(),s=["LR","RL","H"],o=s[0],u=function(d){function h(){return d.apply(this,arguments)||this}r(h,d);var f=h.prototype;return f.execute=function(){var v=this,p=v.options,y=v.rootNode;p.isHorizontal=!0;var m=p.indent,w=m===void 0?20:m,M=p.dropCap,S=M===void 0?!0:M,T=p.direction,A=T===void 0?o:T,O=p.align;if(A&&s.indexOf(A)===-1)throw new TypeError("Invalid direction: "+A);if(A===s[0])n(y,w,S,O);else if(A===s[1])n(y,w,S,O),y.right2left();else if(A===s[2]){var N=i(y,p),C=N.left,P=N.right;n(C,w,S,O),C.right2left(),n(P,w,S,O);var D=C.getBoundingBox();P.translate(D.width,0),y.x=P.x-y.width/2}return y},h}(t),l={};function c(d,h){return h=a.assign({},l,h),new u(d,h).execute()}return Yh=c,Yh}var Uh,Ew;function NB(){if(Ew)return Uh;Ew=1;var r=ba();function e(i,a){var s=0;return i.children.length?i.children.forEach(function(o){s+=e(o,a)}):s=i.height,i._subTreeSep=a.getSubTreeSep(i.data),i.totalHeight=Math.max(i.height,s)+2*i._subTreeSep,i.totalHeight}function t(i){var a=i.children,s=a.length;if(s){a.forEach(function(h){t(h)});var o=a[0],u=a[s-1],l=u.y-o.y+u.height,c=0;if(a.forEach(function(h){c+=h.totalHeight}),l>i.height)i.y=o.y+l/2-i.height/2;else if(a.length!==1||i.height>c){var d=i.y+(i.height-l)/2-o.y;a.forEach(function(h){h.translate(0,d)})}else i.y=(o.y+o.height/2+u.y+u.height/2)/2-i.height/2}}var n={getSubTreeSep:function(){return 0}};return Uh=function(i,a){a===void 0&&(a={}),a=r.assign({},n,a),i.parent={x:0,width:0,height:0,y:0},i.BFTraverse(function(s){s.x=s.parent.x+s.parent.width}),i.parent=null,e(i,a),i.startY=0,i.y=i.totalHeight/2-i.height/2,i.eachNode(function(s){var o=s.children,u=o.length;if(u){var l=o[0];if(l.startY=s.startY+s._subTreeSep,u===1)l.y=s.y+s.height/2-l.height/2;else{l.y=l.startY+l.totalHeight/2-l.height/2;for(var c=1;c<u;c++){var d=o[c];d.startY=o[c-1].startY+o[c-1].totalHeight,d.y=d.startY+d.totalHeight/2-d.height/2}}}}),t(i)},Uh}var Hh,Mw;function CB(){if(Mw)return Hh;Mw=1;function r(l,c){l.prototype=Object.create(c.prototype),l.prototype.constructor=l,e(l,c)}function e(l,c){return e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(d,h){return d.__proto__=h,d},e(l,c)}var t=id(),n=NB(),i=Bm(),a=ba(),s=function(l){function c(){return l.apply(this,arguments)||this}r(c,l);var d=c.prototype;return d.execute=function(){var f=this;return i(f.rootNode,f.options,n)},c}(t),o={};function u(l,c){return c=a.assign({},o,c),new s(l,c).execute()}return Hh=u,Hh}var Xh,Sw;function PB(){if(Sw)return Xh;Sw=1;var r={compactBox:_B(),dendrogram:OB(),indented:kB(),mindmap:CB()};return Xh=r,Xh}var pl=PB();const LB=(r,e)=>{if(r!=="next"&&r!=="prev")return e},_w=r=>{r.prev.next=r.next,r.next.prev=r.prev,delete r.next,delete r.prev};let DB=class{constructor(){const e={};e.prev=e,e.next=e.prev,this.shortcut=e}dequeue(){const e=this.shortcut,t=e.prev;if(t&&t!==e)return _w(t),t}enqueue(e){const t=this.shortcut;e.prev&&e.next&&_w(e),e.next=t.next,t.next.prev=e,t.next=e,e.prev=t}toString(){const e=[],t=this.shortcut;let n=t.prev;for(;n!==t;)e.push(JSON.stringify(n,LB)),n=n==null?void 0:n.prev;return`[${e.join(", ")}]`}};class IB extends DB{}const RB=(r,e)=>{var t;if(r.getAllNodes().length<=1)return[];const n=BB(r,e);return(t=jB(n.graph,n.buckets,n.zeroIdx).map(a=>r.getRelatedEdges(a.v,"out").filter(({target:s})=>s===a.w)))===null||t===void 0?void 0:t.flat()},jB=(r,e,t)=>{let n=[];const i=e[e.length-1],a=e[0];let s;for(;r.getAllNodes().length;){for(;s=a.dequeue();)Kh(r,e,t,s);for(;s=i.dequeue();)Kh(r,e,t,s);if(r.getAllNodes().length){for(let o=e.length-2;o>0;--o)if(s=e[o].dequeue(),s){n=n.concat(Kh(r,e,t,s,!0));break}}}return n},Kh=(r,e,t,n,i)=>{var a,s;const o=[];return r.hasNode(n.v)&&((a=r.getRelatedEdges(n.v,"in"))===null||a===void 0||a.forEach(u=>{const l=u.data.weight,c=r.getNode(u.source);i&&o.push({v:u.source,w:u.target,in:0,out:0}),c.data.out===void 0&&(c.data.out=0),c.data.out-=l,Ay(e,t,Object.assign({v:c.id},c.data))}),(s=r.getRelatedEdges(n.v,"out"))===null||s===void 0||s.forEach(u=>{const l=u.data.weight,c=u.target,d=r.getNode(c);d.data.in===void 0&&(d.data.in=0),d.data.in-=l,Ay(e,t,Object.assign({v:d.id},d.data))}),r.removeNode(n.v)),i?o:void 0},BB=(r,e)=>{const t=new cn;let n=0,i=0;r.getAllNodes().forEach(u=>{t.addNode({id:u.id,data:{v:u.id,in:0,out:0}})}),r.getAllEdges().forEach(u=>{const l=t.getRelatedEdges(u.source,"out").find(d=>d.target===u.target),c=(e==null?void 0:e(u))||1;l?t.updateEdgeData(l==null?void 0:l.id,Object.assign(Object.assign({},l.data),{weight:l.data.weight+c})):t.addEdge({id:u.id,source:u.source,target:u.target,data:{weight:c}}),i=Math.max(i,t.getNode(u.source).data.out+=c),n=Math.max(n,t.getNode(u.target).data.in+=c)});const a=[],s=i+n+3;for(let u=0;u<s;u++)a.push(new IB);const o=n+1;return t.getAllNodes().forEach(u=>{Ay(a,o,Object.assign({v:u.id},t.getNode(u.id).data))}),{buckets:a,zeroIdx:o,graph:t}},Ay=(r,e,t)=>{t.out?t.in?r[t.out-t.in+e].enqueue(t):r[r.length-1].enqueue(t):r[0].enqueue(t)},FB=(r,e)=>{const n=e==="greedy"?RB(r,(i=>a=>a.data.weight||1)()):zB(r);n==null||n.forEach(i=>{const a=i.data;r.removeEdge(i.id),a.forwardName=i.data.name,a.reversed=!0,r.addEdge({id:i.id,source:i.target,target:i.source,data:Object.assign({},a)})})},zB=r=>{const e=[],t={},n={},i=a=>{n[a]||(n[a]=!0,t[a]=!0,r.getRelatedEdges(a,"out").forEach(s=>{t[s.target]?e.push(s):i(s.target)}),delete t[a])};return r.getAllNodes().forEach(a=>i(a.id)),e},$B=r=>{r.getAllEdges().forEach(e=>{const t=e.data;if(t.reversed){r.removeEdge(e.id);const n=t.forwardName;delete t.reversed,delete t.forwardName,r.addEdge({id:e.id,source:e.target,target:e.source,data:Object.assign(Object.assign({},t),{forwardName:n})})}})},qB=(r,e)=>Number(r)-Number(e),Us=(r,e,t,n)=>{let i;do i=`${n}${Math.random()}`;while(r.hasNode(i));return t.dummy=e,r.addNode({id:i,data:t}),i},GB=r=>{const e=new cn;return r.getAllNodes().forEach(t=>{e.addNode(Object.assign({},t))}),r.getAllEdges().forEach(t=>{const n=e.getRelatedEdges(t.source,"out").find(i=>i.target===t.target);n?e.updateEdgeData(n==null?void 0:n.id,Object.assign(Object.assign({},n.data),{weight:n.data.weight+t.data.weight||0,minlen:Math.max(n.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})}),e},NA=r=>{const e=new cn;return r.getAllNodes().forEach(t=>{r.getChildren(t.id).length||e.addNode(Object.assign({},t))}),r.getAllEdges().forEach(t=>{e.addEdge(t)}),e},WB=(r,e)=>r==null?void 0:r.reduce((t,n,i)=>(t[n]=e[i],t),{}),Tw=(r,e)=>{const t=Number(r.x),n=Number(r.y),i=Number(e.x)-t,a=Number(e.y)-n;let s=Number(r.width)/2,o=Number(r.height)/2;if(!i&&!a)return{x:0,y:0};let u,l;return Math.abs(a)*s>Math.abs(i)*o?(a<0&&(o=-o),u=o*i/a,l=o):(i<0&&(s=-s),u=s,l=s*a/i),{x:t+u,y:n+l}},Yo=r=>{const e=[],t=CA(r)+1;for(let n=0;n<t;n++)e.push([]);r.getAllNodes().forEach(n=>{const i=n.data.rank;i!==void 0&&e[i]&&e[i].push(n.id)});for(let n=0;n<t;n++)e[n]=e[n].sort((i,a)=>qB(r.getNode(i).data.order,r.getNode(a).data.order));return e},VB=r=>{const e=r.getAllNodes().filter(n=>n.data.rank!==void 0).map(n=>n.data.rank),t=Math.min(...e);r.getAllNodes().forEach(n=>{n.data.hasOwnProperty("rank")&&t!==1/0&&(n.data.rank-=t)})},YB=(r,e=0)=>{const t=r.getAllNodes(),n=t.filter(o=>o.data.rank!==void 0).map(o=>o.data.rank),i=Math.min(...n),a=[];t.forEach(o=>{const u=(o.data.rank||0)-i;a[u]||(a[u]=[]),a[u].push(o.id)});let s=0;for(let o=0;o<a.length;o++){const u=a[o];u===void 0?o%e!==0&&(s-=1):s&&(u==null||u.forEach(l=>{const c=r.getNode(l);c&&(c.data.rank=c.data.rank||0,c.data.rank+=s)}))}},Ow=(r,e,t,n)=>{const i={width:0,height:0};return Ee(t)&&Ee(n)&&(i.rank=t,i.order=n),Us(r,"border",i,e)},CA=r=>{let e;return r.getAllNodes().forEach(t=>{const n=t.data.rank;n!==void 0&&(e===void 0||n>e)&&(e=n)}),e||(e=0),e},UB=(r,e)=>{const t={lhs:[],rhs:[]};return r==null||r.forEach(n=>{e(n)?t.lhs.push(n):t.rhs.push(n)}),t},Fm=(r,e)=>r.reduce((t,n)=>{const i=e(t),a=e(n);return i>a?n:t}),PA=(r,e,t,n,i,a)=>{n.includes(e.id)||(n.push(e.id),t||a.push(e.id),i(e.id).forEach(s=>PA(r,s,t,n,i,a)),t&&a.push(e.id))},LA=(r,e,t,n)=>{const i=Array.isArray(e)?e:[e],a=u=>r.getNeighbors(u),s=[],o=[];return i.forEach(u=>{if(r.hasNode(u.id))PA(r,u,t==="post",o,a,s);else throw new Error(`Graph does not have node: ${u}`)}),s},HB=r=>{const e=t=>{const n=r.getChildren(t),i=r.getNode(t);if(n!=null&&n.length&&n.forEach(a=>e(a.id)),i.data.hasOwnProperty("minRank")){i.data.borderLeft=[],i.data.borderRight=[];for(let a=i.data.minRank,s=i.data.maxRank+1;a<s;a+=1)Aw(r,"borderLeft","_bl",t,i,a),Aw(r,"borderRight","_br",t,i,a)}};r.getRoots().forEach(t=>e(t.id))},Aw=(r,e,t,n,i,a)=>{const s={rank:a,borderType:e,width:0,height:0},o=i.data[e][a-1],u=Us(r,"border",s,t);i.data[e][a]=u,r.setParent(u,n),o&&r.addEdge({id:`e${Math.random()}`,source:o,target:u,data:{weight:1}})},XB=(r,e)=>{const t=e.toLowerCase();(t==="lr"||t==="rl")&&DA(r)},KB=(r,e)=>{const t=e.toLowerCase();(t==="bt"||t==="rl")&&ZB(r),(t==="lr"||t==="rl")&&(QB(r),DA(r))},DA=r=>{r.getAllNodes().forEach(e=>{kw(e)}),r.getAllEdges().forEach(e=>{kw(e)})},kw=r=>{const e=r.data.width;r.data.width=r.data.height,r.data.height=e},ZB=r=>{r.getAllNodes().forEach(e=>{Zh(e.data)}),r.getAllEdges().forEach(e=>{var t;(t=e.data.points)===null||t===void 0||t.forEach(n=>Zh(n)),e.data.hasOwnProperty("y")&&Zh(e.data)})},Zh=r=>{r!=null&&r.y&&(r.y=-r.y)},QB=r=>{r.getAllNodes().forEach(e=>{Qh(e.data)}),r.getAllEdges().forEach(e=>{var t;(t=e.data.points)===null||t===void 0||t.forEach(n=>Qh(n)),e.data.hasOwnProperty("x")&&Qh(e.data)})},Qh=r=>{const e=r.x;r.x=r.y,r.y=e},JB=r=>{const e=Us(r,"root",{},"_root"),t=eF(r);let n=Math.max(...Object.values(t));Math.abs(n)===1/0&&(n=1);const i=n-1,a=2*i+1;r.getAllEdges().forEach(o=>{o.data.minlen*=a});const s=tF(r)+1;return r.getRoots().forEach(o=>{IA(r,e,a,s,i,t,o.id)}),{nestingRoot:e,nodeRankFactor:a}},IA=(r,e,t,n,i,a,s)=>{const o=r.getChildren(s);if(!(o!=null&&o.length)){s!==e&&r.addEdge({id:`e${Math.random()}`,source:e,target:s,data:{weight:0,minlen:t}});return}const u=Ow(r,"_bt"),l=Ow(r,"_bb"),c=r.getNode(s);r.setParent(u,s),c.data.borderTop=u,r.setParent(l,s),c.data.borderBottom=l,o==null||o.forEach(d=>{IA(r,e,t,n,i,a,d.id);const h=d.data.borderTop?d.data.borderTop:d.id,f=d.data.borderBottom?d.data.borderBottom:d.id,g=d.data.borderTop?n:2*n,v=h!==f?1:i-a[s]+1;r.addEdge({id:`e${Math.random()}`,source:u,target:h,data:{minlen:v,weight:g,nestingEdge:!0}}),r.addEdge({id:`e${Math.random()}`,source:f,target:l,data:{minlen:v,weight:g,nestingEdge:!0}})}),r.getParent(s)||r.addEdge({id:`e${Math.random()}`,source:e,target:u,data:{weight:0,minlen:i+a[s]}})},eF=r=>{const e={},t=(n,i)=>{const a=r.getChildren(n);a==null||a.forEach(s=>t(s.id,i+1)),e[n]=i};return r.getRoots().forEach(n=>t(n.id,1)),e},tF=r=>{let e=0;return r.getAllEdges().forEach(t=>{e+=t.data.weight}),e},nF=(r,e)=>{e&&r.removeNode(e),r.getAllEdges().forEach(t=>{t.data.nestingEdge&&r.removeEdge(t.id)})},rF="edge",RA="edge-label",iF=(r,e)=>{r.getAllEdges().forEach(t=>aF(r,t,e))},aF=(r,e,t)=>{let n=e.source,i=r.getNode(n).data.rank;const a=e.target,s=r.getNode(a).data.rank,o=e.data.labelRank;if(s===i+1)return;r.removeEdge(e.id);let u,l,c;for(c=0,++i;i<s;++c,++i)e.data.points=[],l={originalEdge:e,width:0,height:0,rank:i},u=Us(r,rF,l,"_d"),i===o&&(l.width=e.data.width,l.height=e.data.height,l.dummy=RA,l.labelpos=e.data.labelpos),r.addEdge({id:`e${Math.random()}`,source:n,target:u,data:{weight:e.data.weight}}),c===0&&t.push(u),n=u;r.addEdge({id:`e${Math.random()}`,source:n,target:a,data:{weight:e.data.weight}})},sF=(r,e)=>{e.forEach(t=>{let n=r.getNode(t);const{data:i}=n,a=i.originalEdge;let s;a&&r.addEdge(a);let o=t;for(;n.data.dummy;)s=r.getSuccessors(o)[0],r.removeNode(o),a.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===RA&&(a.data.x=n.data.x,a.data.y=n.data.y,a.data.width=n.data.width,a.data.height=n.data.height),o=s.id,n=r.getNode(o)})},oF=(r,e,t)=>{const n={};let i;t==null||t.forEach(a=>{let s=r.getParent(a),o,u;for(;s;){if(o=r.getParent(s.id),o?(u=n[o.id],n[o.id]=s.id):(u=i,i=s.id),u&&u!==s.id){e.hasNode(u)||e.addNode({id:u,data:{}}),e.hasNode(s.id)||e.addNode({id:s.id,data:{}}),e.hasEdge(`e${u}-${s.id}`)||e.addEdge({id:`e${u}-${s.id}`,source:u,target:s.id,data:{}});return}s=o}})},uF=(r,e,t)=>{const n=lF(r),i=new cn({tree:[{id:n,children:[],data:{}}]});return r.getAllNodes().forEach(a=>{const s=r.getParent(a.id);(a.data.rank===e||a.data.minRank<=e&&e<=a.data.maxRank)&&(i.hasNode(a.id)||i.addNode(Object.assign({},a)),s!=null&&s.id&&!i.hasNode(s==null?void 0:s.id)&&i.addNode(Object.assign({},s)),i.setParent(a.id,(s==null?void 0:s.id)||n),r.getRelatedEdges(a.id,t).forEach(o=>{const u=o.source===a.id?o.target:o.source;i.hasNode(u)||i.addNode(Object.assign({},r.getNode(u)));const l=i.getRelatedEdges(u,"out").find(({target:d})=>d===a.id),c=l!==void 0?l.data.weight:0;l?i.updateEdgeData(l.id,Object.assign(Object.assign({},l.data),{weight:o.data.weight+c})):i.addEdge({id:o.id,source:u,target:a.id,data:{weight:o.data.weight+c}})}),a.data.hasOwnProperty("minRank")&&i.updateNodeData(a.id,Object.assign(Object.assign({},a.data),{borderLeft:a.data.borderLeft[e],borderRight:a.data.borderRight[e]})))}),i},lF=r=>{let e;for(;r.hasNode(e=`_root${Math.random()}`););return e},cF=(r,e,t)=>{const n=WB(t,t.map((c,d)=>d)),a=e.map(c=>{const d=r.getRelatedEdges(c,"out").map(h=>({pos:n[h.target]||0,weight:h.data.weight}));return d==null?void 0:d.sort((h,f)=>h.pos-f.pos)}).flat().filter(c=>c!==void 0);let s=1;for(;s<t.length;)s<<=1;const o=2*s-1;s-=1;const u=Array(o).fill(0,0,o);let l=0;return a==null||a.forEach(c=>{if(c){let d=c.pos+s;u[d]+=c.weight;let h=0;for(;d>0;)d%2&&(h+=u[d+1]),d=d-1>>1,u[d]+=c.weight;l+=c.weight*h}}),l},Nw=(r,e)=>{let t=0;for(let n=1;n<(e==null?void 0:e.length);n+=1)t+=cF(r,e[n-1],e[n]);return t},Cw=r=>{const e={},t=r.getAllNodes(),n=t.map(l=>{var c;return(c=l.data.rank)!==null&&c!==void 0?c:-1/0}),i=Math.max(...n),a=[];for(let l=0;l<i+1;l++)a.push([]);const s=t.sort((l,c)=>r.getNode(l.id).data.rank-r.getNode(c.id).data.rank),u=s.filter(l=>r.getNode(l.id).data.fixorder!==void 0).sort((l,c)=>r.getNode(l.id).data.fixorder-r.getNode(c.id).data.fixorder);return u==null||u.forEach(l=>{isNaN(r.getNode(l.id).data.rank)||a[r.getNode(l.id).data.rank].push(l.id),e[l.id]=!0}),s==null||s.forEach(l=>r.dfsTree(l.id,c=>{if(e.hasOwnProperty(c.id))return!0;e[c.id]=!0,isNaN(c.data.rank)||a[c.data.rank].push(c.id)})),a},dF=(r,e)=>e.map(t=>{const n=r.getRelatedEdges(t,"in");if(!(n!=null&&n.length))return{v:t};const i={sum:0,weight:0};return n==null||n.forEach(a=>{const s=r.getNode(a.source);i.sum+=a.data.weight*s.data.order,i.weight+=a.data.weight}),{v:t,barycenter:i.sum/i.weight,weight:i.weight}}),hF=(r,e)=>{var t,n,i;const a={};r==null||r.forEach((o,u)=>{a[o.v]={i:u,indegree:0,in:[],out:[],vs:[o.v]};const l=a[o.v];o.barycenter!==void 0&&(l.barycenter=o.barycenter,l.weight=o.weight)}),(t=e.getAllEdges())===null||t===void 0||t.forEach(o=>{const u=a[o.source],l=a[o.target];u!==void 0&&l!==void 0&&(l.indegree++,u.out.push(a[o.target]))});const s=(i=(n=Object.values(a)).filter)===null||i===void 0?void 0:i.call(n,o=>!o.indegree);return fF(s)},fF=r=>{var e,t;const n=[],i=u=>l=>{l.merged||(l.barycenter===void 0||u.barycenter===void 0||l.barycenter>=u.barycenter)&&gF(u,l)},a=u=>l=>{l.in.push(u),--l.indegree===0&&r.push(l)};for(;r!=null&&r.length;){const u=r.pop();n.push(u),(e=u.in.reverse())===null||e===void 0||e.forEach(l=>i(u)(l)),(t=u.out)===null||t===void 0||t.forEach(l=>a(u)(l))}const s=n.filter(u=>!u.merged),o=["vs","i","barycenter","weight"];return s.map(u=>{const l={};return o==null||o.forEach(c=>{u[c]!==void 0&&(l[c]=u[c])}),l})},gF=(r,e)=>{var t;let n=0,i=0;r.weight&&(n+=r.barycenter*r.weight,i+=r.weight),e.weight&&(n+=e.barycenter*e.weight,i+=e.weight),r.vs=(t=e.vs)===null||t===void 0?void 0:t.concat(r.vs),r.barycenter=n/i,r.weight=i,r.i=Math.min(e.i,r.i),e.merged=!0},pF=(r,e,t,n)=>{const i=UB(r,h=>{const f=h.hasOwnProperty("fixorder")&&!isNaN(h.fixorder);return n?!f&&h.hasOwnProperty("barycenter"):f||h.hasOwnProperty("barycenter")}),a=i.lhs,s=i.rhs.sort((h,f)=>-h.i- -f.i),o=[];let u=0,l=0,c=0;a==null||a.sort(vF(!!e,!!t)),c=Pw(o,s,c),a==null||a.forEach(h=>{var f;c+=(f=h.vs)===null||f===void 0?void 0:f.length,o.push(h.vs),u+=h.barycenter*h.weight,l+=h.weight,c=Pw(o,s,c)});const d={vs:o.flat()};return l&&(d.barycenter=u/l,d.weight=l),d},Pw=(r,e,t)=>{let n=t,i;for(;e.length&&(i=e[e.length-1]).i<=n;)e.pop(),r==null||r.push(i.vs),n++;return n},vF=(r,e)=>(t,n)=>{if(t.fixorder!==void 0&&n.fixorder!==void 0)return t.fixorder-n.fixorder;if(t.barycenter<n.barycenter)return-1;if(t.barycenter>n.barycenter)return 1;if(e&&t.order!==void 0&&n.order!==void 0){if(t.order<n.order)return-1;if(t.order>n.order)return 1}return r?n.i-t.i:t.i-n.i},jA=(r,e,t,n,i,a)=>{var s,o,u,l;let c=r.getChildren(e).map(m=>m.id);const d=r.getNode(e),h=d?d.data.borderLeft:void 0,f=d?d.data.borderRight:void 0,g={};h&&(c=c==null?void 0:c.filter(m=>m!==h&&m!==f));const v=dF(r,c||[]);v==null||v.forEach(m=>{var w;if(!((w=r.getChildren(m.v))===null||w===void 0)&&w.length){const M=jA(r,m.v,t,n,a);g[m.v]=M,M.hasOwnProperty("barycenter")&&mF(m,M)}});const p=hF(v,t);yF(p,g),(s=p.filter(m=>m.vs.length>0))===null||s===void 0||s.forEach(m=>{const w=r.getNode(m.vs[0]);w&&(m.fixorder=w.data.fixorder,m.order=w.data.order)});const y=pF(p,n,i,a);if(h&&(y.vs=[h,y.vs,f].flat(),!((o=r.getPredecessors(h))===null||o===void 0)&&o.length)){const m=r.getNode(((u=r.getPredecessors(h))===null||u===void 0?void 0:u[0].id)||""),w=r.getNode(((l=r.getPredecessors(f))===null||l===void 0?void 0:l[0].id)||"");y.hasOwnProperty("barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+m.data.order+w.data.order)/(y.weight+2),y.weight+=2}return y},yF=(r,e)=>{r==null||r.forEach(t=>{var n;const i=(n=t.vs)===null||n===void 0?void 0:n.map(a=>e[a]?e[a].vs:a);t.vs=i.flat()})},mF=(r,e)=>{r.barycenter!==void 0?(r.barycenter=(r.barycenter*r.weight+e.barycenter*e.weight)/(r.weight+e.weight),r.weight+=e.weight):(r.barycenter=e.barycenter,r.weight=e.weight)},bF=(r,e)=>{const t=CA(r),n=[],i=[];for(let c=1;c<t+1;c++)n.push(c);for(let c=t-1;c>-1;c--)i.push(c);const a=Lw(r,n,"in"),s=Lw(r,i,"out");let o=Cw(r);Jh(r,o);let u=Number.POSITIVE_INFINITY,l;for(let c=0,d=0;d<4;++c,++d){Dw(c%2?a:s,c%4>=2,!1,e),o=Yo(r);const h=Nw(r,o);h<u&&(d=0,l=la(o),u=h)}o=Cw(r),Jh(r,o);for(let c=0,d=0;d<4;++c,++d){Dw(c%2?a:s,c%4>=2,!0,e),o=Yo(r);const h=Nw(r,o);h<u&&(d=0,l=la(o),u=h)}Jh(r,l)},Lw=(r,e,t)=>e.map(n=>uF(r,n,t)),Dw=(r,e,t,n)=>{const i=new cn;r==null||r.forEach(a=>{var s;const o=a.getRoots()[0].id,u=jA(a,o,i,e,t,n);for(let l=0;l<((s=u.vs)===null||s===void 0?void 0:s.length);l++){const c=a.getNode(u.vs[l]);c&&(c.data.order=l)}oF(a,i,u.vs)})},Jh=(r,e)=>{e==null||e.forEach(t=>{t==null||t.forEach((n,i)=>{r.getNode(n).data.order=i})})},wF=(r,e)=>{const n=r.getAllNodes().filter(s=>{var o;return!(!((o=r.getChildren(s.id))===null||o===void 0)&&o.length)}).map(s=>s.data.rank),i=Math.max(...n),a=[];for(let s=0;s<i+1;s++)a[s]=[];e==null||e.forEach(s=>{const o=r.getNode(s);!o||o.data.dummy||isNaN(o.data.rank)||(o.data.fixorder=a[o.data.rank].length,a[o.data.rank].push(s))})},xF=r=>{const e={};let t=0;const n=i=>{const a=t;r.getChildren(i).forEach(s=>n(s.id)),e[i]={low:a,lim:t++}};return r.getRoots().forEach(i=>n(i.id)),e},EF=(r,e,t,n)=>{var i,a;const s=[],o=[],u=Math.min(e[t].low,e[n].low),l=Math.max(e[t].lim,e[n].lim);let c,d;c=t;do c=(i=r.getParent(c))===null||i===void 0?void 0:i.id,s.push(c);while(c&&(e[c].low>u||l>e[c].lim));for(d=c,c=n;c&&c!==d;)o.push(c),c=(a=r.getParent(c))===null||a===void 0?void 0:a.id;return{lca:d,path:s.concat(o.reverse())}},MF=(r,e)=>{const t=xF(r);e.forEach(n=>{var i,a;let s=n,o=r.getNode(s);const u=o.data.originalEdge;if(!u)return;const l=EF(r,t,u.source,u.target),c=l.path,d=l.lca;let h=0,f=c[h],g=!0;for(;s!==u.target;){if(o=r.getNode(s),g){for(;f!==d&&((i=r.getNode(f))===null||i===void 0?void 0:i.data.maxRank)<o.data.rank;)h++,f=c[h];f===d&&(g=!1)}if(!g){for(;h<c.length-1&&((a=r.getNode(c[h+1]))===null||a===void 0?void 0:a.data.minRank)<=o.data.rank;)h++;f=c[h]}r.hasNode(f)&&r.setParent(s,f),s=r.getSuccessors(s)[0].id}})},SF=(r,e)=>{const t={},n=(i,a)=>{let s=0,o=0;const u=i.length,l=a==null?void 0:a[(a==null?void 0:a.length)-1];return a==null||a.forEach((c,d)=>{var h;const f=TF(r,c),g=f?r.getNode(f.id).data.order:u;(f||c===l)&&((h=a.slice(o,d+1))===null||h===void 0||h.forEach(v=>{var p;(p=r.getPredecessors(v))===null||p===void 0||p.forEach(y=>{var m;const w=r.getNode(y.id),M=w.data.order;(M<s||g<M)&&!(w.data.dummy&&(!((m=r.getNode(v))===null||m===void 0)&&m.data.dummy))&&BA(t,y.id,v)})}),o=d+1,s=g)}),a};return e!=null&&e.length&&e.reduce(n),t},_F=(r,e)=>{const t={};function n(o,u,l,c,d){var h,f;let g;for(let v=u;v<l;v++)g=o[v],!((h=r.getNode(g))===null||h===void 0)&&h.data.dummy&&((f=r.getPredecessors(g))===null||f===void 0||f.forEach(p=>{const y=r.getNode(p.id);y.data.dummy&&(y.data.order<c||y.data.order>d)&&BA(t,p.id,g)}))}function i(o){return JSON.stringify(o.slice(1))}function a(o,u){const l=i(o);u.get(l)||(n(...o),u.set(l,!0))}const s=(o,u)=>{let l=-1,c,d=0;const h=new Map;return u==null||u.forEach((f,g)=>{var v;if(((v=r.getNode(f))===null||v===void 0?void 0:v.data.dummy)==="border"){const p=r.getPredecessors(f)||[];p.length&&(c=r.getNode(p[0].id).data.order,a([u,d,g,l,c],h),d=g,l=c)}a([u,d,u.length,c,o.length],h)}),u};return e!=null&&e.length&&e.reduce(s),t},TF=(r,e)=>{var t,n;if(!((t=r.getNode(e))===null||t===void 0)&&t.data.dummy)return(n=r.getPredecessors(e))===null||n===void 0?void 0:n.find(i=>r.getNode(i.id).data.dummy)},BA=(r,e,t)=>{let n=e,i=t;if(n>i){const s=n;n=i,i=s}let a=r[n];a||(r[n]=a={}),a[i]=!0},OF=(r,e,t)=>{let n=e,i=t;if(n>i){const a=e;n=i,i=a}return!!r[n]},AF=(r,e,t,n)=>{const i={},a={},s={};return e==null||e.forEach(o=>{o==null||o.forEach((u,l)=>{i[u]=u,a[u]=u,s[u]=l})}),e==null||e.forEach(o=>{let u=-1;o==null||o.forEach(l=>{let c=n(l).map(d=>d.id);if(c.length){c=c.sort((h,f)=>s[h]-s[f]);const d=(c.length-1)/2;for(let h=Math.floor(d),f=Math.ceil(d);h<=f;++h){const g=c[h];a[l]===l&&u<s[g]&&!OF(t,l,g)&&(a[g]=l,a[l]=i[l]=i[g],u=s[g])}}})}),{root:i,align:a}},kF=(r,e,t,n,i,a,s)=>{var o;const u={},l=NF(r,e,t,i,a,s),c=s?"borderLeft":"borderRight",d=(g,v)=>{let p=l.getAllNodes(),y=p.pop();const m={};for(;y;)m[y.id]?g(y.id):(m[y.id]=!0,p.push(y),p=p.concat(v(y.id))),y=p.pop()},h=g=>{u[g]=(l.getRelatedEdges(g,"in")||[]).reduce((v,p)=>Math.max(v,(u[p.source]||0)+p.data.weight),0)},f=g=>{const v=(l.getRelatedEdges(g,"out")||[]).reduce((y,m)=>Math.min(y,(u[m.target]||0)-m.data.weight),Number.POSITIVE_INFINITY),p=r.getNode(g);v!==Number.POSITIVE_INFINITY&&p.data.borderType!==c&&(u[g]=Math.max(u[g],v))};return d(h,l.getPredecessors.bind(l)),d(f,l.getSuccessors.bind(l)),(o=Object.values(n))===null||o===void 0||o.forEach(g=>{u[g]=u[t[g]]}),u},NF=(r,e,t,n,i,a)=>{const s=new cn,o=DF(n,i,a);return e==null||e.forEach(u=>{let l;u==null||u.forEach(c=>{const d=t[c];if(s.hasNode(d)||s.addNode({id:d,data:{}}),l){const h=t[l],f=s.getRelatedEdges(h,"out").find(g=>g.target===d);f?s.updateEdgeData(f.id,Object.assign(Object.assign({},f.data),{weight:Math.max(o(r,c,l),f.data.weight||0)})):s.addEdge({id:`e${Math.random()}`,source:h,target:d,data:{weight:Math.max(o(r,c,l),0)}})}l=c})}),s},CF=(r,e)=>Fm(Object.values(e),t=>{var n;let i=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY;return(n=Object.keys(t))===null||n===void 0||n.forEach(s=>{const o=t[s],u=IF(r,s)/2;i=Math.max(o+u,i),a=Math.min(o-u,a)}),i-a});function PF(r,e){const t=Object.values(e),n=Math.min(...t),i=Math.max(...t);["u","d"].forEach(a=>{["l","r"].forEach(s=>{const o=a+s,u=r[o];let l;if(u===e)return;const c=Object.values(u);l=s==="l"?n-Math.min(...c):i-Math.max(...c),l&&(r[o]={},Object.keys(u).forEach(d=>{r[o][d]=u[d]+l}))})})}const LF=(r,e)=>{const t={};return Object.keys(r.ul).forEach(n=>{if(e)t[n]=r[e.toLowerCase()][n];else{const i=Object.values(r).map(a=>a[n]);t[n]=(i[0]+i[1])/2}}),t},DF=(r,e,t)=>(n,i,a)=>{const s=n.getNode(i),o=n.getNode(a);let u=0,l=0;if(u+=s.data.width/2,s.data.hasOwnProperty("labelpos"))switch((s.data.labelpos||"").toLowerCase()){case"l":l=-s.data.width/2;break;case"r":l=s.data.width/2;break}if(l&&(u+=t?l:-l),l=0,u+=(s.data.dummy?e:r)/2,u+=(o.data.dummy?e:r)/2,u+=o.data.width/2,o.data.labelpos)switch((o.data.labelpos||"").toLowerCase()){case"l":l=o.data.width/2;break;case"r":l=-o.data.width/2;break}return l&&(u+=t?l:-l),l=0,u},IF=(r,e)=>r.getNode(e).data.width||0,RF=(r,e)=>{const{ranksep:t=0}=e,n=Yo(r);let i=0;n==null||n.forEach(a=>{const s=a.map(u=>r.getNode(u).data.height),o=Math.max(...s,0);a==null||a.forEach(u=>{r.getNode(u).data.y=i+o/2}),i+=o+t})},jF=(r,e)=>{const{align:t,nodesep:n=0,edgesep:i=0}=e,a=Yo(r),s=Object.assign(SF(r,a),_F(r,a)),o={};let u=[];["u","d"].forEach(c=>{u=c==="u"?a:Object.values(a).reverse(),["l","r"].forEach(d=>{d==="r"&&(u=u.map(v=>Object.values(v).reverse()));const h=(c==="u"?r.getPredecessors:r.getSuccessors).bind(r),f=AF(r,u,s,h),g=kF(r,u,f.root,f.align,n,i,d==="r");d==="r"&&Object.keys(g).forEach(v=>g[v]=-g[v]),o[c+d]=g})});const l=CF(r,o);return l&&PF(o,l),LF(o,t)},BF=(r,e)=>{var t;const n=NA(r);RF(n,e);const i=jF(n,e);(t=Object.keys(i))===null||t===void 0||t.forEach(a=>{n.getNode(a).data.x=i[a]})},FA=r=>{const e={},t=n=>{var i;const a=r.getNode(n);if(!a)return 0;if(e[n])return a.data.rank;e[n]=!0;let s;return(i=r.getRelatedEdges(n,"out"))===null||i===void 0||i.forEach(o=>{const u=t(o.target),l=o.data.minlen,c=u-l;c&&(s===void 0||c<s)&&(s=c)}),s||(s=0),a.data.rank=s,s};r.getAllNodes().filter(n=>r.getRelatedEdges(n.id,"in").length===0).forEach(n=>t(n.id))},FF=r=>{const e={};let t;const n=s=>{var o;const u=r.getNode(s);if(!u)return 0;if(e[s])return u.data.rank;e[s]=!0;let l;return(o=r.getRelatedEdges(s,"out"))===null||o===void 0||o.forEach(c=>{const d=n(c.target),h=c.data.minlen,f=d-h;f&&(l===void 0||f<l)&&(l=f)}),l||(l=0),(t===void 0||l<t)&&(t=l),u.data.rank=l,l};r.getAllNodes().filter(s=>r.getRelatedEdges(s.id,"in").length===0).forEach(s=>{s&&n(s.id)}),t===void 0&&(t=0);const i={},a=(s,o)=>{var u;const l=r.getNode(s),c=isNaN(l.data.layer)?o:l.data.layer;(l.data.rank===void 0||l.data.rank<c)&&(l.data.rank=c),!i[s]&&(i[s]=!0,(u=r.getRelatedEdges(s,"out"))===null||u===void 0||u.forEach(d=>{a(d.target,c+d.data.minlen)}))};r.getAllNodes().forEach(s=>{const o=s.data;o&&(isNaN(o.layer)?o.rank-=t:a(s.id,o.layer))})},fa=(r,e)=>r.getNode(e.target).data.rank-r.getNode(e.source).data.rank-e.data.minlen,zF=r=>{const e=new cn({tree:[]}),t=r.getAllNodes()[0],n=r.getAllNodes().length;e.addNode(t);let i,a;for(;$F(e,r)<n;)i=zA(e,r),a=e.hasNode(i.source)?fa(r,i):-fa(r,i),$A(e,r,a);return e},$F=(r,e)=>{const t=n=>{e.getRelatedEdges(n,"both").forEach(i=>{const a=i.source,s=n===a?i.target:a;!r.hasNode(s)&&!fa(e,i)&&(r.addNode({id:s,data:{}}),r.addEdge({id:i.id,source:n,target:s,data:{}}),t(s))})};return r.getAllNodes().forEach(n=>t(n.id)),r.getAllNodes().length},qF=r=>{const e=new cn({tree:[]}),t=r.getAllNodes()[0],n=r.getAllNodes().length;e.addNode(t);let i,a;for(;GF(e,r)<n;)i=zA(e,r),a=e.hasNode(i.source)?fa(r,i):-fa(r,i),$A(e,r,a);return e},GF=(r,e)=>{const t=n=>{var i;(i=e.getRelatedEdges(n,"both"))===null||i===void 0||i.forEach(a=>{const s=a.source,o=n===s?a.target:s;!r.hasNode(o)&&(e.getNode(o).data.layer!==void 0||!fa(e,a))&&(r.addNode({id:o,data:{}}),r.addEdge({id:a.id,source:n,target:o,data:{}}),t(o))})};return r.getAllNodes().forEach(n=>t(n.id)),r.getAllNodes().length},zA=(r,e)=>Fm(e.getAllEdges(),t=>r.hasNode(t.source)!==r.hasNode(t.target)?fa(e,t):1/0),$A=(r,e,t)=>{r.getAllNodes().forEach(n=>{const i=e.getNode(n.id);i.data.rank||(i.data.rank=0),i.data.rank+=t})},WF=r=>{const e=GB(r);FA(e);const t=zF(e);GA(t),qA(t,e);let n,i;for(;n=UF(t);)i=HF(t,e,n),XF(t,e,n,i)},qA=(r,e)=>{let t=LA(r,r.getAllNodes(),"post");t=t.slice(0,(t==null?void 0:t.length)-1),t.forEach(n=>{VF(r,e,n)})},VF=(r,e,t)=>{const i=r.getNode(t).data.parent,a=r.getRelatedEdges(t,"both").find(s=>s.target===i||s.source===i);a.data.cutvalue=YF(r,e,t)},YF=(r,e,t)=>{const i=r.getNode(t).data.parent;let a=!0,s=e.getRelatedEdges(t,"out").find(u=>u.target===i),o=0;return s||(a=!1,s=e.getRelatedEdges(i,"out").find(u=>u.target===t)),o=s.data.weight,e.getRelatedEdges(t,"both").forEach(u=>{const l=u.source===t,c=l?u.target:u.source;if(c!==i){const d=l===a,h=u.data.weight;if(o+=d?h:-h,ZF(r,t,c)){const f=r.getRelatedEdges(t,"both").find(g=>g.source===c||g.target===c).data.cutvalue;o+=d?-f:f}}}),o},GA=(r,e=r.getAllNodes()[0].id)=>{WA(r,{},1,e)},WA=(r,e,t,n,i)=>{var a;const s=t;let o=t;const u=r.getNode(n);return e[n]=!0,(a=r.getNeighbors(n))===null||a===void 0||a.forEach(l=>{e[l.id]||(o=WA(r,e,o,l.id,n))}),u.data.low=s,u.data.lim=o++,i?u.data.parent=i:delete u.data.parent,o},UF=r=>r.getAllEdges().find(e=>e.data.cutvalue<0),HF=(r,e,t)=>{let n=t.source,i=t.target;e.getRelatedEdges(n,"out").find(c=>c.target===i)||(n=t.target,i=t.source);const a=r.getNode(n),s=r.getNode(i);let o=a,u=!1;a.data.lim>s.data.lim&&(o=s,u=!0);const l=e.getAllEdges().filter(c=>u===Iw(r.getNode(c.source),o)&&u!==Iw(r.getNode(c.target),o));return Fm(l,c=>fa(e,c))},XF=(r,e,t,n)=>{const i=r.getRelatedEdges(t.source,"both").find(a=>a.source===t.target||a.target===t.target);i&&r.removeEdge(i.id),r.addEdge({id:`e${Math.random()}`,source:n.source,target:n.target,data:{}}),GA(r),qA(r,e),KF(r,e)},KF=(r,e)=>{const t=r.getAllNodes().find(i=>!i.data.parent);let n=LA(r,t,"pre");n=n.slice(1),n.forEach(i=>{const a=r.getNode(i).data.parent;let s=e.getRelatedEdges(i,"out").find(u=>u.target===a),o=!1;!s&&e.hasNode(a)&&(s=e.getRelatedEdges(a,"out").find(u=>u.target===i),o=!0),e.getNode(i).data.rank=(e.hasNode(a)&&e.getNode(a).data.rank||0)+(o?s==null?void 0:s.data.minlen:-(s==null?void 0:s.data.minlen))})},ZF=(r,e,t)=>r.getRelatedEdges(e,"both").find(n=>n.source===t||n.target===t),Iw=(r,e)=>e.data.low<=r.data.lim&&r.data.lim<=e.data.lim,QF=(r,e)=>{switch(e){case"network-simplex":ez(r);break;case"tight-tree":Rw(r);break;case"longest-path":JF(r);break;default:Rw(r)}},JF=FA,Rw=r=>{FF(r),qF(r)},ez=r=>{WF(r)},tz=(r,e)=>{const{edgeLabelSpace:t,keepNodeOrder:n,prevGraph:i,rankdir:a,ranksep:s}=e;!n&&i&&rz(r,i);const o=lz(r);t&&(e.ranksep=cz(o,{rankdir:a,ranksep:s}));let u;try{u=nz(o,e)}catch(l){if(l.message==="Not possible to find intersection inside of the rectangle"){console.error(`The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:
`,l);return}throw l}return iz(r,o),u},nz=(r,e)=>{const{acyclicer:t,ranker:n,rankdir:i="tb",nodeOrder:a,keepNodeOrder:s,align:o,nodesep:u=50,edgesep:l=20,ranksep:c=50}=e;bz(r),FB(r,t);const{nestingRoot:d,nodeRankFactor:h}=JB(r);QF(NA(r),n),dz(r),YB(r,h),nF(r,d),VB(r),hz(r),fz(r);const f=[];iF(r,f),MF(r,f),HB(r),s&&wF(r,a),bF(r,s),wz(r),XB(r,i),BF(r,{align:o,nodesep:u,edgesep:l,ranksep:c}),xz(r),mz(r),sF(r,f),vz(r),KB(r,i);const{width:g,height:v}=gz(r);return pz(r),yz(r),$B(r),{width:g,height:v}},rz=(r,e)=>{r.getAllNodes().forEach(t=>{const n=r.getNode(t.id);if(e.hasNode(t.id)){const i=e.getNode(t.id);n.data.fixorder=i.data._order,delete i.data._order}else delete n.data.fixorder})},iz=(r,e)=>{r.getAllNodes().forEach(t=>{var n;const i=r.getNode(t.id);if(i){const a=e.getNode(t.id);i.data.x=a.data.x,i.data.y=a.data.y,i.data._order=a.data.order,i.data._rank=a.data.rank,!((n=e.getChildren(t.id))===null||n===void 0)&&n.length&&(i.data.width=a.data.width,i.data.height=a.data.height)}}),r.getAllEdges().forEach(t=>{const n=r.getEdge(t.id),i=e.getEdge(t.id);n.data.points=i?i.data.points:[],i&&i.data.hasOwnProperty("x")&&(n.data.x=i.data.x,n.data.y=i.data.y)})},az=["width","height","layer","fixorder"],sz={width:0,height:0},oz=["minlen","weight","width","height","labeloffset"],uz={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},ef=["labelpos"],lz=r=>{const e=new cn({tree:[]});return r.getAllNodes().forEach(t=>{const n=Bw(r.getNode(t.id).data),i=Object.assign(Object.assign({},sz),n),a=jw(i,az);e.hasNode(t.id)||e.addNode({id:t.id,data:Object.assign({},a)});const s=r.hasTreeStructure("combo")?r.getParent(t.id,"combo"):r.getParent(t.id);Le(s)||(e.hasNode(s.id)||e.addNode(Object.assign({},s)),e.setParent(t.id,s.id))}),r.getAllEdges().forEach(t=>{const n=Bw(r.getEdge(t.id).data),i={};ef==null||ef.forEach(a=>{n[a]!==void 0&&(i[a]=n[a])}),e.addEdge({id:t.id,source:t.source,target:t.target,data:Object.assign({},uz,jw(n,oz),i)})}),e},cz=(r,e)=>{const{ranksep:t=0,rankdir:n}=e;return r.getAllNodes().forEach(i=>{isNaN(i.data.layer)||i.data.layer||(i.data.layer=0)}),r.getAllEdges().forEach(i=>{var a;i.data.minlen*=2,((a=i.data.labelpos)===null||a===void 0?void 0:a.toLowerCase())!=="c"&&(n==="TB"||n==="BT"?i.data.width+=i.data.labeloffset:i.data.height+=i.data.labeloffset)}),t/2},dz=r=>{r.getAllEdges().forEach(e=>{if(e.data.width&&e.data.height){const t=r.getNode(e.source),n=r.getNode(e.target),i={e,rank:(n.data.rank-t.data.rank)/2+t.data.rank};Us(r,"edge-proxy",i,"_ep")}})},hz=r=>{let e=0;return r.getAllNodes().forEach(t=>{var n,i;t.data.borderTop&&(t.data.minRank=(n=r.getNode(t.data.borderTop))===null||n===void 0?void 0:n.data.rank,t.data.maxRank=(i=r.getNode(t.data.borderBottom))===null||i===void 0?void 0:i.data.rank,e=Math.max(e,t.data.maxRank||-1/0))}),e},fz=r=>{r.getAllNodes().forEach(e=>{e.data.dummy==="edge-proxy"&&(r.getEdge(e.data.e.id).data.labelRank=e.data.rank,r.removeNode(e.id))})},gz=(r,e)=>{let t,n=0,i,a=0;const{marginx:s=0,marginy:o=0}={},u=l=>{if(!l.data)return;const c=l.data.x,d=l.data.y,h=l.data.width,f=l.data.height;!isNaN(c)&&!isNaN(h)&&(t===void 0&&(t=c-h/2),t=Math.min(t,c-h/2),n=Math.max(n,c+h/2)),!isNaN(d)&&!isNaN(f)&&(i===void 0&&(i=d-f/2),i=Math.min(i,d-f/2),a=Math.max(a,d+f/2))};return r.getAllNodes().forEach(l=>{u(l)}),r.getAllEdges().forEach(l=>{l!=null&&l.data.hasOwnProperty("x")&&u(l)}),t-=s,i-=o,r.getAllNodes().forEach(l=>{l.data.x-=t,l.data.y-=i}),r.getAllEdges().forEach(l=>{var c;(c=l.data.points)===null||c===void 0||c.forEach(d=>{d.x-=t,d.y-=i}),l.data.hasOwnProperty("x")&&(l.data.x-=t),l.data.hasOwnProperty("y")&&(l.data.y-=i)}),{width:n-t+s,height:a-i+o}},pz=r=>{r.getAllEdges().forEach(e=>{const t=r.getNode(e.source),n=r.getNode(e.target);let i,a;e.data.points?(i=e.data.points[0],a=e.data.points[e.data.points.length-1]):(e.data.points=[],i={x:n.data.x,y:n.data.y},a={x:t.data.x,y:t.data.y}),e.data.points.unshift(Tw(t.data,i)),e.data.points.push(Tw(n.data,a))})},vz=r=>{r.getAllEdges().forEach(e=>{if(e.data.hasOwnProperty("x"))switch((e.data.labelpos==="l"||e.data.labelpos==="r")&&(e.data.width-=e.data.labeloffset),e.data.labelpos){case"l":e.data.x-=e.data.width/2+e.data.labeloffset;break;case"r":e.data.x+=e.data.width/2+e.data.labeloffset;break}})},yz=r=>{r.getAllEdges().forEach(e=>{var t;e.data.reversed&&((t=e.data.points)===null||t===void 0||t.reverse())})},mz=r=>{r.getAllNodes().forEach(e=>{var t,n,i;if(!((t=r.getChildren(e.id))===null||t===void 0)&&t.length){const a=r.getNode(e.id),s=r.getNode(a.data.borderTop),o=r.getNode(a.data.borderBottom),u=r.getNode(a.data.borderLeft[((n=a.data.borderLeft)===null||n===void 0?void 0:n.length)-1]),l=r.getNode(a.data.borderRight[((i=a.data.borderRight)===null||i===void 0?void 0:i.length)-1]);a.data.width=Math.abs((l==null?void 0:l.data.x)-(u==null?void 0:u.data.x))||10,a.data.height=Math.abs((o==null?void 0:o.data.y)-(s==null?void 0:s.data.y))||10,a.data.x=((u==null?void 0:u.data.x)||0)+a.data.width/2,a.data.y=((s==null?void 0:s.data.y)||0)+a.data.height/2}}),r.getAllNodes().forEach(e=>{e.data.dummy==="border"&&r.removeNode(e.id)})},bz=r=>{r.getAllEdges().forEach(e=>{if(e.source===e.target){const t=r.getNode(e.source);t.data.selfEdges||(t.data.selfEdges=[]),t.data.selfEdges.push(e),r.removeEdge(e.id)}})},wz=r=>{const e=Yo(r);e==null||e.forEach(t=>{let n=0;t==null||t.forEach((i,a)=>{var s;const o=r.getNode(i);o.data.order=a+n,(s=o.data.selfEdges)===null||s===void 0||s.forEach(u=>{Us(r,"selfedge",{width:u.data.width,height:u.data.height,rank:o.data.rank,order:a+ ++n,e:u},"_se")}),delete o.data.selfEdges})})},xz=r=>{r.getAllNodes().forEach(e=>{const t=r.getNode(e.id);if(t.data.dummy==="selfedge"){const n=r.getNode(t.data.e.source),i=n.data.x+n.data.width/2,a=n.data.y,s=t.data.x-i,o=n.data.height/2;r.hasEdge(t.data.e.id)?r.updateEdgeData(t.data.e.id,t.data.e.data):r.addEdge({id:t.data.e.id,source:t.data.e.source,target:t.data.e.target,data:t.data.e.data}),r.removeNode(e.id),t.data.e.data.points=[{x:i+2*s/3,y:a-o},{x:i+5*s/6,y:a-o},{y:a,x:i+s},{x:i+5*s/6,y:a+o},{x:i+2*s/3,y:a+o}],t.data.e.data.x=t.data.x,t.data.e.data.y=t.data.y}})},jw=(r,e)=>{const t={};return e==null||e.forEach(n=>{r[n]!==void 0&&(t[n]=+r[n])}),t},Bw=(r={})=>{const e={};return Object.keys(r).forEach(t=>{e[t.toLowerCase()]=r[t]}),e},Ei=Array.isArray,VA=r=>{const e=[],t=r.length;for(let n=0;n<t;n+=1){e[n]=[];for(let i=0;i<t;i+=1)n===i?e[n][i]=0:r[n][i]===0||!r[n][i]?e[n][i]=1/0:e[n][i]=r[n][i]}for(let n=0;n<t;n+=1)for(let i=0;i<t;i+=1)for(let a=0;a<t;a+=1)e[i][a]>e[i][n]+e[n][a]&&(e[i][a]=e[i][n]+e[n][a]);return e},YA=(r,e)=>{const{nodes:t,edges:n}=r,i=[],a={};if(!t)throw new Error("invalid nodes data!");return t&&t.forEach((s,o)=>{a[s.id]=o;const u=[];i.push(u)}),n==null||n.forEach(s=>{const{source:o,target:u}=s,l=a[o],c=a[u];l===void 0||c===void 0||(i[l][c]=1,i[c][l]=1)}),i},Ez=(r,e)=>{const t=[];return r.forEach(n=>{const i=[];n.forEach(a=>{i.push(a*e)}),t.push(i)}),t},Mz=r=>{let e=1/0,t=1/0,n=-1/0,i=-1/0;return r.forEach(a=>{let s=a.data.size;Ei(s)?s.length===1&&(s=[s[0],s[0]]):Ee(s)?s=[s,s]:(s===void 0||isNaN(s))&&(s=[30,30]);const o=[s[0]/2,s[1]/2],u=a.data.x-o[0],l=a.data.x+o[0],c=a.data.y-o[1],d=a.data.y+o[1];e>u&&(e=u),t>c&&(t=c),n<l&&(n=l),i<d&&(i=d)}),{minX:e,minY:t,maxX:n,maxY:i}},Fw=(r,e)=>Math.sqrt((r.x-e.x)*(r.x-e.x)+(r.y-e.y)*(r.y-e.y)),ky=(r,e,t,n="TB",i,a={})=>{if(!(e!=null&&e.length))return;const{stopBranchFn:s,stopAllFn:o}=a;for(let u=0;u<e.length;u++){const l=e[u];if(r.hasNode(l.id)&&!(s!=null&&s(l))){if(o!=null&&o(l))return;n==="TB"&&t(l),ky(r,r.getChildren(l.id,i),t,n,i,a),n!=="TB"&&t(l)}}},Ny=r=>{if(r===null)return r;if(r instanceof Date)return new Date(r.getTime());if(r instanceof Array){const e=[];return r.forEach(t=>{e.push(t)}),e.map(t=>Ny(t))}if(typeof r=="object"){const e={};return Object.keys(r).forEach(t=>{e[t]=Ny(r[t])}),e}return r},cr=(r,e)=>{const t=Ny(r);return t.data=t.data||{},e&&(Ee(t.data.x)||(t.data.x=Math.random()*e[0]),Ee(t.data.y)||(t.data.y=Math.random()*e[1])),t};function bu(r){if(!r)return[0,0,0];if(Ee(r))return[r,r,r];if(r.length===0)return[0,0,0];const[e,t=e,n=e]=r;return[e,t,n]}function Fa(r,e){let t;return Te(e)?t=e:Ee(e)?t=()=>e:t=()=>r,t}function zm(r,e,t=!0){return!e&&e!==0?n=>{const{size:i}=n.data||{};return i?Array.isArray(i)?t?Math.max(...i)||r:i:Yt(i)&&i.width&&i.height?t?Math.max(i.width,i.height)||r:[i.width,i.height]:i:r}:Te(e)?e:Ee(e)?()=>e:Array.isArray(e)?()=>t?Math.max(...e)||r:e:Yt(e)&&e.width&&e.height?()=>t?Math.max(e.width,e.height)||r:[e.width,e.height]:()=>r}const $m=(r,e,t=10)=>{let n;const i=typeof e=="function"?e:()=>e||0;return r?Array.isArray(r)?n=s=>r:Te(r)?n=r:n=s=>r:n=s=>{var o,u,l;if(!((o=s.data)===null||o===void 0)&&o.bboxSize)return(u=s.data)===null||u===void 0?void 0:u.bboxSize;if(!((l=s.data)===null||l===void 0)&&l.size){const c=s.data.size;return Array.isArray(c)?c:Yt(c)?[c.width,c.height]:c}return t},s=>{const o=n(s),u=i(s);return Math.max(...bu(o))+u}},Sz={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,ranker:"tight-tree",controlPoints:!1,radial:!1,focusNode:null};class _z{constructor(e={}){this.options=e,this.id="antv-dagre",this.options=Object.assign(Object.assign({},Sz),e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericDagreLayout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericDagreLayout(!0,e,t)})}genericDagreLayout(e,t,n){return Ye(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{nodeSize:a,align:s,rankdir:o="TB",ranksep:u,nodesep:l,ranksepFunc:c,nodesepFunc:d,edgeLabelSpace:h,ranker:f,nodeOrder:g,begin:v,controlPoints:p,radial:y,sortByCombo:m,preset:w}=i,M=new cn({tree:[]}),S=Fa(u||50,c),T=Fa(l||50,d);let A=T,O=S;(o==="LR"||o==="RL")&&(A=S,O=T);const N=zm(10,a,!1),C=t.getAllNodes(),P=t.getAllEdges();C.forEach(z=>{const Z=bu(N(z)),ne=O(z),se=A(z),oe=Z[0]+2*se,Ne=Z[1]+2*ne,K=z.data.layer;Ee(K)?M.addNode({id:z.id,data:{width:oe,height:Ne,layer:K}}):M.addNode({id:z.id,data:{width:oe,height:Ne}})}),m&&(M.attachTreeStructure("combo"),C.forEach(z=>{const{parentId:Z}=z.data;Z!==void 0&&M.hasNode(Z)&&M.setParent(z.id,Z,"combo")})),P.forEach(z=>{M.addEdge({id:z.id,source:z.source,target:z.target,data:{weight:z.data.weight||1}})});let D;w!=null&&w.length&&(D=new cn({nodes:w})),tz(M,{prevGraph:D,edgeLabelSpace:h,keepNodeOrder:!!g,nodeOrder:g||[],acyclicer:"greedy",ranker:f,rankdir:o,nodesep:l,align:s});const j=[0,0];if(v){let z=1/0,Z=1/0;M.getAllNodes().forEach(ne=>{z>ne.data.x&&(z=ne.data.x),Z>ne.data.y&&(Z=ne.data.y)}),M.getAllEdges().forEach(ne=>{var se;(se=ne.data.points)===null||se===void 0||se.forEach(oe=>{z>oe.x&&(z=oe.x),Z>oe.y&&(Z=oe.y)})}),j[0]=v[0]-z,j[1]=v[1]-Z}const G=o==="LR"||o==="RL";if(!y){const z=new Set,ne=o==="BT"||o==="RL"?(K,W)=>W-K:(K,W)=>K-W;M.getAllNodes().forEach(K=>{K.data.x=K.data.x+j[0],K.data.y=K.data.y+j[1],z.add(G?K.data.x:K.data.y)});const se=Array.from(z).sort(ne),oe=G?(K,W)=>K.x!==W.x:(K,W)=>K.y!==W.y,Ne=G?(K,W,ee)=>{const le=Math.max(W.y,ee.y),xe=Math.min(W.y,ee.y);return K.filter(Ce=>Ce.y<=le&&Ce.y>=xe)}:(K,W,ee)=>{const le=Math.max(W.x,ee.x),xe=Math.min(W.x,ee.x);return K.filter(Ce=>Ce.x<=le&&Ce.x>=xe)};M.getAllEdges().forEach((K,W)=>{var ee;h&&p&&K.data.type!=="loop"&&(K.data.controlPoints=Tz((ee=K.data.points)===null||ee===void 0?void 0:ee.map(({x:le,y:xe})=>({x:le+j[0],y:xe+j[1]})),M.getNode(K.source),M.getNode(K.target),se,G,oe,Ne))})}let V=[];V=M.getAllNodes().map(z=>cr(z));const Y=M.getAllEdges();return e&&(V.forEach(z=>{t.mergeNodeData(z.id,{x:z.data.x,y:z.data.y})}),Y.forEach(z=>{t.mergeEdgeData(z.id,{controlPoints:z.data.controlPoints})})),{nodes:V,edges:Y}})}}const Tz=(r,e,t,n,i,a,s)=>{let o=(r==null?void 0:r.slice(1,r.length-1))||[];if(e&&t){let{x:u,y:l}=e.data,{x:c,y:d}=t.data;if(i&&(u=e.data.y,l=e.data.x,c=t.data.y,d=t.data.x),d!==l&&u!==c){const h=n.indexOf(l),f=n[h+1];if(f){const p=o[0],y=i?{x:(l+f)/2,y:(p==null?void 0:p.y)||c}:{x:(p==null?void 0:p.x)||c,y:(l+f)/2};(!p||a(p,y))&&o.unshift(y)}const g=n.indexOf(d),v=Math.abs(g-h);if(v===1)o=s(o,e.data,t.data),o.length||o.push(i?{x:(l+d)/2,y:u}:{x:u,y:(l+d)/2});else if(v>1){const p=n[g-1];if(p){const y=o[o.length-1],m=i?{x:(d+p)/2,y:(y==null?void 0:y.y)||c}:{x:(y==null?void 0:y.x)||u,y:(d+p)/2};(!y||a(y,m))&&o.push(m)}}}}return o},ns=(r,e,t)=>{const n=r.getAllNodes(),i=r.getAllEdges();if(!(n!=null&&n.length))return{nodes:[],edges:i};if(n.length===1)return e&&r.mergeNodeData(n[0].id,{x:t[0],y:t[1]}),{nodes:[Object.assign(Object.assign({},n[0]),{data:Object.assign(Object.assign({},n[0].data),{x:t[0],y:t[1]})})],edges:i}},Oz={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1};class Az{constructor(e={}){this.options=e,this.id="circular",this.options=Object.assign(Object.assign({},Oz),e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericCircularLayout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericCircularLayout(!0,e,t)})}genericCircularLayout(e,t,n){return Ye(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{width:a,height:s,center:o,divisions:u,startAngle:l=0,endAngle:c=2*Math.PI,angleRatio:d,ordering:h,clockwise:f,nodeSpacing:g,nodeSize:v}=i,p=t.getAllNodes(),y=t.getAllEdges(),[m,w,M]=Nz(a,s,o),S=p==null?void 0:p.length;if(!S||S===1)return ns(t,e,M);const T=(c-l)/S;let{radius:A,startRadius:O,endRadius:N}=i;if(g){const G=Fa(10,g),V=zm(10,v);let Y=-1/0;p.forEach(z=>{const Z=V(z);Y<Z&&(Y=Z)});let $=0;p.forEach((z,Z)=>{Z===0?$+=Y||10:$+=(G(z)||0)+(Y||10)}),A=$/(2*Math.PI)}else!A&&!O&&!N?A=Math.min(w,m)/2:!O&&N?O=N:O&&!N&&(N=O);const C=T*d;let P=[];h==="topology"?P=zw(t,p):h==="topology-directed"?P=zw(t,p,!0):h==="degree"?P=kz(t,p):P=p.map(G=>cr(G));const D=Math.ceil(S/u);for(let G=0;G<S;++G){let V=A;!V&&O!==null&&N!==null&&(V=O+G*(N-O)/(S-1)),V||(V=10+G*100/(S-1));let Y=l+G%D*C+2*Math.PI/u*Math.floor(G/D);f||(Y=c-G%D*C-2*Math.PI/u*Math.floor(G/D)),P[G].data.x=M[0]+Math.cos(Y)*V,P[G].data.y=M[1]+Math.sin(Y)*V}return e&&P.forEach(G=>{t.mergeNodeData(G.id,{x:G.data.x,y:G.data.y})}),{nodes:P,edges:y}})}}const zw=(r,e,t=!1)=>{const n=[cr(e[0])],i={},a=e.length;i[e[0].id]=!0;let s=0;return e.forEach((o,u)=>{if(u!==0)if((u===a-1||r.getDegree(o.id,"both")!==r.getDegree(e[u+1].id,"both")||r.areNeighbors(n[s].id,o.id))&&!i[o.id])n.push(cr(o)),i[o.id]=!0,s++;else{const l=t?r.getSuccessors(n[s].id):r.getNeighbors(n[s].id);let c=!1;for(let h=0;h<l.length;h++){const f=l[h];if(r.getDegree(f.id)===r.getDegree(o.id)&&!i[f.id]){n.push(cr(f)),i[f.id]=!0,c=!0;break}}let d=0;for(;!c&&(i[e[d].id]||(n.push(cr(e[d])),i[e[d].id]=!0,c=!0),d++,d!==a););}}),n};function kz(r,e){const t=[];return e.forEach((n,i)=>{t.push(cr(n))}),t.sort((n,i)=>r.getDegree(n.id,"both")-r.getDegree(i.id,"both")),t}const Nz=(r,e,t)=>{let n=r,i=e,a=t;return!n&&typeof window<"u"&&(n=window.innerWidth),!i&&typeof window<"u"&&(i=window.innerHeight),a||(a=[n/2,i/2]),[n,i,a]},Cz={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:3/2*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"};class Cy{constructor(e={}){this.options=e,this.id="concentric",this.options=Object.assign(Object.assign({},Cz),e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericConcentricLayout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericConcentricLayout(!0,e,t)})}genericConcentricLayout(e,t,n){return Ye(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{center:a,width:s,height:o,sortBy:u,maxLevelDiff:l,sweep:c,clockwise:d,equidistant:h,preventOverlap:f,startAngle:g=3/2*Math.PI,nodeSize:v,nodeSpacing:p}=i,y=t.getAllNodes(),m=t.getAllEdges(),w=!s&&typeof window<"u"?window.innerWidth:s,M=!o&&typeof window<"u"?window.innerHeight:o,S=a||[w/2,M/2];if(!(y!=null&&y.length)||y.length===1)return ns(t,e,S);const T=[];let A,O=0;Ei(v)?A=Math.max(v[0],v[1]):Te(v)?(A=-1/0,y.forEach(z=>{const Z=Math.max(...bu(v(z)));Z>A&&(A=Z)})):A=v,Ei(p)?O=Math.max(p[0],p[1]):Ee(p)&&(O=p),y.forEach(z=>{const Z=cr(z);T.push(Z);let ne=A;const{data:se}=Z;Ei(se.size)?ne=Math.max(se.size[0],se.size[1]):Ee(se.size)?ne=se.size:Yt(se.size)&&(ne=Math.max(se.size.width,se.size.height)),A=Math.max(A,ne),Te(p)&&(O=Math.max(p(z),O))});const N={};T.forEach((z,Z)=>{N[z.id]=Z});let C=u;(!tt(C)||T[0].data[C]===void 0)&&(C="degree"),C==="degree"?T.sort((z,Z)=>t.getDegree(Z.id,"both")-t.getDegree(z.id,"both")):T.sort((z,Z)=>Z.data[C]-z.data[C]);const P=T[0],D=(l||(C==="degree"?t.getDegree(P.id,"both"):P.data[C]))/4,j=[{nodes:[]}];let G=j[0];T.forEach(z=>{if(G.nodes.length>0){const Z=Math.abs(C==="degree"?t.getDegree(G.nodes[0].id,"both")-t.getDegree(z.id,"both"):G.nodes[0].data[C]-z.data[C]);D&&Z>=D&&(G={nodes:[]},j.push(G))}G.nodes.push(z)});let V=A+O;if(!f){const z=j.length>0&&j[0].nodes.length>1,ne=(Math.min(w,M)/2-V)/(j.length+(z?1:0));V=Math.min(V,ne)}let Y=0;if(j.forEach(z=>{const Z=c===void 0?2*Math.PI-2*Math.PI/z.nodes.length:c;if(z.dTheta=Z/Math.max(1,z.nodes.length-1),z.nodes.length>1&&f){const ne=Math.cos(z.dTheta)-Math.cos(0),se=Math.sin(z.dTheta)-Math.sin(0),oe=Math.sqrt(V*V/(ne*ne+se*se));Y=Math.max(oe,Y)}z.r=Y,Y+=V}),h){let z=0,Z=0;for(let ne=0;ne<j.length;ne++){const oe=(j[ne].r||0)-Z;z=Math.max(z,oe)}Z=0,j.forEach((ne,se)=>{se===0&&(Z=ne.r||0),ne.r=Z,Z+=z})}return j.forEach(z=>{const Z=z.dTheta||0,ne=z.r||0;z.nodes.forEach((se,oe)=>{const Ne=g+(d?1:-1)*Z*oe;se.data.x=S[0]+ne*Math.cos(Ne),se.data.y=S[1]+ne*Math.sin(Ne)})}),e&&T.forEach(z=>t.mergeNodeData(z.id,{x:z.data.x,y:z.data.y})),{nodes:T,edges:m}})}}function Pz(r){const e=+this._x.call(null,r),t=+this._y.call(null,r);return UA(this.cover(e,t),e,t,r)}function UA(r,e,t,n){if(isNaN(e)||isNaN(t))return r;var i,a=r._root,s={data:n},o=r._x0,u=r._y0,l=r._x1,c=r._y1,d,h,f,g,v,p,y,m;if(!a)return r._root=s,r;for(;a.length;)if((v=e>=(d=(o+l)/2))?o=d:l=d,(p=t>=(h=(u+c)/2))?u=h:c=h,i=a,!(a=a[y=p<<1|v]))return i[y]=s,r;if(f=+r._x.call(null,a.data),g=+r._y.call(null,a.data),e===f&&t===g)return s.next=a,i?i[y]=s:r._root=s,r;do i=i?i[y]=new Array(4):r._root=new Array(4),(v=e>=(d=(o+l)/2))?o=d:l=d,(p=t>=(h=(u+c)/2))?u=h:c=h;while((y=p<<1|v)===(m=(g>=h)<<1|f>=d));return i[m]=a,i[y]=s,r}function Lz(r){var e,t,n=r.length,i,a,s=new Array(n),o=new Array(n),u=1/0,l=1/0,c=-1/0,d=-1/0;for(t=0;t<n;++t)isNaN(i=+this._x.call(null,e=r[t]))||isNaN(a=+this._y.call(null,e))||(s[t]=i,o[t]=a,i<u&&(u=i),i>c&&(c=i),a<l&&(l=a),a>d&&(d=a));if(u>c||l>d)return this;for(this.cover(u,l).cover(c,d),t=0;t<n;++t)UA(this,s[t],o[t],r[t]);return this}function Dz(r,e){if(isNaN(r=+r)||isNaN(e=+e))return this;var t=this._x0,n=this._y0,i=this._x1,a=this._y1;if(isNaN(t))i=(t=Math.floor(r))+1,a=(n=Math.floor(e))+1;else{for(var s=i-t||1,o=this._root,u,l;t>r||r>=i||n>e||e>=a;)switch(l=(e<n)<<1|r<t,u=new Array(4),u[l]=o,o=u,s*=2,l){case 0:i=t+s,a=n+s;break;case 1:t=i-s,a=n+s;break;case 2:i=t+s,n=a-s;break;case 3:t=i-s,n=a-s;break}this._root&&this._root.length&&(this._root=o)}return this._x0=t,this._y0=n,this._x1=i,this._y1=a,this}function Iz(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function Rz(r){return arguments.length?this.cover(+r[0][0],+r[0][1]).cover(+r[1][0],+r[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function zn(r,e,t,n,i){this.node=r,this.x0=e,this.y0=t,this.x1=n,this.y1=i}function jz(r,e,t){var n,i=this._x0,a=this._y0,s,o,u,l,c=this._x1,d=this._y1,h=[],f=this._root,g,v;for(f&&h.push(new zn(f,i,a,c,d)),t==null?t=1/0:(i=r-t,a=e-t,c=r+t,d=e+t,t*=t);g=h.pop();)if(!(!(f=g.node)||(s=g.x0)>c||(o=g.y0)>d||(u=g.x1)<i||(l=g.y1)<a))if(f.length){var p=(s+u)/2,y=(o+l)/2;h.push(new zn(f[3],p,y,u,l),new zn(f[2],s,y,p,l),new zn(f[1],p,o,u,y),new zn(f[0],s,o,p,y)),(v=(e>=y)<<1|r>=p)&&(g=h[h.length-1],h[h.length-1]=h[h.length-1-v],h[h.length-1-v]=g)}else{var m=r-+this._x.call(null,f.data),w=e-+this._y.call(null,f.data),M=m*m+w*w;if(M<t){var S=Math.sqrt(t=M);i=r-S,a=e-S,c=r+S,d=e+S,n=f.data}}return n}function Bz(r){if(isNaN(c=+this._x.call(null,r))||isNaN(d=+this._y.call(null,r)))return this;var e,t=this._root,n,i,a,s=this._x0,o=this._y0,u=this._x1,l=this._y1,c,d,h,f,g,v,p,y;if(!t)return this;if(t.length)for(;;){if((g=c>=(h=(s+u)/2))?s=h:u=h,(v=d>=(f=(o+l)/2))?o=f:l=f,e=t,!(t=t[p=v<<1|g]))return this;if(!t.length)break;(e[p+1&3]||e[p+2&3]||e[p+3&3])&&(n=e,y=p)}for(;t.data!==r;)if(i=t,!(t=t.next))return this;return(a=t.next)&&delete t.next,i?(a?i.next=a:delete i.next,this):e?(a?e[p]=a:delete e[p],(t=e[0]||e[1]||e[2]||e[3])&&t===(e[3]||e[2]||e[1]||e[0])&&!t.length&&(n?n[y]=t:this._root=t),this):(this._root=a,this)}function Fz(r){for(var e=0,t=r.length;e<t;++e)this.remove(r[e]);return this}function zz(){return this._root}function $z(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function qz(r){var e=[],t,n=this._root,i,a,s,o,u;for(n&&e.push(new zn(n,this._x0,this._y0,this._x1,this._y1));t=e.pop();)if(!r(n=t.node,a=t.x0,s=t.y0,o=t.x1,u=t.y1)&&n.length){var l=(a+o)/2,c=(s+u)/2;(i=n[3])&&e.push(new zn(i,l,c,o,u)),(i=n[2])&&e.push(new zn(i,a,c,l,u)),(i=n[1])&&e.push(new zn(i,l,s,o,c)),(i=n[0])&&e.push(new zn(i,a,s,l,c))}return this}function Gz(r){var e=[],t=[],n;for(this._root&&e.push(new zn(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var i=n.node;if(i.length){var a,s=n.x0,o=n.y0,u=n.x1,l=n.y1,c=(s+u)/2,d=(o+l)/2;(a=i[0])&&e.push(new zn(a,s,o,c,d)),(a=i[1])&&e.push(new zn(a,c,o,u,d)),(a=i[2])&&e.push(new zn(a,s,d,c,l)),(a=i[3])&&e.push(new zn(a,c,d,u,l))}t.push(n)}for(;n=t.pop();)r(n.node,n.x0,n.y0,n.x1,n.y1);return this}function Wz(r){return r[0]}function Vz(r){return arguments.length?(this._x=r,this):this._x}function Yz(r){return r[1]}function Uz(r){return arguments.length?(this._y=r,this):this._y}function ad(r,e,t){var n=new qm(e??Wz,t??Yz,NaN,NaN,NaN,NaN);return r==null?n:n.addAll(r)}function qm(r,e,t,n,i,a){this._x=r,this._y=e,this._x0=t,this._y0=n,this._x1=i,this._y1=a,this._root=void 0}function $w(r){for(var e={data:r.data},t=e;r=r.next;)t=t.next={data:r.data};return e}var Wn=ad.prototype=qm.prototype;Wn.copy=function(){var r=new qm(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,t,n;if(!e)return r;if(!e.length)return r._root=$w(e),r;for(t=[{source:e,target:r._root=new Array(4)}];e=t.pop();)for(var i=0;i<4;++i)(n=e.source[i])&&(n.length?t.push({source:n,target:e.target[i]=new Array(4)}):e.target[i]=$w(n));return r};Wn.add=Pz;Wn.addAll=Lz;Wn.cover=Dz;Wn.data=Iz;Wn.extent=Rz;Wn.find=jz;Wn.remove=Bz;Wn.removeAll=Fz;Wn.root=zz;Wn.size=$z;Wn.visit=qz;Wn.visitAfter=Gz;Wn.x=Vz;Wn.y=Uz;function Hz(r){const e=+this._x.call(null,r),t=+this._y.call(null,r),n=+this._z.call(null,r);return HA(this.cover(e,t,n),e,t,n,r)}function HA(r,e,t,n,i){if(isNaN(e)||isNaN(t)||isNaN(n))return r;var a,s=r._root,o={data:i},u=r._x0,l=r._y0,c=r._z0,d=r._x1,h=r._y1,f=r._z1,g,v,p,y,m,w,M,S,T,A,O;if(!s)return r._root=o,r;for(;s.length;)if((M=e>=(g=(u+d)/2))?u=g:d=g,(S=t>=(v=(l+h)/2))?l=v:h=v,(T=n>=(p=(c+f)/2))?c=p:f=p,a=s,!(s=s[A=T<<2|S<<1|M]))return a[A]=o,r;if(y=+r._x.call(null,s.data),m=+r._y.call(null,s.data),w=+r._z.call(null,s.data),e===y&&t===m&&n===w)return o.next=s,a?a[A]=o:r._root=o,r;do a=a?a[A]=new Array(8):r._root=new Array(8),(M=e>=(g=(u+d)/2))?u=g:d=g,(S=t>=(v=(l+h)/2))?l=v:h=v,(T=n>=(p=(c+f)/2))?c=p:f=p;while((A=T<<2|S<<1|M)===(O=(w>=p)<<2|(m>=v)<<1|y>=g));return a[O]=s,a[A]=o,r}function Xz(r){Array.isArray(r)||(r=Array.from(r));const e=r.length,t=new Float64Array(e),n=new Float64Array(e),i=new Float64Array(e);let a=1/0,s=1/0,o=1/0,u=-1/0,l=-1/0,c=-1/0;for(let d=0,h,f,g,v;d<e;++d)isNaN(f=+this._x.call(null,h=r[d]))||isNaN(g=+this._y.call(null,h))||isNaN(v=+this._z.call(null,h))||(t[d]=f,n[d]=g,i[d]=v,f<a&&(a=f),f>u&&(u=f),g<s&&(s=g),g>l&&(l=g),v<o&&(o=v),v>c&&(c=v));if(a>u||s>l||o>c)return this;this.cover(a,s,o).cover(u,l,c);for(let d=0;d<e;++d)HA(this,t[d],n[d],i[d],r[d]);return this}function Kz(r,e,t){if(isNaN(r=+r)||isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,a=this._z0,s=this._x1,o=this._y1,u=this._z1;if(isNaN(n))s=(n=Math.floor(r))+1,o=(i=Math.floor(e))+1,u=(a=Math.floor(t))+1;else{for(var l=s-n||1,c=this._root,d,h;n>r||r>=s||i>e||e>=o||a>t||t>=u;)switch(h=(t<a)<<2|(e<i)<<1|r<n,d=new Array(8),d[h]=c,c=d,l*=2,h){case 0:s=n+l,o=i+l,u=a+l;break;case 1:n=s-l,o=i+l,u=a+l;break;case 2:s=n+l,i=o-l,u=a+l;break;case 3:n=s-l,i=o-l,u=a+l;break;case 4:s=n+l,o=i+l,a=u-l;break;case 5:n=s-l,o=i+l,a=u-l;break;case 6:s=n+l,i=o-l,a=u-l;break;case 7:n=s-l,i=o-l,a=u-l;break}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=i,this._z0=a,this._x1=s,this._y1=o,this._z1=u,this}function Zz(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function Qz(r){return arguments.length?this.cover(+r[0][0],+r[0][1],+r[0][2]).cover(+r[1][0],+r[1][1],+r[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function gt(r,e,t,n,i,a,s){this.node=r,this.x0=e,this.y0=t,this.z0=n,this.x1=i,this.y1=a,this.z1=s}function Jz(r,e,t,n){var i,a=this._x0,s=this._y0,o=this._z0,u,l,c,d,h,f,g=this._x1,v=this._y1,p=this._z1,y=[],m=this._root,w,M;for(m&&y.push(new gt(m,a,s,o,g,v,p)),n==null?n=1/0:(a=r-n,s=e-n,o=t-n,g=r+n,v=e+n,p=t+n,n*=n);w=y.pop();)if(!(!(m=w.node)||(u=w.x0)>g||(l=w.y0)>v||(c=w.z0)>p||(d=w.x1)<a||(h=w.y1)<s||(f=w.z1)<o))if(m.length){var S=(u+d)/2,T=(l+h)/2,A=(c+f)/2;y.push(new gt(m[7],S,T,A,d,h,f),new gt(m[6],u,T,A,S,h,f),new gt(m[5],S,l,A,d,T,f),new gt(m[4],u,l,A,S,T,f),new gt(m[3],S,T,c,d,h,A),new gt(m[2],u,T,c,S,h,A),new gt(m[1],S,l,c,d,T,A),new gt(m[0],u,l,c,S,T,A)),(M=(t>=A)<<2|(e>=T)<<1|r>=S)&&(w=y[y.length-1],y[y.length-1]=y[y.length-1-M],y[y.length-1-M]=w)}else{var O=r-+this._x.call(null,m.data),N=e-+this._y.call(null,m.data),C=t-+this._z.call(null,m.data),P=O*O+N*N+C*C;if(P<n){var D=Math.sqrt(n=P);a=r-D,s=e-D,o=t-D,g=r+D,v=e+D,p=t+D,i=m.data}}return i}const e8=(r,e,t,n,i,a)=>Math.sqrt((r-n)**2+(e-i)**2+(t-a)**2);function t8(r,e,t,n){const i=[],a=r-n,s=e-n,o=t-n,u=r+n,l=e+n,c=t+n;return this.visit((d,h,f,g,v,p,y)=>{if(!d.length)do{const m=d.data;e8(r,e,t,this._x(m),this._y(m),this._z(m))<=n&&i.push(m)}while(d=d.next);return h>u||f>l||g>c||v<a||p<s||y<o}),i}function n8(r){if(isNaN(h=+this._x.call(null,r))||isNaN(f=+this._y.call(null,r))||isNaN(g=+this._z.call(null,r)))return this;var e,t=this._root,n,i,a,s=this._x0,o=this._y0,u=this._z0,l=this._x1,c=this._y1,d=this._z1,h,f,g,v,p,y,m,w,M,S,T;if(!t)return this;if(t.length)for(;;){if((m=h>=(v=(s+l)/2))?s=v:l=v,(w=f>=(p=(o+c)/2))?o=p:c=p,(M=g>=(y=(u+d)/2))?u=y:d=y,e=t,!(t=t[S=M<<2|w<<1|m]))return this;if(!t.length)break;(e[S+1&7]||e[S+2&7]||e[S+3&7]||e[S+4&7]||e[S+5&7]||e[S+6&7]||e[S+7&7])&&(n=e,T=S)}for(;t.data!==r;)if(i=t,!(t=t.next))return this;return(a=t.next)&&delete t.next,i?(a?i.next=a:delete i.next,this):e?(a?e[S]=a:delete e[S],(t=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&t===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!t.length&&(n?n[T]=t:this._root=t),this):(this._root=a,this)}function r8(r){for(var e=0,t=r.length;e<t;++e)this.remove(r[e]);return this}function i8(){return this._root}function a8(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function s8(r){var e=[],t,n=this._root,i,a,s,o,u,l,c;for(n&&e.push(new gt(n,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));t=e.pop();)if(!r(n=t.node,a=t.x0,s=t.y0,o=t.z0,u=t.x1,l=t.y1,c=t.z1)&&n.length){var d=(a+u)/2,h=(s+l)/2,f=(o+c)/2;(i=n[7])&&e.push(new gt(i,d,h,f,u,l,c)),(i=n[6])&&e.push(new gt(i,a,h,f,d,l,c)),(i=n[5])&&e.push(new gt(i,d,s,f,u,h,c)),(i=n[4])&&e.push(new gt(i,a,s,f,d,h,c)),(i=n[3])&&e.push(new gt(i,d,h,o,u,l,f)),(i=n[2])&&e.push(new gt(i,a,h,o,d,l,f)),(i=n[1])&&e.push(new gt(i,d,s,o,u,h,f)),(i=n[0])&&e.push(new gt(i,a,s,o,d,h,f))}return this}function o8(r){var e=[],t=[],n;for(this._root&&e.push(new gt(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=e.pop();){var i=n.node;if(i.length){var a,s=n.x0,o=n.y0,u=n.z0,l=n.x1,c=n.y1,d=n.z1,h=(s+l)/2,f=(o+c)/2,g=(u+d)/2;(a=i[0])&&e.push(new gt(a,s,o,u,h,f,g)),(a=i[1])&&e.push(new gt(a,h,o,u,l,f,g)),(a=i[2])&&e.push(new gt(a,s,f,u,h,c,g)),(a=i[3])&&e.push(new gt(a,h,f,u,l,c,g)),(a=i[4])&&e.push(new gt(a,s,o,g,h,f,d)),(a=i[5])&&e.push(new gt(a,h,o,g,l,f,d)),(a=i[6])&&e.push(new gt(a,s,f,g,h,c,d)),(a=i[7])&&e.push(new gt(a,h,f,g,l,c,d))}t.push(n)}for(;n=t.pop();)r(n.node,n.x0,n.y0,n.z0,n.x1,n.y1,n.z1);return this}function u8(r){return r[0]}function l8(r){return arguments.length?(this._x=r,this):this._x}function c8(r){return r[1]}function d8(r){return arguments.length?(this._y=r,this):this._y}function h8(r){return r[2]}function f8(r){return arguments.length?(this._z=r,this):this._z}function XA(r,e,t,n){var i=new Gm(e??u8,t??c8,n??h8,NaN,NaN,NaN,NaN,NaN,NaN);return r==null?i:i.addAll(r)}function Gm(r,e,t,n,i,a,s,o,u){this._x=r,this._y=e,this._z=t,this._x0=n,this._y0=i,this._z0=a,this._x1=s,this._y1=o,this._z1=u,this._root=void 0}function qw(r){for(var e={data:r.data},t=e;r=r.next;)t=t.next={data:r.data};return e}var On=XA.prototype=Gm.prototype;On.copy=function(){var r=new Gm(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),e=this._root,t,n;if(!e)return r;if(!e.length)return r._root=qw(e),r;for(t=[{source:e,target:r._root=new Array(8)}];e=t.pop();)for(var i=0;i<8;++i)(n=e.source[i])&&(n.length?t.push({source:n,target:e.target[i]=new Array(8)}):e.target[i]=qw(n));return r};On.add=Hz;On.addAll=Xz;On.cover=Kz;On.data=Zz;On.extent=Qz;On.find=Jz;On.findAllWithinRadius=t8;On.remove=n8;On.removeAll=r8;On.root=i8;On.size=a8;On.visit=s8;On.visitAfter=o8;On.x=l8;On.y=d8;On.z=f8;const g8=.81,tf=.1;function p8(r,e,t,n,i=2){const a=e/t,s=r.getAllNodes(),o=s.map((c,d)=>{const{nodeStrength:h,x:f,y:g,z:v,size:p}=c.data;return{x:f,y:g,z:v,size:p,index:d,id:c.id,vx:0,vy:0,vz:0,weight:a*h}}),u=(i===2?ad(o,c=>c.x,c=>c.y):XA(o,c=>c.x,c=>c.y,c=>c.z)).visitAfter(v8),l=new Map;return o.forEach(c=>{l.set(c.id,c),m8(c,u,i)}),o.map((c,d)=>{const{id:h,data:f}=s[d],{mass:g=1}=f;n[h]={x:c.vx/g,y:c.vy/g,z:c.vz/g}}),n}function v8(r){let e=0,t=0,n=0,i=0,a=0;const s=r.length;if(s){for(let o=0;o<s;o++){const u=r[o];u&&u.weight&&(e+=u.weight,t+=u.x*u.weight,n+=u.y*u.weight,i+=u.z*u.weight,a+=u.size*u.weight)}r.x=t/e,r.y=n/e,r.z=i/e,r.size=a/e,r.weight=e}else{const o=r;r.x=o.data.x,r.y=o.data.y,r.z=o.data.z,r.size=o.data.size,r.weight=o.data.weight}}const y8=(r,e,t,n,i,a,s)=>{var o;if(((o=r.data)===null||o===void 0?void 0:o.id)===a.id)return;const u=[t,n,i][s-1],l=a.x-r.x||tf,c=a.y-r.y||tf,d=a.z-r.z||tf,h=[l,c,d],f=u-e;let g=0;for(let y=0;y<s;y++)g+=h[y]*h[y];const p=Math.sqrt(g)*g;if(f*f*g8<g){const y=r.weight/p;return a.vx+=l*y,a.vy+=c*y,a.vz+=d*y,!0}if(r.length)return!1;if(r.data!==a){const y=r.data.weight/p;a.vx+=l*y,a.vy+=c*y,a.vz+=d*y}};function m8(r,e,t){e.visit((n,i,a,s,o)=>y8(n,i,a,s,o,r,t))}const b8={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:50,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:200,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"};class KA{constructor(e={}){this.options=e,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=Object.assign(Object.assign({},b8),e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericForceLayout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericForceLayout(!0,e,t)})}stop(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval),this.running=!1}tick(e=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let n=0;(this.judgingDistance>this.lastOptions.minMovement||n<1)&&n<e;n++)this.runOneStep(this.lastCalcGraph,this.lastGraph,n,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);const t={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&t.nodes.forEach(n=>this.lastGraph.mergeNodeData(n.id,{x:n.data.x,y:n.data.y,z:this.options.dimensions===3?n.data.z:void 0})),t}genericForceLayout(e,t,n){return Ye(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),a=t.getAllNodes(),s=t.getAllEdges(),o=this.formatOptions(i,t),{dimensions:u,width:l,height:c,nodeSize:d,getMass:h,nodeStrength:f,edgeStrength:g,linkDistance:v}=o,p=a.map((O,N)=>Object.assign(Object.assign({},O),{data:Object.assign(Object.assign({},O.data),{x:Ee(O.data.x)?O.data.x:Math.random()*l,y:Ee(O.data.y)?O.data.y:Math.random()*c,z:Ee(O.data.z)?O.data.z:Math.random()*Math.sqrt(l*c),size:d(O)||30,mass:h(O),nodeStrength:f(O)})})),y=s.map(O=>Object.assign(Object.assign({},O),{data:Object.assign(Object.assign({},O.data),{edgeStrength:g(O),linkDistance:v(O,t.getNode(O.source),t.getNode(O.target))})}));if(!(a!=null&&a.length))return this.lastResult={nodes:[],edges:s},{nodes:[],edges:s};const m={};a.forEach((O,N)=>{m[O.id]={x:0,y:0,z:0}});const w=new cn({nodes:p,edges:y});this.formatCentripetal(o,w);const{maxIteration:M,minMovement:S,onTick:T}=o;if(this.lastLayoutNodes=p,this.lastLayoutEdges=y,this.lastAssign=e,this.lastGraph=t,this.lastCalcGraph=w,this.lastOptions=o,this.lastVelMap=m,typeof window>"u")return;let A=0;return new Promise(O=>{this.timeInterval=window.setInterval(()=>{(!a||!this.running)&&O({nodes:nf(t,p),edges:s}),this.runOneStep(w,t,A,m,o),this.updatePosition(t,w,m,o),e&&p.forEach(N=>t.mergeNodeData(N.id,{x:N.data.x,y:N.data.y,z:u===3?N.data.z:void 0})),T==null||T({nodes:nf(t,p),edges:s}),A++,(A>=M||this.judgingDistance<S)&&(window.clearInterval(this.timeInterval),O({nodes:nf(t,p),edges:s}))},0),this.running=!0})})}formatOptions(e,t){const n=Object.assign({},e),{width:i,height:a,getMass:s}=e;n.width=!i&&typeof window<"u"?window.innerWidth:i,n.height=!a&&typeof window<"u"?window.innerHeight:a,e.center||(n.center=[n.width/2,n.height/2]),s||(n.getMass=u=>{let l=1;Ee(u==null?void 0:u.data.mass)&&(l=u==null?void 0:u.data.mass);const c=t.getDegree(u.id,"both");return!c||c<5?l:c*5*l}),n.nodeSize=$m(e.nodeSize,e.nodeSpacing);const o=e.linkDistance?Fa(1,e.linkDistance):u=>1+n.nodeSize(t.getNode(u.source))+n.nodeSize(t.getNode(u.target));return n.linkDistance=o,n.nodeStrength=Fa(1,e.nodeStrength),n.edgeStrength=Fa(1,e.edgeStrength),n}formatCentripetal(e,t){const{dimensions:n,centripetalOptions:i,center:a,clusterNodeStrength:s,leafCluster:o,clustering:u,nodeClusterBy:l}=e,c=t.getAllNodes(),d=i||{leaf:2,single:2,others:1,center:y=>({x:a[0],y:a[1],z:n===3?a[2]:void 0})};typeof s!="function"&&(e.clusterNodeStrength=y=>s);let h,f;if(o&&l&&(h=Gw(t,l),f=Array.from(new Set(c==null?void 0:c.map(y=>y.data[l])))||[],e.centripetalOptions=Object.assign(d,{single:100,leaf:y=>{const{siblingLeaves:m,sameTypeLeaves:w}=h[y.id]||{};return(w==null?void 0:w.length)===(m==null?void 0:m.length)||(f==null?void 0:f.length)===1?1:e.clusterNodeStrength(y)},others:1,center:y=>{const m=t.getDegree(y.id,"both");if(!m)return{x:100,y:100,z:0};let w;if(m===1){const{sameTypeLeaves:M=[]}=h[y.id]||{};M.length===1?w=void 0:M.length>1&&(w=Ww(M))}else w=void 0;return{x:w==null?void 0:w.x,y:w==null?void 0:w.y,z:w==null?void 0:w.z}}})),u&&l){h||(h=Gw(t,l)),f||(f=Array.from(new Set(c.map(m=>m.data[l])))),f=f.filter(m=>m!==void 0);const y={};f.forEach(m=>{const w=c.filter(M=>M.data[l]===m).map(M=>t.getNode(M.id));y[m]=Ww(w)}),e.centripetalOptions=Object.assign(d,{single:m=>e.clusterNodeStrength(m),leaf:m=>e.clusterNodeStrength(m),others:m=>e.clusterNodeStrength(m),center:m=>{const w=y[m.data[l]];return{x:w==null?void 0:w.x,y:w==null?void 0:w.y,z:w==null?void 0:w.z}}})}const{leaf:g,single:v,others:p}=e.centripetalOptions||{};g&&typeof g!="function"&&(e.centripetalOptions.leaf=()=>g),v&&typeof v!="function"&&(e.centripetalOptions.single=()=>v),p&&typeof p!="function"&&(e.centripetalOptions.others=()=>p)}runOneStep(e,t,n,i,a){const s={},o=e.getAllNodes(),u=e.getAllEdges();if(!(o!=null&&o.length))return;const{monitor:l}=a;if(this.calRepulsive(e,s,a),u&&this.calAttractive(e,s,a),this.calGravity(e,t,s,a),this.updateVelocity(e,s,i,a),l){const c=this.calTotalEnergy(s,o);l({energy:c,nodes:t.getAllNodes(),edges:t.getAllEdges(),iterations:n})}}calTotalEnergy(e,t){if(!(t!=null&&t.length))return 0;let n=0;return t.forEach((i,a)=>{const s=e[i.id].x,o=e[i.id].y,u=this.options.dimensions===3?e[i.id].z:0,l=s*s+o*o+u*u,{mass:c=1}=i.data;n+=c*l*.5}),n}calRepulsive(e,t,n){const{dimensions:i,factor:a,coulombDisScale:s}=n;p8(e,a,s*s,t,i)}calAttractive(e,t,n){const{dimensions:i,nodeSize:a}=n;e.getAllEdges().forEach((s,o)=>{const{source:u,target:l}=s,c=e.getNode(u),d=e.getNode(l);if(!c||!d)return;let h=d.data.x-c.data.x,f=d.data.y-c.data.y,g=i===3?d.data.z-c.data.z:0;!h&&!f&&(h=Math.random()*.01,f=Math.random()*.01,i===3&&!g&&(g=Math.random()*.01));const v=Math.sqrt(h*h+f*f+g*g);if(v<a(c)+a(d))return;const p=h/v,y=f/v,m=g/v,{linkDistance:w=200,edgeStrength:M=200}=s.data||{},T=(w-v)*M,A=c.data.mass||1,O=d.data.mass||1,N=1/A,C=1/O,P=p*T,D=y*T,j=m*T;t[u].x-=P*N,t[u].y-=D*N,t[u].z-=j*N,t[l].x+=P*C,t[l].y+=D*C,t[l].z+=j*C})}calGravity(e,t,n,i){const{getCenter:a}=i,s=e.getAllNodes(),o=t.getAllNodes(),u=t.getAllEdges(),{width:l,height:c,center:d,gravity:h,centripetalOptions:f}=i;s&&s.forEach(g=>{const{id:v,data:p}=g,{mass:y,x:m,y:w,z:M}=p,S=t.getNode(v);let T=0,A=0,O=0,N=h;const C=e.getDegree(v,"in"),P=e.getDegree(v,"out"),D=e.getDegree(v,"both"),j=a==null?void 0:a(S,D);if(j){const[G,V,Y]=j;T=m-G,A=w-V,N=Y}else T=m-d[0],A=w-d[1],O=M-d[2];if(N&&(n[v].x-=N*T/y,n[v].y-=N*A/y,n[v].z-=N*O/y),f){const{leaf:G,single:V,others:Y,center:$}=f,{x:z,y:Z,z:ne,centerStrength:se}=($==null?void 0:$(S,o,u,l,c))||{x:0,y:0,z:0,centerStrength:0};if(!Ee(z)||!Ee(Z))return;const oe=(m-z)/y,Ne=(w-Z)/y,K=(M-ne)/y;if(se&&(n[v].x-=se*oe,n[v].y-=se*Ne,n[v].z-=se*K),D===0){const ee=V(S);if(!ee)return;n[v].x-=ee*oe,n[v].y-=ee*Ne,n[v].z-=ee*K;return}if(C===0||P===0){const ee=G(S,o,u);if(!ee)return;n[v].x-=ee*oe,n[v].y-=ee*Ne,n[v].z-=ee*K;return}const W=Y(S);if(!W)return;n[v].x-=W*oe,n[v].y-=W*Ne,n[v].z-=W*K}})}updateVelocity(e,t,n,i){const{damping:a,maxSpeed:s,interval:o,dimensions:u}=i,l=e.getAllNodes();l!=null&&l.length&&l.forEach(c=>{const{id:d}=c;let h=(n[d].x+t[d].x*o)*a||.01,f=(n[d].y+t[d].y*o)*a||.01,g=u===3?(n[d].z+t[d].z*o)*a||.01:0;const v=Math.sqrt(h*h+f*f+g*g);if(v>s){const p=s/v;h=p*h,f=p*f,g=p*g}n[d]={x:h,y:f,z:g}})}updatePosition(e,t,n,i){const{distanceThresholdMode:a,interval:s,dimensions:o}=i,u=t.getAllNodes();if(!(u!=null&&u.length)){this.judgingDistance=0;return}let l=0;a==="max"?this.judgingDistance=-1/0:a==="min"&&(this.judgingDistance=1/0),u.forEach(c=>{const{id:d}=c,h=e.getNode(d);if(Ee(h.data.fx)&&Ee(h.data.fy)){t.mergeNodeData(d,{x:h.data.fx,y:h.data.fy,z:o===3?h.data.fz:void 0});return}const f=n[d].x*s,g=n[d].y*s,v=o===3?n[d].z*s:0;t.mergeNodeData(d,{x:c.data.x+f,y:c.data.y+g,z:c.data.z+v});const p=Math.sqrt(f*f+g*g+v*v);switch(a){case"max":this.judgingDistance<p&&(this.judgingDistance=p);break;case"min":this.judgingDistance>p&&(this.judgingDistance=p);break;default:l=l+p;break}}),(!a||a==="mean")&&(this.judgingDistance=l/u.length)}}const Gw=(r,e)=>{const t=r.getAllNodes();if(!(t!=null&&t.length))return{};const n={};return t.forEach((i,a)=>{r.getDegree(i.id,"both")===1&&(n[i.id]=w8(r,"leaf",i,e))}),n},w8=(r,e,t,n)=>{const i=r.getDegree(t.id,"in"),a=r.getDegree(t.id,"out");let s=t,o=[];i===0?(s=r.getSuccessors(t.id)[0],o=r.getNeighbors(s.id)):a===0&&(s=r.getPredecessors(t.id)[0],o=r.getNeighbors(s.id)),o=o.filter(l=>r.getDegree(l.id,"in")===0||r.getDegree(l.id,"out")===0);const u=x8(r,e,n,t,o);return{coreNode:s,siblingLeaves:o,sameTypeLeaves:u}},x8=(r,e,t,n,i)=>{const a=n.data[t]||"";let s=(i==null?void 0:i.filter(o=>o.data[t]===a))||[];return s=s.filter(o=>r.getDegree(o.id,"in")===0||r.getDegree(o.id,"out")===0),s},Ww=r=>{const e={x:0,y:0};r.forEach(n=>{const{x:i,y:a}=n.data;e.x+=i||0,e.y+=a||0});const t=r.length||1;return{x:e.x/t,y:e.y/t}},nf=(r,e)=>e.map(t=>{const{id:n,data:i}=t,a=r.getNode(n);return Object.assign(Object.assign({},a),{data:Object.assign(Object.assign({},a.data),{x:i.x,y:i.y,z:i.z})})});var Ke={};const E8=Object.prototype.toString;function Uo(r){const e=E8.call(r);return e.endsWith("Array]")&&!e.includes("Big")}const M8=Object.freeze(Object.defineProperty({__proto__:null,isAnyArray:Uo},Symbol.toStringTag,{value:"Module"})),S8=W_(M8);function _8(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Uo(r))throw new TypeError("input must be an array");if(r.length===0)throw new TypeError("input must not be empty");var t=e.fromIndex,n=t===void 0?0:t,i=e.toIndex,a=i===void 0?r.length:i;if(n<0||n>=r.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(a<=n||a>r.length||!Number.isInteger(a))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=r[n],o=n+1;o<a;o++)r[o]>s&&(s=r[o]);return s}function T8(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Uo(r))throw new TypeError("input must be an array");if(r.length===0)throw new TypeError("input must not be empty");var t=e.fromIndex,n=t===void 0?0:t,i=e.toIndex,a=i===void 0?r.length:i;if(n<0||n>=r.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(a<=n||a>r.length||!Number.isInteger(a))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=r[n],o=n+1;o<a;o++)r[o]<s&&(s=r[o]);return s}function O8(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Uo(r)){if(r.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var t;if(e.output!==void 0){if(!Uo(e.output))throw new TypeError("output option must be an array if specified");t=e.output}else t=new Array(r.length);var n=T8(r),i=_8(r);if(n===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var a=e.min,s=a===void 0?e.autoMinMax?n:0:a,o=e.max,u=o===void 0?e.autoMinMax?i:1:o;if(s>=u)throw new RangeError("min option must be smaller than max option");for(var l=(u-s)/(i-n),c=0;c<r.length;c++)t[c]=(r[c]-n)*l+s;return t}const A8=Object.freeze(Object.defineProperty({__proto__:null,default:O8},Symbol.toStringTag,{value:"Module"})),k8=W_(A8);var Vw;function N8(){var Js,Py,kn;if(Vw)return Ke;Vw=1,Object.defineProperty(Ke,"__esModule",{value:!0});var r=S8,e=k8;const t=" ".repeat(2),n=" ".repeat(4);function i(){return a(this)}function a(L,_={}){const{maxRows:x=15,maxColumns:b=10,maxNumSize:E=8,padMinus:k="auto"}=_;return`${L.constructor.name} {
${t}[
${n}${s(L,x,b,E,k)}
${t}]
${t}rows: ${L.rows}
${t}columns: ${L.columns}
}`}function s(L,_,x,b,E){const{rows:k,columns:I}=L,R=Math.min(k,_),B=Math.min(I,x),F=[];if(E==="auto"){E=!1;e:for(let J=0;J<R;J++)for(let U=0;U<B;U++)if(L.get(J,U)<0){E=!0;break e}}for(let J=0;J<R;J++){let U=[];for(let ie=0;ie<B;ie++)U.push(o(L.get(J,ie),b,E));F.push(`${U.join(" ")}`)}return B!==I&&(F[F.length-1]+=` ... ${I-x} more columns`),R!==k&&F.push(`... ${k-_} more rows`),F.join(`
${n}`)}function o(L,_,x){return(L>=0&&x?` ${u(L,_-1)}`:u(L,_)).padEnd(_)}function u(L,_){let x=L.toString();if(x.length<=_)return x;let b=L.toFixed(_);if(b.length>_&&(b=L.toFixed(Math.max(0,_-(b.length-_)))),b.length<=_&&!b.startsWith("0.000")&&!b.startsWith("-0.000"))return b;let E=L.toExponential(_);return E.length>_&&(E=L.toExponential(Math.max(0,_-(E.length-_)))),E.slice(0)}function l(L,_){L.prototype.add=function(b){return typeof b=="number"?this.addS(b):this.addM(b)},L.prototype.addS=function(b){for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)+b);return this},L.prototype.addM=function(b){if(b=_.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)+b.get(E,k));return this},L.add=function(b,E){return new _(b).add(E)},L.prototype.sub=function(b){return typeof b=="number"?this.subS(b):this.subM(b)},L.prototype.subS=function(b){for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)-b);return this},L.prototype.subM=function(b){if(b=_.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)-b.get(E,k));return this},L.sub=function(b,E){return new _(b).sub(E)},L.prototype.subtract=L.prototype.sub,L.prototype.subtractS=L.prototype.subS,L.prototype.subtractM=L.prototype.subM,L.subtract=L.sub,L.prototype.mul=function(b){return typeof b=="number"?this.mulS(b):this.mulM(b)},L.prototype.mulS=function(b){for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)*b);return this},L.prototype.mulM=function(b){if(b=_.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)*b.get(E,k));return this},L.mul=function(b,E){return new _(b).mul(E)},L.prototype.multiply=L.prototype.mul,L.prototype.multiplyS=L.prototype.mulS,L.prototype.multiplyM=L.prototype.mulM,L.multiply=L.mul,L.prototype.div=function(b){return typeof b=="number"?this.divS(b):this.divM(b)},L.prototype.divS=function(b){for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)/b);return this},L.prototype.divM=function(b){if(b=_.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)/b.get(E,k));return this},L.div=function(b,E){return new _(b).div(E)},L.prototype.divide=L.prototype.div,L.prototype.divideS=L.prototype.divS,L.prototype.divideM=L.prototype.divM,L.divide=L.div,L.prototype.mod=function(b){return typeof b=="number"?this.modS(b):this.modM(b)},L.prototype.modS=function(b){for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)%b);return this},L.prototype.modM=function(b){if(b=_.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)%b.get(E,k));return this},L.mod=function(b,E){return new _(b).mod(E)},L.prototype.modulus=L.prototype.mod,L.prototype.modulusS=L.prototype.modS,L.prototype.modulusM=L.prototype.modM,L.modulus=L.mod,L.prototype.and=function(b){return typeof b=="number"?this.andS(b):this.andM(b)},L.prototype.andS=function(b){for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)&b);return this},L.prototype.andM=function(b){if(b=_.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)&b.get(E,k));return this},L.and=function(b,E){return new _(b).and(E)},L.prototype.or=function(b){return typeof b=="number"?this.orS(b):this.orM(b)},L.prototype.orS=function(b){for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)|b);return this},L.prototype.orM=function(b){if(b=_.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)|b.get(E,k));return this},L.or=function(b,E){return new _(b).or(E)},L.prototype.xor=function(b){return typeof b=="number"?this.xorS(b):this.xorM(b)},L.prototype.xorS=function(b){for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)^b);return this},L.prototype.xorM=function(b){if(b=_.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)^b.get(E,k));return this},L.xor=function(b,E){return new _(b).xor(E)},L.prototype.leftShift=function(b){return typeof b=="number"?this.leftShiftS(b):this.leftShiftM(b)},L.prototype.leftShiftS=function(b){for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)<<b);return this},L.prototype.leftShiftM=function(b){if(b=_.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)<<b.get(E,k));return this},L.leftShift=function(b,E){return new _(b).leftShift(E)},L.prototype.signPropagatingRightShift=function(b){return typeof b=="number"?this.signPropagatingRightShiftS(b):this.signPropagatingRightShiftM(b)},L.prototype.signPropagatingRightShiftS=function(b){for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)>>b);return this},L.prototype.signPropagatingRightShiftM=function(b){if(b=_.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)>>b.get(E,k));return this},L.signPropagatingRightShift=function(b,E){return new _(b).signPropagatingRightShift(E)},L.prototype.rightShift=function(b){return typeof b=="number"?this.rightShiftS(b):this.rightShiftM(b)},L.prototype.rightShiftS=function(b){for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)>>>b);return this},L.prototype.rightShiftM=function(b){if(b=_.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)>>>b.get(E,k));return this},L.rightShift=function(b,E){return new _(b).rightShift(E)},L.prototype.zeroFillRightShift=L.prototype.rightShift,L.prototype.zeroFillRightShiftS=L.prototype.rightShiftS,L.prototype.zeroFillRightShiftM=L.prototype.rightShiftM,L.zeroFillRightShift=L.rightShift,L.prototype.not=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,~this.get(b,E));return this},L.not=function(b){return new _(b).not()},L.prototype.abs=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.abs(this.get(b,E)));return this},L.abs=function(b){return new _(b).abs()},L.prototype.acos=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.acos(this.get(b,E)));return this},L.acos=function(b){return new _(b).acos()},L.prototype.acosh=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.acosh(this.get(b,E)));return this},L.acosh=function(b){return new _(b).acosh()},L.prototype.asin=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.asin(this.get(b,E)));return this},L.asin=function(b){return new _(b).asin()},L.prototype.asinh=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.asinh(this.get(b,E)));return this},L.asinh=function(b){return new _(b).asinh()},L.prototype.atan=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.atan(this.get(b,E)));return this},L.atan=function(b){return new _(b).atan()},L.prototype.atanh=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.atanh(this.get(b,E)));return this},L.atanh=function(b){return new _(b).atanh()},L.prototype.cbrt=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.cbrt(this.get(b,E)));return this},L.cbrt=function(b){return new _(b).cbrt()},L.prototype.ceil=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.ceil(this.get(b,E)));return this},L.ceil=function(b){return new _(b).ceil()},L.prototype.clz32=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.clz32(this.get(b,E)));return this},L.clz32=function(b){return new _(b).clz32()},L.prototype.cos=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.cos(this.get(b,E)));return this},L.cos=function(b){return new _(b).cos()},L.prototype.cosh=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.cosh(this.get(b,E)));return this},L.cosh=function(b){return new _(b).cosh()},L.prototype.exp=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.exp(this.get(b,E)));return this},L.exp=function(b){return new _(b).exp()},L.prototype.expm1=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.expm1(this.get(b,E)));return this},L.expm1=function(b){return new _(b).expm1()},L.prototype.floor=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.floor(this.get(b,E)));return this},L.floor=function(b){return new _(b).floor()},L.prototype.fround=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.fround(this.get(b,E)));return this},L.fround=function(b){return new _(b).fround()},L.prototype.log=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.log(this.get(b,E)));return this},L.log=function(b){return new _(b).log()},L.prototype.log1p=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.log1p(this.get(b,E)));return this},L.log1p=function(b){return new _(b).log1p()},L.prototype.log10=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.log10(this.get(b,E)));return this},L.log10=function(b){return new _(b).log10()},L.prototype.log2=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.log2(this.get(b,E)));return this},L.log2=function(b){return new _(b).log2()},L.prototype.round=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.round(this.get(b,E)));return this},L.round=function(b){return new _(b).round()},L.prototype.sign=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.sign(this.get(b,E)));return this},L.sign=function(b){return new _(b).sign()},L.prototype.sin=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.sin(this.get(b,E)));return this},L.sin=function(b){return new _(b).sin()},L.prototype.sinh=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.sinh(this.get(b,E)));return this},L.sinh=function(b){return new _(b).sinh()},L.prototype.sqrt=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.sqrt(this.get(b,E)));return this},L.sqrt=function(b){return new _(b).sqrt()},L.prototype.tan=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.tan(this.get(b,E)));return this},L.tan=function(b){return new _(b).tan()},L.prototype.tanh=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.tanh(this.get(b,E)));return this},L.tanh=function(b){return new _(b).tanh()},L.prototype.trunc=function(){for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.set(b,E,Math.trunc(this.get(b,E)));return this},L.trunc=function(b){return new _(b).trunc()},L.pow=function(b,E){return new _(b).pow(E)},L.prototype.pow=function(b){return typeof b=="number"?this.powS(b):this.powM(b)},L.prototype.powS=function(b){for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)**b);return this},L.prototype.powM=function(b){if(b=_.checkMatrix(b),this.rows!==b.rows||this.columns!==b.columns)throw new RangeError("Matrices dimensions must be equal");for(let E=0;E<this.rows;E++)for(let k=0;k<this.columns;k++)this.set(E,k,this.get(E,k)**b.get(E,k));return this}}function c(L,_,x){let b=x?L.rows:L.rows-1;if(_<0||_>b)throw new RangeError("Row index out of range")}function d(L,_,x){let b=x?L.columns:L.columns-1;if(_<0||_>b)throw new RangeError("Column index out of range")}function h(L,_){if(_.to1DArray&&(_=_.to1DArray()),_.length!==L.columns)throw new RangeError("vector size must be the same as the number of columns");return _}function f(L,_){if(_.to1DArray&&(_=_.to1DArray()),_.length!==L.rows)throw new RangeError("vector size must be the same as the number of rows");return _}function g(L,_){if(!r.isAnyArray(_))throw new TypeError("row indices must be an array");for(let x=0;x<_.length;x++)if(_[x]<0||_[x]>=L.rows)throw new RangeError("row indices are out of range")}function v(L,_){if(!r.isAnyArray(_))throw new TypeError("column indices must be an array");for(let x=0;x<_.length;x++)if(_[x]<0||_[x]>=L.columns)throw new RangeError("column indices are out of range")}function p(L,_,x,b,E){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(m("startRow",_),m("endRow",x),m("startColumn",b),m("endColumn",E),_>x||b>E||_<0||_>=L.rows||x<0||x>=L.rows||b<0||b>=L.columns||E<0||E>=L.columns)throw new RangeError("Submatrix indices are out of range")}function y(L,_=0){let x=[];for(let b=0;b<L;b++)x.push(_);return x}function m(L,_){if(typeof _!="number")throw new TypeError(`${L} must be a number`)}function w(L){if(L.isEmpty())throw new Error("Empty matrix has no elements to index")}function M(L){let _=y(L.rows);for(let x=0;x<L.rows;++x)for(let b=0;b<L.columns;++b)_[x]+=L.get(x,b);return _}function S(L){let _=y(L.columns);for(let x=0;x<L.rows;++x)for(let b=0;b<L.columns;++b)_[b]+=L.get(x,b);return _}function T(L){let _=0;for(let x=0;x<L.rows;x++)for(let b=0;b<L.columns;b++)_+=L.get(x,b);return _}function A(L){let _=y(L.rows,1);for(let x=0;x<L.rows;++x)for(let b=0;b<L.columns;++b)_[x]*=L.get(x,b);return _}function O(L){let _=y(L.columns,1);for(let x=0;x<L.rows;++x)for(let b=0;b<L.columns;++b)_[b]*=L.get(x,b);return _}function N(L){let _=1;for(let x=0;x<L.rows;x++)for(let b=0;b<L.columns;b++)_*=L.get(x,b);return _}function C(L,_,x){const b=L.rows,E=L.columns,k=[];for(let I=0;I<b;I++){let R=0,B=0,F=0;for(let J=0;J<E;J++)F=L.get(I,J)-x[I],R+=F,B+=F*F;_?k.push((B-R*R/E)/(E-1)):k.push((B-R*R/E)/E)}return k}function P(L,_,x){const b=L.rows,E=L.columns,k=[];for(let I=0;I<E;I++){let R=0,B=0,F=0;for(let J=0;J<b;J++)F=L.get(J,I)-x[I],R+=F,B+=F*F;_?k.push((B-R*R/b)/(b-1)):k.push((B-R*R/b)/b)}return k}function D(L,_,x){const b=L.rows,E=L.columns,k=b*E;let I=0,R=0,B=0;for(let F=0;F<b;F++)for(let J=0;J<E;J++)B=L.get(F,J)-x,I+=B,R+=B*B;return _?(R-I*I/k)/(k-1):(R-I*I/k)/k}function j(L,_){for(let x=0;x<L.rows;x++)for(let b=0;b<L.columns;b++)L.set(x,b,L.get(x,b)-_[x])}function G(L,_){for(let x=0;x<L.rows;x++)for(let b=0;b<L.columns;b++)L.set(x,b,L.get(x,b)-_[b])}function V(L,_){for(let x=0;x<L.rows;x++)for(let b=0;b<L.columns;b++)L.set(x,b,L.get(x,b)-_)}function Y(L){const _=[];for(let x=0;x<L.rows;x++){let b=0;for(let E=0;E<L.columns;E++)b+=L.get(x,E)**2/(L.columns-1);_.push(Math.sqrt(b))}return _}function $(L,_){for(let x=0;x<L.rows;x++)for(let b=0;b<L.columns;b++)L.set(x,b,L.get(x,b)/_[x])}function z(L){const _=[];for(let x=0;x<L.columns;x++){let b=0;for(let E=0;E<L.rows;E++)b+=L.get(E,x)**2/(L.rows-1);_.push(Math.sqrt(b))}return _}function Z(L,_){for(let x=0;x<L.rows;x++)for(let b=0;b<L.columns;b++)L.set(x,b,L.get(x,b)/_[b])}function ne(L){const _=L.size-1;let x=0;for(let b=0;b<L.columns;b++)for(let E=0;E<L.rows;E++)x+=L.get(E,b)**2/_;return Math.sqrt(x)}function se(L,_){for(let x=0;x<L.rows;x++)for(let b=0;b<L.columns;b++)L.set(x,b,L.get(x,b)/_)}class oe{static from1DArray(_,x,b){if(_*x!==b.length)throw new RangeError("data length does not match given dimensions");let k=new W(_,x);for(let I=0;I<_;I++)for(let R=0;R<x;R++)k.set(I,R,b[I*x+R]);return k}static rowVector(_){let x=new W(1,_.length);for(let b=0;b<_.length;b++)x.set(0,b,_[b]);return x}static columnVector(_){let x=new W(_.length,1);for(let b=0;b<_.length;b++)x.set(b,0,_[b]);return x}static zeros(_,x){return new W(_,x)}static ones(_,x){return new W(_,x).fill(1)}static rand(_,x,b={}){if(typeof b!="object")throw new TypeError("options must be an object");const{random:E=Math.random}=b;let k=new W(_,x);for(let I=0;I<_;I++)for(let R=0;R<x;R++)k.set(I,R,E());return k}static randInt(_,x,b={}){if(typeof b!="object")throw new TypeError("options must be an object");const{min:E=0,max:k=1e3,random:I=Math.random}=b;if(!Number.isInteger(E))throw new TypeError("min must be an integer");if(!Number.isInteger(k))throw new TypeError("max must be an integer");if(E>=k)throw new RangeError("min must be smaller than max");let R=k-E,B=new W(_,x);for(let F=0;F<_;F++)for(let J=0;J<x;J++){let U=E+Math.round(I()*R);B.set(F,J,U)}return B}static eye(_,x,b){x===void 0&&(x=_),b===void 0&&(b=1);let E=Math.min(_,x),k=this.zeros(_,x);for(let I=0;I<E;I++)k.set(I,I,b);return k}static diag(_,x,b){let E=_.length;x===void 0&&(x=E),b===void 0&&(b=x);let k=Math.min(E,x,b),I=this.zeros(x,b);for(let R=0;R<k;R++)I.set(R,R,_[R]);return I}static min(_,x){_=this.checkMatrix(_),x=this.checkMatrix(x);let b=_.rows,E=_.columns,k=new W(b,E);for(let I=0;I<b;I++)for(let R=0;R<E;R++)k.set(I,R,Math.min(_.get(I,R),x.get(I,R)));return k}static max(_,x){_=this.checkMatrix(_),x=this.checkMatrix(x);let b=_.rows,E=_.columns,k=new this(b,E);for(let I=0;I<b;I++)for(let R=0;R<E;R++)k.set(I,R,Math.max(_.get(I,R),x.get(I,R)));return k}static checkMatrix(_){return oe.isMatrix(_)?_:new W(_)}static isMatrix(_){return _!=null&&_.klass==="Matrix"}get size(){return this.rows*this.columns}apply(_){if(typeof _!="function")throw new TypeError("callback must be a function");for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)_.call(this,x,b);return this}to1DArray(){let _=[];for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)_.push(this.get(x,b));return _}to2DArray(){let _=[];for(let x=0;x<this.rows;x++){_.push([]);for(let b=0;b<this.columns;b++)_[x].push(this.get(x,b))}return _}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isEmpty(){return this.rows===0||this.columns===0}isSymmetric(){if(this.isSquare()){for(let _=0;_<this.rows;_++)for(let x=0;x<=_;x++)if(this.get(_,x)!==this.get(x,_))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let _=0;_<this.rows;_++)if(this.get(_,_)!==0)return!1;return!0}isEchelonForm(){let _=0,x=0,b=-1,E=!0,k=!1;for(;_<this.rows&&E;){for(x=0,k=!1;x<this.columns&&k===!1;)this.get(_,x)===0?x++:this.get(_,x)===1&&x>b?(k=!0,b=x):(E=!1,k=!0);_++}return E}isReducedEchelonForm(){let _=0,x=0,b=-1,E=!0,k=!1;for(;_<this.rows&&E;){for(x=0,k=!1;x<this.columns&&k===!1;)this.get(_,x)===0?x++:this.get(_,x)===1&&x>b?(k=!0,b=x):(E=!1,k=!0);for(let I=x+1;I<this.rows;I++)this.get(_,I)!==0&&(E=!1);_++}return E}echelonForm(){let _=this.clone(),x=0,b=0;for(;x<_.rows&&b<_.columns;){let E=x;for(let k=x;k<_.rows;k++)_.get(k,b)>_.get(E,b)&&(E=k);if(_.get(E,b)===0)b++;else{_.swapRows(x,E);let k=_.get(x,b);for(let I=b;I<_.columns;I++)_.set(x,I,_.get(x,I)/k);for(let I=x+1;I<_.rows;I++){let R=_.get(I,b)/_.get(x,b);_.set(I,b,0);for(let B=b+1;B<_.columns;B++)_.set(I,B,_.get(I,B)-_.get(x,B)*R)}x++,b++}}return _}reducedEchelonForm(){let _=this.echelonForm(),x=_.columns,b=_.rows,E=b-1;for(;E>=0;)if(_.maxRow(E)===0)E--;else{let k=0,I=!1;for(;k<b&&I===!1;)_.get(E,k)===1?I=!0:k++;for(let R=0;R<E;R++){let B=_.get(R,k);for(let F=k;F<x;F++){let J=_.get(R,F)-B*_.get(E,F);_.set(R,F,J)}}E--}return _}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(_={}){if(typeof _!="object")throw new TypeError("options must be an object");const{rows:x=1,columns:b=1}=_;if(!Number.isInteger(x)||x<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(b)||b<=0)throw new TypeError("columns must be a positive integer");let E=new W(this.rows*x,this.columns*b);for(let k=0;k<x;k++)for(let I=0;I<b;I++)E.setSubMatrix(this,this.rows*k,this.columns*I);return E}fill(_){for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,_);return this}neg(){return this.mulS(-1)}getRow(_){c(this,_);let x=[];for(let b=0;b<this.columns;b++)x.push(this.get(_,b));return x}getRowVector(_){return W.rowVector(this.getRow(_))}setRow(_,x){c(this,_),x=h(this,x);for(let b=0;b<this.columns;b++)this.set(_,b,x[b]);return this}swapRows(_,x){c(this,_),c(this,x);for(let b=0;b<this.columns;b++){let E=this.get(_,b);this.set(_,b,this.get(x,b)),this.set(x,b,E)}return this}getColumn(_){d(this,_);let x=[];for(let b=0;b<this.rows;b++)x.push(this.get(b,_));return x}getColumnVector(_){return W.columnVector(this.getColumn(_))}setColumn(_,x){d(this,_),x=f(this,x);for(let b=0;b<this.rows;b++)this.set(b,_,x[b]);return this}swapColumns(_,x){d(this,_),d(this,x);for(let b=0;b<this.rows;b++){let E=this.get(b,_);this.set(b,_,this.get(b,x)),this.set(b,x,E)}return this}addRowVector(_){_=h(this,_);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)+_[b]);return this}subRowVector(_){_=h(this,_);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)-_[b]);return this}mulRowVector(_){_=h(this,_);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)*_[b]);return this}divRowVector(_){_=h(this,_);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)/_[b]);return this}addColumnVector(_){_=f(this,_);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)+_[x]);return this}subColumnVector(_){_=f(this,_);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)-_[x]);return this}mulColumnVector(_){_=f(this,_);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)*_[x]);return this}divColumnVector(_){_=f(this,_);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)this.set(x,b,this.get(x,b)/_[x]);return this}mulRow(_,x){c(this,_);for(let b=0;b<this.columns;b++)this.set(_,b,this.get(_,b)*x);return this}mulColumn(_,x){d(this,_);for(let b=0;b<this.rows;b++)this.set(b,_,this.get(b,_)*x);return this}max(_){if(this.isEmpty())return NaN;switch(_){case"row":{const x=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.get(b,E)>x[b]&&(x[b]=this.get(b,E));return x}case"column":{const x=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.get(b,E)>x[E]&&(x[E]=this.get(b,E));return x}case void 0:{let x=this.get(0,0);for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.get(b,E)>x&&(x=this.get(b,E));return x}default:throw new Error(`invalid option: ${_}`)}}maxIndex(){w(this);let _=this.get(0,0),x=[0,0];for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.get(b,E)>_&&(_=this.get(b,E),x[0]=b,x[1]=E);return x}min(_){if(this.isEmpty())return NaN;switch(_){case"row":{const x=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.get(b,E)<x[b]&&(x[b]=this.get(b,E));return x}case"column":{const x=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.get(b,E)<x[E]&&(x[E]=this.get(b,E));return x}case void 0:{let x=this.get(0,0);for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.get(b,E)<x&&(x=this.get(b,E));return x}default:throw new Error(`invalid option: ${_}`)}}minIndex(){w(this);let _=this.get(0,0),x=[0,0];for(let b=0;b<this.rows;b++)for(let E=0;E<this.columns;E++)this.get(b,E)<_&&(_=this.get(b,E),x[0]=b,x[1]=E);return x}maxRow(_){if(c(this,_),this.isEmpty())return NaN;let x=this.get(_,0);for(let b=1;b<this.columns;b++)this.get(_,b)>x&&(x=this.get(_,b));return x}maxRowIndex(_){c(this,_),w(this);let x=this.get(_,0),b=[_,0];for(let E=1;E<this.columns;E++)this.get(_,E)>x&&(x=this.get(_,E),b[1]=E);return b}minRow(_){if(c(this,_),this.isEmpty())return NaN;let x=this.get(_,0);for(let b=1;b<this.columns;b++)this.get(_,b)<x&&(x=this.get(_,b));return x}minRowIndex(_){c(this,_),w(this);let x=this.get(_,0),b=[_,0];for(let E=1;E<this.columns;E++)this.get(_,E)<x&&(x=this.get(_,E),b[1]=E);return b}maxColumn(_){if(d(this,_),this.isEmpty())return NaN;let x=this.get(0,_);for(let b=1;b<this.rows;b++)this.get(b,_)>x&&(x=this.get(b,_));return x}maxColumnIndex(_){d(this,_),w(this);let x=this.get(0,_),b=[0,_];for(let E=1;E<this.rows;E++)this.get(E,_)>x&&(x=this.get(E,_),b[0]=E);return b}minColumn(_){if(d(this,_),this.isEmpty())return NaN;let x=this.get(0,_);for(let b=1;b<this.rows;b++)this.get(b,_)<x&&(x=this.get(b,_));return x}minColumnIndex(_){d(this,_),w(this);let x=this.get(0,_),b=[0,_];for(let E=1;E<this.rows;E++)this.get(E,_)<x&&(x=this.get(E,_),b[0]=E);return b}diag(){let _=Math.min(this.rows,this.columns),x=[];for(let b=0;b<_;b++)x.push(this.get(b,b));return x}norm(_="frobenius"){switch(_){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${_}`)}}cumulativeSum(){let _=0;for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)_+=this.get(x,b),this.set(x,b,_);return this}dot(_){oe.isMatrix(_)&&(_=_.to1DArray());let x=this.to1DArray();if(x.length!==_.length)throw new RangeError("vectors do not have the same size");let b=0;for(let E=0;E<x.length;E++)b+=x[E]*_[E];return b}mmul(_){_=W.checkMatrix(_);let x=this.rows,b=this.columns,E=_.columns,k=new W(x,E),I=new Float64Array(b);for(let R=0;R<E;R++){for(let B=0;B<b;B++)I[B]=_.get(B,R);for(let B=0;B<x;B++){let F=0;for(let J=0;J<b;J++)F+=this.get(B,J)*I[J];k.set(B,R,F)}}return k}mpow(_){if(!this.isSquare())throw new RangeError("Matrix must be square");if(!Number.isInteger(_)||_<0)throw new RangeError("Exponent must be a non-negative integer");let x=W.eye(this.rows),b=this;for(let E=_;E>1;E/=2)E&1&&(x=x.mmul(b)),b=b.mmul(b);return x}strassen2x2(_){_=W.checkMatrix(_);let x=new W(2,2);const b=this.get(0,0),E=_.get(0,0),k=this.get(0,1),I=_.get(0,1),R=this.get(1,0),B=_.get(1,0),F=this.get(1,1),J=_.get(1,1),U=(b+F)*(E+J),ie=(R+F)*E,me=b*(I-J),te=F*(B-E),ue=(b+k)*J,Se=(R-b)*(E+I),H=(k-F)*(B+J),ye=U+te-ue+H,Ae=me+ue,Re=ie+te,Fe=U-ie+me+Se;return x.set(0,0,ye),x.set(0,1,Ae),x.set(1,0,Re),x.set(1,1,Fe),x}strassen3x3(_){_=W.checkMatrix(_);let x=new W(3,3);const b=this.get(0,0),E=this.get(0,1),k=this.get(0,2),I=this.get(1,0),R=this.get(1,1),B=this.get(1,2),F=this.get(2,0),J=this.get(2,1),U=this.get(2,2),ie=_.get(0,0),me=_.get(0,1),te=_.get(0,2),ue=_.get(1,0),Se=_.get(1,1),H=_.get(1,2),ye=_.get(2,0),Ae=_.get(2,1),Re=_.get(2,2),Fe=(b+E+k-I-R-J-U)*Se,At=(b-I)*(-me+Se),Pe=R*(-ie+me+ue-Se-H-ye+Re),De=(-b+I+R)*(ie-me+Se),ct=(I+R)*(-ie+me),X=b*ie,ge=(-b+F+J)*(ie-te+H),_e=(-b+F)*(te-H),pe=(F+J)*(-ie+te),kt=(b+E+k-R-B-F-J)*H,nt=J*(-ie+te+ue-Se-H-ye+Ae),wt=(-k+J+U)*(Se+ye-Ae),Nt=(k-U)*(Se-Ae),mn=k*ye,Cr=(J+U)*(-ye+Ae),nn=(-k+R+B)*(H+ye-Re),Kr=(k-B)*(H-Re),vi=(R+B)*(-ye+Re),Je=E*ue,bn=B*Ae,nr=I*te,rr=F*me,rn=U*Re,lC=X+mn+Je,cC=Fe+De+ct+X+wt+mn+Cr,dC=X+ge+pe+kt+mn+nn+vi,hC=At+Pe+De+X+mn+nn+Kr,fC=At+De+ct+X+bn,gC=mn+nn+Kr+vi+nr,pC=X+ge+_e+nt+wt+Nt+mn,vC=wt+Nt+mn+Cr+rr,yC=X+ge+_e+pe+rn;return x.set(0,0,lC),x.set(0,1,cC),x.set(0,2,dC),x.set(1,0,hC),x.set(1,1,fC),x.set(1,2,gC),x.set(2,0,pC),x.set(2,1,vC),x.set(2,2,yC),x}mmulStrassen(_){_=W.checkMatrix(_);let x=this.clone(),b=x.rows,E=x.columns,k=_.rows,I=_.columns;E!==k&&console.warn(`Multiplying ${b} x ${E} and ${k} x ${I} matrix: dimensions do not match.`);function R(U,ie,me){let te=U.rows,ue=U.columns;if(te===ie&&ue===me)return U;{let Se=oe.zeros(ie,me);return Se=Se.setSubMatrix(U,0,0),Se}}let B=Math.max(b,k),F=Math.max(E,I);x=R(x,B,F),_=R(_,B,F);function J(U,ie,me,te){if(me<=512||te<=512)return U.mmul(ie);me%2===1&&te%2===1?(U=R(U,me+1,te+1),ie=R(ie,me+1,te+1)):me%2===1?(U=R(U,me+1,te),ie=R(ie,me+1,te)):te%2===1&&(U=R(U,me,te+1),ie=R(ie,me,te+1));let ue=parseInt(U.rows/2,10),Se=parseInt(U.columns/2,10),H=U.subMatrix(0,ue-1,0,Se-1),ye=ie.subMatrix(0,ue-1,0,Se-1),Ae=U.subMatrix(0,ue-1,Se,U.columns-1),Re=ie.subMatrix(0,ue-1,Se,ie.columns-1),Fe=U.subMatrix(ue,U.rows-1,0,Se-1),At=ie.subMatrix(ue,ie.rows-1,0,Se-1),Pe=U.subMatrix(ue,U.rows-1,Se,U.columns-1),De=ie.subMatrix(ue,ie.rows-1,Se,ie.columns-1),ct=J(oe.add(H,Pe),oe.add(ye,De),ue,Se),X=J(oe.add(Fe,Pe),ye,ue,Se),ge=J(H,oe.sub(Re,De),ue,Se),_e=J(Pe,oe.sub(At,ye),ue,Se),pe=J(oe.add(H,Ae),De,ue,Se),kt=J(oe.sub(Fe,H),oe.add(ye,Re),ue,Se),nt=J(oe.sub(Ae,Pe),oe.add(At,De),ue,Se),wt=oe.add(ct,_e);wt.sub(pe),wt.add(nt);let Nt=oe.add(ge,pe),mn=oe.add(X,_e),Cr=oe.sub(ct,X);Cr.add(ge),Cr.add(kt);let nn=oe.zeros(2*wt.rows,2*wt.columns);return nn=nn.setSubMatrix(wt,0,0),nn=nn.setSubMatrix(Nt,wt.rows,0),nn=nn.setSubMatrix(mn,0,wt.columns),nn=nn.setSubMatrix(Cr,wt.rows,wt.columns),nn.subMatrix(0,me-1,0,te-1)}return J(x,_,B,F)}scaleRows(_={}){if(typeof _!="object")throw new TypeError("options must be an object");const{min:x=0,max:b=1}=_;if(!Number.isFinite(x))throw new TypeError("min must be a number");if(!Number.isFinite(b))throw new TypeError("max must be a number");if(x>=b)throw new RangeError("min must be smaller than max");let E=new W(this.rows,this.columns);for(let k=0;k<this.rows;k++){const I=this.getRow(k);I.length>0&&e(I,{min:x,max:b,output:I}),E.setRow(k,I)}return E}scaleColumns(_={}){if(typeof _!="object")throw new TypeError("options must be an object");const{min:x=0,max:b=1}=_;if(!Number.isFinite(x))throw new TypeError("min must be a number");if(!Number.isFinite(b))throw new TypeError("max must be a number");if(x>=b)throw new RangeError("min must be smaller than max");let E=new W(this.rows,this.columns);for(let k=0;k<this.columns;k++){const I=this.getColumn(k);I.length&&e(I,{min:x,max:b,output:I}),E.setColumn(k,I)}return E}flipRows(){const _=Math.ceil(this.columns/2);for(let x=0;x<this.rows;x++)for(let b=0;b<_;b++){let E=this.get(x,b),k=this.get(x,this.columns-1-b);this.set(x,b,k),this.set(x,this.columns-1-b,E)}return this}flipColumns(){const _=Math.ceil(this.rows/2);for(let x=0;x<this.columns;x++)for(let b=0;b<_;b++){let E=this.get(b,x),k=this.get(this.rows-1-b,x);this.set(b,x,k),this.set(this.rows-1-b,x,E)}return this}kroneckerProduct(_){_=W.checkMatrix(_);let x=this.rows,b=this.columns,E=_.rows,k=_.columns,I=new W(x*E,b*k);for(let R=0;R<x;R++)for(let B=0;B<b;B++)for(let F=0;F<E;F++)for(let J=0;J<k;J++)I.set(E*R+F,k*B+J,this.get(R,B)*_.get(F,J));return I}kroneckerSum(_){if(_=W.checkMatrix(_),!this.isSquare()||!_.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let x=this.rows,b=_.rows,E=this.kroneckerProduct(W.eye(b,b)),k=W.eye(x,x).kroneckerProduct(_);return E.add(k)}transpose(){let _=new W(this.columns,this.rows);for(let x=0;x<this.rows;x++)for(let b=0;b<this.columns;b++)_.set(b,x,this.get(x,b));return _}sortRows(_=Ne){for(let x=0;x<this.rows;x++)this.setRow(x,this.getRow(x).sort(_));return this}sortColumns(_=Ne){for(let x=0;x<this.columns;x++)this.setColumn(x,this.getColumn(x).sort(_));return this}subMatrix(_,x,b,E){p(this,_,x,b,E);let k=new W(x-_+1,E-b+1);for(let I=_;I<=x;I++)for(let R=b;R<=E;R++)k.set(I-_,R-b,this.get(I,R));return k}subMatrixRow(_,x,b){if(x===void 0&&(x=0),b===void 0&&(b=this.columns-1),x>b||x<0||x>=this.columns||b<0||b>=this.columns)throw new RangeError("Argument out of range");let E=new W(_.length,b-x+1);for(let k=0;k<_.length;k++)for(let I=x;I<=b;I++){if(_[k]<0||_[k]>=this.rows)throw new RangeError(`Row index out of range: ${_[k]}`);E.set(k,I-x,this.get(_[k],I))}return E}subMatrixColumn(_,x,b){if(x===void 0&&(x=0),b===void 0&&(b=this.rows-1),x>b||x<0||x>=this.rows||b<0||b>=this.rows)throw new RangeError("Argument out of range");let E=new W(b-x+1,_.length);for(let k=0;k<_.length;k++)for(let I=x;I<=b;I++){if(_[k]<0||_[k]>=this.columns)throw new RangeError(`Column index out of range: ${_[k]}`);E.set(I-x,k,this.get(I,_[k]))}return E}setSubMatrix(_,x,b){if(_=W.checkMatrix(_),_.isEmpty())return this;let E=x+_.rows-1,k=b+_.columns-1;p(this,x,E,b,k);for(let I=0;I<_.rows;I++)for(let R=0;R<_.columns;R++)this.set(x+I,b+R,_.get(I,R));return this}selection(_,x){g(this,_),v(this,x);let b=new W(_.length,x.length);for(let E=0;E<_.length;E++){let k=_[E];for(let I=0;I<x.length;I++){let R=x[I];b.set(E,I,this.get(k,R))}}return b}trace(){let _=Math.min(this.rows,this.columns),x=0;for(let b=0;b<_;b++)x+=this.get(b,b);return x}clone(){return this.constructor.copy(this,new W(this.rows,this.columns))}static copy(_,x){for(const[b,E,k]of _.entries())x.set(b,E,k);return x}sum(_){switch(_){case"row":return M(this);case"column":return S(this);case void 0:return T(this);default:throw new Error(`invalid option: ${_}`)}}product(_){switch(_){case"row":return A(this);case"column":return O(this);case void 0:return N(this);default:throw new Error(`invalid option: ${_}`)}}mean(_){const x=this.sum(_);switch(_){case"row":{for(let b=0;b<this.rows;b++)x[b]/=this.columns;return x}case"column":{for(let b=0;b<this.columns;b++)x[b]/=this.rows;return x}case void 0:return x/this.size;default:throw new Error(`invalid option: ${_}`)}}variance(_,x={}){if(typeof _=="object"&&(x=_,_=void 0),typeof x!="object")throw new TypeError("options must be an object");const{unbiased:b=!0,mean:E=this.mean(_)}=x;if(typeof b!="boolean")throw new TypeError("unbiased must be a boolean");switch(_){case"row":{if(!r.isAnyArray(E))throw new TypeError("mean must be an array");return C(this,b,E)}case"column":{if(!r.isAnyArray(E))throw new TypeError("mean must be an array");return P(this,b,E)}case void 0:{if(typeof E!="number")throw new TypeError("mean must be a number");return D(this,b,E)}default:throw new Error(`invalid option: ${_}`)}}standardDeviation(_,x){typeof _=="object"&&(x=_,_=void 0);const b=this.variance(_,x);if(_===void 0)return Math.sqrt(b);for(let E=0;E<b.length;E++)b[E]=Math.sqrt(b[E]);return b}center(_,x={}){if(typeof _=="object"&&(x=_,_=void 0),typeof x!="object")throw new TypeError("options must be an object");const{center:b=this.mean(_)}=x;switch(_){case"row":{if(!r.isAnyArray(b))throw new TypeError("center must be an array");return j(this,b),this}case"column":{if(!r.isAnyArray(b))throw new TypeError("center must be an array");return G(this,b),this}case void 0:{if(typeof b!="number")throw new TypeError("center must be a number");return V(this,b),this}default:throw new Error(`invalid option: ${_}`)}}scale(_,x={}){if(typeof _=="object"&&(x=_,_=void 0),typeof x!="object")throw new TypeError("options must be an object");let b=x.scale;switch(_){case"row":{if(b===void 0)b=Y(this);else if(!r.isAnyArray(b))throw new TypeError("scale must be an array");return $(this,b),this}case"column":{if(b===void 0)b=z(this);else if(!r.isAnyArray(b))throw new TypeError("scale must be an array");return Z(this,b),this}case void 0:{if(b===void 0)b=ne(this);else if(typeof b!="number")throw new TypeError("scale must be a number");return se(this,b),this}default:throw new Error(`invalid option: ${_}`)}}toString(_){return a(this,_)}[Symbol.iterator](){return this.entries()}*entries(){for(let _=0;_<this.rows;_++)for(let x=0;x<this.columns;x++)yield[_,x,this.get(_,x)]}*values(){for(let _=0;_<this.rows;_++)for(let x=0;x<this.columns;x++)yield this.get(_,x)}}oe.prototype.klass="Matrix",typeof Symbol<"u"&&(oe.prototype[Symbol.for("nodejs.util.inspect.custom")]=i);function Ne(L,_){return L-_}function K(L){return L.every(_=>typeof _=="number")}oe.random=oe.rand,oe.randomInt=oe.randInt,oe.diagonal=oe.diag,oe.prototype.diagonal=oe.prototype.diag,oe.identity=oe.eye,oe.prototype.negate=oe.prototype.neg,oe.prototype.tensorProduct=oe.prototype.kroneckerProduct;const Ou=class Ou extends oe{constructor(x,b){super();Qd(this,Js);xt(this,"data");if(Ou.isMatrix(x))Jd(this,Js,Py).call(this,x.rows,x.columns),Ou.copy(x,this);else if(Number.isInteger(x)&&x>=0)Jd(this,Js,Py).call(this,x,b);else if(r.isAnyArray(x)){const E=x;if(x=E.length,b=x?E[0].length:0,typeof b!="number")throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let k=0;k<x;k++){if(E[k].length!==b)throw new RangeError("Inconsistent array dimensions");if(!K(E[k]))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(E[k]))}this.rows=x,this.columns=b}else throw new TypeError("First argument must be a positive number or an array")}set(x,b,E){return this.data[x][b]=E,this}get(x,b){return this.data[x][b]}removeRow(x){return c(this,x),this.data.splice(x,1),this.rows-=1,this}addRow(x,b){return b===void 0&&(b=x,x=this.rows),c(this,x,!0),b=Float64Array.from(h(this,b)),this.data.splice(x,0,b),this.rows+=1,this}removeColumn(x){d(this,x);for(let b=0;b<this.rows;b++){const E=new Float64Array(this.columns-1);for(let k=0;k<x;k++)E[k]=this.data[b][k];for(let k=x+1;k<this.columns;k++)E[k-1]=this.data[b][k];this.data[b]=E}return this.columns-=1,this}addColumn(x,b){typeof b>"u"&&(b=x,x=this.columns),d(this,x,!0),b=f(this,b);for(let E=0;E<this.rows;E++){const k=new Float64Array(this.columns+1);let I=0;for(;I<x;I++)k[I]=this.data[E][I];for(k[I++]=b[E];I<this.columns+1;I++)k[I]=this.data[E][I-1];this.data[E]=k}return this.columns+=1,this}};Js=new WeakSet,Py=function(x,b){if(this.data=[],Number.isInteger(b)&&b>=0)for(let E=0;E<x;E++)this.data.push(new Float64Array(b));else throw new TypeError("nColumns must be a positive integer");this.rows=x,this.columns=b};let W=Ou;l(oe,W);const Au=class Au extends oe{constructor(x){super();Qd(this,kn);if(W.isMatrix(x)){if(!x.isSymmetric())throw new TypeError("not symmetric data");ku(this,kn,W.copy(x,new W(x.rows,x.rows)))}else if(Number.isInteger(x)&&x>=0)ku(this,kn,new W(x,x));else if(ku(this,kn,new W(x)),!this.isSymmetric())throw new TypeError("not symmetric data")}get size(){return Pr(this,kn).size}get rows(){return Pr(this,kn).rows}get columns(){return Pr(this,kn).columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(x){return W.isMatrix(x)&&x.klassType==="SymmetricMatrix"}static zeros(x){return new this(x)}static ones(x){return new this(x).fill(1)}clone(){const x=new Au(this.diagonalSize);for(const[b,E,k]of this.upperRightEntries())x.set(b,E,k);return x}toMatrix(){return new W(this)}get(x,b){return Pr(this,kn).get(x,b)}set(x,b,E){return Pr(this,kn).set(x,b,E),Pr(this,kn).set(b,x,E),this}removeCross(x){return Pr(this,kn).removeRow(x),Pr(this,kn).removeColumn(x),this}addCross(x,b){b===void 0&&(b=x,x=this.diagonalSize);const E=b.slice();return E.splice(x,1),Pr(this,kn).addRow(x,E),Pr(this,kn).addColumn(x,b),this}applyMask(x){if(x.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const b=[];for(const[E,k]of x.entries())k||b.push(E);b.reverse();for(const E of b)this.removeCross(E);return this}toCompact(){const{diagonalSize:x}=this,b=new Array(x*(x+1)/2);for(let E=0,k=0,I=0;I<b.length;I++)b[I]=this.get(k,E),++E>=x&&(E=++k);return b}static fromCompact(x){const b=x.length,E=(Math.sqrt(8*b+1)-1)/2;if(!Number.isInteger(E))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(x)}`);const k=new Au(E);for(let I=0,R=0,B=0;B<b;B++)k.set(I,R,x[B]),++I>=E&&(I=++R);return k}*upperRightEntries(){for(let x=0,b=0;x<this.diagonalSize;void 0){const E=this.get(x,b);yield[x,b,E],++b>=this.diagonalSize&&(b=++x)}}*upperRightValues(){for(let x=0,b=0;x<this.diagonalSize;void 0)yield this.get(x,b),++b>=this.diagonalSize&&(b=++x)}};kn=new WeakMap;let ee=Au;ee.prototype.klassType="SymmetricMatrix";class le extends ee{static isDistanceMatrix(_){return ee.isSymmetricMatrix(_)&&_.klassSubType==="DistanceMatrix"}constructor(_){if(super(_),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(_,x,b){return _===x&&(b=0),super.set(_,x,b)}addCross(_,x){return x===void 0&&(x=_,_=this.diagonalSize),x=x.slice(),x[_]=0,super.addCross(_,x)}toSymmetricMatrix(){return new ee(this)}clone(){const _=new le(this.diagonalSize);for(const[x,b,E]of this.upperRightEntries())x!==b&&_.set(x,b,E);return _}toCompact(){const{diagonalSize:_}=this,x=(_-1)*_/2,b=new Array(x);for(let E=1,k=0,I=0;I<b.length;I++)b[I]=this.get(k,E),++E>=_&&(E=++k+1);return b}static fromCompact(_){const x=_.length;if(x===0)return new this(0);const b=(Math.sqrt(8*x+1)+1)/2;if(!Number.isInteger(b))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(_)}`);const E=new this(b);for(let k=1,I=0,R=0;R<x;R++)E.set(k,I,_[R]),++k>=b&&(k=++I+1);return E}}le.prototype.klassSubType="DistanceMatrix";class xe extends oe{constructor(_,x,b){super(),this.matrix=_,this.rows=x,this.columns=b}}class Ce extends xe{constructor(_,x){d(_,x),super(_,_.rows,1),this.column=x}set(_,x,b){return this.matrix.set(_,this.column,b),this}get(_){return this.matrix.get(_,this.column)}}class Ve extends xe{constructor(_,x){v(_,x),super(_,_.rows,x.length),this.columnIndices=x}set(_,x,b){return this.matrix.set(_,this.columnIndices[x],b),this}get(_,x){return this.matrix.get(_,this.columnIndices[x])}}class Tt extends xe{constructor(_){super(_,_.rows,_.columns)}set(_,x,b){return this.matrix.set(_,this.columns-x-1,b),this}get(_,x){return this.matrix.get(_,this.columns-x-1)}}class dn extends xe{constructor(_){super(_,_.rows,_.columns)}set(_,x,b){return this.matrix.set(this.rows-_-1,x,b),this}get(_,x){return this.matrix.get(this.rows-_-1,x)}}class Ot extends xe{constructor(_,x){c(_,x),super(_,1,_.columns),this.row=x}set(_,x,b){return this.matrix.set(this.row,x,b),this}get(_,x){return this.matrix.get(this.row,x)}}class Ut extends xe{constructor(_,x){g(_,x),super(_,x.length,_.columns),this.rowIndices=x}set(_,x,b){return this.matrix.set(this.rowIndices[_],x,b),this}get(_,x){return this.matrix.get(this.rowIndices[_],x)}}class Xe extends xe{constructor(_,x,b){g(_,x),v(_,b),super(_,x.length,b.length),this.rowIndices=x,this.columnIndices=b}set(_,x,b){return this.matrix.set(this.rowIndices[_],this.columnIndices[x],b),this}get(_,x){return this.matrix.get(this.rowIndices[_],this.columnIndices[x])}}class vr extends xe{constructor(_,x,b,E,k){p(_,x,b,E,k),super(_,b-x+1,k-E+1),this.startRow=x,this.startColumn=E}set(_,x,b){return this.matrix.set(this.startRow+_,this.startColumn+x,b),this}get(_,x){return this.matrix.get(this.startRow+_,this.startColumn+x)}}class Qe extends xe{constructor(_){super(_,_.columns,_.rows)}set(_,x,b){return this.matrix.set(x,_,b),this}get(_,x){return this.matrix.get(x,_)}}class yr extends oe{constructor(_,x={}){const{rows:b=1}=x;if(_.length%b!==0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=b,this.columns=_.length/b,this.data=_}set(_,x,b){let E=this._calculateIndex(_,x);return this.data[E]=b,this}get(_,x){let b=this._calculateIndex(_,x);return this.data[b]}_calculateIndex(_,x){return _*this.columns+x}}class bt extends oe{constructor(_){super(),this.data=_,this.rows=_.length,this.columns=_[0].length}set(_,x,b){return this.data[_][x]=b,this}get(_,x){return this.data[_][x]}}function as(L,_){if(r.isAnyArray(L))return L[0]&&r.isAnyArray(L[0])?new bt(L):new yr(L,_);throw new Error("the argument is not an array")}class mr{constructor(_){_=bt.checkMatrix(_);let x=_.clone(),b=x.rows,E=x.columns,k=new Float64Array(b),I=1,R,B,F,J,U,ie,me,te,ue;for(R=0;R<b;R++)k[R]=R;for(te=new Float64Array(b),B=0;B<E;B++){for(R=0;R<b;R++)te[R]=x.get(R,B);for(R=0;R<b;R++){for(ue=Math.min(R,B),U=0,F=0;F<ue;F++)U+=x.get(R,F)*te[F];te[R]-=U,x.set(R,B,te[R])}for(J=B,R=B+1;R<b;R++)Math.abs(te[R])>Math.abs(te[J])&&(J=R);if(J!==B){for(F=0;F<E;F++)ie=x.get(J,F),x.set(J,F,x.get(B,F)),x.set(B,F,ie);me=k[J],k[J]=k[B],k[B]=me,I=-I}if(B<b&&x.get(B,B)!==0)for(R=B+1;R<b;R++)x.set(R,B,x.get(R,B)/x.get(B,B))}this.LU=x,this.pivotVector=k,this.pivotSign=I}isSingular(){let _=this.LU,x=_.columns;for(let b=0;b<x;b++)if(_.get(b,b)===0)return!0;return!1}solve(_){_=W.checkMatrix(_);let x=this.LU;if(x.rows!==_.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let E=_.columns,k=_.subMatrixRow(this.pivotVector,0,E-1),I=x.columns,R,B,F;for(F=0;F<I;F++)for(R=F+1;R<I;R++)for(B=0;B<E;B++)k.set(R,B,k.get(R,B)-k.get(F,B)*x.get(R,F));for(F=I-1;F>=0;F--){for(B=0;B<E;B++)k.set(F,B,k.get(F,B)/x.get(F,F));for(R=0;R<F;R++)for(B=0;B<E;B++)k.set(R,B,k.get(R,B)-k.get(F,B)*x.get(R,F))}return k}get determinant(){let _=this.LU;if(!_.isSquare())throw new Error("Matrix must be square");let x=this.pivotSign,b=_.columns;for(let E=0;E<b;E++)x*=_.get(E,E);return x}get lowerTriangularMatrix(){let _=this.LU,x=_.rows,b=_.columns,E=new W(x,b);for(let k=0;k<x;k++)for(let I=0;I<b;I++)k>I?E.set(k,I,_.get(k,I)):k===I?E.set(k,I,1):E.set(k,I,0);return E}get upperTriangularMatrix(){let _=this.LU,x=_.rows,b=_.columns,E=new W(x,b);for(let k=0;k<x;k++)for(let I=0;I<b;I++)k<=I?E.set(k,I,_.get(k,I)):E.set(k,I,0);return E}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function qt(L,_){let x=0;return Math.abs(L)>Math.abs(_)?(x=_/L,Math.abs(L)*Math.sqrt(1+x*x)):_!==0?(x=L/_,Math.abs(_)*Math.sqrt(1+x*x)):0}class Lt{constructor(_){_=bt.checkMatrix(_);let x=_.clone(),b=_.rows,E=_.columns,k=new Float64Array(E),I,R,B,F;for(B=0;B<E;B++){let J=0;for(I=B;I<b;I++)J=qt(J,x.get(I,B));if(J!==0){for(x.get(B,B)<0&&(J=-J),I=B;I<b;I++)x.set(I,B,x.get(I,B)/J);for(x.set(B,B,x.get(B,B)+1),R=B+1;R<E;R++){for(F=0,I=B;I<b;I++)F+=x.get(I,B)*x.get(I,R);for(F=-F/x.get(B,B),I=B;I<b;I++)x.set(I,R,x.get(I,R)+F*x.get(I,B))}}k[B]=-J}this.QR=x,this.Rdiag=k}solve(_){_=W.checkMatrix(_);let x=this.QR,b=x.rows;if(_.rows!==b)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let E=_.columns,k=_.clone(),I=x.columns,R,B,F,J;for(F=0;F<I;F++)for(B=0;B<E;B++){for(J=0,R=F;R<b;R++)J+=x.get(R,F)*k.get(R,B);for(J=-J/x.get(F,F),R=F;R<b;R++)k.set(R,B,k.get(R,B)+J*x.get(R,F))}for(F=I-1;F>=0;F--){for(B=0;B<E;B++)k.set(F,B,k.get(F,B)/this.Rdiag[F]);for(R=0;R<F;R++)for(B=0;B<E;B++)k.set(R,B,k.get(R,B)-k.get(F,B)*x.get(R,F))}return k.subMatrix(0,I-1,0,E-1)}isFullRank(){let _=this.QR.columns;for(let x=0;x<_;x++)if(this.Rdiag[x]===0)return!1;return!0}get upperTriangularMatrix(){let _=this.QR,x=_.columns,b=new W(x,x),E,k;for(E=0;E<x;E++)for(k=0;k<x;k++)E<k?b.set(E,k,_.get(E,k)):E===k?b.set(E,k,this.Rdiag[E]):b.set(E,k,0);return b}get orthogonalMatrix(){let _=this.QR,x=_.rows,b=_.columns,E=new W(x,b),k,I,R,B;for(R=b-1;R>=0;R--){for(k=0;k<x;k++)E.set(k,R,0);for(E.set(R,R,1),I=R;I<b;I++)if(_.get(R,R)!==0){for(B=0,k=R;k<x;k++)B+=_.get(k,R)*E.get(k,I);for(B=-B/_.get(R,R),k=R;k<x;k++)E.set(k,I,E.get(k,I)+B*_.get(k,R))}}return E}}class Vn{constructor(_,x={}){if(_=bt.checkMatrix(_),_.isEmpty())throw new Error("Matrix must be non-empty");let b=_.rows,E=_.columns;const{computeLeftSingularVectors:k=!0,computeRightSingularVectors:I=!0,autoTranspose:R=!1}=x;let B=!!k,F=!!I,J=!1,U;if(b<E)if(!R)U=_.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{U=_.transpose(),b=U.rows,E=U.columns,J=!0;let X=B;B=F,F=X}else U=_.clone();let ie=Math.min(b,E),me=Math.min(b+1,E),te=new Float64Array(me),ue=new W(b,ie),Se=new W(E,E),H=new Float64Array(E),ye=new Float64Array(b),Ae=new Float64Array(me);for(let X=0;X<me;X++)Ae[X]=X;let Re=Math.min(b-1,E),Fe=Math.max(0,Math.min(E-2,b)),At=Math.max(Re,Fe);for(let X=0;X<At;X++){if(X<Re){te[X]=0;for(let ge=X;ge<b;ge++)te[X]=qt(te[X],U.get(ge,X));if(te[X]!==0){U.get(X,X)<0&&(te[X]=-te[X]);for(let ge=X;ge<b;ge++)U.set(ge,X,U.get(ge,X)/te[X]);U.set(X,X,U.get(X,X)+1)}te[X]=-te[X]}for(let ge=X+1;ge<E;ge++){if(X<Re&&te[X]!==0){let _e=0;for(let pe=X;pe<b;pe++)_e+=U.get(pe,X)*U.get(pe,ge);_e=-_e/U.get(X,X);for(let pe=X;pe<b;pe++)U.set(pe,ge,U.get(pe,ge)+_e*U.get(pe,X))}H[ge]=U.get(X,ge)}if(B&&X<Re)for(let ge=X;ge<b;ge++)ue.set(ge,X,U.get(ge,X));if(X<Fe){H[X]=0;for(let ge=X+1;ge<E;ge++)H[X]=qt(H[X],H[ge]);if(H[X]!==0){H[X+1]<0&&(H[X]=0-H[X]);for(let ge=X+1;ge<E;ge++)H[ge]/=H[X];H[X+1]+=1}if(H[X]=-H[X],X+1<b&&H[X]!==0){for(let ge=X+1;ge<b;ge++)ye[ge]=0;for(let ge=X+1;ge<b;ge++)for(let _e=X+1;_e<E;_e++)ye[ge]+=H[_e]*U.get(ge,_e);for(let ge=X+1;ge<E;ge++){let _e=-H[ge]/H[X+1];for(let pe=X+1;pe<b;pe++)U.set(pe,ge,U.get(pe,ge)+_e*ye[pe])}}if(F)for(let ge=X+1;ge<E;ge++)Se.set(ge,X,H[ge])}}let Pe=Math.min(E,b+1);if(Re<E&&(te[Re]=U.get(Re,Re)),b<Pe&&(te[Pe-1]=0),Fe+1<Pe&&(H[Fe]=U.get(Fe,Pe-1)),H[Pe-1]=0,B){for(let X=Re;X<ie;X++){for(let ge=0;ge<b;ge++)ue.set(ge,X,0);ue.set(X,X,1)}for(let X=Re-1;X>=0;X--)if(te[X]!==0){for(let ge=X+1;ge<ie;ge++){let _e=0;for(let pe=X;pe<b;pe++)_e+=ue.get(pe,X)*ue.get(pe,ge);_e=-_e/ue.get(X,X);for(let pe=X;pe<b;pe++)ue.set(pe,ge,ue.get(pe,ge)+_e*ue.get(pe,X))}for(let ge=X;ge<b;ge++)ue.set(ge,X,-ue.get(ge,X));ue.set(X,X,1+ue.get(X,X));for(let ge=0;ge<X-1;ge++)ue.set(ge,X,0)}else{for(let ge=0;ge<b;ge++)ue.set(ge,X,0);ue.set(X,X,1)}}if(F)for(let X=E-1;X>=0;X--){if(X<Fe&&H[X]!==0)for(let ge=X+1;ge<E;ge++){let _e=0;for(let pe=X+1;pe<E;pe++)_e+=Se.get(pe,X)*Se.get(pe,ge);_e=-_e/Se.get(X+1,X);for(let pe=X+1;pe<E;pe++)Se.set(pe,ge,Se.get(pe,ge)+_e*Se.get(pe,X))}for(let ge=0;ge<E;ge++)Se.set(ge,X,0);Se.set(X,X,1)}let De=Pe-1,ct=Number.EPSILON;for(;Pe>0;){let X,ge;for(X=Pe-2;X>=-1&&X!==-1;X--){const _e=Number.MIN_VALUE+ct*Math.abs(te[X]+Math.abs(te[X+1]));if(Math.abs(H[X])<=_e||Number.isNaN(H[X])){H[X]=0;break}}if(X===Pe-2)ge=4;else{let _e;for(_e=Pe-1;_e>=X&&_e!==X;_e--){let pe=(_e!==Pe?Math.abs(H[_e]):0)+(_e!==X+1?Math.abs(H[_e-1]):0);if(Math.abs(te[_e])<=ct*pe){te[_e]=0;break}}_e===X?ge=3:_e===Pe-1?ge=1:(ge=2,X=_e)}switch(X++,ge){case 1:{let _e=H[Pe-2];H[Pe-2]=0;for(let pe=Pe-2;pe>=X;pe--){let kt=qt(te[pe],_e),nt=te[pe]/kt,wt=_e/kt;if(te[pe]=kt,pe!==X&&(_e=-wt*H[pe-1],H[pe-1]=nt*H[pe-1]),F)for(let Nt=0;Nt<E;Nt++)kt=nt*Se.get(Nt,pe)+wt*Se.get(Nt,Pe-1),Se.set(Nt,Pe-1,-wt*Se.get(Nt,pe)+nt*Se.get(Nt,Pe-1)),Se.set(Nt,pe,kt)}break}case 2:{let _e=H[X-1];H[X-1]=0;for(let pe=X;pe<Pe;pe++){let kt=qt(te[pe],_e),nt=te[pe]/kt,wt=_e/kt;if(te[pe]=kt,_e=-wt*H[pe],H[pe]=nt*H[pe],B)for(let Nt=0;Nt<b;Nt++)kt=nt*ue.get(Nt,pe)+wt*ue.get(Nt,X-1),ue.set(Nt,X-1,-wt*ue.get(Nt,pe)+nt*ue.get(Nt,X-1)),ue.set(Nt,pe,kt)}break}case 3:{const _e=Math.max(Math.abs(te[Pe-1]),Math.abs(te[Pe-2]),Math.abs(H[Pe-2]),Math.abs(te[X]),Math.abs(H[X])),pe=te[Pe-1]/_e,kt=te[Pe-2]/_e,nt=H[Pe-2]/_e,wt=te[X]/_e,Nt=H[X]/_e,mn=((kt+pe)*(kt-pe)+nt*nt)/2,Cr=pe*nt*(pe*nt);let nn=0;(mn!==0||Cr!==0)&&(mn<0?nn=0-Math.sqrt(mn*mn+Cr):nn=Math.sqrt(mn*mn+Cr),nn=Cr/(mn+nn));let Kr=(wt+pe)*(wt-pe)+nn,vi=wt*Nt;for(let Je=X;Je<Pe-1;Je++){let bn=qt(Kr,vi);bn===0&&(bn=Number.MIN_VALUE);let nr=Kr/bn,rr=vi/bn;if(Je!==X&&(H[Je-1]=bn),Kr=nr*te[Je]+rr*H[Je],H[Je]=nr*H[Je]-rr*te[Je],vi=rr*te[Je+1],te[Je+1]=nr*te[Je+1],F)for(let rn=0;rn<E;rn++)bn=nr*Se.get(rn,Je)+rr*Se.get(rn,Je+1),Se.set(rn,Je+1,-rr*Se.get(rn,Je)+nr*Se.get(rn,Je+1)),Se.set(rn,Je,bn);if(bn=qt(Kr,vi),bn===0&&(bn=Number.MIN_VALUE),nr=Kr/bn,rr=vi/bn,te[Je]=bn,Kr=nr*H[Je]+rr*te[Je+1],te[Je+1]=-rr*H[Je]+nr*te[Je+1],vi=rr*H[Je+1],H[Je+1]=nr*H[Je+1],B&&Je<b-1)for(let rn=0;rn<b;rn++)bn=nr*ue.get(rn,Je)+rr*ue.get(rn,Je+1),ue.set(rn,Je+1,-rr*ue.get(rn,Je)+nr*ue.get(rn,Je+1)),ue.set(rn,Je,bn)}H[Pe-2]=Kr;break}case 4:{if(te[X]<=0&&(te[X]=te[X]<0?-te[X]:0,F))for(let _e=0;_e<=De;_e++)Se.set(_e,X,-Se.get(_e,X));for(;X<De&&!(te[X]>=te[X+1]);){let _e=te[X];if(te[X]=te[X+1],te[X+1]=_e,F&&X<E-1)for(let pe=0;pe<E;pe++)_e=Se.get(pe,X+1),Se.set(pe,X+1,Se.get(pe,X)),Se.set(pe,X,_e);if(B&&X<b-1)for(let pe=0;pe<b;pe++)_e=ue.get(pe,X+1),ue.set(pe,X+1,ue.get(pe,X)),ue.set(pe,X,_e);X++}Pe--;break}}}if(J){let X=Se;Se=ue,ue=X}this.m=b,this.n=E,this.s=te,this.U=ue,this.V=Se}solve(_){let x=_,b=this.threshold,E=this.s.length,k=W.zeros(E,E);for(let ie=0;ie<E;ie++)Math.abs(this.s[ie])<=b?k.set(ie,ie,0):k.set(ie,ie,1/this.s[ie]);let I=this.U,R=this.rightSingularVectors,B=R.mmul(k),F=R.rows,J=I.rows,U=W.zeros(F,J);for(let ie=0;ie<F;ie++)for(let me=0;me<J;me++){let te=0;for(let ue=0;ue<E;ue++)te+=B.get(ie,ue)*I.get(me,ue);U.set(ie,me,te)}return U.mmul(x)}solveForDiagonal(_){return this.solve(W.diag(_))}inverse(){let _=this.V,x=this.threshold,b=_.rows,E=_.columns,k=new W(b,this.s.length);for(let J=0;J<b;J++)for(let U=0;U<E;U++)Math.abs(this.s[U])>x&&k.set(J,U,_.get(J,U)/this.s[U]);let I=this.U,R=I.rows,B=I.columns,F=new W(b,R);for(let J=0;J<b;J++)for(let U=0;U<R;U++){let ie=0;for(let me=0;me<B;me++)ie+=k.get(J,me)*I.get(U,me);F.set(J,U,ie)}return F}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let _=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,x=0,b=this.s;for(let E=0,k=b.length;E<k;E++)b[E]>_&&x++;return x}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return W.diag(this.s)}}function Yn(L,_=!1){return L=bt.checkMatrix(L),_?new Vn(L).inverse():br(L,W.eye(L.rows))}function br(L,_,x=!1){return L=bt.checkMatrix(L),_=bt.checkMatrix(_),x?new Vn(L).solve(_):L.isSquare()?new mr(L).solve(_):new Lt(L).solve(_)}function pi(L){if(L=W.checkMatrix(L),L.isSquare()){if(L.columns===0)return 1;let _,x,b,E;if(L.columns===2)return _=L.get(0,0),x=L.get(0,1),b=L.get(1,0),E=L.get(1,1),_*E-x*b;if(L.columns===3){let k,I,R;return k=new Xe(L,[1,2],[1,2]),I=new Xe(L,[1,2],[0,2]),R=new Xe(L,[1,2],[0,1]),_=L.get(0,0),x=L.get(0,1),b=L.get(0,2),_*pi(k)-x*pi(I)+b*pi(R)}else return new mr(L).determinant}else throw Error("determinant can only be calculated for a square matrix")}function Ur(L,_){let x=[];for(let b=0;b<L;b++)b!==_&&x.push(b);return x}function ss(L,_,x,b=1e-9,E=1e-9){if(L>E)return new Array(_.rows+1).fill(0);{let k=_.addRow(x,[0]);for(let I=0;I<k.rows;I++)Math.abs(k.get(I,0))<b&&k.set(I,0,0);return k.to1DArray()}}function os(L,_={}){const{thresholdValue:x=1e-9,thresholdError:b=1e-9}=_;L=W.checkMatrix(L);let E=L.rows,k=new W(E,E);for(let I=0;I<E;I++){let R=W.columnVector(L.getRow(I)),B=L.subMatrixRow(Ur(E,I)).transpose(),J=new Vn(B).solve(R),U=W.sub(R,B.mmul(J)).abs().max();k.setRow(I,ss(U,J,I,x,b))}return k}function Kd(L,_=Number.EPSILON){if(L=W.checkMatrix(L),L.isEmpty())return L.transpose();let x=new Vn(L,{autoTranspose:!0}),b=x.leftSingularVectors,E=x.rightSingularVectors,k=x.diagonal;for(let I=0;I<k.length;I++)Math.abs(k[I])>_?k[I]=1/k[I]:k[I]=0;return E.mmul(W.diag(k).mmul(b.transpose()))}function _u(L,_=L,x={}){L=new W(L);let b=!1;if(typeof _=="object"&&!W.isMatrix(_)&&!r.isAnyArray(_)?(x=_,_=L,b=!0):_=new W(_),L.rows!==_.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:E=!0}=x;E&&(L=L.center("column"),b||(_=_.center("column")));const k=L.transpose().mmul(_);for(let I=0;I<k.rows;I++)for(let R=0;R<k.columns;R++)k.set(I,R,k.get(I,R)*(1/(L.rows-1)));return k}function Hr(L,_=L,x={}){L=new W(L);let b=!1;if(typeof _=="object"&&!W.isMatrix(_)&&!r.isAnyArray(_)?(x=_,_=L,b=!0):_=new W(_),L.rows!==_.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:E=!0,scale:k=!0}=x;E&&(L.center("column"),b||_.center("column")),k&&(L.scale("column"),b||_.scale("column"));const I=L.standardDeviation("column",{unbiased:!0}),R=b?I:_.standardDeviation("column",{unbiased:!0}),B=L.transpose().mmul(_);for(let F=0;F<B.rows;F++)for(let J=0;J<B.columns;J++)B.set(F,J,B.get(F,J)*(1/(I[F]*R[J]))*(1/(L.rows-1)));return B}class Xr{constructor(_,x={}){const{assumeSymmetric:b=!1}=x;if(_=bt.checkMatrix(_),!_.isSquare())throw new Error("Matrix is not a square matrix");if(_.isEmpty())throw new Error("Matrix must be non-empty");let E=_.columns,k=new W(E,E),I=new Float64Array(E),R=new Float64Array(E),B=_,F,J,U=!1;if(b?U=!0:U=_.isSymmetric(),U){for(F=0;F<E;F++)for(J=0;J<E;J++)k.set(F,J,B.get(F,J));aC(E,R,I,k),sC(E,R,I,k)}else{let ie=new W(E,E),me=new Float64Array(E);for(J=0;J<E;J++)for(F=0;F<E;F++)ie.set(F,J,B.get(F,J));oC(E,ie,me,k),uC(E,R,I,k,ie)}this.n=E,this.e=R,this.d=I,this.V=k}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let _=this.n,x=this.e,b=this.d,E=new W(_,_),k,I;for(k=0;k<_;k++){for(I=0;I<_;I++)E.set(k,I,0);E.set(k,k,b[k]),x[k]>0?E.set(k,k+1,x[k]):x[k]<0&&E.set(k,k-1,x[k])}return E}}function aC(L,_,x,b){let E,k,I,R,B,F,J,U;for(B=0;B<L;B++)x[B]=b.get(L-1,B);for(R=L-1;R>0;R--){for(U=0,I=0,F=0;F<R;F++)U=U+Math.abs(x[F]);if(U===0)for(_[R]=x[R-1],B=0;B<R;B++)x[B]=b.get(R-1,B),b.set(R,B,0),b.set(B,R,0);else{for(F=0;F<R;F++)x[F]/=U,I+=x[F]*x[F];for(E=x[R-1],k=Math.sqrt(I),E>0&&(k=-k),_[R]=U*k,I=I-E*k,x[R-1]=E-k,B=0;B<R;B++)_[B]=0;for(B=0;B<R;B++){for(E=x[B],b.set(B,R,E),k=_[B]+b.get(B,B)*E,F=B+1;F<=R-1;F++)k+=b.get(F,B)*x[F],_[F]+=b.get(F,B)*E;_[B]=k}for(E=0,B=0;B<R;B++)_[B]/=I,E+=_[B]*x[B];for(J=E/(I+I),B=0;B<R;B++)_[B]-=J*x[B];for(B=0;B<R;B++){for(E=x[B],k=_[B],F=B;F<=R-1;F++)b.set(F,B,b.get(F,B)-(E*_[F]+k*x[F]));x[B]=b.get(R-1,B),b.set(R,B,0)}}x[R]=I}for(R=0;R<L-1;R++){if(b.set(L-1,R,b.get(R,R)),b.set(R,R,1),I=x[R+1],I!==0){for(F=0;F<=R;F++)x[F]=b.get(F,R+1)/I;for(B=0;B<=R;B++){for(k=0,F=0;F<=R;F++)k+=b.get(F,R+1)*b.get(F,B);for(F=0;F<=R;F++)b.set(F,B,b.get(F,B)-k*x[F])}}for(F=0;F<=R;F++)b.set(F,R+1,0)}for(B=0;B<L;B++)x[B]=b.get(L-1,B),b.set(L-1,B,0);b.set(L-1,L-1,1),_[0]=0}function sC(L,_,x,b){let E,k,I,R,B,F,J,U,ie,me,te,ue,Se,H,ye,Ae;for(I=1;I<L;I++)_[I-1]=_[I];_[L-1]=0;let Re=0,Fe=0,At=Number.EPSILON;for(F=0;F<L;F++){for(Fe=Math.max(Fe,Math.abs(x[F])+Math.abs(_[F])),J=F;J<L&&!(Math.abs(_[J])<=At*Fe);)J++;if(J>F)do{for(E=x[F],U=(x[F+1]-E)/(2*_[F]),ie=qt(U,1),U<0&&(ie=-ie),x[F]=_[F]/(U+ie),x[F+1]=_[F]*(U+ie),me=x[F+1],k=E-x[F],I=F+2;I<L;I++)x[I]-=k;for(Re=Re+k,U=x[J],te=1,ue=te,Se=te,H=_[F+1],ye=0,Ae=0,I=J-1;I>=F;I--)for(Se=ue,ue=te,Ae=ye,E=te*_[I],k=te*U,ie=qt(U,_[I]),_[I+1]=ye*ie,ye=_[I]/ie,te=U/ie,U=te*x[I]-ye*E,x[I+1]=k+ye*(te*E+ye*x[I]),B=0;B<L;B++)k=b.get(B,I+1),b.set(B,I+1,ye*b.get(B,I)+te*k),b.set(B,I,te*b.get(B,I)-ye*k);U=-ye*Ae*Se*H*_[F]/me,_[F]=ye*U,x[F]=te*U}while(Math.abs(_[F])>At*Fe);x[F]=x[F]+Re,_[F]=0}for(I=0;I<L-1;I++){for(B=I,U=x[I],R=I+1;R<L;R++)x[R]<U&&(B=R,U=x[R]);if(B!==I)for(x[B]=x[I],x[I]=U,R=0;R<L;R++)U=b.get(R,I),b.set(R,I,b.get(R,B)),b.set(R,B,U)}}function oC(L,_,x,b){let E=0,k=L-1,I,R,B,F,J,U,ie;for(U=E+1;U<=k-1;U++){for(ie=0,F=U;F<=k;F++)ie=ie+Math.abs(_.get(F,U-1));if(ie!==0){for(B=0,F=k;F>=U;F--)x[F]=_.get(F,U-1)/ie,B+=x[F]*x[F];for(R=Math.sqrt(B),x[U]>0&&(R=-R),B=B-x[U]*R,x[U]=x[U]-R,J=U;J<L;J++){for(I=0,F=k;F>=U;F--)I+=x[F]*_.get(F,J);for(I=I/B,F=U;F<=k;F++)_.set(F,J,_.get(F,J)-I*x[F])}for(F=0;F<=k;F++){for(I=0,J=k;J>=U;J--)I+=x[J]*_.get(F,J);for(I=I/B,J=U;J<=k;J++)_.set(F,J,_.get(F,J)-I*x[J])}x[U]=ie*x[U],_.set(U,U-1,ie*R)}}for(F=0;F<L;F++)for(J=0;J<L;J++)b.set(F,J,F===J?1:0);for(U=k-1;U>=E+1;U--)if(_.get(U,U-1)!==0){for(F=U+1;F<=k;F++)x[F]=_.get(F,U-1);for(J=U;J<=k;J++){for(R=0,F=U;F<=k;F++)R+=x[F]*b.get(F,J);for(R=R/x[U]/_.get(U,U-1),F=U;F<=k;F++)b.set(F,J,b.get(F,J)+R*x[F])}}}function uC(L,_,x,b,E){let k=L-1,I=0,R=L-1,B=Number.EPSILON,F=0,J=0,U=0,ie=0,me=0,te=0,ue=0,Se=0,H,ye,Ae,Re,Fe,At,Pe,De,ct,X,ge,_e,pe,kt,nt;for(H=0;H<L;H++)for((H<I||H>R)&&(x[H]=E.get(H,H),_[H]=0),ye=Math.max(H-1,0);ye<L;ye++)J=J+Math.abs(E.get(H,ye));for(;k>=I;){for(Re=k;Re>I&&(te=Math.abs(E.get(Re-1,Re-1))+Math.abs(E.get(Re,Re)),te===0&&(te=J),!(Math.abs(E.get(Re,Re-1))<B*te));)Re--;if(Re===k)E.set(k,k,E.get(k,k)+F),x[k]=E.get(k,k),_[k]=0,k--,Se=0;else if(Re===k-1){if(Pe=E.get(k,k-1)*E.get(k-1,k),U=(E.get(k-1,k-1)-E.get(k,k))/2,ie=U*U+Pe,ue=Math.sqrt(Math.abs(ie)),E.set(k,k,E.get(k,k)+F),E.set(k-1,k-1,E.get(k-1,k-1)+F),De=E.get(k,k),ie>=0){for(ue=U>=0?U+ue:U-ue,x[k-1]=De+ue,x[k]=x[k-1],ue!==0&&(x[k]=De-Pe/ue),_[k-1]=0,_[k]=0,De=E.get(k,k-1),te=Math.abs(De)+Math.abs(ue),U=De/te,ie=ue/te,me=Math.sqrt(U*U+ie*ie),U=U/me,ie=ie/me,ye=k-1;ye<L;ye++)ue=E.get(k-1,ye),E.set(k-1,ye,ie*ue+U*E.get(k,ye)),E.set(k,ye,ie*E.get(k,ye)-U*ue);for(H=0;H<=k;H++)ue=E.get(H,k-1),E.set(H,k-1,ie*ue+U*E.get(H,k)),E.set(H,k,ie*E.get(H,k)-U*ue);for(H=I;H<=R;H++)ue=b.get(H,k-1),b.set(H,k-1,ie*ue+U*b.get(H,k)),b.set(H,k,ie*b.get(H,k)-U*ue)}else x[k-1]=De+U,x[k]=De+U,_[k-1]=ue,_[k]=-ue;k=k-2,Se=0}else{if(De=E.get(k,k),ct=0,Pe=0,Re<k&&(ct=E.get(k-1,k-1),Pe=E.get(k,k-1)*E.get(k-1,k)),Se===10){for(F+=De,H=I;H<=k;H++)E.set(H,H,E.get(H,H)-De);te=Math.abs(E.get(k,k-1))+Math.abs(E.get(k-1,k-2)),De=ct=.75*te,Pe=-.4375*te*te}if(Se===30&&(te=(ct-De)/2,te=te*te+Pe,te>0)){for(te=Math.sqrt(te),ct<De&&(te=-te),te=De-Pe/((ct-De)/2+te),H=I;H<=k;H++)E.set(H,H,E.get(H,H)-te);F+=te,De=ct=Pe=.964}for(Se=Se+1,Fe=k-2;Fe>=Re&&(ue=E.get(Fe,Fe),me=De-ue,te=ct-ue,U=(me*te-Pe)/E.get(Fe+1,Fe)+E.get(Fe,Fe+1),ie=E.get(Fe+1,Fe+1)-ue-me-te,me=E.get(Fe+2,Fe+1),te=Math.abs(U)+Math.abs(ie)+Math.abs(me),U=U/te,ie=ie/te,me=me/te,!(Fe===Re||Math.abs(E.get(Fe,Fe-1))*(Math.abs(ie)+Math.abs(me))<B*(Math.abs(U)*(Math.abs(E.get(Fe-1,Fe-1))+Math.abs(ue)+Math.abs(E.get(Fe+1,Fe+1))))));)Fe--;for(H=Fe+2;H<=k;H++)E.set(H,H-2,0),H>Fe+2&&E.set(H,H-3,0);for(Ae=Fe;Ae<=k-1&&(kt=Ae!==k-1,Ae!==Fe&&(U=E.get(Ae,Ae-1),ie=E.get(Ae+1,Ae-1),me=kt?E.get(Ae+2,Ae-1):0,De=Math.abs(U)+Math.abs(ie)+Math.abs(me),De!==0&&(U=U/De,ie=ie/De,me=me/De)),De!==0);Ae++)if(te=Math.sqrt(U*U+ie*ie+me*me),U<0&&(te=-te),te!==0){for(Ae!==Fe?E.set(Ae,Ae-1,-te*De):Re!==Fe&&E.set(Ae,Ae-1,-E.get(Ae,Ae-1)),U=U+te,De=U/te,ct=ie/te,ue=me/te,ie=ie/U,me=me/U,ye=Ae;ye<L;ye++)U=E.get(Ae,ye)+ie*E.get(Ae+1,ye),kt&&(U=U+me*E.get(Ae+2,ye),E.set(Ae+2,ye,E.get(Ae+2,ye)-U*ue)),E.set(Ae,ye,E.get(Ae,ye)-U*De),E.set(Ae+1,ye,E.get(Ae+1,ye)-U*ct);for(H=0;H<=Math.min(k,Ae+3);H++)U=De*E.get(H,Ae)+ct*E.get(H,Ae+1),kt&&(U=U+ue*E.get(H,Ae+2),E.set(H,Ae+2,E.get(H,Ae+2)-U*me)),E.set(H,Ae,E.get(H,Ae)-U),E.set(H,Ae+1,E.get(H,Ae+1)-U*ie);for(H=I;H<=R;H++)U=De*b.get(H,Ae)+ct*b.get(H,Ae+1),kt&&(U=U+ue*b.get(H,Ae+2),b.set(H,Ae+2,b.get(H,Ae+2)-U*me)),b.set(H,Ae,b.get(H,Ae)-U),b.set(H,Ae+1,b.get(H,Ae+1)-U*ie)}}}if(J!==0){for(k=L-1;k>=0;k--)if(U=x[k],ie=_[k],ie===0)for(Re=k,E.set(k,k,1),H=k-1;H>=0;H--){for(Pe=E.get(H,H)-U,me=0,ye=Re;ye<=k;ye++)me=me+E.get(H,ye)*E.get(ye,k);if(_[H]<0)ue=Pe,te=me;else if(Re=H,_[H]===0?E.set(H,k,Pe!==0?-me/Pe:-me/(B*J)):(De=E.get(H,H+1),ct=E.get(H+1,H),ie=(x[H]-U)*(x[H]-U)+_[H]*_[H],At=(De*te-ue*me)/ie,E.set(H,k,At),E.set(H+1,k,Math.abs(De)>Math.abs(ue)?(-me-Pe*At)/De:(-te-ct*At)/ue)),At=Math.abs(E.get(H,k)),B*At*At>1)for(ye=H;ye<=k;ye++)E.set(ye,k,E.get(ye,k)/At)}else if(ie<0)for(Re=k-1,Math.abs(E.get(k,k-1))>Math.abs(E.get(k-1,k))?(E.set(k-1,k-1,ie/E.get(k,k-1)),E.set(k-1,k,-(E.get(k,k)-U)/E.get(k,k-1))):(nt=Tu(0,-E.get(k-1,k),E.get(k-1,k-1)-U,ie),E.set(k-1,k-1,nt[0]),E.set(k-1,k,nt[1])),E.set(k,k-1,0),E.set(k,k,1),H=k-2;H>=0;H--){for(X=0,ge=0,ye=Re;ye<=k;ye++)X=X+E.get(H,ye)*E.get(ye,k-1),ge=ge+E.get(H,ye)*E.get(ye,k);if(Pe=E.get(H,H)-U,_[H]<0)ue=Pe,me=X,te=ge;else if(Re=H,_[H]===0?(nt=Tu(-X,-ge,Pe,ie),E.set(H,k-1,nt[0]),E.set(H,k,nt[1])):(De=E.get(H,H+1),ct=E.get(H+1,H),_e=(x[H]-U)*(x[H]-U)+_[H]*_[H]-ie*ie,pe=(x[H]-U)*2*ie,_e===0&&pe===0&&(_e=B*J*(Math.abs(Pe)+Math.abs(ie)+Math.abs(De)+Math.abs(ct)+Math.abs(ue))),nt=Tu(De*me-ue*X+ie*ge,De*te-ue*ge-ie*X,_e,pe),E.set(H,k-1,nt[0]),E.set(H,k,nt[1]),Math.abs(De)>Math.abs(ue)+Math.abs(ie)?(E.set(H+1,k-1,(-X-Pe*E.get(H,k-1)+ie*E.get(H,k))/De),E.set(H+1,k,(-ge-Pe*E.get(H,k)-ie*E.get(H,k-1))/De)):(nt=Tu(-me-ct*E.get(H,k-1),-te-ct*E.get(H,k),ue,ie),E.set(H+1,k-1,nt[0]),E.set(H+1,k,nt[1]))),At=Math.max(Math.abs(E.get(H,k-1)),Math.abs(E.get(H,k))),B*At*At>1)for(ye=H;ye<=k;ye++)E.set(ye,k-1,E.get(ye,k-1)/At),E.set(ye,k,E.get(ye,k)/At)}for(H=0;H<L;H++)if(H<I||H>R)for(ye=H;ye<L;ye++)b.set(H,ye,E.get(H,ye));for(ye=L-1;ye>=I;ye--)for(H=I;H<=R;H++){for(ue=0,Ae=I;Ae<=Math.min(ye,R);Ae++)ue=ue+b.get(H,Ae)*E.get(Ae,ye);b.set(H,ye,ue)}}}function Tu(L,_,x,b){let E,k;return Math.abs(x)>Math.abs(b)?(E=b/x,k=x+E*b,[(L+E*_)/k,(_-E*L)/k]):(E=x/b,k=b+E*x,[(E*L+_)/k,(E*_-L)/k])}class M1{constructor(_){if(_=bt.checkMatrix(_),!_.isSymmetric())throw new Error("Matrix is not symmetric");let x=_,b=x.rows,E=new W(b,b),k=!0,I,R,B;for(R=0;R<b;R++){let F=0;for(B=0;B<R;B++){let J=0;for(I=0;I<B;I++)J+=E.get(B,I)*E.get(R,I);J=(x.get(R,B)-J)/E.get(B,B),E.set(R,B,J),F=F+J*J}for(F=x.get(R,R)-F,k&&(k=F>0),E.set(R,R,Math.sqrt(Math.max(F,0))),B=R+1;B<b;B++)E.set(R,B,0)}this.L=E,this.positiveDefinite=k}isPositiveDefinite(){return this.positiveDefinite}solve(_){_=bt.checkMatrix(_);let x=this.L,b=x.rows;if(_.rows!==b)throw new Error("Matrix dimensions do not match");if(this.isPositiveDefinite()===!1)throw new Error("Matrix is not positive definite");let E=_.columns,k=_.clone(),I,R,B;for(B=0;B<b;B++)for(R=0;R<E;R++){for(I=0;I<B;I++)k.set(B,R,k.get(B,R)-k.get(I,R)*x.get(B,I));k.set(B,R,k.get(B,R)/x.get(B,B))}for(B=b-1;B>=0;B--)for(R=0;R<E;R++){for(I=B+1;I<b;I++)k.set(B,R,k.get(B,R)-k.get(I,R)*x.get(I,B));k.set(B,R,k.get(B,R)/x.get(B,B))}return k}get lowerTriangularMatrix(){return this.L}}class S1{constructor(_,x={}){_=bt.checkMatrix(_);let{Y:b}=x;const{scaleScores:E=!1,maxIterations:k=1e3,terminationCriteria:I=1e-10}=x;let R;if(b){if(r.isAnyArray(b)&&typeof b[0]=="number"?b=W.columnVector(b):b=bt.checkMatrix(b),b.rows!==_.rows)throw new Error("Y should have the same number of rows as X");R=b.getColumnVector(0)}else R=_.getColumnVector(0);let B=1,F,J,U,ie;for(let me=0;me<k&&B>I;me++)U=_.transpose().mmul(R).div(R.transpose().mmul(R).get(0,0)),U=U.div(U.norm()),F=_.mmul(U).div(U.transpose().mmul(U).get(0,0)),me>0&&(B=F.clone().sub(ie).pow(2).sum()),ie=F.clone(),b?(J=b.transpose().mmul(F).div(F.transpose().mmul(F).get(0,0)),J=J.div(J.norm()),R=b.mmul(J).div(J.transpose().mmul(J).get(0,0))):R=F;if(b){let me=_.transpose().mmul(F).div(F.transpose().mmul(F).get(0,0));me=me.div(me.norm());let te=_.clone().sub(F.clone().mmul(me.transpose())),ue=R.transpose().mmul(F).div(F.transpose().mmul(F).get(0,0)),Se=b.clone().sub(F.clone().mulS(ue.get(0,0)).mmul(J.transpose()));this.t=F,this.p=me.transpose(),this.w=U.transpose(),this.q=J,this.u=R,this.s=F.transpose().mmul(F),this.xResidual=te,this.yResidual=Se,this.betas=ue}else this.w=U.transpose(),this.s=F.transpose().mmul(F).sqrt(),E?this.t=F.clone().div(this.s.get(0,0)):this.t=F,this.xResidual=_.sub(F.mmul(U.transpose()))}}return Ke.AbstractMatrix=oe,Ke.CHO=M1,Ke.CholeskyDecomposition=M1,Ke.DistanceMatrix=le,Ke.EVD=Xr,Ke.EigenvalueDecomposition=Xr,Ke.LU=mr,Ke.LuDecomposition=mr,Ke.Matrix=W,Ke.MatrixColumnSelectionView=Ve,Ke.MatrixColumnView=Ce,Ke.MatrixFlipColumnView=Tt,Ke.MatrixFlipRowView=dn,Ke.MatrixRowSelectionView=Ut,Ke.MatrixRowView=Ot,Ke.MatrixSelectionView=Xe,Ke.MatrixSubView=vr,Ke.MatrixTransposeView=Qe,Ke.NIPALS=S1,Ke.Nipals=S1,Ke.QR=Lt,Ke.QrDecomposition=Lt,Ke.SVD=Vn,Ke.SingularValueDecomposition=Vn,Ke.SymmetricMatrix=ee,Ke.WrapperMatrix1D=yr,Ke.WrapperMatrix2D=bt,Ke.correlation=Hr,Ke.covariance=_u,Ke.default=W,Ke.determinant=pi,Ke.inverse=Yn,Ke.linearDependencies=os,Ke.pseudoInverse=Kd,Ke.solve=br,Ke.wrap=as,Ke}var sd=N8();const Yw=tu(sd),ea=sd.Matrix,ZA=sd.SingularValueDecomposition;Yw.Matrix?Yw.Matrix:sd.Matrix;const C8={center:[0,0],linkDistance:50};class QA{constructor(e={}){this.options=e,this.id="mds",this.options=Object.assign(Object.assign({},C8),e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericMDSLayout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericMDSLayout(!0,e,t)})}genericMDSLayout(e,t,n){return Ye(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{center:a=[0,0],linkDistance:s=50}=i,o=t.getAllNodes(),u=t.getAllEdges();if(!(o!=null&&o.length)||o.length===1)return ns(t,e,a);const l=YA({nodes:o,edges:u}),c=VA(l);P8(c);const d=Ez(c,s),h=L8(d),f=[];return h.forEach((v,p)=>{const y=cr(o[p]);y.data.x=v[0]+a[0],y.data.y=v[1]+a[1],f.push(y)}),e&&f.forEach(v=>t.mergeNodeData(v.id,{x:v.data.x,y:v.data.y})),{nodes:f,edges:u}})}}const P8=r=>{let e=-999999;r.forEach(t=>{t.forEach(n=>{n!==1/0&&e<n&&(e=n)})}),r.forEach((t,n)=>{t.forEach((i,a)=>{i===1/0&&(r[n][a]=e)})})},L8=r=>{const t=ea.mul(ea.pow(r,2),-.5),n=t.mean("row"),i=t.mean("column"),a=t.mean();t.add(a).subRowVector(n).subColumnVector(i);const s=new ZA(t),o=ea.sqrt(s.diagonalMatrix).diagonal();return s.leftSingularVectors.toJSON().map(u=>ea.mul([u],[o]).toJSON()[0].splice(0,2))};function Ly(r){return!!r.tick&&!!r.stop}const D8={gForce:!0,force2:!0,d3force:!0,fruchterman:!0,forceAtlas2:!0,force:!0,"graphin-force":!0},I8={center:[0,0],comboPadding:10,treeKey:"combo"};class R8{constructor(e={}){this.options=e,this.id="comboCombined",this.options=Object.assign(Object.assign({},I8),e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericComboCombinedLayout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericComboCombinedLayout(!0,e,t)})}genericComboCombinedLayout(e,t,n){return Ye(this,void 0,void 0,function*(){const i=this.initVals(Object.assign(Object.assign({},this.options),n)),{center:a,treeKey:s,outerLayout:o}=i,u=t.getAllNodes().filter(O=>!O.data._isCombo),l=t.getAllNodes().filter(O=>O.data._isCombo),c=t.getAllEdges(),d=u==null?void 0:u.length;if(!d||d===1)return ns(t,e,a);const h=[],f=new Map;u.forEach(O=>{f.set(O.id,O)});const g=new Map;l.forEach(O=>{g.set(O.id,O)});const v=new Map,p=this.getInnerGraphs(t,s,f,g,c,i,v);yield Promise.all(p);const y=new Map,m=[],w=new Map;let M=!0;t.getRoots(s).forEach(O=>{const N=v.get(O.id),C=g.get(O.id)||f.get(O.id),P={id:O.id,data:Object.assign(Object.assign({},O.data),{x:N.data.x||C.data.x,y:N.data.y||C.data.y,fx:N.data.fx||C.data.fx,fy:N.data.fy||C.data.fy,mass:N.data.mass||C.data.mass,size:N.data.size})};m.push(P),y.set(O.id,!0),!isNaN(P.data.x)&&P.data.x!==0&&!isNaN(P.data.y)&&P.data.y!==0?M=!1:(P.data.x=Math.random()*100,P.data.y=Math.random()*100),ky(t,[O],D=>{D.id!==O.id&&w.set(D.id,O.id)},"TB",s)});const S=[];c.forEach(O=>{const N=w.get(O.source)||O.source,C=w.get(O.target)||O.target;N!==C&&y.has(N)&&y.has(C)&&S.push({id:O.id,source:N,target:C,data:{}})});let T;if(m!=null&&m.length){if(m.length===1)m[0].data.x=a[0],m[0].data.y=a[1];else{const O=new cn({nodes:m,edges:S}),N=o||new KA;M&&D8[N.id]&&(yield(m.length<100?new QA:new Cy).assign(O));const C=Object.assign({center:a,kg:5,preventOverlap:!0,animate:!1},N.id==="force"?{gravity:1,factor:4,linkDistance:(P,D,j)=>{const G=Math.max(...D.data.size)||32,V=Math.max(...j.data.size)||32;return G/2+V/2+200}}:{});T=yield Uw(N,O,C)}v.forEach(O=>{var N;const C=T.nodes.find(j=>j.id===O.id);if(C){const{x:j,y:G}=C.data;O.data.visited=!0,O.data.x=j,O.data.y=G,h.push({id:O.id,data:{x:j,y:G}})}const{x:P,y:D}=O.data;(N=O.data.nodes)===null||N===void 0||N.forEach(j=>{h.push({id:j.id,data:{x:j.data.x+P,y:j.data.y+D}})})}),v.forEach(({data:O})=>{const{x:N,y:C,visited:P,nodes:D}=O;D==null||D.forEach(j=>{if(!P){const G=h.find(V=>V.id===j.id);G.data.x+=N||0,G.data.y+=C||0}})})}return e&&h.forEach(O=>{t.mergeNodeData(O.id,{x:O.data.x,y:O.data.y})}),{nodes:h,edges:c}})}initVals(e){const t=Object.assign({},e),{nodeSize:n,spacing:i,comboPadding:a}=e;let s,o;if(Ee(i)?o=()=>i:Te(i)?o=i:o=()=>0,t.spacing=o,!n)s=l=>{const c=o(l);return l.size?Ei(l.size)?((l.size[0]>l.size[1]?l.size[0]:l.size[1])+c)/2:Yt(l.size)?((l.size.width>l.size.height?l.size.width:l.size.height)+c)/2:(l.size+c)/2:32+c/2};else if(Te(n))s=l=>{const c=n(l),d=o(l);return Ei(l.size)?((l.size[0]>l.size[1]?l.size[0]:l.size[1])+d)/2:((c||32)+d)/2};else if(Ei(n)){const c=(n[0]>n[1]?n[0]:n[1])/2;s=d=>c+o(d)/2}else{const l=n/2;s=c=>l+o(c)/2}t.nodeSize=s;let u;return Ee(a)?u=()=>a:Ei(a)?u=()=>Math.max.apply(null,a):Te(a)?u=a:u=()=>0,t.comboPadding=u,t}getInnerGraphs(e,t,n,i,a,s,o){const{nodeSize:u,comboPadding:l,spacing:c,innerLayout:d}=s,h=d||new Cy({}),f={center:[0,0],preventOverlap:!0,nodeSpacing:c},g=[],v=p=>{let y=(l==null?void 0:l(p))||10;return Ei(y)&&(y=Math.max(...y)),{size:y?[y*2,y*2]:[30,30],padding:y}};return e.getRoots(t).forEach(p=>{o.set(p.id,{id:p.id,data:{nodes:[],size:v(p).size}});let y=Promise.resolve();ky(e,[p],m=>{var w;if(!m.data._isCombo)return;const{size:M,padding:S}=v(m);if(!(!((w=e.getChildren(m.id,t))===null||w===void 0)&&w.length))o.set(m.id,{id:m.id,data:Object.assign(Object.assign({},m.data),{size:M})});else{const T=o.get(m.id);o.set(m.id,{id:m.id,data:Object.assign({nodes:[]},T==null?void 0:T.data)});const A=new Map,O=e.getChildren(m.id,t).map(P=>{if(P.data._isCombo)return o.has(P.id)||o.set(P.id,{id:P.id,data:Object.assign({},P.data)}),A.set(P.id,!0),o.get(P.id);const D=n.get(P.id)||i.get(P.id);return A.set(P.id,!0),{id:P.id,data:Object.assign(Object.assign({},D.data),P.data)}}),N={nodes:O,edges:a.filter(P=>A.has(P.source)&&A.has(P.target))};let C=1/0;O.forEach(P=>{var D;let{size:j}=P.data;j||(j=((D=o.get(P.id))===null||D===void 0?void 0:D.data.size)||(u==null?void 0:u(P))||[30,30]),Ee(j)&&(j=[j,j]);const[G,V]=j;C>G&&(C=G),C>V&&(C=V),P.data.size=j}),y=y.then(()=>Ye(this,void 0,void 0,function*(){const P=new cn(N);yield Uw(h,P,f,!0);const{minX:D,minY:j,maxX:G,maxY:V}=Mz(O),Y={x:(G+D)/2,y:(V+j)/2};N.nodes.forEach(z=>{z.data.x-=Y.x,z.data.y-=Y.y});const $=[Math.max(G-D,C)+S*2,Math.max(V-j,C)+S*2];o.get(m.id).data.size=$,o.get(m.id).data.nodes=O}))}return!0},"BT",t),g.push(y)}),g}}function Uw(r,e,t,n){var i;return Ye(this,void 0,void 0,function*(){return Ly(r)?(r.execute(e,t),r.stop(),r.tick((i=t.iterations)!==null&&i!==void 0?i:300)):n?yield r.assign(e,t):yield r.execute(e,t)})}function j8(r,e){var t,n=1;r==null&&(r=0),e==null&&(e=0);function i(){var a,s=t.length,o,u=0,l=0;for(a=0;a<s;++a)o=t[a],u+=o.x,l+=o.y;for(u=(u/s-r)*n,l=(l/s-e)*n,a=0;a<s;++a)o=t[a],o.x-=u,o.y-=l}return i.initialize=function(a){t=a},i.x=function(a){return arguments.length?(r=+a,i):r},i.y=function(a){return arguments.length?(e=+a,i):e},i.strength=function(a){return arguments.length?(n=+a,i):n},i}function un(r){return function(){return r}}function ta(r){return(r()-.5)*1e-6}function B8(r){return r.x+r.vx}function F8(r){return r.y+r.vy}function z8(r){var e,t,n,i=1,a=1;typeof r!="function"&&(r=un(r==null?1:+r));function s(){for(var l,c=e.length,d,h,f,g,v,p,y=0;y<a;++y)for(d=ad(e,B8,F8).visitAfter(o),l=0;l<c;++l)h=e[l],v=t[h.index],p=v*v,f=h.x+h.vx,g=h.y+h.vy,d.visit(m);function m(w,M,S,T,A){var O=w.data,N=w.r,C=v+N;if(O){if(O.index>h.index){var P=f-O.x-O.vx,D=g-O.y-O.vy,j=P*P+D*D;j<C*C&&(P===0&&(P=ta(n),j+=P*P),D===0&&(D=ta(n),j+=D*D),j=(C-(j=Math.sqrt(j)))/j*i,h.vx+=(P*=j)*(C=(N*=N)/(p+N)),h.vy+=(D*=j)*C,O.vx-=P*(C=1-C),O.vy-=D*C)}return}return M>f+C||T<f-C||S>g+C||A<g-C}}function o(l){if(l.data)return l.r=t[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(e){var l,c=e.length,d;for(t=new Array(c),l=0;l<c;++l)d=e[l],t[d.index]=+r(d,l,e)}}return s.initialize=function(l,c){e=l,n=c,u()},s.iterations=function(l){return arguments.length?(a=+l,s):a},s.strength=function(l){return arguments.length?(i=+l,s):i},s.radius=function(l){return arguments.length?(r=typeof l=="function"?l:un(+l),u(),s):r},s}function $8(r){return r.index}function Hw(r,e){var t=r.get(e);if(!t)throw new Error("node not found: "+e);return t}function q8(r){var e=$8,t=d,n,i=un(30),a,s,o,u,l,c=1;r==null&&(r=[]);function d(p){return 1/Math.min(o[p.source.index],o[p.target.index])}function h(p){for(var y=0,m=r.length;y<c;++y)for(var w=0,M,S,T,A,O,N,C;w<m;++w)M=r[w],S=M.source,T=M.target,A=T.x+T.vx-S.x-S.vx||ta(l),O=T.y+T.vy-S.y-S.vy||ta(l),N=Math.sqrt(A*A+O*O),N=(N-a[w])/N*p*n[w],A*=N,O*=N,T.vx-=A*(C=u[w]),T.vy-=O*C,S.vx+=A*(C=1-C),S.vy+=O*C}function f(){if(s){var p,y=s.length,m=r.length,w=new Map(s.map((S,T)=>[e(S,T,s),S])),M;for(p=0,o=new Array(y);p<m;++p)M=r[p],M.index=p,typeof M.source!="object"&&(M.source=Hw(w,M.source)),typeof M.target!="object"&&(M.target=Hw(w,M.target)),o[M.source.index]=(o[M.source.index]||0)+1,o[M.target.index]=(o[M.target.index]||0)+1;for(p=0,u=new Array(m);p<m;++p)M=r[p],u[p]=o[M.source.index]/(o[M.source.index]+o[M.target.index]);n=new Array(m),g(),a=new Array(m),v()}}function g(){if(s)for(var p=0,y=r.length;p<y;++p)n[p]=+t(r[p],p,r)}function v(){if(s)for(var p=0,y=r.length;p<y;++p)a[p]=+i(r[p],p,r)}return h.initialize=function(p,y){s=p,l=y,f()},h.links=function(p){return arguments.length?(r=p,f(),h):r},h.id=function(p){return arguments.length?(e=p,h):e},h.iterations=function(p){return arguments.length?(c=+p,h):c},h.strength=function(p){return arguments.length?(t=typeof p=="function"?p:un(+p),g(),h):t},h.distance=function(p){return arguments.length?(i=typeof p=="function"?p:un(+p),v(),h):i},h}var G8={value:()=>{}};function JA(){for(var r=0,e=arguments.length,t={},n;r<e;++r){if(!(n=arguments[r]+"")||n in t||/[\s.]/.test(n))throw new Error("illegal type: "+n);t[n]=[]}return new Ll(t)}function Ll(r){this._=r}function W8(r,e){return r.trim().split(/^|\s+/).map(function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}Ll.prototype=JA.prototype={constructor:Ll,on:function(r,e){var t=this._,n=W8(r+"",t),i,a=-1,s=n.length;if(arguments.length<2){for(;++a<s;)if((i=(r=n[a]).type)&&(i=V8(t[i],r.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<s;)if(i=(r=n[a]).type)t[i]=Xw(t[i],r.name,e);else if(e==null)for(i in t)t[i]=Xw(t[i],r.name,null);return this},copy:function(){var r={},e=this._;for(var t in e)r[t]=e[t].slice();return new Ll(r)},call:function(r,e){if((i=arguments.length-2)>0)for(var t=new Array(i),n=0,i,a;n<i;++n)t[n]=arguments[n+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(a=this._[r],n=0,i=a.length;n<i;++n)a[n].value.apply(e,t)},apply:function(r,e,t){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var n=this._[r],i=0,a=n.length;i<a;++i)n[i].value.apply(e,t)}};function V8(r,e){for(var t=0,n=r.length,i;t<n;++t)if((i=r[t]).name===e)return i.value}function Xw(r,e,t){for(var n=0,i=r.length;n<i;++n)if(r[n].name===e){r[n]=G8,r=r.slice(0,n).concat(r.slice(n+1));break}return t!=null&&r.push({name:e,value:t}),r}var $s=0,yo=0,so=0,ek=1e3,hc,mo,fc=0,Ha=0,od=0,Ho=typeof performance=="object"&&performance.now?performance:Date,tk=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(r){setTimeout(r,17)};function nk(){return Ha||(tk(Y8),Ha=Ho.now()+od)}function Y8(){Ha=0}function Dy(){this._call=this._time=this._next=null}Dy.prototype=rk.prototype={constructor:Dy,restart:function(r,e,t){if(typeof r!="function")throw new TypeError("callback is not a function");t=(t==null?nk():+t)+(e==null?0:+e),!this._next&&mo!==this&&(mo?mo._next=this:hc=this,mo=this),this._call=r,this._time=t,Iy()},stop:function(){this._call&&(this._call=null,this._time=1/0,Iy())}};function rk(r,e,t){var n=new Dy;return n.restart(r,e,t),n}function U8(){nk(),++$s;for(var r=hc,e;r;)(e=Ha-r._time)>=0&&r._call.call(void 0,e),r=r._next;--$s}function Kw(){Ha=(fc=Ho.now())+od,$s=yo=0;try{U8()}finally{$s=0,X8(),Ha=0}}function H8(){var r=Ho.now(),e=r-fc;e>ek&&(od-=e,fc=r)}function X8(){for(var r,e=hc,t,n=1/0;e;)e._call?(n>e._time&&(n=e._time),r=e,e=e._next):(t=e._next,e._next=null,e=r?r._next=t:hc=t);mo=r,Iy(n)}function Iy(r){if(!$s){yo&&(yo=clearTimeout(yo));var e=r-Ha;e>24?(r<1/0&&(yo=setTimeout(Kw,r-Ho.now()-od)),so&&(so=clearInterval(so))):(so||(fc=Ho.now(),so=setInterval(H8,ek)),$s=1,tk(Kw))}}const K8=1664525,Z8=1013904223,Zw=4294967296;function Q8(){let r=1;return()=>(r=(K8*r+Z8)%Zw)/Zw}function J8(r){return r.x}function e9(r){return r.y}var t9=10,n9=Math.PI*(3-Math.sqrt(5));function r9(r){var e,t=1,n=.001,i=1-Math.pow(n,1/300),a=0,s=.6,o=new Map,u=rk(d),l=JA("tick","end"),c=Q8();r==null&&(r=[]);function d(){h(),l.call("tick",e),t<n&&(u.stop(),l.call("end",e))}function h(v){var p,y=r.length,m;v===void 0&&(v=1);for(var w=0;w<v;++w)for(t+=(a-t)*i,o.forEach(function(M){M(t)}),p=0;p<y;++p)m=r[p],m.fx==null?m.x+=m.vx*=s:(m.x=m.fx,m.vx=0),m.fy==null?m.y+=m.vy*=s:(m.y=m.fy,m.vy=0);return e}function f(){for(var v=0,p=r.length,y;v<p;++v){if(y=r[v],y.index=v,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var m=t9*Math.sqrt(.5+v),w=v*n9;y.x=m*Math.cos(w),y.y=m*Math.sin(w)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function g(v){return v.initialize&&v.initialize(r,c),v}return f(),e={tick:h,restart:function(){return u.restart(d),e},stop:function(){return u.stop(),e},nodes:function(v){return arguments.length?(r=v,f(),o.forEach(g),e):r},alpha:function(v){return arguments.length?(t=+v,e):t},alphaMin:function(v){return arguments.length?(n=+v,e):n},alphaDecay:function(v){return arguments.length?(i=+v,e):+i},alphaTarget:function(v){return arguments.length?(a=+v,e):a},velocityDecay:function(v){return arguments.length?(s=1-v,e):1-s},randomSource:function(v){return arguments.length?(c=v,o.forEach(g),e):c},force:function(v,p){return arguments.length>1?(p==null?o.delete(v):o.set(v,g(p)),e):o.get(v)},find:function(v,p,y){var m=0,w=r.length,M,S,T,A,O;for(y==null?y=1/0:y*=y,m=0;m<w;++m)A=r[m],M=v-A.x,S=p-A.y,T=M*M+S*S,T<y&&(O=A,y=T);return O},on:function(v,p){return arguments.length>1?(l.on(v,p),e):l.on(v)}}}function i9(){var r,e,t,n,i=un(-30),a,s=1,o=1/0,u=.81;function l(f){var g,v=r.length,p=ad(r,J8,e9).visitAfter(d);for(n=f,g=0;g<v;++g)e=r[g],p.visit(h)}function c(){if(r){var f,g=r.length,v;for(a=new Array(g),f=0;f<g;++f)v=r[f],a[v.index]=+i(v,f,r)}}function d(f){var g=0,v,p,y=0,m,w,M;if(f.length){for(m=w=M=0;M<4;++M)(v=f[M])&&(p=Math.abs(v.value))&&(g+=v.value,y+=p,m+=p*v.x,w+=p*v.y);f.x=m/y,f.y=w/y}else{v=f,v.x=v.data.x,v.y=v.data.y;do g+=a[v.data.index];while(v=v.next)}f.value=g}function h(f,g,v,p){if(!f.value)return!0;var y=f.x-e.x,m=f.y-e.y,w=p-g,M=y*y+m*m;if(w*w/u<M)return M<o&&(y===0&&(y=ta(t),M+=y*y),m===0&&(m=ta(t),M+=m*m),M<s&&(M=Math.sqrt(s*M)),e.vx+=y*f.value*n/M,e.vy+=m*f.value*n/M),!0;if(f.length||M>=o)return;(f.data!==e||f.next)&&(y===0&&(y=ta(t),M+=y*y),m===0&&(m=ta(t),M+=m*m),M<s&&(M=Math.sqrt(s*M)));do f.data!==e&&(w=a[f.data.index]*n/M,e.vx+=y*w,e.vy+=m*w);while(f=f.next)}return l.initialize=function(f,g){r=f,t=g,c()},l.strength=function(f){return arguments.length?(i=typeof f=="function"?f:un(+f),c(),l):i},l.distanceMin=function(f){return arguments.length?(s=f*f,l):Math.sqrt(s)},l.distanceMax=function(f){return arguments.length?(o=f*f,l):Math.sqrt(o)},l.theta=function(f){return arguments.length?(u=f*f,l):Math.sqrt(u)},l}function a9(r,e,t){var n,i=un(.1),a,s;typeof r!="function"&&(r=un(+r)),e==null&&(e=0),t==null&&(t=0);function o(l){for(var c=0,d=n.length;c<d;++c){var h=n[c],f=h.x-e||1e-6,g=h.y-t||1e-6,v=Math.sqrt(f*f+g*g),p=(s[c]-v)*a[c]*l/v;h.vx+=f*p,h.vy+=g*p}}function u(){if(n){var l,c=n.length;for(a=new Array(c),s=new Array(c),l=0;l<c;++l)s[l]=+r(n[l],l,n),a[l]=isNaN(s[l])?0:+i(n[l],l,n)}}return o.initialize=function(l){n=l,u()},o.strength=function(l){return arguments.length?(i=typeof l=="function"?l:un(+l),u(),o):i},o.radius=function(l){return arguments.length?(r=typeof l=="function"?l:un(+l),u(),o):r},o.x=function(l){return arguments.length?(e=+l,o):e},o.y=function(l){return arguments.length?(t=+l,o):t},o}function s9(r){var e=un(.1),t,n,i;typeof r!="function"&&(r=un(r==null?0:+r));function a(o){for(var u=0,l=t.length,c;u<l;++u)c=t[u],c.vx+=(i[u]-c.x)*n[u]*o}function s(){if(t){var o,u=t.length;for(n=new Array(u),i=new Array(u),o=0;o<u;++o)n[o]=isNaN(i[o]=+r(t[o],o,t))?0:+e(t[o],o,t)}}return a.initialize=function(o){t=o,s()},a.strength=function(o){return arguments.length?(e=typeof o=="function"?o:un(+o),s(),a):e},a.x=function(o){return arguments.length?(r=typeof o=="function"?o:un(+o),s(),a):r},a}function o9(r){var e=un(.1),t,n,i;typeof r!="function"&&(r=un(r==null?0:+r));function a(o){for(var u=0,l=t.length,c;u<l;++u)c=t[u],c.vy+=(i[u]-c.y)*n[u]*o}function s(){if(t){var o,u=t.length;for(n=new Array(u),i=new Array(u),o=0;o<u;++o)n[o]=isNaN(i[o]=+r(t[o],o,t))?0:+e(t[o],o,t)}}return a.initialize=function(o){t=o,s()},a.strength=function(o){return arguments.length?(e=typeof o=="function"?o:un(+o),s(),a):e},a.y=function(o){return arguments.length?(r=typeof o=="function"?o:un(+o),s(),a):r},a}class u9{constructor(e){this.id="d3-force",this.config={inputNodeAttrs:["x","y","vx","vy","fx","fy"],outputNodeAttrs:["x","y","vx","vy"],simulationAttrs:["alpha","alphaMin","alphaDecay","alphaTarget","velocityDecay","randomSource"]},this.forceMap={link:q8,manyBody:i9,center:j8,collide:z8,radial:a9,x:s9,y:o9},this.options={link:{id:t=>t.id},manyBody:{},center:{x:0,y:0}},this.context={options:{},assign:!1,nodes:[],edges:[]},Gn(this.options,e),this.options.forceSimulation&&(this.simulation=this.options.forceSimulation)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericLayout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericLayout(!0,e,t)})}stop(){this.simulation.stop()}tick(e){return this.simulation.tick(e),this.getResult()}restart(){this.simulation.restart()}setFixedPosition(e,t){const n=this.context.nodes.find(i=>i.id===e);n&&t.forEach((i,a)=>{if(typeof i=="number"||i===null){const s=["fx","fy","fz"][a];n[s]=i}})}getOptions(e){var t,n;const i=Gn({},this.options,e);return i.collide&&((t=i.collide)===null||t===void 0?void 0:t.radius)===void 0&&(i.collide=i.collide||{},i.collide.radius=(n=i.nodeSize)!==null&&n!==void 0?n:10),i.iterations===void 0&&(i.link&&i.link.iterations===void 0&&(i.iterations=i.link.iterations),i.collide&&i.collide.iterations===void 0&&(i.iterations=i.collide.iterations)),this.context.options=i,i}genericLayout(e,t,n){var i;return Ye(this,void 0,void 0,function*(){const a=this.getOptions(n),s=t.getAllNodes().map(({id:c,data:d})=>Object.assign(Object.assign({id:c},d),$a(d.data,this.config.inputNodeAttrs))),o=t.getAllEdges().map(c=>Object.assign({},c));Object.assign(this.context,{assign:e,nodes:s,edges:o,graph:t});const u=new Promise(c=>{this.resolver=c}),l=this.setSimulation(a);return l.nodes(s),(i=l.force("link"))===null||i===void 0||i.links(o),u})}getResult(){const{assign:e,nodes:t,edges:n,graph:i}=this.context,a=t.map(o=>({id:o.id,data:Object.assign(Object.assign({},o.data),$a(o,this.config.outputNodeAttrs))})),s=n.map(({id:o,source:u,target:l,data:c})=>({id:o,source:typeof u=="object"?u.id:u,target:typeof l=="object"?l.id:l,data:c}));return e&&a.forEach(o=>i.mergeNodeData(o.id,o.data)),{nodes:a,edges:s}}initSimulation(){return r9()}setSimulation(e){const t=this.simulation||this.options.forceSimulation||this.initSimulation();return this.simulation||(this.simulation=t.on("tick",()=>{var n;return(n=e.onTick)===null||n===void 0?void 0:n.call(e,this.getResult())}).on("end",()=>{var n;return(n=this.resolver)===null||n===void 0?void 0:n.call(this,this.getResult())})),Qw(t,this.config.simulationAttrs.map(n=>[n,e[n]])),Object.entries(this.forceMap).forEach(([n,i])=>{const a=n;if(e[n]){let s=t.force(a);s||(s=i(),t.force(a,s)),Qw(s,Object.entries(e[a]))}else t.force(a,null)}),t}}const Qw=(r,e)=>e.reduce((t,[n,i])=>!t[n]||i===void 0?t:t[n].call(r,i),r);var rf,Jw;function l9(){if(Jw)return rf;Jw=1;var r=Jy();function e(){this.__data__=new r,this.size=0}return rf=e,rf}var af,ex;function c9(){if(ex)return af;ex=1;function r(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}return af=r,af}var sf,tx;function d9(){if(tx)return sf;tx=1;function r(e){return this.__data__.get(e)}return sf=r,sf}var of,nx;function h9(){if(nx)return of;nx=1;function r(e){return this.__data__.has(e)}return of=r,of}var uf,rx;function f9(){if(rx)return uf;rx=1;var r=Jy(),e=U_(),t=H_(),n=200;function i(a,s){var o=this.__data__;if(o instanceof r){var u=o.__data__;if(!e||u.length<n-1)return u.push([a,s]),this.size=++o.size,this;o=this.__data__=new t(u)}return o.set(a,s),this.size=o.size,this}return uf=i,uf}var lf,ix;function ud(){if(ix)return lf;ix=1;var r=Jy(),e=l9(),t=c9(),n=d9(),i=h9(),a=f9();function s(o){var u=this.__data__=new r(o);this.size=u.size}return s.prototype.clear=e,s.prototype.delete=t,s.prototype.get=n,s.prototype.has=i,s.prototype.set=a,lf=s,lf}var cf,ax;function Wm(){if(ax)return cf;ax=1;function r(e,t){for(var n=-1,i=e==null?0:e.length;++n<i&&t(e[n],n,e)!==!1;);return e}return cf=r,cf}var df,sx;function ik(){if(sx)return df;sx=1;var r=ru(),e=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch{}}();return df=e,df}var hf,ox;function ld(){if(ox)return hf;ox=1;var r=ik();function e(t,n,i){n=="__proto__"&&r?r(t,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[n]=i}return hf=e,hf}var ff,ux;function cd(){if(ux)return ff;ux=1;var r=ld(),e=iu(),t=Object.prototype,n=t.hasOwnProperty;function i(a,s,o){var u=a[s];(!(n.call(a,s)&&e(u,o))||o===void 0&&!(s in a))&&r(a,s,o)}return ff=i,ff}var gf,lx;function wu(){if(lx)return gf;lx=1;var r=cd(),e=ld();function t(n,i,a,s){var o=!a;a||(a={});for(var u=-1,l=i.length;++u<l;){var c=i[u],d=s?s(a[c],n[c],c,a,n):void 0;d===void 0&&(d=n[c]),o?e(a,c,d):r(a,c,d)}return a}return gf=t,gf}var pf,cx;function g9(){if(cx)return pf;cx=1;function r(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}return pf=r,pf}var vf,dx;function p9(){if(dx)return vf;dx=1;var r=au(),e=Li(),t="[object Arguments]";function n(i){return e(i)&&r(i)==t}return vf=n,vf}var yf,hx;function xu(){if(hx)return yf;hx=1;var r=p9(),e=Li(),t=Object.prototype,n=t.hasOwnProperty,i=t.propertyIsEnumerable,a=r(function(){return arguments}())?r:function(s){return e(s)&&n.call(s,"callee")&&!i.call(s,"callee")};return yf=a,yf}var bo={exports:{}},mf,fx;function v9(){if(fx)return mf;fx=1;function r(){return!1}return mf=r,mf}bo.exports;var gx;function Hs(){return gx||(gx=1,function(r,e){var t=Ka(),n=v9(),i=e&&!e.nodeType&&e,a=i&&!0&&r&&!r.nodeType&&r,s=a&&a.exports===i,o=s?t.Buffer:void 0,u=o?o.isBuffer:void 0,l=u||n;r.exports=l}(bo,bo.exports)),bo.exports}var bf,px;function dd(){if(px)return bf;px=1;var r=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function t(n,i){var a=typeof n;return i=i??r,!!i&&(a=="number"||a!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<i}return bf=t,bf}var wf,vx;function Vm(){if(vx)return wf;vx=1;var r=9007199254740991;function e(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=r}return wf=e,wf}var xf,yx;function y9(){if(yx)return xf;yx=1;var r=au(),e=Vm(),t=Li(),n="[object Arguments]",i="[object Array]",a="[object Boolean]",s="[object Date]",o="[object Error]",u="[object Function]",l="[object Map]",c="[object Number]",d="[object Object]",h="[object RegExp]",f="[object Set]",g="[object String]",v="[object WeakMap]",p="[object ArrayBuffer]",y="[object DataView]",m="[object Float32Array]",w="[object Float64Array]",M="[object Int8Array]",S="[object Int16Array]",T="[object Int32Array]",A="[object Uint8Array]",O="[object Uint8ClampedArray]",N="[object Uint16Array]",C="[object Uint32Array]",P={};P[m]=P[w]=P[M]=P[S]=P[T]=P[A]=P[O]=P[N]=P[C]=!0,P[n]=P[i]=P[p]=P[a]=P[y]=P[s]=P[o]=P[u]=P[l]=P[c]=P[d]=P[h]=P[f]=P[g]=P[v]=!1;function D(j){return t(j)&&e(j.length)&&!!P[r(j)]}return xf=D,xf}var Ef,mx;function hd(){if(mx)return Ef;mx=1;function r(e){return function(t){return e(t)}}return Ef=r,Ef}var wo={exports:{}};wo.exports;var bx;function Ym(){return bx||(bx=1,function(r,e){var t=YC(),n=e&&!e.nodeType&&e,i=n&&!0&&r&&!r.nodeType&&r,a=i&&i.exports===n,s=a&&t.process,o=function(){try{var u=i&&i.require&&i.require("util").types;return u||s&&s.binding&&s.binding("util")}catch{}}();r.exports=o}(wo,wo.exports)),wo.exports}var Mf,wx;function Eu(){if(wx)return Mf;wx=1;var r=y9(),e=hd(),t=Ym(),n=t&&t.isTypedArray,i=n?e(n):r;return Mf=i,Mf}var Sf,xx;function ak(){if(xx)return Sf;xx=1;var r=g9(),e=xu(),t=Tn(),n=Hs(),i=dd(),a=Eu(),s=Object.prototype,o=s.hasOwnProperty;function u(l,c){var d=t(l),h=!d&&e(l),f=!d&&!h&&n(l),g=!d&&!h&&!f&&a(l),v=d||h||f||g,p=v?r(l.length,String):[],y=p.length;for(var m in l)(c||o.call(l,m))&&!(v&&(m=="length"||f&&(m=="offset"||m=="parent")||g&&(m=="buffer"||m=="byteLength"||m=="byteOffset")||i(m,y)))&&p.push(m);return p}return Sf=u,Sf}var _f,Ex;function fd(){if(Ex)return _f;Ex=1;var r=Object.prototype;function e(t){var n=t&&t.constructor,i=typeof n=="function"&&n.prototype||r;return t===i}return _f=e,_f}var Tf,Mx;function sk(){if(Mx)return Tf;Mx=1;function r(e,t){return function(n){return e(t(n))}}return Tf=r,Tf}var Of,Sx;function m9(){if(Sx)return Of;Sx=1;var r=sk(),e=r(Object.keys,Object);return Of=e,Of}var Af,_x;function Um(){if(_x)return Af;_x=1;var r=fd(),e=m9(),t=Object.prototype,n=t.hasOwnProperty;function i(a){if(!r(a))return e(a);var s=[];for(var o in Object(a))n.call(a,o)&&o!="constructor"&&s.push(o);return s}return Af=i,Af}var kf,Tx;function Ri(){if(Tx)return kf;Tx=1;var r=Mc(),e=Vm();function t(n){return n!=null&&e(n.length)&&!r(n)}return kf=t,kf}var Nf,Ox;function wa(){if(Ox)return Nf;Ox=1;var r=ak(),e=Um(),t=Ri();function n(i){return t(i)?r(i):e(i)}return Nf=n,Nf}var Cf,Ax;function b9(){if(Ax)return Cf;Ax=1;var r=wu(),e=wa();function t(n,i){return n&&r(i,e(i),n)}return Cf=t,Cf}var Pf,kx;function w9(){if(kx)return Pf;kx=1;function r(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}return Pf=r,Pf}var Lf,Nx;function x9(){if(Nx)return Lf;Nx=1;var r=Di(),e=fd(),t=w9(),n=Object.prototype,i=n.hasOwnProperty;function a(s){if(!r(s))return t(s);var o=e(s),u=[];for(var l in s)l=="constructor"&&(o||!i.call(s,l))||u.push(l);return u}return Lf=a,Lf}var Df,Cx;function rs(){if(Cx)return Df;Cx=1;var r=ak(),e=x9(),t=Ri();function n(i){return t(i)?r(i,!0):e(i)}return Df=n,Df}var If,Px;function E9(){if(Px)return If;Px=1;var r=wu(),e=rs();function t(n,i){return n&&r(i,e(i),n)}return If=t,If}var xo={exports:{}};xo.exports;var Lx;function ok(){return Lx||(Lx=1,function(r,e){var t=Ka(),n=e&&!e.nodeType&&e,i=n&&!0&&r&&!r.nodeType&&r,a=i&&i.exports===n,s=a?t.Buffer:void 0,o=s?s.allocUnsafe:void 0;function u(l,c){if(c)return l.slice();var d=l.length,h=o?o(d):new l.constructor(d);return l.copy(h),h}r.exports=u}(xo,xo.exports)),xo.exports}var Rf,Dx;function uk(){if(Dx)return Rf;Dx=1;function r(e,t){var n=-1,i=e.length;for(t||(t=Array(i));++n<i;)t[n]=e[n];return t}return Rf=r,Rf}var jf,Ix;function lk(){if(Ix)return jf;Ix=1;function r(e,t){for(var n=-1,i=e==null?0:e.length,a=0,s=[];++n<i;){var o=e[n];t(o,n,e)&&(s[a++]=o)}return s}return jf=r,jf}var Bf,Rx;function ck(){if(Rx)return Bf;Rx=1;function r(){return[]}return Bf=r,Bf}var Ff,jx;function Hm(){if(jx)return Ff;jx=1;var r=lk(),e=ck(),t=Object.prototype,n=t.propertyIsEnumerable,i=Object.getOwnPropertySymbols,a=i?function(s){return s==null?[]:(s=Object(s),r(i(s),function(o){return n.call(s,o)}))}:e;return Ff=a,Ff}var zf,Bx;function M9(){if(Bx)return zf;Bx=1;var r=wu(),e=Hm();function t(n,i){return r(n,e(n),i)}return zf=t,zf}var $f,Fx;function Xm(){if(Fx)return $f;Fx=1;function r(e,t){for(var n=-1,i=t.length,a=e.length;++n<i;)e[a+n]=t[n];return e}return $f=r,$f}var qf,zx;function gd(){if(zx)return qf;zx=1;var r=sk(),e=r(Object.getPrototypeOf,Object);return qf=e,qf}var Gf,$x;function dk(){if($x)return Gf;$x=1;var r=Xm(),e=gd(),t=Hm(),n=ck(),i=Object.getOwnPropertySymbols,a=i?function(s){for(var o=[];s;)r(o,t(s)),s=e(s);return o}:n;return Gf=a,Gf}var Wf,qx;function S9(){if(qx)return Wf;qx=1;var r=wu(),e=dk();function t(n,i){return r(n,e(n),i)}return Wf=t,Wf}var Vf,Gx;function hk(){if(Gx)return Vf;Gx=1;var r=Xm(),e=Tn();function t(n,i,a){var s=i(n);return e(n)?s:r(s,a(n))}return Vf=t,Vf}var Yf,Wx;function fk(){if(Wx)return Yf;Wx=1;var r=hk(),e=Hm(),t=wa();function n(i){return r(i,t,e)}return Yf=n,Yf}var Uf,Vx;function _9(){if(Vx)return Uf;Vx=1;var r=hk(),e=dk(),t=rs();function n(i){return r(i,t,e)}return Uf=n,Uf}var Hf,Yx;function T9(){if(Yx)return Hf;Yx=1;var r=ru(),e=Ka(),t=r(e,"DataView");return Hf=t,Hf}var Xf,Ux;function O9(){if(Ux)return Xf;Ux=1;var r=ru(),e=Ka(),t=r(e,"Promise");return Xf=t,Xf}var Kf,Hx;function gk(){if(Hx)return Kf;Hx=1;var r=ru(),e=Ka(),t=r(e,"Set");return Kf=t,Kf}var Zf,Xx;function A9(){if(Xx)return Zf;Xx=1;var r=ru(),e=Ka(),t=r(e,"WeakMap");return Zf=t,Zf}var Qf,Kx;function Xs(){if(Kx)return Qf;Kx=1;var r=T9(),e=U_(),t=O9(),n=gk(),i=A9(),a=au(),s=GC(),o="[object Map]",u="[object Object]",l="[object Promise]",c="[object Set]",d="[object WeakMap]",h="[object DataView]",f=s(r),g=s(e),v=s(t),p=s(n),y=s(i),m=a;return(r&&m(new r(new ArrayBuffer(1)))!=h||e&&m(new e)!=o||t&&m(t.resolve())!=l||n&&m(new n)!=c||i&&m(new i)!=d)&&(m=function(w){var M=a(w),S=M==u?w.constructor:void 0,T=S?s(S):"";if(T)switch(T){case f:return h;case g:return o;case v:return l;case p:return c;case y:return d}return M}),Qf=m,Qf}var Jf,Zx;function k9(){if(Zx)return Jf;Zx=1;var r=Object.prototype,e=r.hasOwnProperty;function t(n){var i=n.length,a=new n.constructor(i);return i&&typeof n[0]=="string"&&e.call(n,"index")&&(a.index=n.index,a.input=n.input),a}return Jf=t,Jf}var eg,Qx;function pk(){if(Qx)return eg;Qx=1;var r=Ka(),e=r.Uint8Array;return eg=e,eg}var tg,Jx;function Km(){if(Jx)return tg;Jx=1;var r=pk();function e(t){var n=new t.constructor(t.byteLength);return new r(n).set(new r(t)),n}return tg=e,tg}var ng,eE;function N9(){if(eE)return ng;eE=1;var r=Km();function e(t,n){var i=n?r(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}return ng=e,ng}var rg,tE;function C9(){if(tE)return rg;tE=1;var r=/\w*$/;function e(t){var n=new t.constructor(t.source,r.exec(t));return n.lastIndex=t.lastIndex,n}return rg=e,rg}var ig,nE;function P9(){if(nE)return ig;nE=1;var r=rm(),e=r?r.prototype:void 0,t=e?e.valueOf:void 0;function n(i){return t?Object(t.call(i)):{}}return ig=n,ig}var ag,rE;function vk(){if(rE)return ag;rE=1;var r=Km();function e(t,n){var i=n?r(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}return ag=e,ag}var sg,iE;function L9(){if(iE)return sg;iE=1;var r=Km(),e=N9(),t=C9(),n=P9(),i=vk(),a="[object Boolean]",s="[object Date]",o="[object Map]",u="[object Number]",l="[object RegExp]",c="[object Set]",d="[object String]",h="[object Symbol]",f="[object ArrayBuffer]",g="[object DataView]",v="[object Float32Array]",p="[object Float64Array]",y="[object Int8Array]",m="[object Int16Array]",w="[object Int32Array]",M="[object Uint8Array]",S="[object Uint8ClampedArray]",T="[object Uint16Array]",A="[object Uint32Array]";function O(N,C,P){var D=N.constructor;switch(C){case f:return r(N);case a:case s:return new D(+N);case g:return e(N,P);case v:case p:case y:case m:case w:case M:case S:case T:case A:return i(N,P);case o:return new D;case u:case d:return new D(N);case l:return t(N);case c:return new D;case h:return n(N)}}return sg=O,sg}var og,aE;function yk(){if(aE)return og;aE=1;var r=Di(),e=Object.create,t=function(){function n(){}return function(i){if(!r(i))return{};if(e)return e(i);n.prototype=i;var a=new n;return n.prototype=void 0,a}}();return og=t,og}var ug,sE;function mk(){if(sE)return ug;sE=1;var r=yk(),e=gd(),t=fd();function n(i){return typeof i.constructor=="function"&&!t(i)?r(e(i)):{}}return ug=n,ug}var lg,oE;function D9(){if(oE)return lg;oE=1;var r=Xs(),e=Li(),t="[object Map]";function n(i){return e(i)&&r(i)==t}return lg=n,lg}var cg,uE;function I9(){if(uE)return cg;uE=1;var r=D9(),e=hd(),t=Ym(),n=t&&t.isMap,i=n?e(n):r;return cg=i,cg}var dg,lE;function R9(){if(lE)return dg;lE=1;var r=Xs(),e=Li(),t="[object Set]";function n(i){return e(i)&&r(i)==t}return dg=n,dg}var hg,cE;function j9(){if(cE)return hg;cE=1;var r=R9(),e=hd(),t=Ym(),n=t&&t.isSet,i=n?e(n):r;return hg=i,hg}var fg,dE;function bk(){if(dE)return fg;dE=1;var r=ud(),e=Wm(),t=cd(),n=b9(),i=E9(),a=ok(),s=uk(),o=M9(),u=S9(),l=fk(),c=_9(),d=Xs(),h=k9(),f=L9(),g=mk(),v=Tn(),p=Hs(),y=I9(),m=Di(),w=j9(),M=wa(),S=rs(),T=1,A=2,O=4,N="[object Arguments]",C="[object Array]",P="[object Boolean]",D="[object Date]",j="[object Error]",G="[object Function]",V="[object GeneratorFunction]",Y="[object Map]",$="[object Number]",z="[object Object]",Z="[object RegExp]",ne="[object Set]",se="[object String]",oe="[object Symbol]",Ne="[object WeakMap]",K="[object ArrayBuffer]",W="[object DataView]",ee="[object Float32Array]",le="[object Float64Array]",xe="[object Int8Array]",Ce="[object Int16Array]",Ve="[object Int32Array]",Tt="[object Uint8Array]",dn="[object Uint8ClampedArray]",Ot="[object Uint16Array]",Ut="[object Uint32Array]",Xe={};Xe[N]=Xe[C]=Xe[K]=Xe[W]=Xe[P]=Xe[D]=Xe[ee]=Xe[le]=Xe[xe]=Xe[Ce]=Xe[Ve]=Xe[Y]=Xe[$]=Xe[z]=Xe[Z]=Xe[ne]=Xe[se]=Xe[oe]=Xe[Tt]=Xe[dn]=Xe[Ot]=Xe[Ut]=!0,Xe[j]=Xe[G]=Xe[Ne]=!1;function vr(Qe,yr,bt,as,mr,qt){var Lt,Vn=yr&T,Yn=yr&A,br=yr&O;if(bt&&(Lt=mr?bt(Qe,as,mr,qt):bt(Qe)),Lt!==void 0)return Lt;if(!m(Qe))return Qe;var pi=v(Qe);if(pi){if(Lt=h(Qe),!Vn)return s(Qe,Lt)}else{var Ur=d(Qe),ss=Ur==G||Ur==V;if(p(Qe))return a(Qe,Vn);if(Ur==z||Ur==N||ss&&!mr){if(Lt=Yn||ss?{}:g(Qe),!Vn)return Yn?u(Qe,i(Lt,Qe)):o(Qe,n(Lt,Qe))}else{if(!Xe[Ur])return mr?Qe:{};Lt=f(Qe,Ur,Vn)}}qt||(qt=new r);var os=qt.get(Qe);if(os)return os;qt.set(Qe,Lt),w(Qe)?Qe.forEach(function(Hr){Lt.add(vr(Hr,yr,bt,Hr,Qe,qt))}):y(Qe)&&Qe.forEach(function(Hr,Xr){Lt.set(Xr,vr(Hr,yr,bt,Xr,Qe,qt))});var Kd=br?Yn?c:l:Yn?S:M,_u=pi?void 0:Kd(Qe);return e(_u||Qe,function(Hr,Xr){_u&&(Xr=Hr,Hr=Qe[Xr]),t(Lt,Xr,vr(Hr,yr,bt,Xr,Qe,qt))}),Lt}return fg=vr,fg}var gg,hE;function B9(){if(hE)return gg;hE=1;var r=bk(),e=4;function t(n){return r(n,e)}return gg=t,gg}var pg,fE;function Zm(){if(fE)return pg;fE=1;function r(e){return function(){return e}}return pg=r,pg}var vg,gE;function F9(){if(gE)return vg;gE=1;function r(e){return function(t,n,i){for(var a=-1,s=Object(t),o=i(t),u=o.length;u--;){var l=o[e?u:++a];if(n(s[l],l,s)===!1)break}return t}}return vg=r,vg}var yg,pE;function Qm(){if(pE)return yg;pE=1;var r=F9(),e=r();return yg=e,yg}var mg,vE;function Jm(){if(vE)return mg;vE=1;var r=Qm(),e=wa();function t(n,i){return n&&r(n,i,e)}return mg=t,mg}var bg,yE;function z9(){if(yE)return bg;yE=1;var r=Ri();function e(t,n){return function(i,a){if(i==null)return i;if(!r(i))return t(i,a);for(var s=i.length,o=n?s:-1,u=Object(i);(n?o--:++o<s)&&a(u[o],o,u)!==!1;);return i}}return bg=e,bg}var wg,mE;function pd(){if(mE)return wg;mE=1;var r=Jm(),e=z9(),t=e(r);return wg=t,wg}var xg,bE;function is(){if(bE)return xg;bE=1;function r(e){return e}return xg=r,xg}var Eg,wE;function wk(){if(wE)return Eg;wE=1;var r=is();function e(t){return typeof t=="function"?t:r}return Eg=e,Eg}var Mg,xE;function xk(){if(xE)return Mg;xE=1;var r=Wm(),e=pd(),t=wk(),n=Tn();function i(a,s){var o=n(a)?r:e;return o(a,t(s))}return Mg=i,Mg}var Sg,EE;function Ek(){return EE||(EE=1,Sg=xk()),Sg}var _g,ME;function $9(){if(ME)return _g;ME=1;var r=pd();function e(t,n){var i=[];return r(t,function(a,s,o){n(a,s,o)&&i.push(a)}),i}return _g=e,_g}var Tg,SE;function q9(){if(SE)return Tg;SE=1;var r="__lodash_hash_undefined__";function e(t){return this.__data__.set(t,r),this}return Tg=e,Tg}var Og,_E;function G9(){if(_E)return Og;_E=1;function r(e){return this.__data__.has(e)}return Og=r,Og}var Ag,TE;function Mk(){if(TE)return Ag;TE=1;var r=H_(),e=q9(),t=G9();function n(i){var a=-1,s=i==null?0:i.length;for(this.__data__=new r;++a<s;)this.add(i[a])}return n.prototype.add=n.prototype.push=e,n.prototype.has=t,Ag=n,Ag}var kg,OE;function W9(){if(OE)return kg;OE=1;function r(e,t){for(var n=-1,i=e==null?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}return kg=r,kg}var Ng,AE;function Sk(){if(AE)return Ng;AE=1;function r(e,t){return e.has(t)}return Ng=r,Ng}var Cg,kE;function _k(){if(kE)return Cg;kE=1;var r=Mk(),e=W9(),t=Sk(),n=1,i=2;function a(s,o,u,l,c,d){var h=u&n,f=s.length,g=o.length;if(f!=g&&!(h&&g>f))return!1;var v=d.get(s),p=d.get(o);if(v&&p)return v==o&&p==s;var y=-1,m=!0,w=u&i?new r:void 0;for(d.set(s,o),d.set(o,s);++y<f;){var M=s[y],S=o[y];if(l)var T=h?l(S,M,y,o,s,d):l(M,S,y,s,o,d);if(T!==void 0){if(T)continue;m=!1;break}if(w){if(!e(o,function(A,O){if(!t(w,O)&&(M===A||c(M,A,u,l,d)))return w.push(O)})){m=!1;break}}else if(!(M===S||c(M,S,u,l,d))){m=!1;break}}return d.delete(s),d.delete(o),m}return Cg=a,Cg}var Pg,NE;function V9(){if(NE)return Pg;NE=1;function r(e){var t=-1,n=Array(e.size);return e.forEach(function(i,a){n[++t]=[a,i]}),n}return Pg=r,Pg}var Lg,CE;function e1(){if(CE)return Lg;CE=1;function r(e){var t=-1,n=Array(e.size);return e.forEach(function(i){n[++t]=i}),n}return Lg=r,Lg}var Dg,PE;function Y9(){if(PE)return Dg;PE=1;var r=rm(),e=pk(),t=iu(),n=_k(),i=V9(),a=e1(),s=1,o=2,u="[object Boolean]",l="[object Date]",c="[object Error]",d="[object Map]",h="[object Number]",f="[object RegExp]",g="[object Set]",v="[object String]",p="[object Symbol]",y="[object ArrayBuffer]",m="[object DataView]",w=r?r.prototype:void 0,M=w?w.valueOf:void 0;function S(T,A,O,N,C,P,D){switch(O){case m:if(T.byteLength!=A.byteLength||T.byteOffset!=A.byteOffset)return!1;T=T.buffer,A=A.buffer;case y:return!(T.byteLength!=A.byteLength||!P(new e(T),new e(A)));case u:case l:case h:return t(+T,+A);case c:return T.name==A.name&&T.message==A.message;case f:case v:return T==A+"";case d:var j=i;case g:var G=N&s;if(j||(j=a),T.size!=A.size&&!G)return!1;var V=D.get(T);if(V)return V==A;N|=o,D.set(T,A);var Y=n(j(T),j(A),N,C,P,D);return D.delete(T),Y;case p:if(M)return M.call(T)==M.call(A)}return!1}return Dg=S,Dg}var Ig,LE;function U9(){if(LE)return Ig;LE=1;var r=fk(),e=1,t=Object.prototype,n=t.hasOwnProperty;function i(a,s,o,u,l,c){var d=o&e,h=r(a),f=h.length,g=r(s),v=g.length;if(f!=v&&!d)return!1;for(var p=f;p--;){var y=h[p];if(!(d?y in s:n.call(s,y)))return!1}var m=c.get(a),w=c.get(s);if(m&&w)return m==s&&w==a;var M=!0;c.set(a,s),c.set(s,a);for(var S=d;++p<f;){y=h[p];var T=a[y],A=s[y];if(u)var O=d?u(A,T,y,s,a,c):u(T,A,y,a,s,c);if(!(O===void 0?T===A||l(T,A,o,u,c):O)){M=!1;break}S||(S=y=="constructor")}if(M&&!S){var N=a.constructor,C=s.constructor;N!=C&&"constructor"in a&&"constructor"in s&&!(typeof N=="function"&&N instanceof N&&typeof C=="function"&&C instanceof C)&&(M=!1)}return c.delete(a),c.delete(s),M}return Ig=i,Ig}var Rg,DE;function H9(){if(DE)return Rg;DE=1;var r=ud(),e=_k(),t=Y9(),n=U9(),i=Xs(),a=Tn(),s=Hs(),o=Eu(),u=1,l="[object Arguments]",c="[object Array]",d="[object Object]",h=Object.prototype,f=h.hasOwnProperty;function g(v,p,y,m,w,M){var S=a(v),T=a(p),A=S?c:i(v),O=T?c:i(p);A=A==l?d:A,O=O==l?d:O;var N=A==d,C=O==d,P=A==O;if(P&&s(v)){if(!s(p))return!1;S=!0,N=!1}if(P&&!N)return M||(M=new r),S||o(v)?e(v,p,y,m,w,M):t(v,p,A,y,m,w,M);if(!(y&u)){var D=N&&f.call(v,"__wrapped__"),j=C&&f.call(p,"__wrapped__");if(D||j){var G=D?v.value():v,V=j?p.value():p;return M||(M=new r),w(G,V,y,m,M)}}return P?(M||(M=new r),n(v,p,y,m,w,M)):!1}return Rg=g,Rg}var jg,IE;function Tk(){if(IE)return jg;IE=1;var r=H9(),e=Li();function t(n,i,a,s,o){return n===i?!0:n==null||i==null||!e(n)&&!e(i)?n!==n&&i!==i:r(n,i,a,s,t,o)}return jg=t,jg}var Bg,RE;function X9(){if(RE)return Bg;RE=1;var r=ud(),e=Tk(),t=1,n=2;function i(a,s,o,u){var l=o.length,c=l,d=!u;if(a==null)return!c;for(a=Object(a);l--;){var h=o[l];if(d&&h[2]?h[1]!==a[h[0]]:!(h[0]in a))return!1}for(;++l<c;){h=o[l];var f=h[0],g=a[f],v=h[1];if(d&&h[2]){if(g===void 0&&!(f in a))return!1}else{var p=new r;if(u)var y=u(g,v,f,a,s,p);if(!(y===void 0?e(v,g,t|n,u,p):y))return!1}}return!0}return Bg=i,Bg}var Fg,jE;function Ok(){if(jE)return Fg;jE=1;var r=Di();function e(t){return t===t&&!r(t)}return Fg=e,Fg}var zg,BE;function K9(){if(BE)return zg;BE=1;var r=Ok(),e=wa();function t(n){for(var i=e(n),a=i.length;a--;){var s=i[a],o=n[s];i[a]=[s,o,r(o)]}return i}return zg=t,zg}var $g,FE;function Ak(){if(FE)return $g;FE=1;function r(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==void 0||e in Object(n))}}return $g=r,$g}var qg,zE;function Z9(){if(zE)return qg;zE=1;var r=X9(),e=K9(),t=Ak();function n(i){var a=e(i);return a.length==1&&a[0][2]?t(a[0][0],a[0][1]):function(s){return s===i||r(s,i,a)}}return qg=n,qg}var Gg,$E;function Q9(){if($E)return Gg;$E=1;function r(e,t){return e!=null&&t in Object(e)}return Gg=r,Gg}var Wg,qE;function kk(){if(qE)return Wg;qE=1;var r=em(),e=xu(),t=Tn(),n=dd(),i=Vm(),a=Sc();function s(o,u,l){u=r(u,o);for(var c=-1,d=u.length,h=!1;++c<d;){var f=a(u[c]);if(!(h=o!=null&&l(o,f)))break;o=o[f]}return h||++c!=d?h:(d=o==null?0:o.length,!!d&&i(d)&&n(f,d)&&(t(o)||e(o)))}return Wg=s,Wg}var Vg,GE;function Nk(){if(GE)return Vg;GE=1;var r=Q9(),e=kk();function t(n,i){return n!=null&&e(n,i,r)}return Vg=t,Vg}var Yg,WE;function J9(){if(WE)return Yg;WE=1;var r=Tk(),e=WC(),t=Nk(),n=X_(),i=Ok(),a=Ak(),s=Sc(),o=1,u=2;function l(c,d){return n(c)&&i(d)?a(s(c),d):function(h){var f=e(h,c);return f===void 0&&f===d?t(h,c):r(d,f,o|u)}}return Yg=l,Yg}var Ug,VE;function Ck(){if(VE)return Ug;VE=1;function r(e){return function(t){return t==null?void 0:t[e]}}return Ug=r,Ug}var Hg,YE;function e$(){if(YE)return Hg;YE=1;var r=tm();function e(t){return function(n){return r(n,t)}}return Hg=e,Hg}var Xg,UE;function t$(){if(UE)return Xg;UE=1;var r=Ck(),e=e$(),t=X_(),n=Sc();function i(a){return t(a)?r(n(a)):e(a)}return Xg=i,Xg}var Kg,HE;function ji(){if(HE)return Kg;HE=1;var r=Z9(),e=J9(),t=is(),n=Tn(),i=t$();function a(s){return typeof s=="function"?s:s==null?t:typeof s=="object"?n(s)?e(s[0],s[1]):r(s):i(s)}return Kg=a,Kg}var Zg,XE;function Pk(){if(XE)return Zg;XE=1;var r=lk(),e=$9(),t=ji(),n=Tn();function i(a,s){var o=n(a)?r:e;return o(a,t(s,3))}return Zg=i,Zg}var Qg,KE;function n$(){if(KE)return Qg;KE=1;var r=Object.prototype,e=r.hasOwnProperty;function t(n,i){return n!=null&&e.call(n,i)}return Qg=t,Qg}var Jg,ZE;function Lk(){if(ZE)return Jg;ZE=1;var r=n$(),e=kk();function t(n,i){return n!=null&&e(n,i,r)}return Jg=t,Jg}var ep,QE;function r$(){if(QE)return ep;QE=1;var r=Um(),e=Xs(),t=xu(),n=Tn(),i=Ri(),a=Hs(),s=fd(),o=Eu(),u="[object Map]",l="[object Set]",c=Object.prototype,d=c.hasOwnProperty;function h(f){if(f==null)return!0;if(i(f)&&(n(f)||typeof f=="string"||typeof f.splice=="function"||a(f)||o(f)||t(f)))return!f.length;var g=e(f);if(g==u||g==l)return!f.size;if(s(f))return!r(f).length;for(var v in f)if(d.call(f,v))return!1;return!0}return ep=h,ep}var tp,JE;function Dk(){if(JE)return tp;JE=1;function r(e){return e===void 0}return tp=r,tp}var np,e2;function Ik(){if(e2)return np;e2=1;var r=pd(),e=Ri();function t(n,i){var a=-1,s=e(n)?Array(n.length):[];return r(n,function(o,u,l){s[++a]=i(o,u,l)}),s}return np=t,np}var rp,t2;function Rk(){if(t2)return rp;t2=1;var r=nm(),e=ji(),t=Ik(),n=Tn();function i(a,s){var o=n(a)?r:t;return o(a,e(s,3))}return rp=i,rp}var ip,n2;function i$(){if(n2)return ip;n2=1;function r(e,t,n,i){var a=-1,s=e==null?0:e.length;for(i&&s&&(n=e[++a]);++a<s;)n=t(n,e[a],a,e);return n}return ip=r,ip}var ap,r2;function a$(){if(r2)return ap;r2=1;function r(e,t,n,i,a){return a(e,function(s,o,u){n=i?(i=!1,s):t(n,s,o,u)}),n}return ap=r,ap}var sp,i2;function jk(){if(i2)return sp;i2=1;var r=i$(),e=pd(),t=ji(),n=a$(),i=Tn();function a(s,o,u){var l=i(s)?r:n,c=arguments.length<3;return l(s,t(o,4),u,c,e)}return sp=a,sp}var op,a2;function s$(){if(a2)return op;a2=1;var r=au(),e=Tn(),t=Li(),n="[object String]";function i(a){return typeof a=="string"||!e(a)&&t(a)&&r(a)==n}return op=i,op}var up,s2;function o$(){if(s2)return up;s2=1;var r=Ck(),e=r("length");return up=e,up}var lp,o2;function u$(){if(o2)return lp;o2=1;var r="\\ud800-\\udfff",e="\\u0300-\\u036f",t="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=e+t+n,a="\\ufe0e\\ufe0f",s="\\u200d",o=RegExp("["+s+r+i+a+"]");function u(l){return o.test(l)}return lp=u,lp}var cp,u2;function l$(){if(u2)return cp;u2=1;var r="\\ud800-\\udfff",e="\\u0300-\\u036f",t="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=e+t+n,a="\\ufe0e\\ufe0f",s="["+r+"]",o="["+i+"]",u="\\ud83c[\\udffb-\\udfff]",l="(?:"+o+"|"+u+")",c="[^"+r+"]",d="(?:\\ud83c[\\udde6-\\uddff]){2}",h="[\\ud800-\\udbff][\\udc00-\\udfff]",f="\\u200d",g=l+"?",v="["+a+"]?",p="(?:"+f+"(?:"+[c,d,h].join("|")+")"+v+g+")*",y=v+g+p,m="(?:"+[c+o+"?",o,d,h,s].join("|")+")",w=RegExp(u+"(?="+u+")|"+m+y,"g");function M(S){for(var T=w.lastIndex=0;w.test(S);)++T;return T}return cp=M,cp}var dp,l2;function c$(){if(l2)return dp;l2=1;var r=o$(),e=u$(),t=l$();function n(i){return e(i)?t(i):r(i)}return dp=n,dp}var hp,c2;function d$(){if(c2)return hp;c2=1;var r=Um(),e=Xs(),t=Ri(),n=s$(),i=c$(),a="[object Map]",s="[object Set]";function o(u){if(u==null)return 0;if(t(u))return n(u)?i(u):u.length;var l=e(u);return l==a||l==s?u.size:r(u).length}return hp=o,hp}var fp,d2;function h$(){if(d2)return fp;d2=1;var r=Wm(),e=yk(),t=Jm(),n=ji(),i=gd(),a=Tn(),s=Hs(),o=Mc(),u=Di(),l=Eu();function c(d,h,f){var g=a(d),v=g||s(d)||l(d);if(h=n(h,4),f==null){var p=d&&d.constructor;v?f=g?new p:[]:u(d)?f=o(p)?e(i(d)):{}:f={}}return(v?r:t)(d,function(y,m,w){return h(f,y,m,w)}),f}return fp=c,fp}var gp,h2;function f$(){if(h2)return gp;h2=1;var r=rm(),e=xu(),t=Tn(),n=r?r.isConcatSpreadable:void 0;function i(a){return t(a)||e(a)||!!(n&&a&&a[n])}return gp=i,gp}var pp,f2;function t1(){if(f2)return pp;f2=1;var r=Xm(),e=f$();function t(n,i,a,s,o){var u=-1,l=n.length;for(a||(a=e),o||(o=[]);++u<l;){var c=n[u];i>0&&a(c)?i>1?t(c,i-1,a,s,o):r(o,c):s||(o[o.length]=c)}return o}return pp=t,pp}var vp,g2;function g$(){if(g2)return vp;g2=1;function r(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}return vp=r,vp}var yp,p2;function Bk(){if(p2)return yp;p2=1;var r=g$(),e=Math.max;function t(n,i,a){return i=e(i===void 0?n.length-1:i,0),function(){for(var s=arguments,o=-1,u=e(s.length-i,0),l=Array(u);++o<u;)l[o]=s[i+o];o=-1;for(var c=Array(i+1);++o<i;)c[o]=s[o];return c[i]=a(l),r(n,this,c)}}return yp=t,yp}var mp,v2;function p$(){if(v2)return mp;v2=1;var r=Zm(),e=ik(),t=is(),n=e?function(i,a){return e(i,"toString",{configurable:!0,enumerable:!1,value:r(a),writable:!0})}:t;return mp=n,mp}var bp,y2;function v$(){if(y2)return bp;y2=1;var r=800,e=16,t=Date.now;function n(i){var a=0,s=0;return function(){var o=t(),u=e-(o-s);if(s=o,u>0){if(++a>=r)return arguments[0]}else a=0;return i.apply(void 0,arguments)}}return bp=n,bp}var wp,m2;function Fk(){if(m2)return wp;m2=1;var r=p$(),e=v$(),t=e(r);return wp=t,wp}var xp,b2;function vd(){if(b2)return xp;b2=1;var r=is(),e=Bk(),t=Fk();function n(i,a){return t(e(i,a,r),i+"")}return xp=n,xp}var Ep,w2;function zk(){if(w2)return Ep;w2=1;function r(e,t,n,i){for(var a=e.length,s=n+(i?1:-1);i?s--:++s<a;)if(t(e[s],s,e))return s;return-1}return Ep=r,Ep}var Mp,x2;function y$(){if(x2)return Mp;x2=1;function r(e){return e!==e}return Mp=r,Mp}var Sp,E2;function m$(){if(E2)return Sp;E2=1;function r(e,t,n){for(var i=n-1,a=e.length;++i<a;)if(e[i]===t)return i;return-1}return Sp=r,Sp}var _p,M2;function b$(){if(M2)return _p;M2=1;var r=zk(),e=y$(),t=m$();function n(i,a,s){return a===a?t(i,a,s):r(i,e,s)}return _p=n,_p}var Tp,S2;function w$(){if(S2)return Tp;S2=1;var r=b$();function e(t,n){var i=t==null?0:t.length;return!!i&&r(t,n,0)>-1}return Tp=e,Tp}var Op,_2;function x$(){if(_2)return Op;_2=1;function r(e,t,n){for(var i=-1,a=e==null?0:e.length;++i<a;)if(n(t,e[i]))return!0;return!1}return Op=r,Op}var Ap,T2;function E$(){if(T2)return Ap;T2=1;function r(){}return Ap=r,Ap}var kp,O2;function M$(){if(O2)return kp;O2=1;var r=gk(),e=E$(),t=e1(),n=1/0,i=r&&1/t(new r([,-0]))[1]==n?function(a){return new r(a)}:e;return kp=i,kp}var Np,A2;function S$(){if(A2)return Np;A2=1;var r=Mk(),e=w$(),t=x$(),n=Sk(),i=M$(),a=e1(),s=200;function o(u,l,c){var d=-1,h=e,f=u.length,g=!0,v=[],p=v;if(c)g=!1,h=t;else if(f>=s){var y=l?null:i(u);if(y)return a(y);g=!1,h=n,p=new r}else p=l?[]:v;e:for(;++d<f;){var m=u[d],w=l?l(m):m;if(m=c||m!==0?m:0,g&&w===w){for(var M=p.length;M--;)if(p[M]===w)continue e;l&&p.push(w),v.push(m)}else h(p,w,c)||(p!==v&&p.push(w),v.push(m))}return v}return Np=o,Np}var Cp,k2;function $k(){if(k2)return Cp;k2=1;var r=Ri(),e=Li();function t(n){return e(n)&&r(n)}return Cp=t,Cp}var Pp,N2;function _$(){if(N2)return Pp;N2=1;var r=t1(),e=vd(),t=S$(),n=$k(),i=e(function(a){return t(r(a,1,n,!0))});return Pp=i,Pp}var Lp,C2;function T$(){if(C2)return Lp;C2=1;var r=nm();function e(t,n){return r(n,function(i){return t[i]})}return Lp=e,Lp}var Dp,P2;function qk(){if(P2)return Dp;P2=1;var r=T$(),e=wa();function t(n){return n==null?[]:r(n,e(n))}return Dp=t,Dp}var Ip,L2;function Nr(){if(L2)return Ip;L2=1;var r;if(typeof Qy=="function")try{r={clone:B9(),constant:Zm(),each:Ek(),filter:Pk(),has:Lk(),isArray:Tn(),isEmpty:r$(),isFunction:Mc(),isUndefined:Dk(),keys:wa(),map:Rk(),reduce:jk(),size:d$(),transform:h$(),union:_$(),values:qk()}}catch{}return r||(r=window._),Ip=r,Ip}var Rp,D2;function n1(){if(D2)return Rp;D2=1;var r=Nr();Rp=i;var e="\0",t="\0",n="";function i(c){this._isDirected=r.has(c,"directed")?c.directed:!0,this._isMultigraph=r.has(c,"multigraph")?c.multigraph:!1,this._isCompound=r.has(c,"compound")?c.compound:!1,this._label=void 0,this._defaultNodeLabelFn=r.constant(void 0),this._defaultEdgeLabelFn=r.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[t]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}i.prototype._nodeCount=0,i.prototype._edgeCount=0,i.prototype.isDirected=function(){return this._isDirected},i.prototype.isMultigraph=function(){return this._isMultigraph},i.prototype.isCompound=function(){return this._isCompound},i.prototype.setGraph=function(c){return this._label=c,this},i.prototype.graph=function(){return this._label},i.prototype.setDefaultNodeLabel=function(c){return r.isFunction(c)||(c=r.constant(c)),this._defaultNodeLabelFn=c,this},i.prototype.nodeCount=function(){return this._nodeCount},i.prototype.nodes=function(){return r.keys(this._nodes)},i.prototype.sources=function(){var c=this;return r.filter(this.nodes(),function(d){return r.isEmpty(c._in[d])})},i.prototype.sinks=function(){var c=this;return r.filter(this.nodes(),function(d){return r.isEmpty(c._out[d])})},i.prototype.setNodes=function(c,d){var h=arguments,f=this;return r.each(c,function(g){h.length>1?f.setNode(g,d):f.setNode(g)}),this},i.prototype.setNode=function(c,d){return r.has(this._nodes,c)?(arguments.length>1&&(this._nodes[c]=d),this):(this._nodes[c]=arguments.length>1?d:this._defaultNodeLabelFn(c),this._isCompound&&(this._parent[c]=t,this._children[c]={},this._children[t][c]=!0),this._in[c]={},this._preds[c]={},this._out[c]={},this._sucs[c]={},++this._nodeCount,this)},i.prototype.node=function(c){return this._nodes[c]},i.prototype.hasNode=function(c){return r.has(this._nodes,c)},i.prototype.removeNode=function(c){var d=this;if(r.has(this._nodes,c)){var h=function(f){d.removeEdge(d._edgeObjs[f])};delete this._nodes[c],this._isCompound&&(this._removeFromParentsChildList(c),delete this._parent[c],r.each(this.children(c),function(f){d.setParent(f)}),delete this._children[c]),r.each(r.keys(this._in[c]),h),delete this._in[c],delete this._preds[c],r.each(r.keys(this._out[c]),h),delete this._out[c],delete this._sucs[c],--this._nodeCount}return this},i.prototype.setParent=function(c,d){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(r.isUndefined(d))d=t;else{d+="";for(var h=d;!r.isUndefined(h);h=this.parent(h))if(h===c)throw new Error("Setting "+d+" as parent of "+c+" would create a cycle");this.setNode(d)}return this.setNode(c),this._removeFromParentsChildList(c),this._parent[c]=d,this._children[d][c]=!0,this},i.prototype._removeFromParentsChildList=function(c){delete this._children[this._parent[c]][c]},i.prototype.parent=function(c){if(this._isCompound){var d=this._parent[c];if(d!==t)return d}},i.prototype.children=function(c){if(r.isUndefined(c)&&(c=t),this._isCompound){var d=this._children[c];if(d)return r.keys(d)}else{if(c===t)return this.nodes();if(this.hasNode(c))return[]}},i.prototype.predecessors=function(c){var d=this._preds[c];if(d)return r.keys(d)},i.prototype.successors=function(c){var d=this._sucs[c];if(d)return r.keys(d)},i.prototype.neighbors=function(c){var d=this.predecessors(c);if(d)return r.union(d,this.successors(c))},i.prototype.isLeaf=function(c){var d;return this.isDirected()?d=this.successors(c):d=this.neighbors(c),d.length===0},i.prototype.filterNodes=function(c){var d=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});d.setGraph(this.graph());var h=this;r.each(this._nodes,function(v,p){c(p)&&d.setNode(p,v)}),r.each(this._edgeObjs,function(v){d.hasNode(v.v)&&d.hasNode(v.w)&&d.setEdge(v,h.edge(v))});var f={};function g(v){var p=h.parent(v);return p===void 0||d.hasNode(p)?(f[v]=p,p):p in f?f[p]:g(p)}return this._isCompound&&r.each(d.nodes(),function(v){d.setParent(v,g(v))}),d},i.prototype.setDefaultEdgeLabel=function(c){return r.isFunction(c)||(c=r.constant(c)),this._defaultEdgeLabelFn=c,this},i.prototype.edgeCount=function(){return this._edgeCount},i.prototype.edges=function(){return r.values(this._edgeObjs)},i.prototype.setPath=function(c,d){var h=this,f=arguments;return r.reduce(c,function(g,v){return f.length>1?h.setEdge(g,v,d):h.setEdge(g,v),v}),this},i.prototype.setEdge=function(){var c,d,h,f,g=!1,v=arguments[0];typeof v=="object"&&v!==null&&"v"in v?(c=v.v,d=v.w,h=v.name,arguments.length===2&&(f=arguments[1],g=!0)):(c=v,d=arguments[1],h=arguments[3],arguments.length>2&&(f=arguments[2],g=!0)),c=""+c,d=""+d,r.isUndefined(h)||(h=""+h);var p=o(this._isDirected,c,d,h);if(r.has(this._edgeLabels,p))return g&&(this._edgeLabels[p]=f),this;if(!r.isUndefined(h)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(c),this.setNode(d),this._edgeLabels[p]=g?f:this._defaultEdgeLabelFn(c,d,h);var y=u(this._isDirected,c,d,h);return c=y.v,d=y.w,Object.freeze(y),this._edgeObjs[p]=y,a(this._preds[d],c),a(this._sucs[c],d),this._in[d][p]=y,this._out[c][p]=y,this._edgeCount++,this},i.prototype.edge=function(c,d,h){var f=arguments.length===1?l(this._isDirected,arguments[0]):o(this._isDirected,c,d,h);return this._edgeLabels[f]},i.prototype.hasEdge=function(c,d,h){var f=arguments.length===1?l(this._isDirected,arguments[0]):o(this._isDirected,c,d,h);return r.has(this._edgeLabels,f)},i.prototype.removeEdge=function(c,d,h){var f=arguments.length===1?l(this._isDirected,arguments[0]):o(this._isDirected,c,d,h),g=this._edgeObjs[f];return g&&(c=g.v,d=g.w,delete this._edgeLabels[f],delete this._edgeObjs[f],s(this._preds[d],c),s(this._sucs[c],d),delete this._in[d][f],delete this._out[c][f],this._edgeCount--),this},i.prototype.inEdges=function(c,d){var h=this._in[c];if(h){var f=r.values(h);return d?r.filter(f,function(g){return g.v===d}):f}},i.prototype.outEdges=function(c,d){var h=this._out[c];if(h){var f=r.values(h);return d?r.filter(f,function(g){return g.w===d}):f}},i.prototype.nodeEdges=function(c,d){var h=this.inEdges(c,d);if(h)return h.concat(this.outEdges(c,d))};function a(c,d){c[d]?c[d]++:c[d]=1}function s(c,d){--c[d]||delete c[d]}function o(c,d,h,f){var g=""+d,v=""+h;if(!c&&g>v){var p=g;g=v,v=p}return g+n+v+n+(r.isUndefined(f)?e:f)}function u(c,d,h,f){var g=""+d,v=""+h;if(!c&&g>v){var p=g;g=v,v=p}var y={v:g,w:v};return f&&(y.name=f),y}function l(c,d){return o(c,d.v,d.w,d.name)}return Rp}var jp,I2;function O$(){return I2||(I2=1,jp="2.1.8"),jp}var Bp,R2;function A$(){return R2||(R2=1,Bp={Graph:n1(),version:O$()}),Bp}var Fp,j2;function k$(){if(j2)return Fp;j2=1;var r=Nr(),e=n1();Fp={write:t,read:a};function t(s){var o={options:{directed:s.isDirected(),multigraph:s.isMultigraph(),compound:s.isCompound()},nodes:n(s),edges:i(s)};return r.isUndefined(s.graph())||(o.value=r.clone(s.graph())),o}function n(s){return r.map(s.nodes(),function(o){var u=s.node(o),l=s.parent(o),c={v:o};return r.isUndefined(u)||(c.value=u),r.isUndefined(l)||(c.parent=l),c})}function i(s){return r.map(s.edges(),function(o){var u=s.edge(o),l={v:o.v,w:o.w};return r.isUndefined(o.name)||(l.name=o.name),r.isUndefined(u)||(l.value=u),l})}function a(s){var o=new e(s.options).setGraph(s.value);return r.each(s.nodes,function(u){o.setNode(u.v,u.value),u.parent&&o.setParent(u.v,u.parent)}),r.each(s.edges,function(u){o.setEdge({v:u.v,w:u.w,name:u.name},u.value)}),o}return Fp}var zp,B2;function N$(){if(B2)return zp;B2=1;var r=Nr();zp=e;function e(t){var n={},i=[],a;function s(o){r.has(n,o)||(n[o]=!0,a.push(o),r.each(t.successors(o),s),r.each(t.predecessors(o),s))}return r.each(t.nodes(),function(o){a=[],s(o),a.length&&i.push(a)}),i}return zp}var $p,F2;function Gk(){if(F2)return $p;F2=1;var r=Nr();$p=e;function e(){this._arr=[],this._keyIndices={}}return e.prototype.size=function(){return this._arr.length},e.prototype.keys=function(){return this._arr.map(function(t){return t.key})},e.prototype.has=function(t){return r.has(this._keyIndices,t)},e.prototype.priority=function(t){var n=this._keyIndices[t];if(n!==void 0)return this._arr[n].priority},e.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},e.prototype.add=function(t,n){var i=this._keyIndices;if(t=String(t),!r.has(i,t)){var a=this._arr,s=a.length;return i[t]=s,a.push({key:t,priority:n}),this._decrease(s),!0}return!1},e.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},e.prototype.decrease=function(t,n){var i=this._keyIndices[t];if(n>this._arr[i].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[i].priority+" New: "+n);this._arr[i].priority=n,this._decrease(i)},e.prototype._heapify=function(t){var n=this._arr,i=2*t,a=i+1,s=t;i<n.length&&(s=n[i].priority<n[s].priority?i:s,a<n.length&&(s=n[a].priority<n[s].priority?a:s),s!==t&&(this._swap(t,s),this._heapify(s)))},e.prototype._decrease=function(t){for(var n=this._arr,i=n[t].priority,a;t!==0&&(a=t>>1,!(n[a].priority<i));)this._swap(t,a),t=a},e.prototype._swap=function(t,n){var i=this._arr,a=this._keyIndices,s=i[t],o=i[n];i[t]=o,i[n]=s,a[o.key]=t,a[s.key]=n},$p}var qp,z2;function Wk(){if(z2)return qp;z2=1;var r=Nr(),e=Gk();qp=n;var t=r.constant(1);function n(a,s,o,u){return i(a,String(s),o||t,u||function(l){return a.outEdges(l)})}function i(a,s,o,u){var l={},c=new e,d,h,f=function(g){var v=g.v!==d?g.v:g.w,p=l[v],y=o(g),m=h.distance+y;if(y<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+g+" Weight: "+y);m<p.distance&&(p.distance=m,p.predecessor=d,c.decrease(v,m))};for(a.nodes().forEach(function(g){var v=g===s?0:Number.POSITIVE_INFINITY;l[g]={distance:v},c.add(g,v)});c.size()>0&&(d=c.removeMin(),h=l[d],h.distance!==Number.POSITIVE_INFINITY);)u(d).forEach(f);return l}return qp}var Gp,$2;function C$(){if($2)return Gp;$2=1;var r=Wk(),e=Nr();Gp=t;function t(n,i,a){return e.transform(n.nodes(),function(s,o){s[o]=r(n,o,i,a)},{})}return Gp}var Wp,q2;function Vk(){if(q2)return Wp;q2=1;var r=Nr();Wp=e;function e(t){var n=0,i=[],a={},s=[];function o(u){var l=a[u]={onStack:!0,lowlink:n,index:n++};if(i.push(u),t.successors(u).forEach(function(h){r.has(a,h)?a[h].onStack&&(l.lowlink=Math.min(l.lowlink,a[h].index)):(o(h),l.lowlink=Math.min(l.lowlink,a[h].lowlink))}),l.lowlink===l.index){var c=[],d;do d=i.pop(),a[d].onStack=!1,c.push(d);while(u!==d);s.push(c)}}return t.nodes().forEach(function(u){r.has(a,u)||o(u)}),s}return Wp}var Vp,G2;function P$(){if(G2)return Vp;G2=1;var r=Nr(),e=Vk();Vp=t;function t(n){return r.filter(e(n),function(i){return i.length>1||i.length===1&&n.hasEdge(i[0],i[0])})}return Vp}var Yp,W2;function L$(){if(W2)return Yp;W2=1;var r=Nr();Yp=t;var e=r.constant(1);function t(i,a,s){return n(i,a||e,s||function(o){return i.outEdges(o)})}function n(i,a,s){var o={},u=i.nodes();return u.forEach(function(l){o[l]={},o[l][l]={distance:0},u.forEach(function(c){l!==c&&(o[l][c]={distance:Number.POSITIVE_INFINITY})}),s(l).forEach(function(c){var d=c.v===l?c.w:c.v,h=a(c);o[l][d]={distance:h,predecessor:l}})}),u.forEach(function(l){var c=o[l];u.forEach(function(d){var h=o[d];u.forEach(function(f){var g=h[l],v=c[f],p=h[f],y=g.distance+v.distance;y<p.distance&&(p.distance=y,p.predecessor=v.predecessor)})})}),o}return Yp}var Up,V2;function Yk(){if(V2)return Up;V2=1;var r=Nr();Up=e,e.CycleException=t;function e(n){var i={},a={},s=[];function o(u){if(r.has(a,u))throw new t;r.has(i,u)||(a[u]=!0,i[u]=!0,r.each(n.predecessors(u),o),delete a[u],s.push(u))}if(r.each(n.sinks(),o),r.size(i)!==n.nodeCount())throw new t;return s}function t(){}return t.prototype=new Error,Up}var Hp,Y2;function D$(){if(Y2)return Hp;Y2=1;var r=Yk();Hp=e;function e(t){try{r(t)}catch(n){if(n instanceof r.CycleException)return!1;throw n}return!0}return Hp}var Xp,U2;function Uk(){if(U2)return Xp;U2=1;var r=Nr();Xp=e;function e(n,i,a){r.isArray(i)||(i=[i]);var s=(n.isDirected()?n.successors:n.neighbors).bind(n),o=[],u={};return r.each(i,function(l){if(!n.hasNode(l))throw new Error("Graph does not have node: "+l);t(n,l,a==="post",u,s,o)}),o}function t(n,i,a,s,o,u){r.has(s,i)||(s[i]=!0,a||u.push(i),r.each(o(i),function(l){t(n,l,a,s,o,u)}),a&&u.push(i))}return Xp}var Kp,H2;function I$(){if(H2)return Kp;H2=1;var r=Uk();Kp=e;function e(t,n){return r(t,n,"post")}return Kp}var Zp,X2;function R$(){if(X2)return Zp;X2=1;var r=Uk();Zp=e;function e(t,n){return r(t,n,"pre")}return Zp}var Qp,K2;function j$(){if(K2)return Qp;K2=1;var r=Nr(),e=n1(),t=Gk();Qp=n;function n(i,a){var s=new e,o={},u=new t,l;function c(h){var f=h.v===l?h.w:h.v,g=u.priority(f);if(g!==void 0){var v=a(h);v<g&&(o[f]=l,u.decrease(f,v))}}if(i.nodeCount()===0)return s;r.each(i.nodes(),function(h){u.add(h,Number.POSITIVE_INFINITY),s.setNode(h)}),u.decrease(i.nodes()[0],0);for(var d=!1;u.size()>0;){if(l=u.removeMin(),r.has(o,l))s.setEdge(l,o[l]);else{if(d)throw new Error("Input graph is not connected: "+i);d=!0}i.nodeEdges(l).forEach(c)}return s}return Qp}var Jp,Z2;function B$(){return Z2||(Z2=1,Jp={components:N$(),dijkstra:Wk(),dijkstraAll:C$(),findCycles:P$(),floydWarshall:L$(),isAcyclic:D$(),postorder:I$(),preorder:R$(),prim:j$(),tarjan:Vk(),topsort:Yk()}),Jp}var ev,Q2;function F$(){if(Q2)return ev;Q2=1;var r=A$();return ev={Graph:r.Graph,json:k$(),alg:B$(),version:r.version},ev}var tv,J2;function Gr(){if(J2)return tv;J2=1;var r;if(typeof Qy=="function")try{r=F$()}catch{}return r||(r=window.graphlib),tv=r,tv}var nv,eM;function z$(){if(eM)return nv;eM=1;var r=bk(),e=1,t=4;function n(i){return r(i,e|t)}return nv=n,nv}var rv,tM;function yd(){if(tM)return rv;tM=1;var r=iu(),e=Ri(),t=dd(),n=Di();function i(a,s,o){if(!n(o))return!1;var u=typeof s;return(u=="number"?e(o)&&t(s,o.length):u=="string"&&s in o)?r(o[s],a):!1}return rv=i,rv}var iv,nM;function $$(){if(nM)return iv;nM=1;var r=vd(),e=iu(),t=yd(),n=rs(),i=Object.prototype,a=i.hasOwnProperty,s=r(function(o,u){o=Object(o);var l=-1,c=u.length,d=c>2?u[2]:void 0;for(d&&t(u[0],u[1],d)&&(c=1);++l<c;)for(var h=u[l],f=n(h),g=-1,v=f.length;++g<v;){var p=f[g],y=o[p];(y===void 0||e(y,i[p])&&!a.call(o,p))&&(o[p]=h[p])}return o});return iv=s,iv}var av,rM;function q$(){if(rM)return av;rM=1;var r=ji(),e=Ri(),t=wa();function n(i){return function(a,s,o){var u=Object(a);if(!e(a)){var l=r(s,3);a=t(a),s=function(d){return l(u[d],d,u)}}var c=i(a,s,o);return c>-1?u[l?a[c]:c]:void 0}}return av=n,av}var sv,iM;function Hk(){if(iM)return sv;iM=1;var r=UC(),e=1/0,t=17976931348623157e292;function n(i){if(!i)return i===0?i:0;if(i=r(i),i===e||i===-1/0){var a=i<0?-1:1;return a*t}return i===i?i:0}return sv=n,sv}var ov,aM;function G$(){if(aM)return ov;aM=1;var r=Hk();function e(t){var n=r(t),i=n%1;return n===n?i?n-i:n:0}return ov=e,ov}var uv,sM;function W$(){if(sM)return uv;sM=1;var r=zk(),e=ji(),t=G$(),n=Math.max;function i(a,s,o){var u=a==null?0:a.length;if(!u)return-1;var l=o==null?0:t(o);return l<0&&(l=n(u+l,0)),r(a,e(s,3),l)}return uv=i,uv}var lv,oM;function V$(){if(oM)return lv;oM=1;var r=q$(),e=W$(),t=r(e);return lv=t,lv}var cv,uM;function Xk(){if(uM)return cv;uM=1;var r=t1();function e(t){var n=t==null?0:t.length;return n?r(t,1):[]}return cv=e,cv}var dv,lM;function Y$(){if(lM)return dv;lM=1;var r=Qm(),e=wk(),t=rs();function n(i,a){return i==null?i:r(i,e(a),t)}return dv=n,dv}var hv,cM;function U$(){if(cM)return hv;cM=1;function r(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}return hv=r,hv}var fv,dM;function H$(){if(dM)return fv;dM=1;var r=ld(),e=Jm(),t=ji();function n(i,a){var s={};return a=t(a,3),e(i,function(o,u,l){r(s,u,a(o,u,l))}),s}return fv=n,fv}var gv,hM;function r1(){if(hM)return gv;hM=1;var r=K_();function e(t,n,i){for(var a=-1,s=t.length;++a<s;){var o=t[a],u=n(o);if(u!=null&&(l===void 0?u===u&&!r(u):i(u,l)))var l=u,c=o}return c}return gv=e,gv}var pv,fM;function X$(){if(fM)return pv;fM=1;function r(e,t){return e>t}return pv=r,pv}var vv,gM;function K$(){if(gM)return vv;gM=1;var r=r1(),e=X$(),t=is();function n(i){return i&&i.length?r(i,t,e):void 0}return vv=n,vv}var yv,pM;function Kk(){if(pM)return yv;pM=1;var r=ld(),e=iu();function t(n,i,a){(a!==void 0&&!e(n[i],a)||a===void 0&&!(i in n))&&r(n,i,a)}return yv=t,yv}var mv,vM;function Z$(){if(vM)return mv;vM=1;var r=au(),e=gd(),t=Li(),n="[object Object]",i=Function.prototype,a=Object.prototype,s=i.toString,o=a.hasOwnProperty,u=s.call(Object);function l(c){if(!t(c)||r(c)!=n)return!1;var d=e(c);if(d===null)return!0;var h=o.call(d,"constructor")&&d.constructor;return typeof h=="function"&&h instanceof h&&s.call(h)==u}return mv=l,mv}var bv,yM;function Zk(){if(yM)return bv;yM=1;function r(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}return bv=r,bv}var wv,mM;function Q$(){if(mM)return wv;mM=1;var r=wu(),e=rs();function t(n){return r(n,e(n))}return wv=t,wv}var xv,bM;function J$(){if(bM)return xv;bM=1;var r=Kk(),e=ok(),t=vk(),n=uk(),i=mk(),a=xu(),s=Tn(),o=$k(),u=Hs(),l=Mc(),c=Di(),d=Z$(),h=Eu(),f=Zk(),g=Q$();function v(p,y,m,w,M,S,T){var A=f(p,m),O=f(y,m),N=T.get(O);if(N){r(p,m,N);return}var C=S?S(A,O,m+"",p,y,T):void 0,P=C===void 0;if(P){var D=s(O),j=!D&&u(O),G=!D&&!j&&h(O);C=O,D||j||G?s(A)?C=A:o(A)?C=n(A):j?(P=!1,C=e(O,!0)):G?(P=!1,C=t(O,!0)):C=[]:d(O)||a(O)?(C=A,a(A)?C=g(A):(!c(A)||l(A))&&(C=i(O))):P=!1}P&&(T.set(O,C),M(C,O,w,S,T),T.delete(O)),r(p,m,C)}return xv=v,xv}var Ev,wM;function eq(){if(wM)return Ev;wM=1;var r=ud(),e=Kk(),t=Qm(),n=J$(),i=Di(),a=rs(),s=Zk();function o(u,l,c,d,h){u!==l&&t(l,function(f,g){if(h||(h=new r),i(f))n(u,l,g,c,o,d,h);else{var v=d?d(s(u,g),f,g+"",u,l,h):void 0;v===void 0&&(v=f),e(u,g,v)}},a)}return Ev=o,Ev}var Mv,xM;function tq(){if(xM)return Mv;xM=1;var r=vd(),e=yd();function t(n){return r(function(i,a){var s=-1,o=a.length,u=o>1?a[o-1]:void 0,l=o>2?a[2]:void 0;for(u=n.length>3&&typeof u=="function"?(o--,u):void 0,l&&e(a[0],a[1],l)&&(u=o<3?void 0:u,o=1),i=Object(i);++s<o;){var c=a[s];c&&n(i,c,s,u)}return i})}return Mv=t,Mv}var Sv,EM;function nq(){if(EM)return Sv;EM=1;var r=eq(),e=tq(),t=e(function(n,i,a){r(n,i,a)});return Sv=t,Sv}var _v,MM;function Qk(){if(MM)return _v;MM=1;function r(e,t){return e<t}return _v=r,_v}var Tv,SM;function rq(){if(SM)return Tv;SM=1;var r=r1(),e=Qk(),t=is();function n(i){return i&&i.length?r(i,t,e):void 0}return Tv=n,Tv}var Ov,_M;function iq(){if(_M)return Ov;_M=1;var r=r1(),e=ji(),t=Qk();function n(i,a){return i&&i.length?r(i,e(a,2),t):void 0}return Ov=n,Ov}var Av,TM;function aq(){if(TM)return Av;TM=1;var r=cd(),e=em(),t=dd(),n=Di(),i=Sc();function a(s,o,u,l){if(!n(s))return s;o=e(o,s);for(var c=-1,d=o.length,h=d-1,f=s;f!=null&&++c<d;){var g=i(o[c]),v=u;if(g==="__proto__"||g==="constructor"||g==="prototype")return s;if(c!=h){var p=f[g];v=l?l(p,g,f):void 0,v===void 0&&(v=n(p)?p:t(o[c+1])?[]:{})}r(f,g,v),f=f[g]}return s}return Av=a,Av}var kv,OM;function sq(){if(OM)return kv;OM=1;var r=tm(),e=aq(),t=em();function n(i,a,s){for(var o=-1,u=a.length,l={};++o<u;){var c=a[o],d=r(i,c);s(d,c)&&e(l,t(c,i),d)}return l}return kv=n,kv}var Nv,AM;function oq(){if(AM)return Nv;AM=1;var r=sq(),e=Nk();function t(n,i){return r(n,i,function(a,s){return e(n,s)})}return Nv=t,Nv}var Cv,kM;function uq(){if(kM)return Cv;kM=1;var r=Xk(),e=Bk(),t=Fk();function n(i){return t(e(i,void 0,r),i+"")}return Cv=n,Cv}var Pv,NM;function lq(){if(NM)return Pv;NM=1;var r=oq(),e=uq(),t=e(function(n,i){return n==null?{}:r(n,i)});return Pv=t,Pv}var Lv,CM;function cq(){if(CM)return Lv;CM=1;var r=Math.ceil,e=Math.max;function t(n,i,a,s){for(var o=-1,u=e(r((i-n)/(a||1)),0),l=Array(u);u--;)l[s?u:++o]=n,n+=a;return l}return Lv=t,Lv}var Dv,PM;function dq(){if(PM)return Dv;PM=1;var r=cq(),e=yd(),t=Hk();function n(i){return function(a,s,o){return o&&typeof o!="number"&&e(a,s,o)&&(s=o=void 0),a=t(a),s===void 0?(s=a,a=0):s=t(s),o=o===void 0?a<s?1:-1:t(o),r(a,s,o,i)}}return Dv=n,Dv}var Iv,LM;function hq(){if(LM)return Iv;LM=1;var r=dq(),e=r();return Iv=e,Iv}var Rv,DM;function fq(){if(DM)return Rv;DM=1;function r(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}return Rv=r,Rv}var jv,IM;function gq(){if(IM)return jv;IM=1;var r=K_();function e(t,n){if(t!==n){var i=t!==void 0,a=t===null,s=t===t,o=r(t),u=n!==void 0,l=n===null,c=n===n,d=r(n);if(!l&&!d&&!o&&t>n||o&&u&&c&&!l&&!d||a&&u&&c||!i&&c||!s)return 1;if(!a&&!o&&!d&&t<n||d&&i&&s&&!a&&!o||l&&i&&s||!u&&s||!c)return-1}return 0}return jv=e,jv}var Bv,RM;function pq(){if(RM)return Bv;RM=1;var r=gq();function e(t,n,i){for(var a=-1,s=t.criteria,o=n.criteria,u=s.length,l=i.length;++a<u;){var c=r(s[a],o[a]);if(c){if(a>=l)return c;var d=i[a];return c*(d=="desc"?-1:1)}}return t.index-n.index}return Bv=e,Bv}var Fv,jM;function vq(){if(jM)return Fv;jM=1;var r=nm(),e=tm(),t=ji(),n=Ik(),i=fq(),a=hd(),s=pq(),o=is(),u=Tn();function l(c,d,h){d.length?d=r(d,function(v){return u(v)?function(p){return e(p,v.length===1?v[0]:v)}:v}):d=[o];var f=-1;d=r(d,a(t));var g=n(c,function(v,p,y){var m=r(d,function(w){return w(v)});return{criteria:m,index:++f,value:v}});return i(g,function(v,p){return s(v,p,h)})}return Fv=l,Fv}var zv,BM;function yq(){if(BM)return zv;BM=1;var r=t1(),e=vq(),t=vd(),n=yd(),i=t(function(a,s){if(a==null)return[];var o=s.length;return o>1&&n(a,s[0],s[1])?s=[]:o>2&&n(s[0],s[1],s[2])&&(s=[s[0]]),e(a,r(s,1),[])});return zv=i,zv}var $v,FM;function mq(){if(FM)return $v;FM=1;var r=VC(),e=0;function t(n){var i=++e;return r(n)+i}return $v=t,$v}var qv,zM;function bq(){if(zM)return qv;zM=1;function r(e,t,n){for(var i=-1,a=e.length,s=t.length,o={};++i<a;){var u=i<s?t[i]:void 0;n(o,e[i],u)}return o}return qv=r,qv}var Gv,$M;function wq(){if($M)return Gv;$M=1;var r=cd(),e=bq();function t(n,i){return e(n||[],i||[],r)}return Gv=t,Gv}var Wv,qM;function Pt(){if(qM)return Wv;qM=1;var r;if(typeof Qy=="function")try{r={cloneDeep:z$(),constant:Zm(),defaults:$$(),each:Ek(),filter:Pk(),find:V$(),flatten:Xk(),forEach:xk(),forIn:Y$(),has:Lk(),isUndefined:Dk(),last:U$(),map:Rk(),mapValues:H$(),max:K$(),merge:nq(),min:rq(),minBy:iq(),now:HC(),pick:lq(),range:hq(),reduce:jk(),sortBy:yq(),uniqueId:mq(),values:qk(),zipObject:wq()}}catch{}return r||(r=window._),Wv=r,Wv}var Vv,GM;function xq(){if(GM)return Vv;GM=1,Vv=r;function r(){var n={};n._next=n._prev=n,this._sentinel=n}r.prototype.dequeue=function(){var n=this._sentinel,i=n._prev;if(i!==n)return e(i),i},r.prototype.enqueue=function(n){var i=this._sentinel;n._prev&&n._next&&e(n),n._next=i._next,i._next._prev=n,i._next=n,n._prev=i},r.prototype.toString=function(){for(var n=[],i=this._sentinel,a=i._prev;a!==i;)n.push(JSON.stringify(a,t)),a=a._prev;return"["+n.join(", ")+"]"};function e(n){n._prev._next=n._next,n._next._prev=n._prev,delete n._next,delete n._prev}function t(n,i){if(n!=="_next"&&n!=="_prev")return i}return Vv}var Yv,WM;function Eq(){if(WM)return Yv;WM=1;var r=Pt(),e=Gr().Graph,t=xq();Yv=i;var n=r.constant(1);function i(l,c){if(l.nodeCount()<=1)return[];var d=o(l,c||n),h=a(d.graph,d.buckets,d.zeroIdx);return r.flatten(r.map(h,function(f){return l.outEdges(f.v,f.w)}),!0)}function a(l,c,d){for(var h=[],f=c[c.length-1],g=c[0],v;l.nodeCount();){for(;v=g.dequeue();)s(l,c,d,v);for(;v=f.dequeue();)s(l,c,d,v);if(l.nodeCount()){for(var p=c.length-2;p>0;--p)if(v=c[p].dequeue(),v){h=h.concat(s(l,c,d,v,!0));break}}}return h}function s(l,c,d,h,f){var g=f?[]:void 0;return r.forEach(l.inEdges(h.v),function(v){var p=l.edge(v),y=l.node(v.v);f&&g.push({v:v.v,w:v.w}),y.out-=p,u(c,d,y)}),r.forEach(l.outEdges(h.v),function(v){var p=l.edge(v),y=v.w,m=l.node(y);m.in-=p,u(c,d,m)}),l.removeNode(h.v),g}function o(l,c){var d=new e,h=0,f=0;r.forEach(l.nodes(),function(p){d.setNode(p,{v:p,in:0,out:0})}),r.forEach(l.edges(),function(p){var y=d.edge(p.v,p.w)||0,m=c(p),w=y+m;d.setEdge(p.v,p.w,w),f=Math.max(f,d.node(p.v).out+=m),h=Math.max(h,d.node(p.w).in+=m)});var g=r.range(f+h+3).map(function(){return new t}),v=h+1;return r.forEach(d.nodes(),function(p){u(g,v,d.node(p))}),{graph:d,buckets:g,zeroIdx:v}}function u(l,c,d){d.out?d.in?l[d.out-d.in+c].enqueue(d):l[l.length-1].enqueue(d):l[0].enqueue(d)}return Yv}var Uv,VM;function Mq(){if(VM)return Uv;VM=1;var r=Pt(),e=Eq();Uv={run:t,undo:i};function t(a){var s=a.graph().acyclicer==="greedy"?e(a,o(a)):n(a);r.forEach(s,function(u){var l=a.edge(u);a.removeEdge(u),l.forwardName=u.name,l.reversed=!0,a.setEdge(u.w,u.v,l,r.uniqueId("rev"))});function o(u){return function(l){return u.edge(l).weight}}}function n(a){var s=[],o={},u={};function l(c){r.has(u,c)||(u[c]=!0,o[c]=!0,r.forEach(a.outEdges(c),function(d){r.has(o,d.w)?s.push(d):l(d.w)}),delete o[c])}return r.forEach(a.nodes(),l),s}function i(a){r.forEach(a.edges(),function(s){var o=a.edge(s);if(o.reversed){a.removeEdge(s);var u=o.forwardName;delete o.reversed,delete o.forwardName,a.setEdge(s.w,s.v,o,u)}})}return Uv}var Hv,YM;function tr(){if(YM)return Hv;YM=1;var r=Pt(),e=Gr().Graph;Hv={addDummyNode:t,simplify:n,asNonCompoundGraph:i,successorWeights:a,predecessorWeights:s,intersectRect:o,buildLayerMatrix:u,normalizeRanks:l,removeEmptyRanks:c,addBorderNode:d,maxRank:h,partition:f,time:g,notime:v};function t(p,y,m,w){var M;do M=r.uniqueId(w);while(p.hasNode(M));return m.dummy=y,p.setNode(M,m),M}function n(p){var y=new e().setGraph(p.graph());return r.forEach(p.nodes(),function(m){y.setNode(m,p.node(m))}),r.forEach(p.edges(),function(m){var w=y.edge(m.v,m.w)||{weight:0,minlen:1},M=p.edge(m);y.setEdge(m.v,m.w,{weight:w.weight+M.weight,minlen:Math.max(w.minlen,M.minlen)})}),y}function i(p){var y=new e({multigraph:p.isMultigraph()}).setGraph(p.graph());return r.forEach(p.nodes(),function(m){p.children(m).length||y.setNode(m,p.node(m))}),r.forEach(p.edges(),function(m){y.setEdge(m,p.edge(m))}),y}function a(p){var y=r.map(p.nodes(),function(m){var w={};return r.forEach(p.outEdges(m),function(M){w[M.w]=(w[M.w]||0)+p.edge(M).weight}),w});return r.zipObject(p.nodes(),y)}function s(p){var y=r.map(p.nodes(),function(m){var w={};return r.forEach(p.inEdges(m),function(M){w[M.v]=(w[M.v]||0)+p.edge(M).weight}),w});return r.zipObject(p.nodes(),y)}function o(p,y){var m=p.x,w=p.y,M=y.x-m,S=y.y-w,T=p.width/2,A=p.height/2;if(!M&&!S)throw new Error("Not possible to find intersection inside of the rectangle");var O,N;return Math.abs(S)*T>Math.abs(M)*A?(S<0&&(A=-A),O=A*M/S,N=A):(M<0&&(T=-T),O=T,N=T*S/M),{x:m+O,y:w+N}}function u(p){var y=r.map(r.range(h(p)+1),function(){return[]});return r.forEach(p.nodes(),function(m){var w=p.node(m),M=w.rank;r.isUndefined(M)||(y[M][w.order]=m)}),y}function l(p){var y=r.min(r.map(p.nodes(),function(m){return p.node(m).rank}));r.forEach(p.nodes(),function(m){var w=p.node(m);r.has(w,"rank")&&(w.rank-=y)})}function c(p){var y=r.min(r.map(p.nodes(),function(S){return p.node(S).rank})),m=[];r.forEach(p.nodes(),function(S){var T=p.node(S).rank-y;m[T]||(m[T]=[]),m[T].push(S)});var w=0,M=p.graph().nodeRankFactor;r.forEach(m,function(S,T){r.isUndefined(S)&&T%M!==0?--w:w&&r.forEach(S,function(A){p.node(A).rank+=w})})}function d(p,y,m,w){var M={width:0,height:0};return arguments.length>=4&&(M.rank=m,M.order=w),t(p,"border",M,y)}function h(p){return r.max(r.map(p.nodes(),function(y){var m=p.node(y).rank;if(!r.isUndefined(m))return m}))}function f(p,y){var m={lhs:[],rhs:[]};return r.forEach(p,function(w){y(w)?m.lhs.push(w):m.rhs.push(w)}),m}function g(p,y){var m=r.now();try{return y()}finally{console.log(p+" time: "+(r.now()-m)+"ms")}}function v(p,y){return y()}return Hv}var Xv,UM;function Sq(){if(UM)return Xv;UM=1;var r=Pt(),e=tr();Xv={run:t,undo:i};function t(a){a.graph().dummyChains=[],r.forEach(a.edges(),function(s){n(a,s)})}function n(a,s){var o=s.v,u=a.node(o).rank,l=s.w,c=a.node(l).rank,d=s.name,h=a.edge(s),f=h.labelRank;if(c!==u+1){a.removeEdge(s);var g,v,p;for(p=0,++u;u<c;++p,++u)h.points=[],v={width:0,height:0,edgeLabel:h,edgeObj:s,rank:u},g=e.addDummyNode(a,"edge",v,"_d"),u===f&&(v.width=h.width,v.height=h.height,v.dummy="edge-label",v.labelpos=h.labelpos),a.setEdge(o,g,{weight:h.weight},d),p===0&&a.graph().dummyChains.push(g),o=g;a.setEdge(o,l,{weight:h.weight},d)}}function i(a){r.forEach(a.graph().dummyChains,function(s){var o=a.node(s),u=o.edgeLabel,l;for(a.setEdge(o.edgeObj,u);o.dummy;)l=a.successors(s)[0],a.removeNode(s),u.points.push({x:o.x,y:o.y}),o.dummy==="edge-label"&&(u.x=o.x,u.y=o.y,u.width=o.width,u.height=o.height),s=l,o=a.node(s)})}return Xv}var Kv,HM;function gc(){if(HM)return Kv;HM=1;var r=Pt();Kv={longestPath:e,slack:t};function e(n){var i={};function a(s){var o=n.node(s);if(r.has(i,s))return o.rank;i[s]=!0;var u=r.min(r.map(n.outEdges(s),function(l){return a(l.w)-n.edge(l).minlen}));return(u===Number.POSITIVE_INFINITY||u===void 0||u===null)&&(u=0),o.rank=u}r.forEach(n.sources(),a)}function t(n,i){return n.node(i.w).rank-n.node(i.v).rank-n.edge(i).minlen}return Kv}var Zv,XM;function Jk(){if(XM)return Zv;XM=1;var r=Pt(),e=Gr().Graph,t=gc().slack;Zv=n;function n(o){var u=new e({directed:!1}),l=o.nodes()[0],c=o.nodeCount();u.setNode(l,{});for(var d,h;i(u,o)<c;)d=a(u,o),h=u.hasNode(d.v)?t(o,d):-t(o,d),s(u,o,h);return u}function i(o,u){function l(c){r.forEach(u.nodeEdges(c),function(d){var h=d.v,f=c===h?d.w:h;!o.hasNode(f)&&!t(u,d)&&(o.setNode(f,{}),o.setEdge(c,f,{}),l(f))})}return r.forEach(o.nodes(),l),o.nodeCount()}function a(o,u){return r.minBy(u.edges(),function(l){if(o.hasNode(l.v)!==o.hasNode(l.w))return t(u,l)})}function s(o,u,l){r.forEach(o.nodes(),function(c){u.node(c).rank+=l})}return Zv}var Qv,KM;function _q(){if(KM)return Qv;KM=1;var r=Pt(),e=Jk(),t=gc().slack,n=gc().longestPath,i=Gr().alg.preorder,a=Gr().alg.postorder,s=tr().simplify;Qv=o,o.initLowLimValues=d,o.initCutValues=u,o.calcCutValue=c,o.leaveEdge=f,o.enterEdge=g,o.exchangeEdges=v;function o(w){w=s(w),n(w);var M=e(w);d(M),u(M,w);for(var S,T;S=f(M);)T=g(M,w,S),v(M,w,S,T)}function u(w,M){var S=a(w,w.nodes());S=S.slice(0,S.length-1),r.forEach(S,function(T){l(w,M,T)})}function l(w,M,S){var T=w.node(S),A=T.parent;w.edge(S,A).cutvalue=c(w,M,S)}function c(w,M,S){var T=w.node(S),A=T.parent,O=!0,N=M.edge(S,A),C=0;return N||(O=!1,N=M.edge(A,S)),C=N.weight,r.forEach(M.nodeEdges(S),function(P){var D=P.v===S,j=D?P.w:P.v;if(j!==A){var G=D===O,V=M.edge(P).weight;if(C+=G?V:-V,y(w,S,j)){var Y=w.edge(S,j).cutvalue;C+=G?-Y:Y}}}),C}function d(w,M){arguments.length<2&&(M=w.nodes()[0]),h(w,{},1,M)}function h(w,M,S,T,A){var O=S,N=w.node(T);return M[T]=!0,r.forEach(w.neighbors(T),function(C){r.has(M,C)||(S=h(w,M,S,C,T))}),N.low=O,N.lim=S++,A?N.parent=A:delete N.parent,S}function f(w){return r.find(w.edges(),function(M){return w.edge(M).cutvalue<0})}function g(w,M,S){var T=S.v,A=S.w;M.hasEdge(T,A)||(T=S.w,A=S.v);var O=w.node(T),N=w.node(A),C=O,P=!1;O.lim>N.lim&&(C=N,P=!0);var D=r.filter(M.edges(),function(j){return P===m(w,w.node(j.v),C)&&P!==m(w,w.node(j.w),C)});return r.minBy(D,function(j){return t(M,j)})}function v(w,M,S,T){var A=S.v,O=S.w;w.removeEdge(A,O),w.setEdge(T.v,T.w,{}),d(w),u(w,M),p(w,M)}function p(w,M){var S=r.find(w.nodes(),function(A){return!M.node(A).parent}),T=i(w,S);T=T.slice(1),r.forEach(T,function(A){var O=w.node(A).parent,N=M.edge(A,O),C=!1;N||(N=M.edge(O,A),C=!0),M.node(A).rank=M.node(O).rank+(C?N.minlen:-N.minlen)})}function y(w,M,S){return w.hasEdge(M,S)}function m(w,M,S){return S.low<=M.lim&&M.lim<=S.lim}return Qv}var Jv,ZM;function Tq(){if(ZM)return Jv;ZM=1;var r=gc(),e=r.longestPath,t=Jk(),n=_q();Jv=i;function i(u){switch(u.graph().ranker){case"network-simplex":o(u);break;case"tight-tree":s(u);break;case"longest-path":a(u);break;default:o(u)}}var a=e;function s(u){e(u),t(u)}function o(u){n(u)}return Jv}var e0,QM;function Oq(){if(QM)return e0;QM=1;var r=Pt();e0=e;function e(i){var a=n(i);r.forEach(i.graph().dummyChains,function(s){for(var o=i.node(s),u=o.edgeObj,l=t(i,a,u.v,u.w),c=l.path,d=l.lca,h=0,f=c[h],g=!0;s!==u.w;){if(o=i.node(s),g){for(;(f=c[h])!==d&&i.node(f).maxRank<o.rank;)h++;f===d&&(g=!1)}if(!g){for(;h<c.length-1&&i.node(f=c[h+1]).minRank<=o.rank;)h++;f=c[h]}i.setParent(s,f),s=i.successors(s)[0]}})}function t(i,a,s,o){var u=[],l=[],c=Math.min(a[s].low,a[o].low),d=Math.max(a[s].lim,a[o].lim),h,f;h=s;do h=i.parent(h),u.push(h);while(h&&(a[h].low>c||d>a[h].lim));for(f=h,h=o;(h=i.parent(h))!==f;)l.push(h);return{path:u.concat(l.reverse()),lca:f}}function n(i){var a={},s=0;function o(u){var l=s;r.forEach(i.children(u),o),a[u]={low:l,lim:s++}}return r.forEach(i.children(),o),a}return e0}var t0,JM;function Aq(){if(JM)return t0;JM=1;var r=Pt(),e=tr();t0={run:t,cleanup:s};function t(o){var u=e.addDummyNode(o,"root",{},"_root"),l=i(o),c=r.max(r.values(l))-1,d=2*c+1;o.graph().nestingRoot=u,r.forEach(o.edges(),function(f){o.edge(f).minlen*=d});var h=a(o)+1;r.forEach(o.children(),function(f){n(o,u,d,h,c,l,f)}),o.graph().nodeRankFactor=d}function n(o,u,l,c,d,h,f){var g=o.children(f);if(!g.length){f!==u&&o.setEdge(u,f,{weight:0,minlen:l});return}var v=e.addBorderNode(o,"_bt"),p=e.addBorderNode(o,"_bb"),y=o.node(f);o.setParent(v,f),y.borderTop=v,o.setParent(p,f),y.borderBottom=p,r.forEach(g,function(m){n(o,u,l,c,d,h,m);var w=o.node(m),M=w.borderTop?w.borderTop:m,S=w.borderBottom?w.borderBottom:m,T=w.borderTop?c:2*c,A=M!==S?1:d-h[f]+1;o.setEdge(v,M,{weight:T,minlen:A,nestingEdge:!0}),o.setEdge(S,p,{weight:T,minlen:A,nestingEdge:!0})}),o.parent(f)||o.setEdge(u,v,{weight:0,minlen:d+h[f]})}function i(o){var u={};function l(c,d){var h=o.children(c);h&&h.length&&r.forEach(h,function(f){l(f,d+1)}),u[c]=d}return r.forEach(o.children(),function(c){l(c,1)}),u}function a(o){return r.reduce(o.edges(),function(u,l){return u+o.edge(l).weight},0)}function s(o){var u=o.graph();o.removeNode(u.nestingRoot),delete u.nestingRoot,r.forEach(o.edges(),function(l){var c=o.edge(l);c.nestingEdge&&o.removeEdge(l)})}return t0}var n0,eS;function kq(){if(eS)return n0;eS=1;var r=Pt(),e=tr();n0=t;function t(i){function a(s){var o=i.children(s),u=i.node(s);if(o.length&&r.forEach(o,a),r.has(u,"minRank")){u.borderLeft=[],u.borderRight=[];for(var l=u.minRank,c=u.maxRank+1;l<c;++l)n(i,"borderLeft","_bl",s,u,l),n(i,"borderRight","_br",s,u,l)}}r.forEach(i.children(),a)}function n(i,a,s,o,u,l){var c={width:0,height:0,rank:l,borderType:a},d=u[a][l-1],h=e.addDummyNode(i,"border",c,s);u[a][l]=h,i.setParent(h,o),d&&i.setEdge(d,h,{weight:1})}return n0}var r0,tS;function Nq(){if(tS)return r0;tS=1;var r=Pt();r0={adjust:e,undo:t};function e(l){var c=l.graph().rankdir.toLowerCase();(c==="lr"||c==="rl")&&n(l)}function t(l){var c=l.graph().rankdir.toLowerCase();(c==="bt"||c==="rl")&&a(l),(c==="lr"||c==="rl")&&(o(l),n(l))}function n(l){r.forEach(l.nodes(),function(c){i(l.node(c))}),r.forEach(l.edges(),function(c){i(l.edge(c))})}function i(l){var c=l.width;l.width=l.height,l.height=c}function a(l){r.forEach(l.nodes(),function(c){s(l.node(c))}),r.forEach(l.edges(),function(c){var d=l.edge(c);r.forEach(d.points,s),r.has(d,"y")&&s(d)})}function s(l){l.y=-l.y}function o(l){r.forEach(l.nodes(),function(c){u(l.node(c))}),r.forEach(l.edges(),function(c){var d=l.edge(c);r.forEach(d.points,u),r.has(d,"x")&&u(d)})}function u(l){var c=l.x;l.x=l.y,l.y=c}return r0}var i0,nS;function Cq(){if(nS)return i0;nS=1;var r=Pt();i0=e;function e(t){var n={},i=r.filter(t.nodes(),function(l){return!t.children(l).length}),a=r.max(r.map(i,function(l){return t.node(l).rank})),s=r.map(r.range(a+1),function(){return[]});function o(l){if(!r.has(n,l)){n[l]=!0;var c=t.node(l);s[c.rank].push(l),r.forEach(t.successors(l),o)}}var u=r.sortBy(i,function(l){return t.node(l).rank});return r.forEach(u,o),s}return i0}var a0,rS;function Pq(){if(rS)return a0;rS=1;var r=Pt();a0=e;function e(n,i){for(var a=0,s=1;s<i.length;++s)a+=t(n,i[s-1],i[s]);return a}function t(n,i,a){for(var s=r.zipObject(a,r.map(a,function(h,f){return f})),o=r.flatten(r.map(i,function(h){return r.sortBy(r.map(n.outEdges(h),function(f){return{pos:s[f.w],weight:n.edge(f).weight}}),"pos")}),!0),u=1;u<a.length;)u<<=1;var l=2*u-1;u-=1;var c=r.map(new Array(l),function(){return 0}),d=0;return r.forEach(o.forEach(function(h){var f=h.pos+u;c[f]+=h.weight;for(var g=0;f>0;)f%2&&(g+=c[f+1]),f=f-1>>1,c[f]+=h.weight;d+=h.weight*g})),d}return a0}var s0,iS;function Lq(){if(iS)return s0;iS=1;var r=Pt();s0=e;function e(t,n){return r.map(n,function(i){var a=t.inEdges(i);if(a.length){var s=r.reduce(a,function(o,u){var l=t.edge(u),c=t.node(u.v);return{sum:o.sum+l.weight*c.order,weight:o.weight+l.weight}},{sum:0,weight:0});return{v:i,barycenter:s.sum/s.weight,weight:s.weight}}else return{v:i}})}return s0}var o0,aS;function Dq(){if(aS)return o0;aS=1;var r=Pt();o0=e;function e(i,a){var s={};r.forEach(i,function(u,l){var c=s[u.v]={indegree:0,in:[],out:[],vs:[u.v],i:l};r.isUndefined(u.barycenter)||(c.barycenter=u.barycenter,c.weight=u.weight)}),r.forEach(a.edges(),function(u){var l=s[u.v],c=s[u.w];!r.isUndefined(l)&&!r.isUndefined(c)&&(c.indegree++,l.out.push(s[u.w]))});var o=r.filter(s,function(u){return!u.indegree});return t(o)}function t(i){var a=[];function s(l){return function(c){c.merged||(r.isUndefined(c.barycenter)||r.isUndefined(l.barycenter)||c.barycenter>=l.barycenter)&&n(l,c)}}function o(l){return function(c){c.in.push(l),--c.indegree===0&&i.push(c)}}for(;i.length;){var u=i.pop();a.push(u),r.forEach(u.in.reverse(),s(u)),r.forEach(u.out,o(u))}return r.map(r.filter(a,function(l){return!l.merged}),function(l){return r.pick(l,["vs","i","barycenter","weight"])})}function n(i,a){var s=0,o=0;i.weight&&(s+=i.barycenter*i.weight,o+=i.weight),a.weight&&(s+=a.barycenter*a.weight,o+=a.weight),i.vs=a.vs.concat(i.vs),i.barycenter=s/o,i.weight=o,i.i=Math.min(a.i,i.i),a.merged=!0}return o0}var u0,sS;function Iq(){if(sS)return u0;sS=1;var r=Pt(),e=tr();u0=t;function t(a,s){var o=e.partition(a,function(v){return r.has(v,"barycenter")}),u=o.lhs,l=r.sortBy(o.rhs,function(v){return-v.i}),c=[],d=0,h=0,f=0;u.sort(i(!!s)),f=n(c,l,f),r.forEach(u,function(v){f+=v.vs.length,c.push(v.vs),d+=v.barycenter*v.weight,h+=v.weight,f=n(c,l,f)});var g={vs:r.flatten(c,!0)};return h&&(g.barycenter=d/h,g.weight=h),g}function n(a,s,o){for(var u;s.length&&(u=r.last(s)).i<=o;)s.pop(),a.push(u.vs),o++;return o}function i(a){return function(s,o){return s.barycenter<o.barycenter?-1:s.barycenter>o.barycenter?1:a?o.i-s.i:s.i-o.i}}return u0}var l0,oS;function Rq(){if(oS)return l0;oS=1;var r=Pt(),e=Lq(),t=Dq(),n=Iq();l0=i;function i(o,u,l,c){var d=o.children(u),h=o.node(u),f=h?h.borderLeft:void 0,g=h?h.borderRight:void 0,v={};f&&(d=r.filter(d,function(S){return S!==f&&S!==g}));var p=e(o,d);r.forEach(p,function(S){if(o.children(S.v).length){var T=i(o,S.v,l,c);v[S.v]=T,r.has(T,"barycenter")&&s(S,T)}});var y=t(p,l);a(y,v);var m=n(y,c);if(f&&(m.vs=r.flatten([f,m.vs,g],!0),o.predecessors(f).length)){var w=o.node(o.predecessors(f)[0]),M=o.node(o.predecessors(g)[0]);r.has(m,"barycenter")||(m.barycenter=0,m.weight=0),m.barycenter=(m.barycenter*m.weight+w.order+M.order)/(m.weight+2),m.weight+=2}return m}function a(o,u){r.forEach(o,function(l){l.vs=r.flatten(l.vs.map(function(c){return u[c]?u[c].vs:c}),!0)})}function s(o,u){r.isUndefined(o.barycenter)?(o.barycenter=u.barycenter,o.weight=u.weight):(o.barycenter=(o.barycenter*o.weight+u.barycenter*u.weight)/(o.weight+u.weight),o.weight+=u.weight)}return l0}var c0,uS;function jq(){if(uS)return c0;uS=1;var r=Pt(),e=Gr().Graph;c0=t;function t(i,a,s){var o=n(i),u=new e({compound:!0}).setGraph({root:o}).setDefaultNodeLabel(function(l){return i.node(l)});return r.forEach(i.nodes(),function(l){var c=i.node(l),d=i.parent(l);(c.rank===a||c.minRank<=a&&a<=c.maxRank)&&(u.setNode(l),u.setParent(l,d||o),r.forEach(i[s](l),function(h){var f=h.v===l?h.w:h.v,g=u.edge(f,l),v=r.isUndefined(g)?0:g.weight;u.setEdge(f,l,{weight:i.edge(h).weight+v})}),r.has(c,"minRank")&&u.setNode(l,{borderLeft:c.borderLeft[a],borderRight:c.borderRight[a]}))}),u}function n(i){for(var a;i.hasNode(a=r.uniqueId("_root")););return a}return c0}var d0,lS;function Bq(){if(lS)return d0;lS=1;var r=Pt();d0=e;function e(t,n,i){var a={},s;r.forEach(i,function(o){for(var u=t.parent(o),l,c;u;){if(l=t.parent(u),l?(c=a[l],a[l]=u):(c=s,s=u),c&&c!==u){n.setEdge(c,u);return}u=l}})}return d0}var h0,cS;function Fq(){if(cS)return h0;cS=1;var r=Pt(),e=Cq(),t=Pq(),n=Rq(),i=jq(),a=Bq(),s=Gr().Graph,o=tr();h0=u;function u(h){var f=o.maxRank(h),g=l(h,r.range(1,f+1),"inEdges"),v=l(h,r.range(f-1,-1,-1),"outEdges"),p=e(h);d(h,p);for(var y=Number.POSITIVE_INFINITY,m,w=0,M=0;M<4;++w,++M){c(w%2?g:v,w%4>=2),p=o.buildLayerMatrix(h);var S=t(h,p);S<y&&(M=0,m=r.cloneDeep(p),y=S)}d(h,m)}function l(h,f,g){return r.map(f,function(v){return i(h,v,g)})}function c(h,f){var g=new s;r.forEach(h,function(v){var p=v.graph().root,y=n(v,p,g,f);r.forEach(y.vs,function(m,w){v.node(m).order=w}),a(v,g,y.vs)})}function d(h,f){r.forEach(f,function(g){r.forEach(g,function(v,p){h.node(v).order=p})})}return h0}var f0,dS;function zq(){if(dS)return f0;dS=1;var r=Pt(),e=Gr().Graph,t=tr();f0={positionX:g,findType1Conflicts:n,findType2Conflicts:i,addConflict:s,hasConflict:o,verticalAlignment:u,horizontalCompaction:l,alignCoordinates:h,findSmallestWidthAlignment:d,balance:f};function n(y,m){var w={};function M(S,T){var A=0,O=0,N=S.length,C=r.last(T);return r.forEach(T,function(P,D){var j=a(y,P),G=j?y.node(j).order:N;(j||P===C)&&(r.forEach(T.slice(O,D+1),function(V){r.forEach(y.predecessors(V),function(Y){var $=y.node(Y),z=$.order;(z<A||G<z)&&!($.dummy&&y.node(V).dummy)&&s(w,Y,V)})}),O=D+1,A=G)}),T}return r.reduce(m,M),w}function i(y,m){var w={};function M(T,A,O,N,C){var P;r.forEach(r.range(A,O),function(D){P=T[D],y.node(P).dummy&&r.forEach(y.predecessors(P),function(j){var G=y.node(j);G.dummy&&(G.order<N||G.order>C)&&s(w,j,P)})})}function S(T,A){var O=-1,N,C=0;return r.forEach(A,function(P,D){if(y.node(P).dummy==="border"){var j=y.predecessors(P);j.length&&(N=y.node(j[0]).order,M(A,C,D,O,N),C=D,O=N)}M(A,C,A.length,N,T.length)}),A}return r.reduce(m,S),w}function a(y,m){if(y.node(m).dummy)return r.find(y.predecessors(m),function(w){return y.node(w).dummy})}function s(y,m,w){if(m>w){var M=m;m=w,w=M}var S=y[m];S||(y[m]=S={}),S[w]=!0}function o(y,m,w){if(m>w){var M=m;m=w,w=M}return r.has(y[m],w)}function u(y,m,w,M){var S={},T={},A={};return r.forEach(m,function(O){r.forEach(O,function(N,C){S[N]=N,T[N]=N,A[N]=C})}),r.forEach(m,function(O){var N=-1;r.forEach(O,function(C){var P=M(C);if(P.length){P=r.sortBy(P,function(Y){return A[Y]});for(var D=(P.length-1)/2,j=Math.floor(D),G=Math.ceil(D);j<=G;++j){var V=P[j];T[C]===C&&N<A[V]&&!o(w,C,V)&&(T[V]=C,T[C]=S[C]=S[V],N=A[V])}}})}),{root:S,align:T}}function l(y,m,w,M,S){var T={},A=c(y,m,w,S),O=S?"borderLeft":"borderRight";function N(D,j){for(var G=A.nodes(),V=G.pop(),Y={};V;)Y[V]?D(V):(Y[V]=!0,G.push(V),G=G.concat(j(V))),V=G.pop()}function C(D){T[D]=A.inEdges(D).reduce(function(j,G){return Math.max(j,T[G.v]+A.edge(G))},0)}function P(D){var j=A.outEdges(D).reduce(function(V,Y){return Math.min(V,T[Y.w]-A.edge(Y))},Number.POSITIVE_INFINITY),G=y.node(D);j!==Number.POSITIVE_INFINITY&&G.borderType!==O&&(T[D]=Math.max(T[D],j))}return N(C,A.predecessors.bind(A)),N(P,A.successors.bind(A)),r.forEach(M,function(D){T[D]=T[w[D]]}),T}function c(y,m,w,M){var S=new e,T=y.graph(),A=v(T.nodesep,T.edgesep,M);return r.forEach(m,function(O){var N;r.forEach(O,function(C){var P=w[C];if(S.setNode(P),N){var D=w[N],j=S.edge(D,P);S.setEdge(D,P,Math.max(A(y,C,N),j||0))}N=C})}),S}function d(y,m){return r.minBy(r.values(m),function(w){var M=Number.NEGATIVE_INFINITY,S=Number.POSITIVE_INFINITY;return r.forIn(w,function(T,A){var O=p(y,A)/2;M=Math.max(T+O,M),S=Math.min(T-O,S)}),M-S})}function h(y,m){var w=r.values(m),M=r.min(w),S=r.max(w);r.forEach(["u","d"],function(T){r.forEach(["l","r"],function(A){var O=T+A,N=y[O],C;if(N!==m){var P=r.values(N);C=A==="l"?M-r.min(P):S-r.max(P),C&&(y[O]=r.mapValues(N,function(D){return D+C}))}})})}function f(y,m){return r.mapValues(y.ul,function(w,M){if(m)return y[m.toLowerCase()][M];var S=r.sortBy(r.map(y,M));return(S[1]+S[2])/2})}function g(y){var m=t.buildLayerMatrix(y),w=r.merge(n(y,m),i(y,m)),M={},S;r.forEach(["u","d"],function(A){S=A==="u"?m:r.values(m).reverse(),r.forEach(["l","r"],function(O){O==="r"&&(S=r.map(S,function(D){return r.values(D).reverse()}));var N=(A==="u"?y.predecessors:y.successors).bind(y),C=u(y,S,w,N),P=l(y,S,C.root,C.align,O==="r");O==="r"&&(P=r.mapValues(P,function(D){return-D})),M[A+O]=P})});var T=d(y,M);return h(M,T),f(M,y.graph().align)}function v(y,m,w){return function(M,S,T){var A=M.node(S),O=M.node(T),N=0,C;if(N+=A.width/2,r.has(A,"labelpos"))switch(A.labelpos.toLowerCase()){case"l":C=-A.width/2;break;case"r":C=A.width/2;break}if(C&&(N+=w?C:-C),C=0,N+=(A.dummy?m:y)/2,N+=(O.dummy?m:y)/2,N+=O.width/2,r.has(O,"labelpos"))switch(O.labelpos.toLowerCase()){case"l":C=O.width/2;break;case"r":C=-O.width/2;break}return C&&(N+=w?C:-C),C=0,N}}function p(y,m){return y.node(m).width}return f0}var g0,hS;function $q(){if(hS)return g0;hS=1;var r=Pt(),e=tr(),t=zq().positionX;g0=n;function n(a){a=e.asNonCompoundGraph(a),i(a),r.forEach(t(a),function(s,o){a.node(o).x=s})}function i(a){var s=e.buildLayerMatrix(a),o=a.graph().ranksep,u=0;r.forEach(s,function(l){var c=r.max(r.map(l,function(d){return a.node(d).height}));r.forEach(l,function(d){a.node(d).y=u+c/2}),u+=c+o})}return g0}var p0,fS;function qq(){if(fS)return p0;fS=1;var r=Pt(),e=Mq(),t=Sq(),n=Tq(),i=tr().normalizeRanks,a=Oq(),s=tr().removeEmptyRanks,o=Aq(),u=kq(),l=Nq(),c=Fq(),d=$q(),h=tr(),f=Gr().Graph;p0=g;function g(K,W){var ee=W&&W.debugTiming?h.time:h.notime;ee("layout",function(){var le=ee("  buildLayoutGraph",function(){return N(K)});ee("  runLayout",function(){v(le,ee)}),ee("  updateInputGraph",function(){p(K,le)})})}function v(K,W){W("    makeSpaceForEdgeLabels",function(){C(K)}),W("    removeSelfEdges",function(){Z(K)}),W("    acyclic",function(){e.run(K)}),W("    nestingGraph.run",function(){o.run(K)}),W("    rank",function(){n(h.asNonCompoundGraph(K))}),W("    injectEdgeLabelProxies",function(){P(K)}),W("    removeEmptyRanks",function(){s(K)}),W("    nestingGraph.cleanup",function(){o.cleanup(K)}),W("    normalizeRanks",function(){i(K)}),W("    assignRankMinMax",function(){D(K)}),W("    removeEdgeLabelProxies",function(){j(K)}),W("    normalize.run",function(){t.run(K)}),W("    parentDummyChains",function(){a(K)}),W("    addBorderSegments",function(){u(K)}),W("    order",function(){c(K)}),W("    insertSelfEdges",function(){ne(K)}),W("    adjustCoordinateSystem",function(){l.adjust(K)}),W("    position",function(){d(K)}),W("    positionSelfEdges",function(){se(K)}),W("    removeBorderNodes",function(){z(K)}),W("    normalize.undo",function(){t.undo(K)}),W("    fixupEdgeLabelCoords",function(){Y(K)}),W("    undoCoordinateSystem",function(){l.undo(K)}),W("    translateGraph",function(){G(K)}),W("    assignNodeIntersects",function(){V(K)}),W("    reversePoints",function(){$(K)}),W("    acyclic.undo",function(){e.undo(K)})}function p(K,W){r.forEach(K.nodes(),function(ee){var le=K.node(ee),xe=W.node(ee);le&&(le.x=xe.x,le.y=xe.y,W.children(ee).length&&(le.width=xe.width,le.height=xe.height))}),r.forEach(K.edges(),function(ee){var le=K.edge(ee),xe=W.edge(ee);le.points=xe.points,r.has(xe,"x")&&(le.x=xe.x,le.y=xe.y)}),K.graph().width=W.graph().width,K.graph().height=W.graph().height}var y=["nodesep","edgesep","ranksep","marginx","marginy"],m={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},w=["acyclicer","ranker","rankdir","align"],M=["width","height"],S={width:0,height:0},T=["minlen","weight","width","height","labeloffset"],A={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},O=["labelpos"];function N(K){var W=new f({multigraph:!0,compound:!0}),ee=Ne(K.graph());return W.setGraph(r.merge({},m,oe(ee,y),r.pick(ee,w))),r.forEach(K.nodes(),function(le){var xe=Ne(K.node(le));W.setNode(le,r.defaults(oe(xe,M),S)),W.setParent(le,K.parent(le))}),r.forEach(K.edges(),function(le){var xe=Ne(K.edge(le));W.setEdge(le,r.merge({},A,oe(xe,T),r.pick(xe,O)))}),W}function C(K){var W=K.graph();W.ranksep/=2,r.forEach(K.edges(),function(ee){var le=K.edge(ee);le.minlen*=2,le.labelpos.toLowerCase()!=="c"&&(W.rankdir==="TB"||W.rankdir==="BT"?le.width+=le.labeloffset:le.height+=le.labeloffset)})}function P(K){r.forEach(K.edges(),function(W){var ee=K.edge(W);if(ee.width&&ee.height){var le=K.node(W.v),xe=K.node(W.w),Ce={rank:(xe.rank-le.rank)/2+le.rank,e:W};h.addDummyNode(K,"edge-proxy",Ce,"_ep")}})}function D(K){var W=0;r.forEach(K.nodes(),function(ee){var le=K.node(ee);le.borderTop&&(le.minRank=K.node(le.borderTop).rank,le.maxRank=K.node(le.borderBottom).rank,W=r.max(W,le.maxRank))}),K.graph().maxRank=W}function j(K){r.forEach(K.nodes(),function(W){var ee=K.node(W);ee.dummy==="edge-proxy"&&(K.edge(ee.e).labelRank=ee.rank,K.removeNode(W))})}function G(K){var W=Number.POSITIVE_INFINITY,ee=0,le=Number.POSITIVE_INFINITY,xe=0,Ce=K.graph(),Ve=Ce.marginx||0,Tt=Ce.marginy||0;function dn(Ot){var Ut=Ot.x,Xe=Ot.y,vr=Ot.width,Qe=Ot.height;W=Math.min(W,Ut-vr/2),ee=Math.max(ee,Ut+vr/2),le=Math.min(le,Xe-Qe/2),xe=Math.max(xe,Xe+Qe/2)}r.forEach(K.nodes(),function(Ot){dn(K.node(Ot))}),r.forEach(K.edges(),function(Ot){var Ut=K.edge(Ot);r.has(Ut,"x")&&dn(Ut)}),W-=Ve,le-=Tt,r.forEach(K.nodes(),function(Ot){var Ut=K.node(Ot);Ut.x-=W,Ut.y-=le}),r.forEach(K.edges(),function(Ot){var Ut=K.edge(Ot);r.forEach(Ut.points,function(Xe){Xe.x-=W,Xe.y-=le}),r.has(Ut,"x")&&(Ut.x-=W),r.has(Ut,"y")&&(Ut.y-=le)}),Ce.width=ee-W+Ve,Ce.height=xe-le+Tt}function V(K){r.forEach(K.edges(),function(W){var ee=K.edge(W),le=K.node(W.v),xe=K.node(W.w),Ce,Ve;ee.points?(Ce=ee.points[0],Ve=ee.points[ee.points.length-1]):(ee.points=[],Ce=xe,Ve=le),ee.points.unshift(h.intersectRect(le,Ce)),ee.points.push(h.intersectRect(xe,Ve))})}function Y(K){r.forEach(K.edges(),function(W){var ee=K.edge(W);if(r.has(ee,"x"))switch((ee.labelpos==="l"||ee.labelpos==="r")&&(ee.width-=ee.labeloffset),ee.labelpos){case"l":ee.x-=ee.width/2+ee.labeloffset;break;case"r":ee.x+=ee.width/2+ee.labeloffset;break}})}function $(K){r.forEach(K.edges(),function(W){var ee=K.edge(W);ee.reversed&&ee.points.reverse()})}function z(K){r.forEach(K.nodes(),function(W){if(K.children(W).length){var ee=K.node(W),le=K.node(ee.borderTop),xe=K.node(ee.borderBottom),Ce=K.node(r.last(ee.borderLeft)),Ve=K.node(r.last(ee.borderRight));ee.width=Math.abs(Ve.x-Ce.x),ee.height=Math.abs(xe.y-le.y),ee.x=Ce.x+ee.width/2,ee.y=le.y+ee.height/2}}),r.forEach(K.nodes(),function(W){K.node(W).dummy==="border"&&K.removeNode(W)})}function Z(K){r.forEach(K.edges(),function(W){if(W.v===W.w){var ee=K.node(W.v);ee.selfEdges||(ee.selfEdges=[]),ee.selfEdges.push({e:W,label:K.edge(W)}),K.removeEdge(W)}})}function ne(K){var W=h.buildLayerMatrix(K);r.forEach(W,function(ee){var le=0;r.forEach(ee,function(xe,Ce){var Ve=K.node(xe);Ve.order=Ce+le,r.forEach(Ve.selfEdges,function(Tt){h.addDummyNode(K,"selfedge",{width:Tt.label.width,height:Tt.label.height,rank:Ve.rank,order:Ce+ ++le,e:Tt.e,label:Tt.label},"_se")}),delete Ve.selfEdges})})}function se(K){r.forEach(K.nodes(),function(W){var ee=K.node(W);if(ee.dummy==="selfedge"){var le=K.node(ee.e.v),xe=le.x+le.width/2,Ce=le.y,Ve=ee.x-xe,Tt=le.height/2;K.setEdge(ee.e,ee.label),K.removeNode(W),ee.label.points=[{x:xe+2*Ve/3,y:Ce-Tt},{x:xe+5*Ve/6,y:Ce-Tt},{x:xe+Ve,y:Ce},{x:xe+5*Ve/6,y:Ce+Tt},{x:xe+2*Ve/3,y:Ce+Tt}],ee.label.x=ee.x,ee.label.y=ee.y}})}function oe(K,W){return r.mapValues(r.pick(K,W),Number)}function Ne(K){var W={};return r.forEach(K,function(ee,le){W[le.toLowerCase()]=ee}),W}return p0}var v0,gS;function Gq(){if(gS)return v0;gS=1;var r=Pt(),e=tr(),t=Gr().Graph;v0={debugOrdering:n};function n(i){var a=e.buildLayerMatrix(i),s=new t({compound:!0,multigraph:!0}).setGraph({});return r.forEach(i.nodes(),function(o){s.setNode(o,{label:o}),s.setParent(o,"layer"+i.node(o).rank)}),r.forEach(i.edges(),function(o){s.setEdge(o.v,o.w,{},o.name)}),r.forEach(a,function(o,u){var l="layer"+u;s.setNode(l,{rank:"same"}),r.reduce(o,function(c,d){return s.setEdge(c,d,{style:"invis"}),d})}),s}return v0}var y0,pS;function Wq(){return pS||(pS=1,y0="0.8.5"),y0}var m0,vS;function Vq(){return vS||(vS=1,m0={graphlib:Gr(),layout:qq(),debug:Gq(),util:{time:tr().time,notime:tr().notime},version:Wq()}),m0}var eN=Vq();const Yq=tu(eN);class md{constructor(e){this.id="dagre",this.options={},Object.assign(this.options,md.defaultOptions,e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericDagreLayout(!1,e,Object.assign(Object.assign({},this.options),t))})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericDagreLayout(!0,e,Object.assign(Object.assign({},this.options),t))})}genericDagreLayout(e,t,n){return Ye(this,void 0,void 0,function*(){const{nodeSize:i}=n,a=new eN.graphlib.Graph;a.setGraph(n),a.setDefaultEdgeLabel(()=>({}));const s=t.getAllNodes(),o=t.getAllEdges();[...s,...o].some(({id:l})=>Ee(l))&&console.error("Dagre layout only support string id, it will convert number to string."),t.getAllNodes().forEach(l=>{const{id:c}=l,d=Object.assign({},l.data);if(i!==void 0){const[h,f]=bu(Te(i)?i(l):i);Object.assign(d,{width:h,height:f})}a.setNode(c.toString(),d)}),t.getAllEdges().forEach(({id:l,source:c,target:d})=>{a.setEdge(c.toString(),d.toString(),{id:l})}),Yq.layout(a);const u={nodes:[],edges:[]};return a.nodes().forEach(l=>{const c=a.node(l);u.nodes.push({id:l,data:c}),e&&t.mergeNodeData(l,c)}),a.edges().forEach(l=>{const c=a.edge(l),{id:d}=c,h=kT(c,["id"]),{v:f,w:g}=l;u.edges.push({id:d,source:f,target:g,data:h}),e&&t.mergeEdgeData(d,h)}),u})}}md.defaultOptions={};class i1{constructor(e){this.id=e.id||0,this.rx=e.rx,this.ry=e.ry,this.fx=0,this.fy=0,this.mass=e.mass,this.degree=e.degree,this.g=e.g||0}distanceTo(e){const t=this.rx-e.rx,n=this.ry-e.ry;return Math.hypot(t,n)}setPos(e,t){this.rx=e,this.ry=t}resetForce(){this.fx=0,this.fy=0}addForce(e){const t=e.rx-this.rx,n=e.ry-this.ry;let i=Math.hypot(t,n);i=i<1e-4?1e-4:i;const a=this.g*(this.degree+1)*(e.degree+1)/i;this.fx+=a*t/i,this.fy+=a*n/i}in(e){return e.contains(this.rx,this.ry)}add(e){const t=this.mass+e.mass,n=(this.rx*this.mass+e.rx*e.mass)/t,i=(this.ry*this.mass+e.ry*e.mass)/t,a=this.degree+e.degree,s={rx:n,ry:i,mass:t,degree:a};return new i1(s)}}class _s{constructor(e){this.xmid=e.xmid,this.ymid=e.ymid,this.length=e.length,this.massCenter=e.massCenter||[0,0],this.mass=e.mass||1}getLength(){return this.length}contains(e,t){const n=this.length/2;return e<=this.xmid+n&&e>=this.xmid-n&&t<=this.ymid+n&&t>=this.ymid-n}NW(){const e=this.xmid-this.length/4,t=this.ymid+this.length/4,n=this.length/2,i={xmid:e,ymid:t,length:n};return new _s(i)}NE(){const e=this.xmid+this.length/4,t=this.ymid+this.length/4,n=this.length/2,i={xmid:e,ymid:t,length:n};return new _s(i)}SW(){const e=this.xmid-this.length/4,t=this.ymid-this.length/4,n=this.length/2,i={xmid:e,ymid:t,length:n};return new _s(i)}SE(){const e=this.xmid+this.length/4,t=this.ymid-this.length/4,n=this.length/2,i={xmid:e,ymid:t,length:n};return new _s(i)}}class Ts{constructor(e){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,e!=null&&(this.quad=e)}insert(e){if(this.body==null){this.body=e;return}this._isExternal()?(this.quad&&(this.NW=new Ts(this.quad.NW()),this.NE=new Ts(this.quad.NE()),this.SW=new Ts(this.quad.SW()),this.SE=new Ts(this.quad.SE())),this._putBody(this.body),this._putBody(e),this.body=this.body.add(e)):(this.body=this.body.add(e),this._putBody(e))}_putBody(e){this.quad&&(e.in(this.quad.NW())&&this.NW?this.NW.insert(e):e.in(this.quad.NE())&&this.NE?this.NE.insert(e):e.in(this.quad.SW())&&this.SW?this.SW.insert(e):e.in(this.quad.SE())&&this.SE&&this.SE.insert(e))}_isExternal(){return this.NW==null&&this.NE==null&&this.SW==null&&this.SE==null}updateForce(e){if(!(this.body==null||e===this.body))if(this._isExternal())e.addForce(this.body);else{const t=this.quad?this.quad.getLength():0,n=this.body.distanceTo(e);t/n<this.theta?e.addForce(this.body):(this.NW&&this.NW.updateForce(e),this.NE&&this.NE.updateForce(e),this.SW&&this.SW.updateForce(e),this.SE&&this.SE.updateForce(e))}}}const Uq={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1};class Hq{constructor(e={}){this.options=e,this.id="forceAtlas2",this.options=Object.assign(Object.assign({},Uq),e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericForceAtlas2Layout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericForceAtlas2Layout(!0,e,t)})}genericForceAtlas2Layout(e,t,n){return Ye(this,void 0,void 0,function*(){const i=t.getAllEdges(),a=t.getAllNodes(),s=this.formatOptions(n,a.length),{width:o,height:u,prune:l,maxIteration:c,nodeSize:d,center:h}=s;if(!(a!=null&&a.length)||a.length===1)return ns(t,e,h);const f=a.map(y=>cr(y,[o,u])),g=i.filter(y=>{const{source:m,target:w}=y;return m!==w}),v=new cn({nodes:f,edges:g}),p=this.getSizes(v,d);if(this.run(v,t,c,p,e,s),l){for(let m=0;m<g.length;m+=1){const{source:w,target:M}=g[m],S=v.getDegree(w),T=v.getDegree(w);if(S<=1){const A=v.getNode(M);v.mergeNodeData(w,{x:A.data.x,y:A.data.y})}else if(T<=1){const A=v.getNode(w);v.mergeNodeData(M,{x:A.data.x,y:A.data.y})}}const y=Object.assign(Object.assign({},s),{prune:!1,barnesHut:!1});this.run(v,t,100,p,e,y)}return{nodes:f,edges:i}})}getSizes(e,t){const n=e.getAllNodes(),i={};for(let a=0;a<n.length;a+=1){const s=n[a];i[s.id]=$m(t,void 0)(s)}return i}formatOptions(e={},t){const n=Object.assign(Object.assign({},this.options),e),{center:i,width:a,height:s,barnesHut:o,prune:u,maxIteration:l,kr:c,kg:d}=n;return n.width=!a&&typeof window<"u"?window.innerWidth:a,n.height=!s&&typeof window<"u"?window.innerHeight:s,n.center=i||[n.width/2,n.height/2],o===void 0&&t>250&&(n.barnesHut=!0),u===void 0&&t>100&&(n.prune=!0),l===0&&!u?(n.maxIteration=250,t<=200&&t>100?n.maxIteration=1e3:t>200&&(n.maxIteration=1200)):l===0&&u&&(n.maxIteration=100,t<=200&&t>100?n.maxIteration=500:t>200&&(n.maxIteration=950)),c||(n.kr=50,t>100&&t<=500?n.kr=20:t>500&&(n.kr=1)),d||(n.kg=20,t>100&&t<=500?n.kg=10:t>500&&(n.kg=1)),n}run(e,t,n,i,a,s){const{kr:o,barnesHut:u,onTick:l}=s,c=e.getAllNodes();let d=0,h=n;const f={},g={},v={};for(let p=0;p<c.length;p+=1){const{data:y,id:m}=c[p];if(f[m]=[0,0],u){const w={id:p,rx:y.x,ry:y.y,mass:1,g:o,degree:e.getDegree(m)};v[m]=new i1(w)}}for(;h>0;)d=this.oneStep(e,{iter:h,preventOverlapIters:50,krPrime:100,sg:d,forces:f,preForces:g,bodies:v,sizes:i},s),h--,l==null||l({nodes:c,edges:t.getAllEdges()});return e}oneStep(e,t,n){const{iter:i,preventOverlapIters:a,krPrime:s,sg:o,preForces:u,bodies:l,sizes:c}=t;let{forces:d}=t;const{preventOverlap:h,barnesHut:f}=n,g=e.getAllNodes();for(let v=0;v<g.length;v+=1){const{id:p}=g[v];u[p]=[...d[p]],d[p]=[0,0]}return d=this.getAttrForces(e,i,a,c,d,n),f&&(h&&i>a||!h)?d=this.getOptRepGraForces(e,d,l,n):d=this.getRepGraForces(e,i,a,d,s,c,n),this.updatePos(e,d,u,o,n)}getAttrForces(e,t,n,i,a,s){const{preventOverlap:o,dissuadeHubs:u,mode:l,prune:c}=s,d=e.getAllEdges();for(let h=0;h<d.length;h+=1){const{source:f,target:g}=d[h],v=e.getNode(f),p=e.getNode(g),y=e.getDegree(f),m=e.getDegree(g);if(c&&(y<=1||m<=1))continue;const w=[p.data.x-v.data.x,p.data.y-v.data.y];let M=Math.hypot(w[0],w[1]);M=M<1e-4?1e-4:M,w[0]=w[0]/M,w[1]=w[1]/M,o&&t<n&&(M=M-i[f]-i[g]);let S=M,T=S;l==="linlog"&&(S=Math.log(1+M),T=S),u&&(S=M/y,T=M/m),o&&t<n&&M<=0?(S=0,T=0):o&&t<n&&M>0&&(S=M,T=M),a[f][0]+=S*w[0],a[g][0]-=T*w[0],a[f][1]+=S*w[1],a[g][1]-=T*w[1]}return a}getOptRepGraForces(e,t,n,i){const{kg:a,center:s,prune:o}=i,u=e.getAllNodes(),l=u.length;let c=9e10,d=-9e10,h=9e10,f=-9e10;for(let m=0;m<l;m+=1){const{id:w,data:M}=u[m];o&&e.getDegree(w)<=1||(n[w].setPos(M.x,M.y),M.x>=d&&(d=M.x),M.x<=c&&(c=M.x),M.y>=f&&(f=M.y),M.y<=h&&(h=M.y))}const g=Math.max(d-c,f-h),v={xmid:(d+c)/2,ymid:(f+h)/2,length:g,massCenter:s,mass:l},p=new _s(v),y=new Ts(p);for(let m=0;m<l;m+=1){const{id:w}=u[m];o&&e.getDegree(w)<=1||n[w].in(p)&&y.insert(n[w])}for(let m=0;m<l;m+=1){const{id:w,data:M}=u[m],S=e.getDegree(w);if(o&&S<=1)continue;n[w].resetForce(),y.updateForce(n[w]),t[w][0]-=n[w].fx,t[w][1]-=n[w].fy;const T=[M.x-s[0],M.y-s[1]];let A=Math.hypot(T[0],T[1]);A=A<1e-4?1e-4:A,T[0]=T[0]/A,T[1]=T[1]/A;const O=a*(S+1);t[w][0]-=O*T[0],t[w][1]-=O*T[1]}return t}getRepGraForces(e,t,n,i,a,s,o){const{preventOverlap:u,kr:l,kg:c,center:d,prune:h}=o,f=e.getAllNodes(),g=f.length;for(let v=0;v<g;v+=1){const p=f[v],y=e.getDegree(p.id);for(let S=v+1;S<g;S+=1){const T=f[S],A=e.getDegree(T.id);if(h&&(y<=1||A<=1))continue;const O=[T.data.x-p.data.x,T.data.y-p.data.y];let N=Math.hypot(O[0],O[1]);N=N<1e-4?1e-4:N,O[0]=O[0]/N,O[1]=O[1]/N,u&&t<n&&(N=N-s[p.id]-s[T.id]);let C=l*(y+1)*(A+1)/N;u&&t<n&&N<0?C=a*(y+1)*(A+1):u&&t<n&&N===0?C=0:u&&t<n&&N>0&&(C=l*(y+1)*(A+1)/N),i[p.id][0]-=C*O[0],i[T.id][0]+=C*O[0],i[p.id][1]-=C*O[1],i[T.id][1]+=C*O[1]}const m=[p.data.x-d[0],p.data.y-d[1]],w=Math.hypot(m[0],m[1]);m[0]=m[0]/w,m[1]=m[1]/w;const M=c*(y+1);i[p.id][0]-=M*m[0],i[p.id][1]-=M*m[1]}return i}updatePos(e,t,n,i,a){const{ks:s,tao:o,prune:u,ksmax:l}=a,c=e.getAllNodes(),d=c.length,h=[],f=[];let g=0,v=0,p=i;for(let m=0;m<d;m+=1){const{id:w}=c[m],M=e.getDegree(w);if(u&&M<=1)continue;const S=[t[w][0]-n[w][0],t[w][1]-n[w][1]],T=Math.hypot(S[0],S[1]),A=[t[w][0]+n[w][0],t[w][1]+n[w][1]],O=Math.hypot(A[0],A[1]);h[m]=T,f[m]=O/2,g+=(M+1)*h[m],v+=(M+1)*f[m]}const y=p;p=o*v/g,y!==0&&(p=p>1.5*y?1.5*y:p);for(let m=0;m<d;m+=1){const{id:w,data:M}=c[m],S=e.getDegree(w);if(u&&S<=1||Ee(M.fx)&&Ee(M.fy))continue;let T=s*p/(1+p*Math.sqrt(h[m])),A=Math.hypot(t[w][0],t[w][1]);A=A<1e-4?1e-4:A;const O=l/A;T=T>O?O:T;const N=T*t[w][0],C=T*t[w][1];e.mergeNodeData(w,{x:M.x+N,y:M.y+C})}return p}}const Xq={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},Kq=800;class Zq{constructor(e={}){this.options=e,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=Object.assign(Object.assign({},Xq),e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericFruchtermanLayout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericFruchtermanLayout(!0,e,t)})}stop(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval),this.running=!1}tick(e=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let n=0;n<e;n++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);const t={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&t.nodes.forEach(n=>this.lastGraph.mergeNodeData(n.id,{x:n.data.x,y:n.data.y,z:this.options.dimensions===3?n.data.z:void 0})),t}genericFruchtermanLayout(e,t,n){return Ye(this,void 0,void 0,function*(){if(this.running)return;const i=this.formatOptions(n),{dimensions:a,width:s,height:o,center:u,clustering:l,nodeClusterBy:c,maxIteration:d,onTick:h}=i,f=t.getAllNodes(),g=t.getAllEdges();if(!(f!=null&&f.length)){const w={nodes:[],edges:g};return this.lastResult=w,w}if(f.length===1){e&&t.mergeNodeData(f[0].id,{x:u[0],y:u[1],z:a===3?u[2]:void 0});const w={nodes:[Object.assign(Object.assign({},f[0]),{data:Object.assign(Object.assign({},f[0].data),{x:u[0],y:u[1],z:a===3?u[2]:void 0})})],edges:g};return this.lastResult=w,w}const v=f.map(w=>cr(w,[s,o])),p=new cn({nodes:v,edges:g}),y={};if(l&&v.forEach(w=>{const M=w.data[c];y[M]||(y[M]={name:M,cx:0,cy:0,count:0})}),this.lastLayoutNodes=v,this.lastLayoutEdges=g,this.lastAssign=e,this.lastGraph=p,this.lastOptions=i,this.lastClusterMap=y,typeof window>"u")return;let m=0;return new Promise(w=>{this.timeInterval=window.setInterval(()=>{if(!this.running){w({nodes:v,edges:g});return}this.runOneStep(p,y,i),e&&v.forEach(({id:M,data:S})=>t.mergeNodeData(M,{x:S.x,y:S.y,z:a===3?S.z:void 0})),h==null||h({nodes:v,edges:g}),m++,m>=d&&(window.clearInterval(this.timeInterval),w({nodes:v,edges:g}))},0),this.running=!0})})}formatOptions(e={}){const t=Object.assign(Object.assign({},this.options),e),{clustering:n,nodeClusterBy:i}=t,{center:a,width:s,height:o}=t;return t.width=!s&&typeof window<"u"?window.innerWidth:s,t.height=!o&&typeof window<"u"?window.innerHeight:o,t.center=a||[t.width/2,t.height/2],t.clustering=n&&!!i,t}runOneStep(e,t,n){const{dimensions:i,height:a,width:s,gravity:o,center:u,speed:l,clustering:c,nodeClusterBy:d,clusterGravity:h}=n,f=a*s,g=Math.sqrt(f)/10,v=e.getAllNodes(),p=f/(v.length+1),y=Math.sqrt(p),m={};if(this.applyCalculate(e,m,y,p),c){for(const M in t)t[M].cx=0,t[M].cy=0,t[M].count=0;v.forEach(M=>{const{data:S}=M,T=t[S[d]];Ee(S.x)&&(T.cx+=S.x),Ee(S.y)&&(T.cy+=S.y),T.count++});for(const M in t)t[M].cx/=t[M].count,t[M].cy/=t[M].count;const w=h||o;v.forEach((M,S)=>{const{id:T,data:A}=M;if(!Ee(A.x)||!Ee(A.y))return;const O=t[A[d]],N=Math.sqrt((A.x-O.cx)*(A.x-O.cx)+(A.y-O.cy)*(A.y-O.cy)),C=y*w;m[T].x-=C*(A.x-O.cx)/N,m[T].y-=C*(A.y-O.cy)/N})}v.forEach((w,M)=>{const{id:S,data:T}=w;if(!Ee(T.x)||!Ee(T.y))return;const A=.01*y*o;m[S].x-=A*(T.x-u[0]),m[S].y-=A*(T.y-u[1]),i===3&&(m[S].z-=A*(T.z-u[2]))}),v.forEach((w,M)=>{const{id:S,data:T}=w;if(Ee(T.fx)&&Ee(T.fy)){T.x=T.fx,T.y=T.fy,i===3&&(T.z=T.fz);return}if(!Ee(T.x)||!Ee(T.y))return;const A=Math.sqrt(m[S].x*m[S].x+m[S].y*m[S].y+(i===3?m[S].z*m[S].z:0));if(A>0){const O=Math.min(g*(l/Kq),A);e.mergeNodeData(S,{x:T.x+m[S].x/A*O,y:T.y+m[S].y/A*O,z:i===3?T.z+m[S].z/A*O:void 0})}})}applyCalculate(e,t,n,i){this.calRepulsive(e,t,i),this.calAttractive(e,t,n)}calRepulsive(e,t,n){const i=e.getAllNodes();i.forEach(({data:a,id:s},o)=>{t[s]={x:0,y:0,z:0},i.forEach(({data:u,id:l},c)=>{if(o<=c||!Ee(a.x)||!Ee(u.x)||!Ee(a.y)||!Ee(u.y))return;let d=a.x-u.x,h=a.y-u.y,f=this.options.dimensions===3?a.z-u.z:0,g=d*d+h*h+f*f;g===0&&(g=1,d=.01,h=.01,f=.01);const v=n/g,p=d*v,y=h*v,m=f*v;t[s].x+=p,t[s].y+=y,t[l].x-=p,t[l].y-=y,this.options.dimensions===3&&(t[s].z+=m,t[l].z-=m)})})}calAttractive(e,t,n){e.getAllEdges().forEach(a=>{const{source:s,target:o}=a;if(!s||!o||s===o)return;const{data:u}=e.getNode(s),{data:l}=e.getNode(o);if(!Ee(l.x)||!Ee(u.x)||!Ee(l.y)||!Ee(u.y))return;const c=l.x-u.x,d=l.y-u.y,h=this.options.dimensions===3?l.z-u.z:0,f=Math.sqrt(c*c+d*d+h*h)/n,g=c*f,v=d*f,p=h*f;t[s].x+=g,t[s].y+=v,t[o].x-=g,t[o].y-=v,this.options.dimensions===3&&(t[s].z+=p,t[o].z-=p)})}}const Qq={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300};class Jq{constructor(e={}){this.options=e,this.id="grid",this.options=Object.assign(Object.assign({},Qq),e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericGridLayout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericGridLayout(!0,e,t)})}genericGridLayout(e,t,n){return Ye(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{begin:a=[0,0],condense:s,preventOverlapPadding:o,preventOverlap:u,rows:l,cols:c,nodeSpacing:d,nodeSize:h,width:f,height:g,position:v}=i;let{sortBy:p}=i;const y=t.getAllNodes(),m=t.getAllEdges(),w=y==null?void 0:y.length;if(!w||w===1)return ns(t,e,a);const M=y.map(V=>cr(V));p!=="id"&&(!tt(p)||M[0].data[p]===void 0)&&(p="degree"),p==="degree"?M.sort((V,Y)=>t.getDegree(Y.id,"both")-t.getDegree(V.id,"both")):p==="id"?M.sort((V,Y)=>Ee(Y.id)&&Ee(V.id)?Y.id-V.id:`${V.id}`.localeCompare(`${Y.id}`)):M.sort((V,Y)=>Y.data[p]-V.data[p]);const S=!f&&typeof window<"u"?window.innerWidth:f,T=!g&&typeof window<"u"?window.innerHeight:g,A=w,O={rows:l,cols:c};if(l!=null&&c!=null)O.rows=l,O.cols=c;else if(l!=null&&c==null)O.rows=l,O.cols=Math.ceil(A/O.rows);else if(l==null&&c!=null)O.cols=c,O.rows=Math.ceil(A/O.cols);else{const V=Math.sqrt(A*T/S);O.rows=Math.round(V),O.cols=Math.round(S/T*V)}if(O.rows=Math.max(O.rows,1),O.cols=Math.max(O.cols,1),O.cols*O.rows>A){const V=vl(O),Y=yl(O);(V-1)*Y>=A?vl(O,V-1):(Y-1)*V>=A&&yl(O,Y-1)}else for(;O.cols*O.rows<A;){const V=vl(O),Y=yl(O);(Y+1)*V>=A?yl(O,Y+1):vl(O,V+1)}let N=s?0:S/O.cols,C=s?0:T/O.rows;if(u||d){const V=Fa(10,d),Y=zm(30,h,!1);M.forEach($=>{(!$.data.x||!$.data.y)&&($.data.x=0,$.data.y=0);const z=t.getNode($.id),[Z,ne]=bu(Y(z)||30),se=V!==void 0?V($):o,oe=Z+se,Ne=ne+se;N=Math.max(N,oe),C=Math.max(C,Ne)})}const P={},D={row:0,col:0},j={};for(let V=0;V<M.length;V++){const Y=M[V];let $;if(v&&($=v(t.getNode(Y.id))),$&&($.row!==void 0||$.col!==void 0)){const z={row:$.row,col:$.col};if(z.col===void 0)for(z.col=0;Ry(P,z);)z.col++;else if(z.row===void 0)for(z.row=0;Ry(P,z);)z.row++;j[Y.id]=z,tN(P,z)}eG(Y,a,N,C,j,O,D,P)}const G={nodes:M,edges:m};return e&&M.forEach(V=>{t.mergeNodeData(V.id,{x:V.data.x,y:V.data.y})}),G})}}const vl=(r,e)=>{let t;const n=r.rows||5,i=r.cols||5;return e==null?t=Math.min(n,i):Math.min(n,i)===r.rows?r.rows=e:r.cols=e,t},yl=(r,e)=>{let t;const n=r.rows||5,i=r.cols||5;return e==null?t=Math.max(n,i):Math.max(n,i)===r.rows?r.rows=e:r.cols=e,t},Ry=(r,e)=>r[`c-${e.row}-${e.col}`]||!1,tN=(r,e)=>r[`c-${e.row}-${e.col}`]=!0,yS=(r,e)=>{const t=r.cols||5;e.col++,e.col>=t&&(e.col=0,e.row++)},eG=(r,e,t,n,i,a,s,o)=>{let u,l;const c=i[r.id];if(c)u=c.col*t+t/2+e[0],l=c.row*n+n/2+e[1];else{for(;Ry(o,s);)yS(a,s);u=s.col*t+t/2+e[0],l=s.row*n+n/2+e[1],tN(o,s),yS(a,s)}r.data.x=u,r.data.y=l},tG=(r,e,t)=>{try{const n=ea.mul(ea.pow(e,2),-.5),i=n.mean("row"),a=n.mean("column"),s=n.mean();n.add(s).subRowVector(i).subColumnVector(a);const o=new ZA(n),u=ea.sqrt(o.diagonalMatrix).diagonal();return o.leftSingularVectors.toJSON().map(l=>ea.mul([l],[u]).toJSON()[0].splice(0,r))}catch{const i=[];for(let a=0;a<e.length;a++){const s=Math.random()*t,o=Math.random()*t;i.push([s,o])}return i}},nG=800,rG={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},iG=(r,e)=>{const t=Object.assign(Object.assign({},rG),e),{positions:n,iterations:i,width:a,k:s,speed:o=100,strictRadial:u,focusIdx:l,radii:c=[],nodeSizeFunc:d}=t,h=r.getAllNodes(),f=[],g=a/10;for(let v=0;v<i;v++)n.forEach((p,y)=>{f[y]={x:0,y:0}}),aG(h,n,f,s,c,d),sG(n,f,o,u,l,g,a,c);return n},aG=(r,e,t,n,i,a)=>{e.forEach((s,o)=>{t[o]={x:0,y:0},e.forEach((u,l)=>{if(o===l||i[o]!==i[l])return;let c=s.x-u.x,d=s.y-u.y,h=Math.sqrt(c*c+d*d);if(h===0){h=1;const f=o>l?1:-1;c=.01*f,d=.01*f}if(h<a(r[o])/2+a(r[l])/2){const f=n*n/h;t[o].x+=c/h*f,t[o].y+=d/h*f}})})},sG=(r,e,t,n,i,a,s,o)=>{const u=a||s/10;return n&&e.forEach((l,c)=>{const d=r[c].x-r[i].x,h=r[c].y-r[i].y,f=Math.sqrt(d*d+h*h);let g=h/f,v=-d/f;const p=Math.sqrt(l.x*l.x+l.y*l.y);let y=Math.acos((g*l.x+v*l.y)/p);y>Math.PI/2&&(y-=Math.PI/2,g*=-1,v*=-1);const m=Math.cos(y)*p;l.x=g*m,l.y=v*m}),r.forEach((l,c)=>{if(c===i)return;const d=Math.sqrt(e[c].x*e[c].x+e[c].y*e[c].y);if(d>0&&c!==i){const h=Math.min(u*(t/nG),d);if(l.x+=e[c].x/d*h,l.y+=e[c].y/d*h,n){let f=l.x-r[i].x,g=l.y-r[i].y;const v=Math.sqrt(f*f+g*g);f=f/v*o[c],g=g/v*o[c],l.x=r[i].x+f,l.y=r[i].y+g}}}),r},oG={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10};class uG{constructor(e={}){this.options=e,this.id="radial",this.options=Object.assign(Object.assign({},oG),e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericRadialLayout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericRadialLayout(!0,e,t)})}genericRadialLayout(e,t,n){return Ye(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{width:a,height:s,center:o,focusNode:u,unitRadius:l,nodeSize:c,nodeSpacing:d,strictRadial:h,preventOverlap:f,maxPreventOverlapIteration:g,sortBy:v,linkDistance:p=50,sortStrength:y=10,maxIteration:m=1e3}=i,w=t.getAllNodes(),M=t.getAllEdges(),S=!a&&typeof window<"u"?window.innerWidth:a,T=!s&&typeof window<"u"?window.innerHeight:s,A=o||[S/2,T/2];if(!(w!=null&&w.length)||w.length===1)return ns(t,e,A);let O=w[0];if(tt(u)){for(let le=0;le<w.length;le++)if(w[le].id===u){O=w[le];break}}else O=u||w[0];const N=dG(w,O.id),C=YA({nodes:w,edges:M}),P=VA(C),D=fG(P,N);hG(P,N,D+1);const j=P[N];let G=S-A[0]>A[0]?A[0]:S-A[0],V=T-A[1]>A[1]?A[1]:T-A[1];G===0&&(G=S/2),V===0&&(V=T/2);const Y=Math.min(G,V),$=Math.max(...j),z=[],Z=l||Y/$;j.forEach((le,xe)=>{z[xe]=le*Z});const ne=lG(w,P,p,z,Z,v,y),se=cG(ne),oe=tG(p,ne,p);let Ne=oe.map(([le,xe])=>({x:(isNaN(le)?Math.random()*p:le)-oe[N][0],y:(isNaN(xe)?Math.random()*p:xe)-oe[N][1]}));this.run(m,Ne,se,ne,z,N);let K;if(f){K=$m(c,d);const le={nodes:w,nodeSizeFunc:K,positions:Ne,radii:z,height:T,width:S,strictRadial:!!h,focusIdx:N,iterations:g||200,k:Ne.length/4.5};Ne=iG(t,le)}const W=[];return Ne.forEach((le,xe)=>{const Ce=cr(w[xe]);Ce.data.x=le.x+A[0],Ce.data.y=le.y+A[1],W.push(Ce)}),e&&W.forEach(le=>t.mergeNodeData(le.id,{x:le.data.x,y:le.data.y})),{nodes:W,edges:M}})}run(e,t,n,i,a,s){for(let o=0;o<=e;o++){const u=o/e;this.oneIteration(u,t,a,i,n,s)}}oneIteration(e,t,n,i,a,s){const o=1-e;t.forEach((u,l)=>{const c=Fw(u,{x:0,y:0}),d=c===0?0:1/c;if(l===s)return;let h=0,f=0,g=0;t.forEach((p,y)=>{if(l===y)return;const m=Fw(u,p),w=m===0?0:1/m,M=i[y][l];g+=a[l][y],h+=a[l][y]*(p.x+M*(u.x-p.x)*w),f+=a[l][y]*(p.y+M*(u.y-p.y)*w)});const v=n[l]===0?0:1/n[l];g*=o,g+=e*v*v,h*=o,h+=e*v*u.x*d,u.x=h/g,f*=o,f+=e*v*u.y*d,u.y=f/g})}}const lG=(r,e,t,n,i,a,s)=>{if(!r)return[];const o=[];{const u={};e.forEach((l,c)=>{const d=[];l.forEach((h,f)=>{var g,v;if(c===f)d.push(0);else if(n[c]===n[f])if(a==="data")d.push(h*(Math.abs(c-f)*s)/(n[c]/i));else if(a){let p,y;if(u[r[c].id])p=u[r[c].id];else{const m=(a==="id"?r[c].id:(g=r[c].data)===null||g===void 0?void 0:g[a])||0;tt(m)?p=m.charCodeAt(0):p=m,u[r[c].id]=p}if(u[r[f].id])y=u[r[f].id];else{const m=(a==="id"?r[f].id:(v=r[f].data)===null||v===void 0?void 0:v[a])||0;tt(m)?y=m.charCodeAt(0):y=m,u[r[f].id]=y}d.push(h*(Math.abs(p-y)*s)/(n[c]/i))}else d.push(h*t/(n[c]/i));else{const p=(t+i)/2;d.push(h*p)}}),o.push(d)})}return o},cG=r=>{const e=r.length,t=r[0].length,n=[];for(let i=0;i<e;i++){const a=[];for(let s=0;s<t;s++)r[i][s]!==0?a.push(1/(r[i][s]*r[i][s])):a.push(0);n.push(a)}return n},dG=(r,e)=>{let t=-1;return r.forEach((n,i)=>{n.id===e&&(t=i)}),Math.max(t,0)},hG=(r,e,t)=>{const n=r.length;for(let i=0;i<n;i++)if(r[e][i]===1/0){r[e][i]=t,r[i][e]=t;for(let a=0;a<n;a++)r[i][a]!==1/0&&r[e][a]===1/0&&(r[e][a]=t+r[i][a],r[a][e]=t+r[i][a])}for(let i=0;i<n;i++)if(i!==e){for(let a=0;a<n;a++)if(r[i][a]===1/0){let s=Math.abs(r[e][i]-r[e][a]);s=s===0?1:s,r[i][a]=s}}},fG=(r,e)=>{let t=0;for(let n=0;n<r[e].length;n++)r[e][n]!==1/0&&(t=r[e][n]>t?r[e][n]:t);return t},gG={center:[0,0],width:300,height:300};class pG{constructor(e={}){this.options=e,this.id="random",this.options=Object.assign(Object.assign({},gG),e)}execute(e,t){return Ye(this,void 0,void 0,function*(){return this.genericRandomLayout(!1,e,t)})}assign(e,t){return Ye(this,void 0,void 0,function*(){yield this.genericRandomLayout(!0,e,t)})}genericRandomLayout(e,t,n){return Ye(this,void 0,void 0,function*(){const i=Object.assign(Object.assign({},this.options),n),{center:a,width:s,height:o}=i,u=t.getAllNodes(),l=.9,c=!s&&typeof window<"u"?window.innerWidth:s,d=!o&&typeof window<"u"?window.innerHeight:o,h=a||[c/2,d/2],f=[];return u&&u.forEach(v=>{f.push({id:v.id,data:{x:(Math.random()-.5)*l*c+h[0],y:(Math.random()-.5)*l*d+h[1]}})}),e&&f.forEach(v=>t.mergeNodeData(v.id,{x:v.data.x,y:v.data.y})),{nodes:f,edges:t.getAllEdges()}})}}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const nN=Symbol("Comlink.proxy"),vG=Symbol("Comlink.endpoint"),rN=Symbol("Comlink.releaseProxy"),b0=Symbol("Comlink.finalizer"),Dl=Symbol("Comlink.thrown"),iN=r=>typeof r=="object"&&r!==null||typeof r=="function",yG={canHandle:r=>iN(r)&&r[nN],serialize(r){const{port1:e,port2:t}=new MessageChannel;return sN(r,e),[t,[t]]},deserialize(r){return r.start(),uN(r)}},mG={canHandle:r=>iN(r)&&Dl in r,serialize({value:r}){let e;return r instanceof Error?e={isError:!0,value:{message:r.message,name:r.name,stack:r.stack}}:e={isError:!1,value:r},[e,[]]},deserialize(r){throw r.isError?Object.assign(new Error(r.value.message),r.value):r.value}},aN=new Map([["proxy",yG],["throw",mG]]);function bG(r,e){for(const t of r)if(e===t||t==="*"||t instanceof RegExp&&t.test(e))return!0;return!1}function sN(r,e=globalThis,t=["*"]){e.addEventListener("message",function n(i){if(!i||!i.data)return;if(!bG(t,i.origin)){console.warn(`Invalid origin '${i.origin}' for comlink proxy`);return}const{id:a,type:s,path:o}=Object.assign({path:[]},i.data),u=(i.data.argumentList||[]).map(Na);let l;try{const c=o.slice(0,-1).reduce((h,f)=>h[f],r),d=o.reduce((h,f)=>h[f],r);switch(s){case"GET":l=d;break;case"SET":c[o.slice(-1)[0]]=Na(i.data.value),l=!0;break;case"APPLY":l=d.apply(c,u);break;case"CONSTRUCT":{const h=new d(...u);l=_G(h)}break;case"ENDPOINT":{const{port1:h,port2:f}=new MessageChannel;sN(r,f),l=SG(h,[h])}break;case"RELEASE":l=void 0;break;default:return}}catch(c){l={value:c,[Dl]:0}}Promise.resolve(l).catch(c=>({value:c,[Dl]:0})).then(c=>{const[d,h]=yc(c);e.postMessage(Object.assign(Object.assign({},d),{id:a}),h),s==="RELEASE"&&(e.removeEventListener("message",n),oN(e),b0 in r&&typeof r[b0]=="function"&&r[b0]())}).catch(c=>{const[d,h]=yc({value:new TypeError("Unserializable return value"),[Dl]:0});e.postMessage(Object.assign(Object.assign({},d),{id:a}),h)})}),e.start&&e.start()}function wG(r){return r.constructor.name==="MessagePort"}function oN(r){wG(r)&&r.close()}function uN(r,e){const t=new Map;return r.addEventListener("message",function(i){const{data:a}=i;if(!a||!a.id)return;const s=t.get(a.id);if(s)try{s(a)}finally{t.delete(a.id)}}),jy(r,t,[],e)}function ml(r){if(r)throw new Error("Proxy has been released and is not useable")}function lN(r){return Es(r,new Map,{type:"RELEASE"}).then(()=>{oN(r)})}const pc=new WeakMap,vc="FinalizationRegistry"in globalThis&&new FinalizationRegistry(r=>{const e=(pc.get(r)||0)-1;pc.set(r,e),e===0&&lN(r)});function xG(r,e){const t=(pc.get(e)||0)+1;pc.set(e,t),vc&&vc.register(r,e,r)}function EG(r){vc&&vc.unregister(r)}function jy(r,e,t=[],n=function(){}){let i=!1;const a=new Proxy(n,{get(s,o){if(ml(i),o===rN)return()=>{EG(a),lN(r),e.clear(),i=!0};if(o==="then"){if(t.length===0)return{then:()=>a};const u=Es(r,e,{type:"GET",path:t.map(l=>l.toString())}).then(Na);return u.then.bind(u)}return jy(r,e,[...t,o])},set(s,o,u){ml(i);const[l,c]=yc(u);return Es(r,e,{type:"SET",path:[...t,o].map(d=>d.toString()),value:l},c).then(Na)},apply(s,o,u){ml(i);const l=t[t.length-1];if(l===vG)return Es(r,e,{type:"ENDPOINT"}).then(Na);if(l==="bind")return jy(r,e,t.slice(0,-1));const[c,d]=mS(u);return Es(r,e,{type:"APPLY",path:t.map(h=>h.toString()),argumentList:c},d).then(Na)},construct(s,o){ml(i);const[u,l]=mS(o);return Es(r,e,{type:"CONSTRUCT",path:t.map(c=>c.toString()),argumentList:u},l).then(Na)}});return xG(a,r),a}function MG(r){return Array.prototype.concat.apply([],r)}function mS(r){const e=r.map(yc);return[e.map(t=>t[0]),MG(e.map(t=>t[1]))]}const cN=new WeakMap;function SG(r,e){return cN.set(r,e),r}function _G(r){return Object.assign(r,{[nN]:!0})}function yc(r){for(const[e,t]of aN)if(t.canHandle(r)){const[n,i]=t.serialize(r);return[{type:"HANDLER",name:e,value:n},i]}return[{type:"RAW",value:r},cN.get(r)||[]]}function Na(r){switch(r.type){case"HANDLER":return aN.get(r.name).deserialize(r.value);case"RAW":return r.value}}function Es(r,e,t,n){return new Promise(i=>{const a=TG();e.set(a,i),r.start&&r.start(),r.postMessage(Object.assign({id:a},t),n)})}function TG(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}class OG extends Kc{constructor(e,t,n){super(),this.graph=e,this.layout=t,this.options=n,this.spawnWorker()}spawnWorker(){this.proxy=uN(new Worker(new URL("/assets/worker-XizVwFTu.js",import.meta.url),{type:"module"})),this.running&&(this.running=!1,this.execute())}execute(){var e;return Ye(this,void 0,void 0,function*(){if(this.running)return this;this.running=!0;const t=this.layout.options,n=kT(t,["onTick"]),i={};Object.keys(n).forEach(u=>{Te(n[u])||(i[u]=n[u])});const a={layout:{id:this.layout.id,options:i,iterations:(e=this.options)===null||e===void 0?void 0:e.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},s=new Float32Array([0]),[o]=yield this.proxy.calculateLayout(a,[s]);return o})}stop(){return this.running=!1,this.proxy.stopLayout(),this}kill(){this.proxy[rN]()}isRunning(){return this.running}}var AG=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})};class bd extends Zc{constructor(){super(...arguments),this.id="fishbone"}getRoot(){const e=this.context.model.getRootsData();if(!(ti(e)||e.length>2))return e[0]}formatSize(e){const t=typeof e=="function"?e:()=>e;return n=>hr(t(n))}doLayout(e,t){const{hGap:n,getRibSep:i,vGap:a,nodeSize:s,height:o}=t,{model:u}=this.context,l=this.formatSize(s);let c=l(e)[0]+i(e);const d=(w,M=0)=>{var S;return M+=n*((w.children||[]).length+1),(S=w.children)===null||S===void 0||S.forEach(T=>{var A;(A=u.getNodeLikeDatum(T).children)===null||A===void 0||A.forEach(N=>{const C=u.getNodeLikeDatum(N);M=d(C,M)})}),M},h=w=>{if(w.depth===1)return c;const M=u.getParentData(w.id,"tree");if(ps(w)){const S=u.getParentData(M.id,"tree"),T=v(w)-v(S);return h(M)+T*n/a}else{const S=(M.children||[]).indexOf(w.id),T=u.getNodeData((M.children||[]).slice(S));return f(M)-T.reduce((A,O)=>A+d(O),0)-l(M)[0]/2}},f=X0(w=>{if(w0(w))return l(w)[0]/2;const M=u.getParentData(w.id,"tree");if(ps(w))return h(w)+d(w)+l(w)[0]/2;{const S=v(w)-v(M),T=n/a;return h(w)+S*T}},w=>w.id),g=w=>v(u.getParentData(w,"tree")),v=X0(w=>{if(w0(w))return o/2;if(ps(w)){const M=u.getParentData(w.id,"tree"),S=M.children.indexOf(w.id);if(S===0)return g(M.id)+a;const T=u.getNodeLikeDatum(M.children[S-1]);if(ti(T.children))return v(T)+a;const A=u.getDescendantsData(T.id);return Math.max(...A.map(O=>ps(O)?g(O.id):v(O)))+a}else{if(ti(w.children))return g(w.id)+a;const M=u.getNodeLikeDatum(w.children.slice(-1)[0]);if(ti(M.children))return v(M)+a;const S=u.getDescendantsData(w.id).slice(-1)[0];return(ps(S)?g(S.id):v(S))+a}},w=>w.id);let p=0;const y={nodes:[],edges:[]},m=w=>{var M;(M=w.children)===null||M===void 0||M.forEach(N=>m(u.getNodeLikeDatum(N)));const S=v(w),T=f(w);if(y.nodes.push({id:w.id,x:T,y:S}),w0(w))return;const A=u.getRelatedEdgesData(w.id,"in")[0],O=[h(w),ps(w)?S:g(w.id)];y.edges.push({id:Q(A),controlPoints:[O],relatedNodeId:w.id}),p=Math.max(p,T+i(w)),w.depth===1&&(c=p)};return m(e),y}placeAlterative(e,t){const n=(t.children||[]).filter((o,u)=>u%2!==0);if(n.length===0)return e;const{model:i}=this.context,a=e.nodes.find(o=>o.id===t.id).y,s=o=>{const u=i.getAncestorsData(o,"tree");if(ti(u))return!1;const l=u.length===1?o:u[u.length-2].id;return n.includes(l)};e.nodes.forEach(o=>{s(o.id)&&(o.y=2*a-o.y)}),e.edges.forEach(o=>{s(o.relatedNodeId)&&(o.controlPoints=o.controlPoints.map(u=>[u[0],2*a-u[1]]))})}rightToLeft(e,t){return e.nodes.forEach(n=>n.x=t.width-n.x),e.edges.forEach(n=>{n.controlPoints=n.controlPoints.map(i=>[t.width-i[0],i[1]])}),e}execute(e,t){return AG(this,void 0,void 0,function*(){const n=Object.assign(Object.assign(Object.assign({},bd.defaultOptions),this.options),t),{direction:i,nodeSize:a}=n,s=this.getRoot();if(!s)return e;const o=this.formatSize(a);n.vGap||(n.vGap=Math.max(...(e.nodes||[]).map(h=>o(h)[1]))),n.hGap||(n.hGap=Math.max(...(e.nodes||[]).map(h=>o(h)[0])));let u=this.doLayout(s,n);this.placeAlterative(u,s),i==="RL"&&(u=this.rightToLeft(u,n));const{model:l}=this.context,c=[],d=[];return u.nodes.forEach(h=>{const{id:f,x:g,y:v}=h,p=l.getNodeLikeDatum(f);c.push(bS(p,{x:g,y:v}))}),u.edges.forEach(h=>{const{id:f,controlPoints:g}=h,v=l.getEdgeDatum(f);d.push(bS(v,{controlPoints:g}))}),{nodes:c,edges:d}})}}bd.defaultOptions={direction:"RL",getRibSep:()=>60};const bS=(r,e)=>Object.assign(Object.assign({},r),{style:Object.assign(Object.assign({},r.style||{}),e)}),w0=r=>r.depth===0,ps=r=>(r.depth||(r.depth=0))%2===0;var kG=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})};class wd extends Zc{constructor(){super(...arguments),this.id="snake"}formatSize(e,t){const n=typeof t=="function"?t:()=>t;return e.reduce((i,a)=>{const[s,o]=hr(n(a))||[0,0];return[Math.max(i[0],s),Math.max(i[1],o)]},[0,0])}validate(e){const{nodes:t=[],edges:n=[]}=e,i={},a={},s={};t.forEach(h=>{i[h.id]=0,a[h.id]=0,s[h.id]=[]}),n.forEach(h=>{i[h.target]++,a[h.source]++,s[h.source].push(h.target)});const o=new Set,u=h=>{o.has(h)||(o.add(h),s[h].forEach(u))};if(u(t[0].id),o.size!==t.length)return!1;const l=t.filter(h=>i[h.id]===0),c=t.filter(h=>a[h.id]===0);return!(l.length!==1||c.length!==1||t.filter(h=>i[h.id]===1&&a[h.id]===1).length!==t.length-2)}execute(e,t){return kG(this,void 0,void 0,function*(){var n;if(!this.validate(e))return e;const{nodeSize:i,padding:a,sortBy:s,cols:o,colGap:u,rowGap:l,clockwise:c,width:d,height:h}=Object.assign({},wd.defaultOptions,this.options,t),[f,g,v,p]=hi(a),y=this.formatSize(e.nodes||[],i),m=Math.ceil((e.nodes||[]).length/o);let w=u||(d-p-g-o*y[0])/(o-1),M=l||(h-f-v-m*y[1])/(m-1);return(M===1/0||M<0)&&(M=0),(w===1/0||w<0)&&(w=0),{nodes:((s?(n=e.nodes)===null||n===void 0?void 0:n.sort(s):NG(e))||[]).map((A,O)=>{const N=Math.floor(O/o),C=O%o,P=c?N%2===0?C:o-1-C:N%2===0?o-1-C:C,D=p+P*(y[0]+w)+y[0]/2,j=f+N*(y[1]+M)+y[1]/2;return{id:A.id,style:{x:D,y:j}}})}})}}wd.defaultOptions={padding:0,cols:5,clockwise:!0};function NG(r){const{nodes:e=[],edges:t=[]}=r,n={},i={};e.forEach(o=>{n[o.id]=0,i[o.id]=[]}),t.forEach(o=>{n[o.target]++,i[o.source].push(o.target)});const a=[],s=[];for(e.forEach(o=>{n[o.id]===0&&a.push(o.id)});a.length>0;){const o=a.shift(),u=e.find(l=>l.id===o);s.push(u),i[o].forEach(l=>{n[l]--,n[l]===0&&a.push(l)})}return s}const CG=["rgb(158, 1, 66)","rgb(213, 62, 79)","rgb(244, 109, 67)","rgb(253, 174, 97)","rgb(254, 224, 139)","rgb(255, 255, 191)","rgb(230, 245, 152)","rgb(171, 221, 164)","rgb(102, 194, 165)","rgb(50, 136, 189)","rgb(94, 79, 162)"],PG=["rgb(78, 121, 167)","rgb(242, 142, 44)","rgb(225, 87, 89)","rgb(118, 183, 178)","rgb(89, 161, 79)","rgb(237, 201, 73)","rgb(175, 122, 161)","rgb(255, 157, 167)","rgb(156, 117, 95)","rgb(186, 176, 171)"],LG=["rgb(255, 245, 235)","rgb(254, 230, 206)","rgb(253, 208, 162)","rgb(253, 174, 107)","rgb(253, 141, 60)","rgb(241, 105, 19)","rgb(217, 72, 1)","rgb(166, 54, 3)","rgb(127, 39, 4)"],DG=["rgb(247, 252, 245)","rgb(229, 245, 224)","rgb(199, 233, 192)","rgb(161, 217, 155)","rgb(116, 196, 118)","rgb(65, 171, 93)","rgb(35, 139, 69)","rgb(0, 109, 44)","rgb(0, 68, 27)"],IG=["rgb(247, 251, 255)","rgb(222, 235, 247)","rgb(198, 219, 239)","rgb(158, 202, 225)","rgb(107, 174, 214)","rgb(66, 146, 198)","rgb(33, 113, 181)","rgb(8, 81, 156)","rgb(8, 48, 107)"];class An extends _m{}function Ks(r,e=!0,t){const n=document.createElement("div");return n.setAttribute("class",`g6-${r}`),Object.assign(n.style,{position:"absolute",display:"block"}),e&&Object.assign(n.style,{position:"unset",gridArea:"1 / 1 / 2 / 2",inset:"0px",height:"100%",width:"100%",overflow:"hidden",pointerEvents:"none"}),t&&Object.assign(n.style,t),n}function By(r,e="div",t={},n="",i=document.body){const a=document.getElementById(r);a&&a.remove();const s=document.createElement(e);return s.innerHTML=n,s.id=r,Object.assign(s.style,t),i.appendChild(s),s}var RG=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})};class xd extends An{constructor(e,t){super(e,Object.assign({},xd.defaultOptions,t)),this.$element=Ks("background"),this.context.canvas.getContainer().prepend(this.$element),this.update(t)}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return RG(this,void 0,void 0,function*(){t.update.call(this,e),Object.assign(this.$element.style,om(this.options,["key","type"]))})}destroy(){super.destroy(),this.$element.remove()}}xd.defaultOptions={transition:"background 0.5s",backgroundSize:"cover",zIndex:"-1"};function a1(r,e,t,n,i,a){const s=r,o=e,u=t-s,l=n-o;let c=i-s,d=a-o,h=c*u+d*l,f=0;h<=0?f=0:(c=u-c,d=l-d,h=c*u+d*l,h<=0?f=0:f=h*h/(u*u+l*l));const g=c*c+d*d-f;return g<0?0:g}function na(r,e,t,n){return(r-t)*(r-t)+(e-n)*(e-n)}function wS(r,e,t,n,i){return na(r,e,t,n)<i*i}function jG(r){if(!Number.isFinite(r))return t=>t;if(r===0)return Math.round;const e=Math.pow(10,r);return t=>Math.round(t*e)/e}function dN(r){const e=Math.min(r.x1,r.x2),t=Math.max(r.x1,r.x2),n=Math.min(r.y1,r.y2),i=Math.max(r.y1,r.y2);return{x:e,y:n,x2:t,y2:i,width:t-e,height:i-n}}class pn{constructor(e,t,n,i){this.x1=e,this.y1=t,this.x2=n,this.y2=i}equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2}draw(e){e.moveTo(this.x1,this.y1),e.lineTo(this.x2,this.y2)}toString(){return`Line(from=(${this.x1},${this.y1}),to=(${this.x2},${this.y2}))`}static from(e){return new pn(e.x1,e.y1,e.x2,e.y2)}cuts(e,t){if(this.y1===this.y2||t<this.y1&&t<=this.y2||t>this.y1&&t>=this.y2||e>this.x1&&e>=this.x2)return!1;if(e<this.x1&&e<=this.x2)return!0;const n=this.x1+(t-this.y1)*(this.x2-this.x1)/(this.y2-this.y1);return e<=n}distSquare(e,t){return a1(this.x1,this.y1,this.x2,this.y2,e,t)}ptClose(e,t,n){if(this.x1<this.x2){if(e<this.x1-n||e>this.x2+n)return!1}else if(e<this.x2-n||e>this.x1+n)return!1;if(this.y1<this.y2){if(t<this.y1-n||t>this.y2+n)return!1}else if(t<this.y2-n||t>this.y1+n)return!1;return!0}}var Ft;(function(r){r[r.POINT=1]="POINT",r[r.PARALLEL=2]="PARALLEL",r[r.COINCIDENT=3]="COINCIDENT",r[r.NONE=4]="NONE"})(Ft||(Ft={}));class x0{constructor(e,t=0,n=0){this.state=e,this.x=t,this.y=n}}function bl(r,e){const t=(e.x2-e.x1)*(r.y1-e.y1)-(e.y2-e.y1)*(r.x1-e.x1),n=(r.x2-r.x1)*(r.y1-e.y1)-(r.y2-r.y1)*(r.x1-e.x1),i=(e.y2-e.y1)*(r.x2-r.x1)-(e.x2-e.x1)*(r.y2-r.y1);if(i){const a=t/i,s=n/i;return 0<=a&&a<=1&&0<=s&&s<=1?new x0(Ft.POINT,r.x1+a*(r.x2-r.x1),r.y1+a*(r.y2-r.y1)):new x0(Ft.NONE)}return new x0(t===0||n===0?Ft.COINCIDENT:Ft.PARALLEL)}function hN(r,e){const t=(e.x2-e.x1)*(r.y1-e.y1)-(e.y2-e.y1)*(r.x1-e.x1),n=(r.x2-r.x1)*(r.y1-e.y1)-(r.y2-r.y1)*(r.x1-e.x1),i=(e.y2-e.y1)*(r.x2-r.x1)-(e.x2-e.x1)*(r.y2-r.y1);if(i){const a=t/i,s=n/i;if(0<=a&&a<=1&&0<=s&&s<=1)return a}return Number.POSITIVE_INFINITY}function BG(r,e){function t(i,a,s,o){let u=hN(e,new pn(i,a,s,o));return u=Math.abs(u-.5),u>=0&&u<=1?1:0}let n=t(r.x,r.y,r.x2,r.y);return n+=t(r.x,r.y,r.x,r.y2),n>1||(n+=t(r.x,r.y2,r.x2,r.y2),n>1)?!0:(n+=t(r.x2,r.y,r.x2,r.y2),n>0)}var zt;(function(r){r[r.LEFT=0]="LEFT",r[r.TOP=1]="TOP",r[r.RIGHT=2]="RIGHT",r[r.BOTTOM=3]="BOTTOM"})(zt||(zt={}));function Il(r,e,t){const n=new Set;return r.width<=0?(n.add(zt.LEFT),n.add(zt.RIGHT)):e<r.x?n.add(zt.LEFT):e>r.x+r.width&&n.add(zt.RIGHT),r.height<=0?(n.add(zt.TOP),n.add(zt.BOTTOM)):t<r.y?n.add(zt.TOP):t>r.y+r.height&&n.add(zt.BOTTOM),n}function fN(r,e){let t=e.x1,n=e.y1;const i=e.x2,a=e.y2,s=Array.from(Il(r,i,a));if(s.length===0)return!0;let o=Il(r,t,n);for(;o.size!==0;){for(const u of s)if(o.has(u))return!1;if(o.has(zt.RIGHT)||o.has(zt.LEFT)){let u=r.x;o.has(zt.RIGHT)&&(u+=r.width),n=n+(u-t)*(a-n)/(i-t),t=u}else{let u=r.y;o.has(zt.BOTTOM)&&(u+=r.height),t=t+(u-n)*(i-t)/(a-n),n=u}o=Il(r,t,n)}return!0}function FG(r,e){let t=Number.POSITIVE_INFINITY,n=0;function i(a,s,o,u){let l=hN(e,new pn(a,s,o,u));l=Math.abs(l-.5),l>=0&&l<=1&&(n++,l<t&&(t=l))}return i(r.x,r.y,r.x2,r.y),i(r.x,r.y,r.x,r.y2),n>1||(i(r.x,r.y2,r.x2,r.y2),n>1)?t:(i(r.x2,r.y,r.x2,r.y2),n===0?-1:t)}function zG(r,e){let t=0;const n=bl(r,new pn(e.x,e.y,e.x2,e.y));t+=n.state===Ft.POINT?1:0;const i=bl(r,new pn(e.x,e.y,e.x,e.y2));t+=i.state===Ft.POINT?1:0;const a=bl(r,new pn(e.x,e.y2,e.x2,e.y2));t+=a.state===Ft.POINT?1:0;const s=bl(r,new pn(e.x2,e.y,e.x2,e.y2));return t+=s.state===Ft.POINT?1:0,{top:n,left:i,bottom:a,right:s,count:t}}class Pn{constructor(e,t,n,i){this.x=e,this.y=t,this.width=n,this.height=i}get x2(){return this.x+this.width}get y2(){return this.y+this.height}get cx(){return this.x+this.width/2}get cy(){return this.y+this.height/2}get radius(){return Math.max(this.width,this.height)/2}static from(e){return new Pn(e.x,e.y,e.width,e.height)}equals(e){return this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height}clone(){return new Pn(this.x,this.y,this.width,this.height)}add(e){const t=Math.min(this.x,e.x),n=Math.min(this.y,e.y),i=Math.max(this.x2,e.x+e.width),a=Math.max(this.y2,e.y+e.height);this.x=t,this.y=n,this.width=i-t,this.height=a-n}addPoint(e){const t=Math.min(this.x,e.x),n=Math.min(this.y,e.y),i=Math.max(this.x2,e.x),a=Math.max(this.y2,e.y);this.x=t,this.y=n,this.width=i-t,this.height=a-n}toString(){return`Rectangle[x=${this.x}, y=${this.y}, w=${this.width}, h=${this.height}]`}draw(e){e.rect(this.x,this.y,this.width,this.height)}containsPt(e,t){return e>=this.x&&e<=this.x2&&t>=this.y&&t<=this.y2}get area(){return this.width*this.height}intersects(e){return this.area<=0||e.width<=0||e.height<=0?!1:e.x+e.width>this.x&&e.y+e.height>this.y&&e.x<this.x2&&e.y<this.y2}distSquare(e,t){if(this.containsPt(e,t))return 0;const n=Il(this,e,t);return n.has(zt.TOP)?n.has(zt.LEFT)?na(e,t,this.x,this.y):n.has(zt.RIGHT)?na(e,t,this.x2,this.y):(this.y-t)*(this.y-t):n.has(zt.BOTTOM)?n.has(zt.LEFT)?na(e,t,this.x,this.y2):n.has(zt.RIGHT)?na(e,t,this.x2,this.y2):(t-this.y2)*(t-this.y2):n.has(zt.LEFT)?(this.x-e)*(this.x-e):n.has(zt.RIGHT)?(e-this.x2)*(e-this.x2):0}}function $G(r){if(r.length===0)return null;const e=r[0],t=new Pn(e.x,e.y,0,0);for(const n of r)t.addPoint(n);return t}class mc{constructor(e,t,n){this.cx=e,this.cy=t,this.radius=n}get x(){return this.cx-this.radius}get x2(){return this.cx+this.radius}get width(){return this.radius*2}get y(){return this.cy-this.radius}get y2(){return this.cy+this.radius}get height(){return this.radius*2}static from(e){return new mc(e.cx,e.cy,e.radius)}containsPt(e,t){return na(this.cx,this.cy,e,t)<this.radius*this.radius}distSquare(e,t){const n=na(this.cx,this.cy,e,t);if(n<this.radius*this.radius)return 0;const i=Math.sqrt(n)-this.radius;return i*i}draw(e){e.ellipse(this.cx,this.cy,this.radius,this.radius,0,0,Math.PI*2)}}class za{constructor(e,t=0,n=0,i=0,a=0,s=10,o=10,u=new Float32Array(Math.max(0,s*o)).fill(0)){this.pixelGroup=e,this.i=t,this.j=n,this.pixelX=i,this.pixelY=a,this.width=s,this.height=o,this.area=u}createSub(e,t){return new za(this.pixelGroup,e.x,e.y,t.x,t.y,e.width,e.height)}static fromPixelRegion(e,t){return new za(t,0,0,e.x,e.y,Math.ceil(e.width/t),Math.ceil(e.height/t))}copy(e,t){return new za(this.pixelGroup,this.scaleX(t.x),this.scaleY(t.y),t.x,t.y,e.width,e.height,e.area)}boundX(e){return e<this.i?this.i:e>=this.width?this.width-1:e}boundY(e){return e<this.j?this.j:e>=this.height?this.height-1:e}scaleX(e){return this.boundX(Math.floor((e-this.pixelX)/this.pixelGroup))}scaleY(e){return this.boundY(Math.floor((e-this.pixelY)/this.pixelGroup))}scale(e){const t=this.scaleX(e.x),n=this.scaleY(e.y),i=this.boundX(Math.ceil((e.x+e.width-this.pixelX)/this.pixelGroup)),a=this.boundY(Math.ceil((e.y+e.height-this.pixelY)/this.pixelGroup)),s=i-t,o=a-n;return new Pn(t,n,s,o)}invertScaleX(e){return Math.round(e*this.pixelGroup+this.pixelX)}invertScaleY(e){return Math.round(e*this.pixelGroup+this.pixelY)}addPadding(e,t){const n=Math.ceil(t/this.pixelGroup),i=this.boundX(e.x-n),a=this.boundY(e.y-n),s=this.boundX(e.x2+n),o=this.boundY(e.y2+n),u=s-i,l=o-a;return new Pn(i,a,u,l)}get(e,t){return e<0||t<0||e>=this.width||t>=this.height?Number.NaN:this.area[e+t*this.width]}inc(e,t,n){e<0||t<0||e>=this.width||t>=this.height||(this.area[e+t*this.width]+=n)}set(e,t,n){e<0||t<0||e>=this.width||t>=this.height||(this.area[e+t*this.width]=n)}incArea(e,t){if(e.width<=0||e.height<=0||t===0)return;const n=this.width,i=e.width,a=Math.max(0,e.i),s=Math.max(0,e.j),o=Math.min(e.i+e.width,n),u=Math.min(e.j+e.height,this.height);if(!(u<=0||o<=0||a>=n||u>=this.height))for(let l=s;l<u;l++){const c=(l-e.j)*i,d=l*n;for(let h=a;h<o;h++){const f=e.area[h-e.i+c];f!==0&&(this.area[h+d]+=t*f)}}}fill(e){this.area.fill(e)}fillArea(e,t){const n=e.x+e.y*this.width;for(let i=0;i<e.height;i++){const a=n+i*this.width;this.area.fill(t,a,a+e.width)}}fillHorizontalLine(e,t,n,i){const a=e+t*this.width;this.area.fill(i,a,a+n)}fillVerticalLine(e,t,n,i){const a=e+t*this.width;for(let s=0;s<n;s++)this.area[a+s*this.width]=i}clear(){this.area.fill(0)}toString(){let e="";for(let t=0;t<this.height;t++){const n=t*this.width;for(let i=0;i<this.width;i++){const a=this.area[n+i];e+=a.toFixed(1).padStart(6),e+=" "}e+=`
`}return e}draw(e,t=!0){if(this.width<=0||this.height<=0)return;e.save(),t&&e.translate(this.pixelX,this.pixelY);const n=this.area.reduce((s,o)=>Math.min(s,o),Number.POSITIVE_INFINITY),i=this.area.reduce((s,o)=>Math.max(s,o),Number.NEGATIVE_INFINITY),a=s=>(s-n)/(i-n);e.scale(this.pixelGroup,this.pixelGroup);for(let s=0;s<this.width;s++)for(let o=0;o<this.height;o++){const u=this.area[s+o*this.width];e.fillStyle=`rgba(0, 0, 0, ${a(u)})`,e.fillRect(s,o,1,1)}e.restore()}drawThreshold(e,t,n=!0){if(!(this.width<=0||this.height<=0)){e.save(),n&&e.translate(this.pixelX,this.pixelY),e.scale(this.pixelGroup,this.pixelGroup);for(let i=0;i<this.width;i++)for(let a=0;a<this.height;a++){const s=this.area[i+a*this.width];e.fillStyle=s>t?"black":"white",e.fillRect(i,a,1,1)}e.restore()}}}function gN(r,e){const t=n=>({x:n.x-e,y:n.y-e,width:n.width+2*e,height:n.height+2*e});return Array.isArray(r)?r.map(t):t(r)}function xS(r,e,t){return pN(Object.assign(dN(r),{distSquare:(n,i)=>a1(r.x1,r.y1,r.x2,r.y2,n,i)}),e,t)}function pN(r,e,t){const n=gN(r,t),i=e.scale(n),a=e.createSub(i,n);return qG(a,e,t,(s,o)=>r.distSquare(s,o)),a}function qG(r,e,t,n){const i=t*t;for(let a=0;a<r.height;a++)for(let s=0;s<r.width;s++){const o=e.invertScaleX(r.i+s),u=e.invertScaleY(r.j+a),l=n(o,u);if(l===0){r.set(s,a,i);continue}if(l<i){const c=t-Math.sqrt(l);r.set(s,a,c*c)}}return r}function GG(r,e,t){const n=e.scale(r),i=e.addPadding(n,t),a=e.createSub(i,{x:r.x-t,y:r.y-t}),s=n.x-i.x,o=n.y-i.y,u=i.x2-n.x2,l=i.y2-n.y2,c=i.width-s-u,d=i.height-o-l,h=t*t;a.fillArea({x:s,y:o,width:c+1,height:d+1},h);const f=[0],g=Math.max(o,s,u,l);{const m=e.invertScaleX(n.x+n.width/2);for(let w=1;w<g;w++){const M=e.invertScaleY(n.y-w),S=r.distSquare(m,M);if(S<h){const T=t-Math.sqrt(S);f.push(T*T)}else break}}const v=[],p=Math.max(s,u),y=Math.max(o,u);for(let m=1;m<p;m++){const w=e.invertScaleX(n.x-m),M=[];for(let S=1;S<y;S++){const T=e.invertScaleY(n.y-S),A=r.distSquare(w,T);if(A<h){const O=t-Math.sqrt(A);M.push(O*O)}else M.push(0)}v.push(M)}for(let m=1;m<Math.min(o,f.length);m++){const w=f[m];a.fillHorizontalLine(s,o-m,c+1,w)}for(let m=1;m<Math.min(l,f.length);m++){const w=f[m];a.fillHorizontalLine(s,o+d+m,c+1,w)}for(let m=1;m<Math.min(s,f.length);m++){const w=f[m];a.fillVerticalLine(s-m,o,d+1,w)}for(let m=1;m<Math.min(l,f.length);m++){const w=f[m];a.fillVerticalLine(s+c+m,o,d+1,w)}for(let m=1;m<s;m++){const w=v[m-1],M=s-m;for(let S=1;S<o;S++)a.set(M,o-S,w[S-1]);for(let S=1;S<l;S++)a.set(M,o+d+S,w[S-1])}for(let m=1;m<u;m++){const w=v[m-1],M=s+c+m;for(let S=1;S<o;S++)a.set(M,o-S,w[S-1]);for(let S=1;S<l;S++)a.set(M,o+d+S,w[S-1])}return a}function Et(r,e){return{x:r,y:e}}function WG(r,e,t,n){if(r.length===0)return[];const i=XG(r);return i.map((a,s)=>{const o=i.slice(0,s);return VG(e,a,o,t,n)}).flat()}function VG(r,e,t,n,i){const a=Et(e.cx,e.cy),s=HG(a,t,r);if(s==null)return[];const o=new pn(a.x,a.y,s.cx,s.cy),u=YG(o,r,n,i);return UG(u,r)}function YG(r,e,t,n){const i=[],a=[];a.push(r);let s=!0;for(let o=0;o<t&&s;o++)for(s=!1;!s&&a.length>0;){const u=a.pop(),l=vN(e,u),c=l?zG(u,l):null;if(!l||!c||c.count!==2){s||i.push(u);continue}let d=n,h=xl(l,d,c,!0),f=zi(h,a)||zi(h,i),g=wl(h,e);for(;!f&&g&&d>=1;)d/=1.5,h=xl(l,d,c,!0),f=zi(h,a)||zi(h,i),g=wl(h,e);if(h&&!f&&!g&&(a.push(new pn(u.x1,u.y1,h.x,h.y)),a.push(new pn(h.x,h.y,u.x2,u.y2)),s=!0),s)continue;d=n,h=xl(l,d,c,!1);let v=zi(h,a)||zi(h,i);for(g=wl(h,e);!v&&g&&d>=1;)d/=1.5,h=xl(l,d,c,!1),v=zi(h,a)||zi(h,i),g=wl(h,e);h&&!v&&(a.push(new pn(u.x1,u.y1,h.x,h.y)),a.push(new pn(h.x,h.y,u.x2,u.y2)),s=!0),s||i.push(u)}for(;a.length>0;)i.push(a.pop());return i}function UG(r,e){const t=[];for(;r.length>0;){const n=r.pop();if(r.length===0){t.push(n);break}const i=r.pop(),a=new pn(n.x1,n.y1,i.x2,i.y2);vN(e,a)?(t.push(n),r.push(i)):r.push(a)}return t}function HG(r,e,t){let n=Number.POSITIVE_INFINITY;return e.reduce((i,a)=>{const s=na(r.x,r.y,a.cx,a.cy);if(s>n)return i;const o=new pn(r.x,r.y,a.cx,a.cy),u=KG(t,o);return s*(u+1)*(u+1)<n&&(i=a,n=s*(u+1)*(u+1)),i},null)}function XG(r){if(r.length<2)return r;let e=0,t=0;return r.forEach(n=>{e+=n.cx,t+=n.cy}),e/=r.length,t/=r.length,r.map(n=>{const i=e-n.cx,a=t-n.cy,s=i*i+a*a;return[n,s]}).sort((n,i)=>n[1]-i[1]).map(n=>n[0])}function wl(r,e){return e.some(t=>t.containsPt(r.x,r.y))}function zi(r,e){return e.some(t=>!!(wS(t.x1,t.y1,r.x,r.y,.001)||wS(t.x2,t.y2,r.x,r.y,.001)))}function vN(r,e){let t=Number.POSITIVE_INFINITY,n=null;for(const i of r){if(!fN(i,e))continue;const a=FG(i,e);a>=0&&a<t&&(n=i,t=a)}return n}function KG(r,e){return r.reduce((t,n)=>fN(n,e)&&BG(n,e)?t+1:t,0)}function xl(r,e,t,n){const i=t.top,a=t.left,s=t.bottom,o=t.right;if(n){if(a.state===Ft.POINT){if(i.state===Ft.POINT)return Et(r.x-e,r.y-e);if(s.state===Ft.POINT)return Et(r.x-e,r.y2+e);const h=r.width*r.height;return r.width*((a.y-r.y+(o.y-r.y))*.5)<h*.5?a.y>o.y?Et(r.x-e,r.y-e):Et(r.x2+e,r.y-e):a.y<o.y?Et(r.x-e,r.y2+e):Et(r.x2+e,r.y2+e)}if(o.state===Ft.POINT){if(i.state===Ft.POINT)return Et(r.x2+e,r.y-e);if(s.state===Ft.POINT)return Et(r.x2+e,r.y2+e)}const c=r.height*r.width;return r.height*((i.x-r.x+(o.x-r.x))*.5)<c*.5?i.x>s.x?Et(r.x-e,r.y-e):Et(r.x-e,r.y2+e):i.x<s.x?Et(r.x2+e,r.y-e):Et(r.x2+e,r.y2+e)}if(a.state===Ft.POINT){if(i.state===Ft.POINT)return Et(r.x2+e,r.y2+e);if(s.state===Ft.POINT)return Et(r.x2+e,r.y-e);const c=r.height*r.width;return r.width*((a.y-r.y+(o.y-r.y))*.5)<c*.5?a.y>o.y?Et(r.x2+e,r.y2+e):Et(r.x-e,r.y2+e):a.y<o.y?Et(r.x2+e,r.y-e):Et(r.x-e,r.y-e)}if(o.state===Ft.POINT){if(i.state===Ft.POINT)return Et(r.x-e,r.y2+e);if(s.state===Ft.POINT)return Et(r.x-e,r.y-e)}const u=r.height*r.width;return r.height*((i.x-r.x+(o.x-r.x))*.5)<u*.5?i.x>s.x?Et(r.x2+e,r.y2+e):Et(r.x2+e,r.y-e):i.x<s.x?Et(r.x-e,r.y2+e):Et(r.x-e,r.y-e)}function ZG(r,e,t,n){if(!(r.closed?t<r.length:t<r.length-1))return!1;const a=r.get(e),s=r.get(t+1);for(let o=e+1;o<=t;o++){const u=r.get(o);if(a1(a.x,a.y,s.x,s.y,u.x,u.y)>n)return!1}return!0}function QG(r=0){return e=>{if(r<0||e.length<3)return e;const t=[];let n=0;const i=r*r;for(;n<e.length;){let a=n+1;for(;ZG(e,n,a,i);)a++;t.push(e.get(n)),n=a}return new Zs(t)}}function JG(r,e){switch(r){case-2:return(((-e+3)*e-3)*e+1)/6;case-1:return((3*e-6)*e*e+4)/6;case 0:return(((-3*e+3)*e+3)*e+1)/6;case 1:return e*e*e/6;default:throw new Error("unknown error")}}function eW(r=6){function a(s,o,u){let l=0,c=0;for(let d=-2;d<=1;d++){const h=s.get(o+d),f=JG(d,u);l+=f*h.x,c+=f*h.y}return{x:l,y:c}}return s=>{if(s.length<3)return s;const o=[],u=s.closed,l=s.length+3-1+(u?0:2);o.push(a(s,2-(u?0:2),0));for(let c=2-(u?0:2);c<l;c++)for(let d=1;d<=r;d++)o.push(a(s,c,d/r));return new Zs(o)}}function tW(r=8){return e=>{let t=r,n=e.length;if(t>1)for(n=Math.floor(e.length/t);n<3&&t>1;)t-=1,n=Math.floor(e.length/t);const i=[];for(let a=0,s=0;s<n;s++,a+=t)i.push(e.get(a));return new Zs(i)}}class Zs{constructor(e=[],t=!0){this.points=e,this.closed=t}get(e){const t=e,n=this.points.length;return e<0?this.closed?this.get(e+n):this.points[0]:e>=n?this.closed?this.get(e-n):this.points[n-1]:this.points[t]}get length(){return this.points.length}toString(e=1/0){const t=this.points;if(t.length===0)return"";const n=typeof e=="function"?e:jG(e);let i="M";for(const a of t)i+=`${n(a.x)},${n(a.y)} L`;return i=i.slice(0,-1),this.closed&&(i+=" Z"),i}draw(e){const t=this.points;if(t.length!==0){e.beginPath(),e.moveTo(t[0].x,t[0].y);for(const n of t)e.lineTo(n.x,n.y);this.closed&&e.closePath()}}sample(e){return tW(e)(this)}simplify(e){return QG(e)(this)}bSplines(e){return eW(e)(this)}apply(e){return e(this)}containsElements(e){const t=$G(this.points);return t?e.every(n=>t.containsPt(n.cx,n.cy)&&this.withinArea(n.cx,n.cy)):!1}withinArea(e,t){if(this.length===0)return!1;let n=0;const i=this.points[0],a=new pn(i.x,i.y,i.x,i.y);for(let s=1;s<this.points.length;s++){const o=this.points[s];a.x1=a.x2,a.y1=a.y2,a.x2=o.x,a.y2=o.y,a.cuts(e,t)&&n++}return a.x1=a.x2,a.y1=a.y2,a.x2=i.x,a.y2=i.y,a.cuts(e,t)&&n++,n%2===1}}class nW{constructor(e=0){this.count=0,this.arr=[],this.set=new Set,this.arr.length=e}add(e){this.set.add(`${e.x}x${e.y}`),this.arr[this.count++]=e}contains(e){return this.set.has(`${e.x}x${e.y}`)}isFirst(e){if(this.count===0)return!1;const t=this.arr[0];return t!=null&&t.x===e.x&&t.y===e.y}path(){return new Zs(this.arr.slice(0,this.count))}clear(){this.set.clear(),this.count=0}get(e){return this.arr[e]}get length(){return this.count}}const oo=0,El=1,Ml=2,E0=3;function rW(r,e){const t=(Math.floor(r.width)+Math.floor(r.height))*2,n=new nW(t);function i(u,l,c,d){const h=r.get(u,l);return Number.isNaN(h)?Number.NaN:h>e?c+d:c}function a(u,l){let c=oo;return c=i(u,l,c,1),c=i(u+1,l,c,2),c=i(u,l+1,c,4),c=i(u+1,l+1,c,8),Number.isNaN(c)?-1:c}let s=El;function o(u,l){let c=u,d=l,h=r.invertScaleX(c),f=r.invertScaleY(d);for(let g=0;g<r.width*r.height;g++){const v={x:h,y:f};if(n.contains(v)){if(n.isFirst(v))return!0}else n.add(v);const p=a(c,d);switch(p){case-1:return!0;case 0:case 3:case 2:case 7:s=Ml;break;case 12:case 14:case 4:s=E0;break;case 6:s=s===oo?E0:Ml;break;case 1:case 13:case 5:s=oo;break;case 9:s=s===Ml?oo:El;break;case 10:case 8:case 11:s=El;break;default:return console.warn("Marching squares invalid state: "+p),!0}switch(s){case oo:d--,f-=r.pixelGroup;break;case El:d++,f+=r.pixelGroup;break;case E0:c--,h-=r.pixelGroup;break;case Ml:c++,h+=r.pixelGroup;break;default:return console.warn("Marching squares invalid state: "+p),!0}}return!0}for(let u=0;u<r.width;u++)for(let l=0;l<r.height;l++){if(r.get(u,l)<=e)continue;const c=a(u,l);if(!(c<0||c===15)&&o(u,l))return n.path()}return null}const Ed={maxRoutingIterations:100,maxMarchingIterations:20,pixelGroup:4,edgeR0:10,edgeR1:20,nodeR0:15,nodeR1:50,morphBuffer:10,threshold:1,memberInfluenceFactor:1,edgeInfluenceFactor:1,nonMemberInfluenceFactor:-.8,virtualEdges:!0};function Po(r){return r!=null&&typeof r.radius=="number"}function ES(r,e){if(Po(r)!==Po(e))return!1;if(Po(r)){const n=e;return r.cx===n.cx&&r.cy===n.cy&&r.radius===n.radius}const t=e;return r.x===t.x&&r.y===t.y&&r.width===t.width&&r.height===t.height}var Ir;(function(r){r[r.MEMBERS=0]="MEMBERS",r[r.NON_MEMBERS=1]="NON_MEMBERS",r[r.EDGES=2]="EDGES"})(Ir||(Ir={}));let MS=class{constructor(e={}){this.dirty=new Set,this.members=[],this.nonMembers=[],this.virtualEdges=[],this.edges=[],this.activeRegion=new Pn(0,0,0,0),this.potentialArea=new za(1,0,0,0,0,0,0),this.o=Object.assign({},Ed,e)}pushMember(...e){if(e.length!==0){this.dirty.add(Ir.MEMBERS);for(const t of e)this.members.push({raw:t,obj:Po(t)?mc.from(t):Pn.from(t),area:null})}}removeMember(e){const t=this.members.findIndex(n=>ES(n.raw,e));return t<0?!1:(this.members.splice(t,1),this.dirty.add(Ir.MEMBERS),!0)}removeNonMember(e){const t=this.nonMembers.findIndex(n=>ES(n.raw,e));return t<0?!1:(this.nonMembers.splice(t,1),this.dirty.add(Ir.NON_MEMBERS),!0)}removeEdge(e){const t=this.edges.findIndex(n=>n.obj.equals(e));return t<0?!1:(this.edges.splice(t,1),this.dirty.add(Ir.NON_MEMBERS),!0)}pushNonMember(...e){if(e.length!==0){this.dirty.add(Ir.NON_MEMBERS);for(const t of e)this.nonMembers.push({raw:t,obj:Po(t)?mc.from(t):Pn.from(t),area:null})}}pushEdge(...e){if(e.length!==0){this.dirty.add(Ir.EDGES);for(const t of e)this.edges.push({raw:t,obj:pn.from(t),area:null})}}update(){const e=this.dirty.has(Ir.MEMBERS),t=this.dirty.has(Ir.NON_MEMBERS);let n=this.dirty.has(Ir.EDGES);this.dirty.clear();const i=this.members.map(l=>l.obj);if(this.o.virtualEdges&&(e||t)){const l=this.nonMembers.map(h=>h.obj),c=WG(i,l,this.o.maxRoutingIterations,this.o.morphBuffer),d=new Map(this.virtualEdges.map(h=>[h.obj.toString(),h.area]));this.virtualEdges=c.map(h=>{var f;return{raw:h,obj:h,area:(f=d.get(h.toString()))!==null&&f!==void 0?f:null}}),n=!0}let a=!1;if(e||n){const l=this.virtualEdges.concat(this.edges).map(f=>f.obj),c=aW(i,l),d=Math.max(this.o.edgeR1,this.o.nodeR1)+this.o.morphBuffer,h=Pn.from(gN(c,d));h.equals(this.activeRegion)||(a=!0,this.activeRegion=h)}if(a){const l=Math.ceil(this.activeRegion.width/this.o.pixelGroup),c=Math.ceil(this.activeRegion.height/this.o.pixelGroup);this.activeRegion.x!==this.potentialArea.pixelX||this.activeRegion.y!==this.potentialArea.pixelY?(this.potentialArea=za.fromPixelRegion(this.activeRegion,this.o.pixelGroup),this.members.forEach(d=>d.area=null),this.nonMembers.forEach(d=>d.area=null),this.edges.forEach(d=>d.area=null),this.virtualEdges.forEach(d=>d.area=null)):(l!==this.potentialArea.width||c!==this.potentialArea.height)&&(this.potentialArea=za.fromPixelRegion(this.activeRegion,this.o.pixelGroup))}const s=new Map,o=l=>{if(l.area){const c=`${l.obj.width}x${l.obj.height}x${l.obj instanceof Pn?"R":"C"}`;s.set(c,l.area)}},u=l=>{if(l.area)return;const c=`${l.obj.width}x${l.obj.height}x${l.obj instanceof Pn?"R":"C"}`;if(s.has(c)){const h=s.get(c);l.area=this.potentialArea.copy(h,{x:l.obj.x-this.o.nodeR1,y:l.obj.y-this.o.nodeR1});return}const d=l.obj instanceof Pn?GG(l.obj,this.potentialArea,this.o.nodeR1):pN(l.obj,this.potentialArea,this.o.nodeR1);l.area=d,s.set(c,d)};this.members.forEach(o),this.nonMembers.forEach(o),this.members.forEach(u),this.nonMembers.forEach(l=>{this.activeRegion.intersects(l.obj)?u(l):l.area=null}),this.edges.forEach(l=>{l.area||(l.area=xS(l.obj,this.potentialArea,this.o.edgeR1))}),this.virtualEdges.forEach(l=>{l.area||(l.area=xS(l.obj,this.potentialArea,this.o.edgeR1))})}drawMembers(e){for(const t of this.members)t.obj.draw(e)}drawNonMembers(e){for(const t of this.nonMembers)t.obj.draw(e)}drawEdges(e){for(const t of this.edges)t.obj.draw(e)}drawPotentialArea(e,t=!0){this.potentialArea.draw(e,t)}compute(){if(this.members.length===0)return new Zs([]);this.dirty.size>0&&this.update();const{o:e,potentialArea:t}=this,n=this.members.map(o=>o.area),i=this.virtualEdges.concat(this.edges).map(o=>o.area),a=this.nonMembers.filter(o=>o.area!=null).map(o=>o.area),s=this.members.map(o=>o.obj);return iW(t,n,i,a,o=>o.containsElements(s),e)}};function iW(r,e,t,n,i,a={}){const s=Object.assign({},Ed,a);let o=s.threshold,u=s.memberInfluenceFactor,l=s.edgeInfluenceFactor,c=s.nonMemberInfluenceFactor;const d=(s.nodeR0-s.nodeR1)*(s.nodeR0-s.nodeR1),h=(s.edgeR0-s.edgeR1)*(s.edgeR0-s.edgeR1);for(let f=0;f<s.maxMarchingIterations;f++){if(r.clear(),u!==0){const v=u/d;for(const p of e)r.incArea(p,v)}if(l!==0){const v=l/h;for(const p of t)r.incArea(p,v)}if(c!==0){const v=c/d;for(const p of n)r.incArea(p,v)}const g=rW(r,o);if(g&&i(g))return g;if(o*=.95,f<=s.maxMarchingIterations*.5)u*=1.2,l*=1.2;else if(c!==0&&n.length>0)c*=.8;else break}return new Zs([])}function aW(r,e){if(r.length===0)return new Pn(0,0,0,0);const t=Pn.from(r[0]);for(const n of r)t.add(n);for(const n of e)t.add(dN(n));return t}var sW=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Md extends An{constructor(e,t){super(e,Gn({},Md.defaultOptions,t)),this.members=new Map,this.avoidMembers=new Map,this.bubbleSetOptions={},this.drawBubbleSets=()=>{const{style:n,bubbleSetOptions:i}=this.parseOptions();Bt(this.bubbleSetOptions,i)||this.init(),this.bubbleSetOptions=Object.assign({},i);const a=Object.assign(Object.assign({},n),{d:this.getPath()});this.shape?this.shape.update(a):(this.shape=new pu({style:a}),this.context.canvas.appendChild(this.shape))},this.updateBubbleSetsPath=n=>{if(!this.shape)return;const i=Q(n.data);[...this.options.members,...this.options.avoidMembers].includes(i)&&this.shape.update(Object.assign(Object.assign({},this.parseOptions().style),{d:this.getPath(i)}))},this.getPath=n=>{const{graph:i}=this.context,a=this.options.members,s=[...this.members.keys()],o=this.options.avoidMembers,u=[...this.avoidMembers.keys()];if(!n&&Bt(a,s)&&Bt(o,u))return this.path;const{enter:l=[],exit:c=[]}=aa(s,a,p=>p),{enter:d=[],exit:h=[]}=aa(u,o,p=>p);n&&(c.push(n),l.push(n));const f=(p,y,m)=>{p.forEach(w=>{const M=m?this.members:this.avoidMembers,S=m?"pushMember":"pushNonMember",T=m?"removeMember":"removeNonMember";if(y){let A;i.getElementType(w)==="edge"?([A]=uW(i,w),this.bubbleSets.pushEdge(A)):([A]=oW(i,w),this.bubbleSets[S](A)),M.set(w,A)}else{const A=M.get(w);A&&(i.getElementType(w)==="edge"?this.bubbleSets.removeEdge(A):this.bubbleSets[T](A),M.delete(w))}})};f(c,!1,!0),f(l,!0,!0),f(h,!1,!1),f(d,!0,!1);const v=this.bubbleSets.compute().sample(8).simplify(0).bSplines().simplify(0);return this.path=rA(v.points.map(En)),this.path},this.bindEvents(),this.bubbleSets=new MS(this.options)}bindEvents(){this.context.graph.on(ve.AFTER_RENDER,this.drawBubbleSets),this.context.graph.on(ve.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath)}init(){this.bubbleSets=new MS(this.options),this.members=new Map,this.avoidMembers=new Map}parseOptions(){const e=this.options,{type:t,key:n,members:i,avoidMembers:a}=e,s=sW(e,["type","key","members","avoidMembers"]),o=Object.keys(s).reduce((u,l)=>(l in Ed?u.bubbleSetOptions[l]=s[l]:u.style[l]=s[l],u),{style:{},bubbleSetOptions:{}});return Object.assign({type:t,key:n,members:i,avoidMembers:a},o)}addMember(e){const t=Array.isArray(e)?e:[e];t.some(n=>this.options.avoidMembers.includes(n))&&(this.options.avoidMembers=this.options.avoidMembers.filter(n=>!t.includes(n))),this.options.members=[...new Set([...this.options.members,...t])],this.drawBubbleSets()}removeMember(e){const t=Array.isArray(e)?e:[e];this.options.members=this.options.members.filter(n=>!t.includes(n)),this.drawBubbleSets()}updateMember(e){this.options.members=Te(e)?e(this.options.members):e,this.drawBubbleSets()}getMember(){return this.options.members}addAvoidMember(e){const t=Array.isArray(e)?e:[e];t.some(n=>this.options.members.includes(n))&&(this.options.members=this.options.members.filter(n=>!t.includes(n))),this.options.avoidMembers=[...new Set([...this.options.avoidMembers,...t])],this.drawBubbleSets()}removeAvoidMember(e){const t=Array.isArray(e)?e:[e];this.options.avoidMembers.some(n=>t.includes(n))&&(this.options.avoidMembers=this.options.avoidMembers.filter(n=>!t.includes(n)),this.drawBubbleSets())}updateAvoidMember(e){this.options.avoidMembers=Array.isArray(e)?e:[e],this.drawBubbleSets()}getAvoidMember(){return this.options.avoidMembers}destroy(){this.context.graph.off(ve.AFTER_RENDER,this.drawBubbleSets),this.context.graph.off(ve.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath),this.shape.destroy(),super.destroy()}}Md.defaultOptions=Object.assign({members:[],avoidMembers:[],fill:"lightblue",fillOpacity:.2,stroke:"blue",strokeOpacity:.2},Ed);const oW=(r,e)=>(Array.isArray(e)?e:[e]).map(n=>{const i=r.getElementRenderBounds(n);return new Pn(i.min[0],i.min[1],fi(i),gi(i))}),uW=(r,e)=>(Array.isArray(e)?e:[e]).map(n=>{const i=r.getEdgeData(n),a=r.getElementPosition(i.source),s=r.getElementPosition(i.target);return pn.from({x1:a[0],y1:a[1],x2:s[0],y2:s[1]})});function lW(r){return`
    <ul class="g6-contextmenu-ul">
      ${r.map(e=>`<li  class="g6-contextmenu-li" value="${e.value}">${e.name}</li>`).join("")}
    </ul>
  `}const cW=`
  .g6-contextmenu {
    font-size: 12px;
    background-color: rgba(255, 255, 255, 0.96);
    border-radius: 4px;
    overflow: hidden;
    box-shadow: rgba(0, 0, 0, 0.12) 0px 6px 12px 0px;
    transition: visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1) 0s, left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s;
  }

  .g6-contextmenu-ul {
    max-width: 256px;
    min-width: 96px;
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .g6-contextmenu-li {
    padding: 8px 12px;
    cursor: pointer;
    user-select: none;
  }

  .g6-contextmenu-li:hover {
    background-color: #f5f5f5;
    cursor: pointer;
  }
`;var SS=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})};class Sd extends An{constructor(e,t){super(e,Object.assign({},Sd.defaultOptions,t)),this.targetElement=null,this.onTriggerEvent=n=>{var i;(i=n.preventDefault)===null||i===void 0||i.call(n),this.show(n)},this.onMenuItemClick=n=>{const{onClick:i,trigger:a}=this.options;if(n.target instanceof HTMLElement&&n.target.className.includes("g6-contextmenu-li")){const s=n.target.getAttribute("value");i==null||i(s,n.target,this.targetElement),this.hide()}a!=="click"&&this.hide()},this.initElement(),this.update(t)}initElement(){this.$element=Ks("contextmenu",!1,{zIndex:"99"});const{className:e}=this.options;e&&this.$element.classList.add(e),this.context.canvas.getContainer().appendChild(this.$element),By("g6-contextmenu-css","style",{},cW,document.head)}show(e){return SS(this,void 0,void 0,function*(){const{enable:t,offset:n}=this.options;if(typeof t=="function"&&!t(e)||!t){this.hide();return}const i=yield this.getDOMContent(e);i instanceof HTMLElement?(this.$element.innerHTML="",this.$element.appendChild(i)):this.$element.innerHTML=i;const a=this.context.graph.getCanvas().getContainer().getBoundingClientRect();this.$element.style.left=`${e.client.x-a.left+n[0]}px`,this.$element.style.top=`${e.client.y-a.top+n[1]}px`,this.$element.style.display="block",this.targetElement=e.target})}hide(){this.$element.style.display="none",this.targetElement=null}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy(),this.$element.remove()}getDOMContent(e){return SS(this,void 0,void 0,function*(){const{getContent:t,getItems:n}=this.options;return n?lW(yield n(e)):yield t(e)})}bindEvents(){const{graph:e}=this.context,{trigger:t}=this.options;e.on(`canvas:${t}`,this.onTriggerEvent),e.on(`node:${t}`,this.onTriggerEvent),e.on(`edge:${t}`,this.onTriggerEvent),e.on(`combo:${t}`,this.onTriggerEvent),document.addEventListener("click",this.onMenuItemClick)}unbindEvents(){const{graph:e}=this.context,{trigger:t}=this.options;e.off(`canvas:${t}`,this.onTriggerEvent),e.off(`node:${t}`,this.onTriggerEvent),e.off(`edge:${t}`,this.onTriggerEvent),e.off(`combo:${t}`,this.onTriggerEvent),document.removeEventListener("click",this.onMenuItemClick)}}Sd.defaultOptions={trigger:"contextmenu",offset:[4,4],loadingContent:'<div class="g6-contextmenu-loading">Loading...</div>',getContent:()=>"It is a empty context menu.",enable:()=>!0};class _d extends An{constructor(e,t){super(e,Object.assign({},_d.defaultOptions,t)),this.edgeBundles={},this.edgePoints={},this.onBundle=()=>{const{model:n,element:i}=this.context,a=n.getEdgeData();this.divideEdges(this.options.divisions);const{cycles:s,iterRate:o,divRate:u}=this.options;let{lambda:l,divisions:c,iterations:d}=this.options;for(let h=0;h<s;h++){for(let f=0;f<d;f++){const g={};a.forEach(v=>{var p;if(v.source===v.target)return;const y=Q(v);g[y]=this.getEdgeForces(v,c,l);for(let m=0;m<c+1;m++)(p=this.edgePoints)[y]||(p[y]=[]),this.edgePoints[y][m]=$e(this.edgePoints[y][m],g[y][m])})}l/=2,c*=u,d*=o,this.divideEdges(c)}a.forEach(h=>{const f=Q(h),g=i.getElement(f);g==null||g.update({d:Dm(this.edgePoints[f])})})},this.bindEvents()}get nodeMap(){const e=this.context.model.getNodeData();return Object.fromEntries(e.map(t=>[Q(t),Ya(on(t))]))}divideEdges(e){this.context.model.getEdgeData().forEach(n=>{var i;const a=Q(n);(i=this.edgePoints)[a]||(i[a]=[]);const s=this.nodeMap[n.source],o=this.nodeMap[n.target];if(e===1)this.edgePoints[a].push(s),this.edgePoints[a].push(qr($e(s,o),2)),this.edgePoints[a].push(o);else{const l=(this.edgePoints[a].length===0?yt(s,o):pW(this.edgePoints[a]))/(e+1);let c=l;const d=[s];for(let h=1;h<this.edgePoints[a].length;h++){const f=this.edgePoints[a][h-1],g=this.edgePoints[a][h];let v=yt(g,f);for(;v>c;){const p=c/v,y=$e(f,wi(ot(g,f),p));d.push(y),v-=c,c=l}c-=v}d.push(o),this.edgePoints[a]=d}})}getVectorPosition(e){const t=this.nodeMap[e.source],n=this.nodeMap[e.target],[i,a]=ot(n,t),s=yt(t,n);return{source:t,target:n,vx:i,vy:a,length:s}}measureEdgeCompatibility(e,t){const n=this.getVectorPosition(e),i=this.getVectorPosition(t),a=dW(n,i),s=hW(n,i),o=fW(n,i),u=gW(n,i);return a*s*o*u}getEdgeBundles(){const e={},t=this.options.bundleThreshold,n=this.context.model.getEdgeData();return n.forEach((i,a)=>{n.forEach((s,o)=>{var u,l;if(o<=a)return;this.measureEdgeCompatibility(i,s)>=t&&(e[u=Q(i)]||(e[u]=[]),e[Q(i)].push(s),e[l=Q(s)]||(e[l]=[]),e[Q(s)].push(i))})}),e}getSpringForce(e,t){const{pre:n,cur:i,next:a}=e;return wi(ot($e(n,a),wi(i,2)),t)}getElectrostaticForce(e,t){ti(this.edgeBundles)&&(this.edgeBundles=this.getEdgeBundles());const n=this.edgeBundles[Q(t)];let i=[0,0];return n==null||n.forEach(a=>{const s=this.edgePoints[Q(a)][e],o=this.edgePoints[Q(t)][e],u=ot(s,o),l=yt(s,o);i=$e(i,wi(u,1/l))}),i}getEdgeForces(e,t,n){const i=this.nodeMap[e.source],a=this.nodeMap[e.target],s=this.options.K/(yt(i,a)*(t+1)),o=[[0,0]],u=Q(e);for(let l=1;l<t;l++){const c=this.getSpringForce({pre:this.edgePoints[u][l-1],cur:this.edgePoints[u][l],next:this.edgePoints[u][l+1]||[0,0]},s),d=this.getElectrostaticForce(l,e);o.push(wi($e(c,d),n))}return o.push([0,0]),o}bindEvents(){const{graph:e}=this.context;e.on(ve.AFTER_RENDER,this.onBundle)}unbindEvents(){const{graph:e}=this.context;e.off(ve.AFTER_RENDER,this.onBundle)}destroy(){this.unbindEvents(),super.destroy()}}_d.defaultOptions={K:.1,lambda:.1,divisions:1,divRate:2,cycles:6,iterations:90,iterRate:2/3,bundleThreshold:.6};const dW=(r,e)=>Math.abs(U5([r.vx,r.vy],[e.vx,e.vy])/(r.length*e.length)),hW=(r,e)=>{const t=(r.length+e.length)/2;return 2/(t/Math.min(r.length,e.length)+Math.max(r.length,e.length)/t)},fW=(r,e)=>{const t=(r.length+e.length)/2,n=qr($e(r.source,r.target),2),i=qr($e(e.source,e.target),2);return t/(t+yt(n,i))},_S=(r,e)=>{if(e.source[0]===e.target[0])return[e.source[0],r[1]];if(e.source[1]===e.target[1])return[r[0],e.source[1]];const t=(e.source[1]-e.target[1])/(e.source[0]-e.target[0]),n=(t*t*e.source[0]+t*(r[1]-e.source[1])+r[0])/(t*t+1),i=t*(n-e.source[0])+e.source[1];return[n,i]},TS=(r,e)=>{const t=_S(e.source,r),n=_S(e.target,r),i=qr($e(t,n),2),a=qr($e(r.source,r.target),2);return yt(t,n)===0?0:Math.max(0,1-2*yt(a,i)/yt(t,n))},gW=(r,e)=>Math.min(TS(r,e),TS(e,r)),pW=r=>{let e=0;for(let t=1;t<r.length;t++)e+=yt(r[t],r[t-1]);return e},vW={fill:"#fff",fillOpacity:1,lineWidth:1,stroke:"#000",strokeOpacity:.8,zIndex:-1/0},OS=.05;class Td extends An{constructor(e,t){super(e,Object.assign({},Td.defaultOptions,t)),this.shapes=new Map,this.r=this.options.r,this.onEdgeFilter=n=>{if(this.options.trigger==="drag"&&this.isLensOn)return;const i=En(n.canvas);this.renderLens(i),this.renderFocusElements()},this.renderLens=n=>{const i=Object.assign({},vW,this.options.style);this.isLensOn||(this.lens=new vu({style:i}),this.canvas.appendChild(this.lens)),Object.assign(i,Br(n),{size:this.r*2}),this.lens.update(i)},this.getFilterData=()=>{const{filter:n}=this.options,{model:i}=this.context,a=i.getData();if(!n)return a;const{nodes:s,edges:o,combos:u}=a;return{nodes:s.filter(l=>n(Q(l),"node")),edges:o.filter(l=>n(Q(l),"edge")),combos:u.filter(l=>n(Q(l),"combo"))}},this.getFocusElements=n=>{const{nodes:i,edges:a}=this.getFilterData(),s=i.filter(l=>yt(on(l),n)<this.r),o=s.map(l=>Q(l)),u=a.filter(l=>{const{source:c,target:d}=l,h=o.includes(c),f=o.includes(d);switch(this.options.nodeType){case"both":return h&&f;case"either":return h!==f;case"source":return h&&!f;case"target":return!h&&f;default:return!1}});return{nodes:s,edges:u}},this.renderFocusElements=()=>{const{element:n,graph:i}=this.context;if(!this.isLensOn)return;const a=this.lens.getCenter(),{nodes:s,edges:o}=this.getFocusElements(a),u=new Set,l=c=>{const d=Q(c);u.add(d);const h=n.getElement(d);if(!h)return;const f=this.shapes.get(d)||h.cloneNode();f.setPosition(h.getPosition()),f.id=h.id,this.shapes.has(d)?Object.entries(h.attributes).forEach(([p,y])=>{f.style[p]!==y&&(f.style[p]=y)}):(this.canvas.appendChild(f),this.shapes.set(d,f));const g=i.getElementType(d),v=this.getElementStyle(g,c);f.update(v)};s.forEach(l),o.forEach(l),this.shapes.forEach((c,d)=>{u.has(d)||(c.destroy(),this.shapes.delete(d))})},this.scaleRByWheel=n=>{var i;this.options.preventDefault&&n.preventDefault();const{clientX:a,clientY:s,deltaX:o,deltaY:u}=n,{graph:l,canvas:c}=this.context,d=l.getCanvasByClient([a,s]),h=(i=this.lens)===null||i===void 0?void 0:i.getCenter();if(!this.isLensOn||yt(d,h)>this.r)return;const{maxR:f,minR:g}=this.options,v=o+u>0?1/(1-OS):1-OS,p=Math.min(...c.getSize())/2;this.r=Math.max(g||0,Math.min(f||p,this.r*v)),this.renderLens(h),this.renderFocusElements()},this.isLensDragging=!1,this.onDragStart=n=>{var i;const a=En(n.canvas),s=(i=this.lens)===null||i===void 0?void 0:i.getCenter();!this.isLensOn||yt(a,s)>this.r||(this.isLensDragging=!0)},this.onDrag=n=>{if(!this.isLensDragging)return;const i=En(n.canvas);this.renderLens(i),this.renderFocusElements()},this.onDragEnd=()=>{this.isLensDragging=!1},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}getElementStyle(e,t){const n=e==="node"?this.options.nodeStyle:this.options.edgeStyle;return typeof n=="function"?n(t):n}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var e;const{graph:t}=this.context,{trigger:n,scaleRBy:i}=this.options,a=t.getCanvas().getLayer();["click","drag"].includes(n)&&a.addEventListener(ae.CLICK,this.onEdgeFilter),n==="pointermove"?a.addEventListener(ae.POINTER_MOVE,this.onEdgeFilter):n==="drag"&&(a.addEventListener(ae.DRAG_START,this.onDragStart),a.addEventListener(ae.DRAG,this.onDrag),a.addEventListener(ae.DRAG_END,this.onDragEnd)),i==="wheel"&&((e=this.graphDom)===null||e===void 0||e.addEventListener(ae.WHEEL,this.scaleRByWheel,{passive:!1}))}unbindEvents(){var e;const{graph:t}=this.context,{trigger:n,scaleRBy:i}=this.options,a=t.getCanvas().getLayer();["click","drag"].includes(n)&&a.removeEventListener(ae.CLICK,this.onEdgeFilter),n==="pointermove"?a.removeEventListener(ae.POINTER_MOVE,this.onEdgeFilter):n==="drag"&&(a.removeEventListener(ae.DRAG_START,this.onDragStart),a.removeEventListener(ae.DRAG,this.onDrag),a.removeEventListener(ae.DRAG_END,this.onDragEnd)),i==="wheel"&&((e=this.graphDom)===null||e===void 0||e.removeEventListener(ae.WHEEL,this.scaleRByWheel))}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}destroy(){this.unbindEvents(),this.isLensOn&&this.lens.destroy(),this.shapes.forEach((e,t)=>{e.destroy(),this.shapes.delete(t)}),super.destroy()}}Td.defaultOptions={trigger:"pointermove",r:60,nodeType:"both",filter:()=>!0,style:{lineWidth:2},nodeStyle:{label:!1},edgeStyle:{label:!0},scaleRBy:"wheel",preventDefault:!0};const yW={fill:"#ccc",fillOpacity:.1,lineWidth:2,stroke:"#000",strokeOpacity:.8,labelFontSize:12},AS=.05,kS=.1;class Od extends An{constructor(e,t){super(e,Object.assign({},Od.defaultOptions,t)),this.r=this.options.r,this.d=this.options.d,this.onCreateFisheye=n=>{if(this.options.trigger==="drag"&&this.isLensOn)return;const i=En(n.canvas);this.onMagnify(i)},this.onMagnify=n=>{n.some(isNaN)||(this.renderLens(n),this.renderFocusElements())},this.renderLens=n=>{const i=Object.assign({},yW,this.options.style);this.isLensOn||(this.lens=new vu({style:i}),this.canvas.appendChild(this.lens)),Object.assign(i,Br(n),{size:this.r*2,label:this.options.showDPercent,labelText:this.getDPercent()}),this.lens.update(i)},this.getDPercent=()=>{const{minD:n,maxD:i}=this.options;return`${Math.round((this.d-n)/(i-n)*100)}%`},this.prevMagnifiedStyleMap=new Map,this.prevOriginStyleMap=new Map,this.renderFocusElements=()=>{if(!this.isLensOn)return;const{graph:n}=this.context,i=this.lens.getCenter(),a=(this.d+1)*this.r,s=new Map,o=new Map;n.getNodeData().forEach(l=>{const c=on(l),d=yt(c,i);if(d>this.r)return;const h=a*d/(this.d*d+this.r),[f,g]=c,[v,p]=i,y=(f-v)/d,m=(g-p)/d,w=[v+h*y,p+h*m],M=Q(l),S=this.getNodeStyle(l),T=$a(n.getElementRenderStyle(M),Object.keys(S));s.set(M,Object.assign(Object.assign({},Br(w)),S)),o.set(M,Object.assign(Object.assign({},Br(c)),T))}),this.updateStyle(s,o)},this.getNodeStyle=n=>{const{nodeStyle:i}=this.options;return typeof i=="function"?i(n):i},this.updateStyle=(n,i)=>{const{graph:a,element:s}=this.context,{enter:o,exit:u,keep:l}=aa(Array.from(this.prevMagnifiedStyleMap.keys()),Array.from(n.keys()),h=>h),c=new Set,d=(h,f)=>{const g=s.getElement(h);g==null||g.update(f),a.getRelatedEdgesData(h).forEach(v=>{c.add(Q(v))})};[...o,...l].forEach(h=>{d(h,n.get(h))}),u.forEach(h=>{d(h,this.prevOriginStyleMap.get(h)),this.prevOriginStyleMap.delete(h)}),c.forEach(h=>{const f=s.getElement(h);f==null||f.update({})}),this.prevMagnifiedStyleMap=n,i.forEach((h,f)=>{this.prevOriginStyleMap.has(f)||this.prevOriginStyleMap.set(f,h)})},this.isWheelValid=n=>{if(this.options.preventDefault&&n.preventDefault(),!this.isLensOn)return!1;const{clientX:i,clientY:a}=n,s=this.context.graph.getCanvasByClient([i,a]),o=this.lens.getCenter();return!(yt(s,o)>this.r)},this.scaleR=n=>{const{maxR:i,minR:a}=this.options,s=n?1/(1-AS):1-AS,o=Math.min(...this.context.canvas.getSize())/2;this.r=Math.max(a||0,Math.min(i||o,this.r*s))},this.scaleD=n=>{const{maxD:i,minD:a}=this.options,s=n?this.d+kS:this.d-kS;this.d=Math.max(a,Math.min(i,s))},this.scaleRByWheel=n=>{if(!this.isWheelValid(n))return;const{deltaX:i,deltaY:a}=n;this.scaleR(i+a>0);const s=this.lens.getCenter();this.onMagnify(s)},this.scaleDByWheel=n=>{if(!this.isWheelValid(n))return;const{deltaX:i,deltaY:a}=n;this.scaleD(i+a>0);const s=this.lens.getCenter();this.onMagnify(s)},this.isDragValid=n=>{if(this.options.preventDefault&&n.preventDefault(),!this.isLensOn)return!1;const i=En(n.canvas),a=this.lens.getCenter();return!(yt(i,a)>this.r)},this.isLensDragging=!1,this.onDragStart=n=>{this.isDragValid(n)&&(this.isLensDragging=!0)},this.onDrag=n=>{if(!this.isLensDragging)return;const i=En(n.canvas);this.onMagnify(i)},this.onDragEnd=()=>{this.isLensDragging=!1},this.scaleRByDrag=n=>{if(!this.isLensDragging)return;const{dx:i,dy:a}=n;this.scaleR(i-a>0);const s=this.lens.getCenter();this.onMagnify(s)},this.scaleDByDrag=n=>{if(!this.isLensDragging)return;const{dx:i,dy:a}=n;this.scaleD(i-a>0);const s=this.lens.getCenter();this.onMagnify(s)},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var e;const{graph:t}=this.context,{trigger:n,scaleRBy:i,scaleDBy:a}=this.options,s=t.getCanvas().getLayer();if(["click","drag"].includes(n)&&s.addEventListener(ae.CLICK,this.onCreateFisheye),n==="pointermove"&&s.addEventListener(ae.POINTER_MOVE,this.onCreateFisheye),n==="drag"||i==="drag"||a==="drag"){s.addEventListener(ae.DRAG_START,this.onDragStart),s.addEventListener(ae.DRAG_END,this.onDragEnd);const o=n==="drag"?this.onDrag:i==="drag"?this.scaleRByDrag:this.scaleDByDrag;s.addEventListener(ae.DRAG,o)}if(i==="wheel"||a==="wheel"){const o=i==="wheel"?this.scaleRByWheel:this.scaleDByWheel;(e=this.graphDom)===null||e===void 0||e.addEventListener(ae.WHEEL,o,{passive:!1})}}unbindEvents(){var e;const{graph:t}=this.context,{trigger:n,scaleRBy:i,scaleDBy:a}=this.options,s=t.getCanvas().getLayer();if(["click","drag"].includes(n)&&s.removeEventListener(ae.CLICK,this.onCreateFisheye),n==="pointermove"&&s.removeEventListener(ae.POINTER_MOVE,this.onCreateFisheye),n==="drag"||i==="drag"||a==="drag"){s.removeEventListener(ae.DRAG_START,this.onDragStart),s.removeEventListener(ae.DRAG_END,this.onDragEnd);const o=n==="drag"?this.onDrag:i==="drag"?this.scaleRByDrag:this.scaleDByDrag;s.removeEventListener(ae.DRAG,o)}if(i==="wheel"||a==="wheel"){const o=i==="wheel"?this.scaleRByWheel:this.scaleDByWheel;(e=this.graphDom)===null||e===void 0||e.removeEventListener(ae.WHEEL,o)}}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}destroy(){var e;this.unbindEvents(),this.isLensOn&&((e=this.lens)===null||e===void 0||e.destroy()),this.prevMagnifiedStyleMap.clear(),this.prevOriginStyleMap.clear(),super.destroy()}}Od.defaultOptions={trigger:"pointermove",r:120,d:1.5,maxD:5,minD:0,showDPercent:!0,style:{},nodeStyle:{label:!0},preventDefault:!0};class Ad extends An{constructor(e,t){super(e,Object.assign({},Ad.defaultOptions,t)),this.$el=this.context.canvas.getContainer(),this.graphSize=[0,0],this.onFullscreenChange=()=>{var n,i,a,s;const o=!!document.fullscreenElement;this.options.autoFit&&this.setGraphSize(o),o?(i=(n=this.options).onEnter)===null||i===void 0||i.call(n):(s=(a=this.options).onExit)===null||s===void 0||s.call(a)},this.shortcut=new Ws(e.graph),this.bindEvents(),this.style=document.createElement("style"),document.head.appendChild(this.style),this.style.innerHTML=`
      :not(:root):fullscreen::backdrop {
        background: transparent;
      }
    `}bindEvents(){this.unbindEvents(),this.shortcut.unbindAll();const{request:e=[],exit:t=[]}=this.options.trigger;this.shortcut.bind(e,this.request),this.shortcut.bind(t,this.exit),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(i=>{document.addEventListener(i,this.onFullscreenChange,!1)})}unbindEvents(){this.shortcut.unbindAll(),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(t=>{document.removeEventListener(t,this.onFullscreenChange,!1)})}setGraphSize(e=!0){var t,n;let i,a;e?(i=((t=globalThis.screen)===null||t===void 0?void 0:t.width)||0,a=((n=globalThis.screen)===null||n===void 0?void 0:n.height)||0,this.graphSize=this.context.graph.getSize()):[i,a]=this.graphSize,this.context.graph.setSize(i,a),this.context.graph.render()}request(){document.fullscreenElement||!mW()||this.$el.requestFullscreen().catch(e=>{di.warn(`Error attempting to enable full-screen: ${e.message} (${e.name})`)})}exit(){document.fullscreenElement&&document.exitFullscreen()}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}destroy(){this.exit(),this.style.remove(),super.destroy()}}Ad.defaultOptions={trigger:{},autoFit:!0};function mW(){return document.fullscreenEnabled||Reflect.get(document,"webkitFullscreenEnabled")||Reflect.get(document,"mozFullscreenEnabled")||Reflect.get(document,"msFullscreenEnabled")}class kd extends An{constructor(e,t){super(e,Object.assign({},kd.defaultOptions,t)),this.$element=Ks("grid-line",!0),this.offset=[0,0],this.onTransform=i=>{if(!this.options.follow)return;const{data:{translate:a}}=i;a&&this.updateOffset(a)},this.context.canvas.getContainer().prepend(this.$element),this.updateStyle(),this.bindEvents()}update(e){super.update(e),this.updateStyle()}bindEvents(){const{graph:e}=this.context;e.on(ve.AFTER_TRANSFORM,this.onTransform)}updateStyle(){const{size:e,stroke:t,lineWidth:n,border:i,borderLineWidth:a,borderStroke:s,borderStyle:o}=this.options;Object.assign(this.$element.style,{border:i?`${a}px ${o} ${s}`:"none",backgroundImage:`linear-gradient(${t} ${n}px, transparent ${n}px), linear-gradient(90deg, ${t} ${n}px, transparent ${n}px)`,backgroundSize:`${e}px ${e}px`,backgroundRepeat:"repeat"})}updateOffset(e){this.offset=X5($e(this.offset,e),this.options.size),this.$element.style.backgroundPosition=`${this.offset[0]}px ${this.offset[1]}px`}destroy(){this.context.graph.off(ve.AFTER_TRANSFORM,this.onTransform),this.$element.remove(),super.destroy()}}kd.defaultOptions={border:!0,borderLineWidth:1,borderStroke:"#eee",borderStyle:"solid",lineWidth:1,size:20,stroke:"#eee"};function s1(r){const e={Added:new Map,Updated:new Map,Removed:new Map};return r.forEach(t=>{const{type:n,value:i}=t,a=Q(i);if(n==="NodeAdded"||n==="EdgeAdded"||n==="ComboAdded")e.Added.set(a,t);else if(n==="NodeUpdated"||n==="EdgeUpdated"||n==="ComboUpdated")if(e.Added.has(a))e.Added.set(a,{type:n.replace("Updated","Added"),value:i});else if(e.Updated.has(a)){const{original:s}=e.Updated.get(a);e.Updated.set(a,{type:n,value:i,original:s})}else e.Removed.has(a)||e.Updated.set(a,t);else(n==="NodeRemoved"||n==="EdgeRemoved"||n==="ComboRemoved")&&(e.Added.has(a)?e.Added.delete(a):(e.Updated.has(a)&&e.Updated.delete(a),e.Removed.set(a,t)))}),[...Array.from(e.Added.values()),...Array.from(e.Updated.values()),...Array.from(e.Removed.values())]}function yN(r){const{NodeAdded:e=[],NodeUpdated:t=[],NodeRemoved:n=[],EdgeAdded:i=[],EdgeUpdated:a=[],EdgeRemoved:s=[],ComboAdded:o=[],ComboUpdated:u=[],ComboRemoved:l=[]}=_c(r,c=>c.type);return{add:{nodes:e,edges:i,combos:o},update:{nodes:t,edges:a,combos:u},remove:{nodes:n,edges:s,combos:l}}}function mN(r,e){for(const t in r)Yt(r[t])&&!Array.isArray(r[t])&&r[t]!==null?(e[t]||(e[t]={}),mN(r[t],e[t])):e[t]===void 0&&(e[t]=qo(t))}function bW(r,e=!1,t){const n={animation:e,current:{add:{},update:{},remove:{}},original:{add:{},update:{},remove:{}}},{add:i,update:a,remove:s}=yN(s1(r));return["nodes","edges","combos"].forEach(o=>{a[o]&&a[o].forEach(u=>{var l,c;const d=Object.assign({},u.value);let h=Object.assign({},u.original);if(t){const f=t.graph.getElementType(Q(u.original)),g=f==="edge"?"stroke":"fill",v=t.element.getElementComputedStyle(f,u.original);h=Object.assign(Object.assign({},u.original),{style:Object.assign({[g]:v[g]},u.original.style)})}mN(d,h),(l=n.current.update)[o]||(l[o]=[]),n.current.update[o].push(d),(c=n.original.update)[o]||(c[o]=[]),n.original.update[o].push(h)}),i[o]&&i[o].forEach(u=>{var l,c;const d=Object.assign({},u.value);(l=n.current.add)[o]||(l[o]=[]),n.current.add[o].push(d),(c=n.original.remove)[o]||(c[o]=[]),n.original.remove[o].push(d)}),s[o]&&s[o].forEach(u=>{var l,c;const d=Object.assign({},u.value);(l=n.current.remove)[o]||(l[o]=[]),n.current.remove[o].push(d),(c=n.original.add)[o]||(c[o]=[]),n.original.add[o].push(d)})}),n}class Nd extends An{constructor(e,t){super(e,Object.assign({},Nd.defaultOptions,t)),this.batchChanges=null,this.batchAnimation=!1,this.undoStack=[],this.redoStack=[],this.freezed=!1,this.executeCommand=(i,a=!0)=>{var s,o,u;this.freezed=!0,(o=(s=this.options).executeCommand)===null||o===void 0||o.call(s,i);const l=a?i.original:i.current;this.context.graph.addData(l.add),this.context.graph.updateData(l.update),this.context.graph.removeData($O(l.remove,!1)),(u=this.context.element)===null||u===void 0||u.draw({silence:!0,animation:i.animation}),this.freezed=!1},this.addCommand=i=>{var a;if(!this.freezed){if(i.type===ve.AFTER_DRAW){const{dataChanges:s=[],animation:o=!0}=i.data;if(!((a=this.context.batch)===null||a===void 0)&&a.isBatching){if(!this.batchChanges)return;this.batchChanges.push(s),this.batchAnimation&&(this.batchAnimation=o);return}this.batchChanges=[s],this.batchAnimation=o}this.undoStackPush(bW(this.batchChanges.flat(),this.batchAnimation,this.context)),this.notify(Yi.ADD,this.undoStack[this.undoStack.length-1])}},this.initBatchCommand=i=>{const{initiate:a}=i.data;this.batchAnimation=!1,a?this.batchChanges=[]:this.undoStack.pop()||(this.batchChanges=null)},this.emitter=new Kc;const{graph:n}=this.context;n.on(ve.AFTER_DRAW,this.addCommand),n.on(ve.BATCH_START,this.initBatchCommand),n.on(ve.BATCH_END,this.addCommand)}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(){var e,t,n,i;const a=this.undoStack.pop();if(a){if(this.executeCommand(a),((t=(e=this.options).beforeAddCommand)===null||t===void 0?void 0:t.call(e,a,!1))===!1)return;this.redoStack.push(a),(i=(n=this.options).afterAddCommand)===null||i===void 0||i.call(n,a,!1),this.notify(Yi.UNDO,a)}return this}redo(){const e=this.redoStack.pop();return e&&(this.executeCommand(e,!1),this.undoStackPush(e),this.notify(Yi.REDO,e)),this}undoAndCancel(){const e=this.undoStack.pop();return e&&(this.executeCommand(e,!1),this.redoStack=[],this.notify(Yi.CANCEL,e)),this}undoStackPush(e){var t,n,i,a;const{stackSize:s}=this.options;s!==0&&this.undoStack.length>=s&&this.undoStack.shift(),((n=(t=this.options).beforeAddCommand)===null||n===void 0?void 0:n.call(t,e,!0))!==!1&&(this.undoStack.push(e),(a=(i=this.options).afterAddCommand)===null||a===void 0||a.call(i,e,!0))}clear(){this.undoStack=[],this.redoStack=[],this.batchChanges=null,this.batchAnimation=!1,this.notify(Yi.CLEAR,null)}notify(e,t){this.emitter.emit(e,{cmd:t}),this.emitter.emit(Yi.CHANGE,{cmd:t})}on(e,t){this.emitter.on(e,t)}destroy(){const{graph:e}=this.context;e.off(ve.AFTER_DRAW,this.addCommand),e.off(ve.BATCH_START,this.initBatchCommand),e.off(ve.BATCH_END,this.addCommand),this.emitter.off(),super.destroy(),this.undoStack=[],this.redoStack=[]}}Nd.defaultOptions={stackSize:0};var M0,NS;function wW(){if(NS)return M0;NS=1;function r(t,n,i,a,s,o){const u=(o-n)*(i-t)-(a-n)*(s-t);return u>0?!0:!(u<0)}function e(t,n){const i=t[0][0],a=t[0][1],s=t[1][0],o=t[1][1],u=n[0][0],l=n[0][1],c=n[1][0],d=n[1][1];return r(i,a,u,l,c,d)!==r(s,o,u,l,c,d)&&r(i,a,s,o,u,l)!==r(i,a,s,o,c,d)}return M0=e,M0}var S0,CS;function xW(){if(CS)return S0;CS=1;function r(t,n){this._cells=[],this._cellSize=n,this._reverseCellSize=1/n;for(let i=0;i<t.length;i++){const a=t[i],s=this.coordToCellNum(a[0]),o=this.coordToCellNum(a[1]);if(this._cells[s])this._cells[s][o]?this._cells[s][o].push(a):this._cells[s][o]=[a];else{const u=[];u[o]=[a],this._cells[s]=u}}}r.prototype={cellPoints:function(t,n){return this._cells[t]!==void 0&&this._cells[t][n]!==void 0?this._cells[t][n]:[]},rangePoints:function(t){const n=this.coordToCellNum(t[0]),i=this.coordToCellNum(t[1]),a=this.coordToCellNum(t[2]),s=this.coordToCellNum(t[3]),o=[];for(let u=n;u<=a;u++)for(let l=i;l<=s;l++)for(let c=0;c<this.cellPoints(u,l).length;c++)o.push(this.cellPoints(u,l)[c]);return o},removePoint:function(t){const n=this.coordToCellNum(t[0]),i=this.coordToCellNum(t[1]),a=this._cells[n][i];let s;for(let o=0;o<a.length;o++)if(a[o][0]===t[0]&&a[o][1]===t[1]){s=o;break}return a.splice(s,1),a},trunc:Math.trunc||function(t){return t-t%1},coordToCellNum:function(t){return this.trunc(t*this._reverseCellSize)},extendBbox:function(t,n){return[t[0]-n*this._cellSize,t[1]-n*this._cellSize,t[2]+n*this._cellSize,t[3]+n*this._cellSize]}};function e(t,n){return new r(t,n)}return S0=e,S0}var _0,PS;function EW(){return PS||(PS=1,_0={toXy:function(r,e){return e===void 0?r.slice():r.map(function(t){return new Function("pt","return [pt"+e[0]+",pt"+e[1]+"];")(t)})},fromXy:function(r,e){return e===void 0?r.slice():r.map(function(t){return new Function("pt","const o = {}; o"+e[0]+"= pt[0]; o"+e[1]+"= pt[1]; return o;")(t)})}}),_0}var T0,LS;function MW(){if(LS)return T0;LS=1;function r(i,a,s){return(a[0]-i[0])*(s[1]-i[1])-(a[1]-i[1])*(s[0]-i[0])}function e(i){const a=[];for(let s=0;s<i.length;s++){for(;a.length>=2&&r(a[a.length-2],a[a.length-1],i[s])<=0;)a.pop();a.push(i[s])}return a.pop(),a}function t(i){const a=i.reverse(),s=[];for(let o=0;o<a.length;o++){for(;s.length>=2&&r(s[s.length-2],s[s.length-1],a[o])<=0;)s.pop();s.push(a[o])}return s.pop(),s}function n(i){const a=e(i),o=t(i).concat(a);return o.push(i[0]),o}return T0=n,T0}var O0,DS;function SW(){if(DS)return O0;DS=1;const r=wW(),e=xW(),t=EW(),n=MW();function i(p){const y=[p[0]];let m=p[0];for(let w=1;w<p.length;w++){const M=p[w];(m[0]!==M[0]||m[1]!==M[1])&&y.push(M),m=M}return y}function a(p){return p.sort(function(y,m){return y[0]-m[0]||y[1]-m[1]})}function s(p,y){return Math.pow(y[0]-p[0],2)+Math.pow(y[1]-p[1],2)}function o(p,y,m){const w=[y[0]-p[0],y[1]-p[1]],M=[m[0]-p[0],m[1]-p[1]],S=s(p,y),T=s(p,m);return(w[0]*M[0]+w[1]*M[1])/Math.sqrt(S*T)}function u(p,y){for(let m=0;m<y.length-1;m++){const w=[y[m],y[m+1]];if(!(p[0][0]===w[0][0]&&p[0][1]===w[0][1]||p[0][0]===w[1][0]&&p[0][1]===w[1][1])&&r(p,w))return!0}return!1}function l(p){let y=1/0,m=1/0,w=-1/0,M=-1/0;for(let S=p.length-1;S>=0;S--)p[S][0]<y&&(y=p[S][0]),p[S][1]<m&&(m=p[S][1]),p[S][0]>w&&(w=p[S][0]),p[S][1]>M&&(M=p[S][1]);return[w-y,M-m]}function c(p){return[Math.min(p[0][0],p[1][0]),Math.min(p[0][1],p[1][1]),Math.max(p[0][0],p[1][0]),Math.max(p[0][1],p[1][1])]}function d(p,y,m){let w=null,M=g,S=g,T,A;for(let O=0;O<y.length;O++)T=o(p[0],p[1],y[O]),A=o(p[1],p[0],y[O]),T>M&&A>S&&!u([p[0],y[O]],m)&&!u([p[1],y[O]],m)&&(M=T,S=A,w=y[O]);return w}function h(p,y,m,w,M){let S=!1;for(let T=0;T<p.length-1;T++){const A=[p[T],p[T+1]],O=A[0][0]+","+A[0][1]+","+A[1][0]+","+A[1][1];if(s(A[0],A[1])<y||M.has(O))continue;let N=0,C=c(A),P,D,j;do C=w.extendBbox(C,N),P=C[2]-C[0],D=C[3]-C[1],j=d(A,w.rangePoints(C),p),N++;while(j===null&&(m[0]>P||m[1]>D));P>=m[0]&&D>=m[1]&&M.add(O),j!==null&&(p.splice(T+1,0,j),w.removePoint(j),S=!0)}return S?h(p,y,m,w,M):p}function f(p,y,m){let w=y||20;const M=i(a(t.toXy(p,m)));if(M.length<4){const P=M.concat([M[0]]);return m?t.fromXy(P,m):P}const S=l(M),T=[S[0]*v,S[1]*v],A=n(M),O=M.filter(function(P){return A.indexOf(P)<0}),N=Math.ceil(1/(M.length/(S[0]*S[1]))),C=h(A,Math.pow(w,2),T,e(O,N),new Set);return m?t.fromXy(C,m):C}const g=Math.cos(90/(180/Math.PI)),v=.6;return O0=f,O0}var _W=SW();const TW=tu(_W);function OW(r,e,t){if(r.length===1)return AW(r[0],e,t);if(r.length===2)return IS(r,e,t);if(r.length===3){const[n,i,a]=Am(r);if(HO(n,i,a))return IS([n,a],e,t)}switch(t){case"smooth":return NW(r,e);case"sharp":return CW(r,e);case"rounded":default:return kW(r,e)}}const AW=(r,e,t)=>{if(t==="sharp")return[["M",r[0]-e,r[1]-e],["L",r[0]+e,r[1]-e],["L",r[0]+e,r[1]+e],["L",r[0]-e,r[1]+e],["Z"]];const n=[e,e,0,0,0];return[["M",r[0],r[1]-e],["A",...n,r[0],r[1]+e],["A",...n,r[0],r[1]-e]]},IS=(r,e,t)=>{const n=[e,e,0,0,0],i=t==="sharp"?$e(r[0],Qi(Oi(ot(r[0],r[1])),e)):r[0],a=t==="sharp"?$e(r[1],Qi(Oi(ot(r[1],r[0])),e)):r[1],s=Qi(Oi(Pc(ot(i,a),!1)),e),o=Qi(s,-1),u=$e(i,s),l=$e(a,s),c=$e(a,o),d=$e(i,o);return t==="sharp"?[["M",u[0],u[1]],["L",l[0],l[1]],["L",c[0],c[1]],["L",d[0],d[1]],["Z"]]:[["M",u[0],u[1]],["L",l[0],l[1]],["A",...n,c[0],c[1]],["L",d[0],d[1]],["A",...n,u[0],u[1]]]},kW=(r,e)=>{const t=Am(r).map((o,u)=>{const l=(u-2+r.length)%r.length,c=(u-1+r.length)%r.length,d=(u+1)%r.length,h=r[l],f=r[c],g=r[d],v=ot(h,f),p=ot(f,o),y=ot(o,g),m=(A,O)=>Tm(A,O,!0)<Math.PI,w=m(v,p),M=m(p,y),S=A=>Qi(Oi(Pc(A,!1)),e),T=S(p);return[{p:Ya(w?$e(f,S(v)):$e(f,T)),concave:w&&f},{p:Ya(M?$e(o,S(y)):$e(o,T)),concave:M&&o}]}),n=[e,e,0,0,0],i=t.findIndex((o,u)=>!t[(u-1+t.length)%t.length][0].concave&&!t[(u-1+t.length)%t.length][1].concave&&!o[0].concave&&!o[0].concave&&!o[1].concave),a=t.slice(i).concat(t.slice(0,i));let s=[];return a.flatMap((o,u)=>{const l=[],c=a[t.length-1];return u===0&&l.push(["M",...c[1].p]),o[0].concave?s.push(o[0].p,o[1].p):l.push(["A",...n,...o[0].p]),o[1].concave?s.unshift(o[1].p):l.push(["L",...o[1].p]),s.length===3&&(l.pop(),l.push(["C",...s.flat()]),s=[]),l})},NW=(r,e)=>{const t=Am(r).map((n,i)=>{const a=r[(i+1)%r.length];return{p:n,v:Oi(ot(a,n))}});return t.forEach((n,i)=>{const a=i>0?i-1:r.length-1,s=t[a].v,o=Oi($e(s,Qi(n.v,Tm(s,n.v,!0)<Math.PI?1:-1)));n.p=$e(n.p,Qi(o,e))}),rA(t.map(n=>n.p))},CW=(r,e)=>{const n=r.map((a,s)=>{const o=r[s===0?r.length-1:s-1],u=Go(Qi(Oi(Pc(ot(o,a),!1)),e));return[$e(o,u),$e(a,u)]}).flat();return n.map((a,s)=>{if(s%2===0)return null;const o=[n[(s-1)%n.length],n[s%n.length]],u=[n[(s+1)%n.length],n[(s+2)%n.length]];return Om(o,u,!0)}).filter(Boolean).map((a,s)=>[s===0?"M":"L",a[0],a[1]]).concat([["Z"]])};var PW=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Cd extends An{constructor(e,t){super(e,Object.assign({},Cd.defaultOptions,t)),this.hullMemberIds=[],this.drawHull=()=>{if(!this.shape)this.shape=new pu({style:this.getHullStyle()}),this.context.canvas.appendChild(this.shape);else{const n=!Bt(this.optionsCache,this.options);this.shape.update(this.getHullStyle(n))}this.optionsCache=Object.assign({},this.options)},this.updateHullPath=n=>{this.shape&&this.options.members.includes(Q(n.data))&&this.shape.update({d:this.getHullPath(!0)})},this.getHullPath=(n=!1)=>{const{graph:i}=this.context,a=this.getMember();if(a.length===0)return"";const s=a.map(l=>i.getNodeData(l)),o=TW(s.map(on),this.options.concavity).slice(1).reverse(),u=o.flatMap(l=>s.filter(c=>Bt(on(c),l)).map(Q));return Bt(u,this.hullMemberIds)&&!n?this.path:(this.hullMemberIds=u,this.path=OW(o,this.getPadding(),this.options.corner),this.path)},this.bindEvents()}bindEvents(){this.context.graph.on(ve.AFTER_RENDER,this.drawHull),this.context.graph.on(ve.AFTER_ELEMENT_UPDATE,this.updateHullPath)}getHullStyle(e){const t=this.options,n=PW(t,["members","padding","corner"]);return Object.assign(Object.assign({},n),{d:this.getHullPath(e)})}getPadding(){const{graph:e}=this.context;return this.hullMemberIds.reduce((n,i)=>{const{halfExtents:a}=e.getElementRenderBounds(i),s=Math.max(a[0],a[1]);return Math.max(n,s)},0)+this.options.padding}addMember(e){const t=Array.isArray(e)?e:[e];this.options.members=[...new Set([...this.options.members,...t])],this.shape.update({d:this.getHullPath()})}removeMember(e){const t=Array.isArray(e)?e:[e];this.options.members=this.options.members.filter(n=>!t.includes(n)),t.some(n=>this.hullMemberIds.includes(n))&&this.shape.update({d:this.getHullPath()})}updateMember(e){this.options.members=Te(e)?e(this.options.members):e,this.shape.update(this.getHullStyle(!0))}getMember(){return this.options.members}destroy(){this.context.graph.off(ve.AFTER_DRAW,this.drawHull),this.shape.destroy(),this.hullMemberIds=[],super.destroy()}}Cd.defaultOptions={members:[],padding:10,corner:"rounded",concavity:1/0,fill:"lightblue",fillOpacity:.2,labelOpacity:1,stroke:"blue",strokeOpacity:.2};function bN(r,e){e(r),r.children&&r.children.forEach(function(t){t&&bN(t,e)})}function Mu(r){Pd(r,!0)}function Fr(r){Pd(r,!1)}function Pd(r,e){var t=e?"visible":"hidden";bN(r,function(n){n.attr("visibility",t)})}var LW=function(r){Ue(e,r);function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=r.apply(this,ke([],q(t),!1))||this;return i.isMutationObserved=!0,i.addEventListener(He.INSERTED,function(){Fr(i)}),i}return e}(ln);function wN(r){var e=r.appendChild(new LW({class:"offscreen"}));return Fr(e),e}function DW(r){for(var e=r;e;){if(e.className==="offscreen")return!0;e=e.parent}return!1}var o1=function(r){Ue(e,r);function e(t){t===void 0&&(t={});var n=t.style,i=Jt(t,["style"]);return r.call(this,he({style:he({text:"",fill:"black",fontFamily:"sans-serif",fontSize:16,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1,textAlign:"start",textBaseline:"middle"},n)},i))||this}return Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=wN(this)),this._offscreen},enumerable:!1,configurable:!0}),e.prototype.disconnectedCallback=function(){var t;(t=this._offscreen)===null||t===void 0||t.destroy()},e}(es);function qs(r){return r*Math.PI/180}function xN(r){return Number((r*180/Math.PI).toPrecision(5))}var qn=function(){function r(e,t,n,i){e===void 0&&(e=0),t===void 0&&(t=0),n===void 0&&(n=0),i===void 0&&(i=0),this.x=0,this.y=0,this.width=0,this.height=0,this.x=e,this.y=t,this.width=n,this.height=i}return Object.defineProperty(r.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),r.fromRect=function(e){return new r(e.x,e.y,e.width,e.height)},r.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,right:this.right,bottom:this.bottom,left:this.left}},r.prototype.isPointIn=function(e,t){return e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom},r}();function Ar(r,e){return Te(r)?r.apply(void 0,ke([],q(e),!1)):r}var Vr=function(r,e){var t=function(i){return"".concat(e,"-").concat(i)},n=Object.fromEntries(Object.entries(r).map(function(i){var a=q(i,2),s=a[0],o=a[1],u=t(o);return[s,{name:u,class:".".concat(u),id:"#".concat(u),toString:function(){return u}}]}));return Object.assign(n,{prefix:t}),n},IW=5,EN=function(r,e,t,n){t===void 0&&(t=0),n===void 0&&(n=IW),Object.entries(e).forEach(function(i){var a=q(i,2),s=a[0],o=a[1],u=r;Object.prototype.hasOwnProperty.call(e,s)&&(o?js(o)?(js(r[s])||(u[s]={}),t<n?EN(r[s],o,t+1,n):u[s]=e[s]):gr(o)?(u[s]=[],u[s]=u[s].concat(o)):u[s]=o:u[s]=o)})},vn=function(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var n=0;n<e.length;n+=1)EN(r,e[n]);return r},MN=function(r){return r!==void 0&&r!=null&&!Number.isNaN(r)},Sl,RW=X0(function(r,e){var t=e.fontSize,n=e.fontFamily,i=e.fontWeight,a=e.fontStyle,s=e.fontVariant;return Sl||(Sl=fe.offscreenCanvasCreator.getOrCreateContext(void 0)),Sl.font=[a,s,i,"".concat(t,"px"),n].join(" "),Sl.measureText(r).width},function(r,e){return[r,Object.values(e||SN(r)).join()].join("")},4096),SN=function(r){var e=r.style.fontFamily||"sans-serif",t=r.style.fontWeight||"normal",n=r.style.fontStyle||"normal",i=r.style.fontVariant,a=r.style.fontSize;return a=typeof a=="object"?a.value:a,{fontSize:a,fontFamily:e,fontWeight:t,fontStyle:n,fontVariant:i}};function _N(r){return r.nodeName==="text"?r:r.nodeName==="g"&&r.children.length===1&&r.children[0].nodeName==="text"?r.children[0]:null}function TN(r,e){var t=_N(r);t&&t.attr(e)}function Fy(r,e,t){t===void 0&&(t="..."),TN(r,{wordWrap:!0,wordWrapWidth:e,maxLines:1,textOverflow:t})}function jW(r,e,t,n){t===void 0&&(t=2),n===void 0&&(n="top"),TN(r,{wordWrap:!0,wordWrapWidth:e,maxLines:t,textBaseline:n})}function RS(r){var e=r.canvas,t=r.touches,n=r.offsetX,i=r.offsetY;if(e){var a=e.x,s=e.y;return[a,s]}if(t){var o=t[0],u=o.clientX,l=o.clientY;return[u,l]}return n&&i?[n,i]:[0,0]}function Ci(r){return typeof r=="function"?r():tt(r)||Ee(r)?new o1({style:{text:String(r)}}):r}function BW(r,e){return r.reduce(function(t,n){return(t[n[e]]=t[n[e]]||[]).push(n),t},{})}function fr(r,e,t,n,i){return n===void 0&&(n=!0),i===void 0&&(i=function(a){a.node().removeChildren()}),r?t(e):(n&&i(e),null)}function wn(r,e,t,n,i){return n===void 0&&(n=!0),i===void 0&&(i=!1),n&&r===e||i&&r===t?!0:r>e&&r<t}var FW=function(r,e){return function(t){return r*(1-t)+e*t}};function zW(r,e){var t=e?e.length:0,n=r?Math.min(t,r.length):0;return function(i){var a=new Array(n),s=new Array(t),o=0;for(o=0;o<n;++o)a[o]=u1(r[o],e[o]);for(;o<t;++o)s[o]=e[o];for(o=0;o<n;++o)s[o]=a[o](i);return s}}function $W(r,e){r===void 0&&(r={}),e===void 0&&(e={});var t={},n={};return Object.entries(e).forEach(function(i){var a=q(i,2),s=a[0],o=a[1];s in r?t[s]=u1(r[s],o):n[s]=o}),function(i){return Object.entries(t).forEach(function(a){var s=q(a,2),o=s[0],u=s[1];return n[o]=u(i)}),n}}function u1(r,e){return typeof r=="number"&&typeof e=="number"?FW(r,e):Array.isArray(r)&&Array.isArray(e)?zW(r,e):typeof r=="object"&&typeof e=="object"?$W(r,e):function(t){return r}}function qW(r,e,t,n){if(!n)return r.attr("__keyframe_data__",t),null;var i=n.duration,a=i===void 0?0:i,s=u1(e,t),o=Math.ceil(+a/16),u=new Array(o).fill(0).map(function(l,c,d){return{__keyframe_data__:s(c/(d.length-1))}});return r.animate(u,he({fill:"both"},n))}function Mi(r,e){return[r[0]*e,r[1]*e]}function Eo(r,e){return[r[0]+e[0],r[1]+e[1]]}function A0(r,e){return[r[0]-e[0],r[1]-e[1]]}function _a(r,e){return[Math.min(r[0],e[0]),Math.min(r[1],e[1])]}function Ta(r,e){return[Math.max(r[0],e[0]),Math.max(r[1],e[1])]}function Xo(r,e){return Math.sqrt(Math.pow(r[0]-e[0],2)+Math.pow(r[1]-e[1],2))}function ON(r){if(r[0]===0&&r[1]===0)return[0,0];var e=Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2));return[r[0]/e,r[1]/e]}function GW(r,e){return e?[r[1],-r[0]]:[-r[1],r[0]]}function jS(r,e){return+r.toPrecision(e)}function BS(r,e){var t={},n=Array.isArray(e)?e:[e];for(var i in r)n.includes(i)||(t[i]=r[i]);return t}function WW(r,e,t,n){var i,a=[],s=!!n,o,u,l=[1/0,1/0],c=[-1/0,-1/0],d,h,f;if(s){i=q(n,2),l=i[0],c=i[1];for(var g=0,v=r.length;g<v;g+=1){var p=r[g];l=_a(l,p),c=Ta(c,p)}}for(var g=0,y=r.length;g<y;g+=1){var p=r[g];if(g===0)f=p;else if(g===y-1)h=p,a.push(f),a.push(h);else{var m=[g?g-1:y-1,g-1][1];o=r[m],u=r[g+1];var w=[0,0];w=A0(u,o),w=Mi(w,e);var M=Xo(p,o),S=Xo(p,u),T=M+S;T!==0&&(M/=T,S/=T);var A=Mi(w,-M),O=Mi(w,S);h=Eo(p,A),d=Eo(p,O),d=_a(d,Ta(u,p)),d=Ta(d,_a(u,p)),A=A0(d,p),A=Mi(A,-M/S),h=Eo(p,A),h=_a(h,Ta(o,p)),h=Ta(h,_a(o,p)),O=A0(p,h),O=Mi(O,S/M),d=Eo(p,O),s&&(h=Ta(h,l),h=_a(h,c),d=Ta(d,l),d=_a(d,c)),a.push(f),a.push(h),f=d}}return a}function VW(r,e,t){t===void 0&&(t=[[0,0],[1,1]]);for(var n=!1,i=[],a=0,s=r.length;a<s;a+=2)i.push([r[a],r[a+1]]);for(var o=WW(i,.4,n,t),u=i.length,l=[],c,d,h,a=0;a<u-1;a+=1)c=o[a*2],d=o[a*2+1],h=i[a+1],l.push(["C",c[0],c[1],d[0],d[1],h[0],h[1]]);return l}var YW=["$el","cx","cy","d","dx","dy","fill","fillOpacity","filter","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","img","increasedLineWidthForHitTesting","innerHTML","isBillboard","billboardRotation","isSizeAttenuation","isClosed","isOverflowing","leading","letterSpacing","lineDash","lineHeight","lineWidth","markerEnd","markerEndOffset","markerMid","markerStart","markerStartOffset","maxLines","metrics","miterLimit","offsetX","offsetY","opacity","path","points","r","radius","rx","ry","shadowColor","src","stroke","strokeOpacity","text","textAlign","textBaseline","textDecorationColor","textDecorationLine","textDecorationStyle","textOverflow","textPath","textPathSide","textPathStartOffset","transform","transformOrigin","visibility","width","wordWrap","wordWrapWidth","x","x1","x2","y","y1","y2","z1","z2","zIndex"];function UW(r){return YW.includes(r)}function FS(r){var e={};for(var t in r)UW(t)&&(e[t]=r[t]);return e}function HW(r,e){if(r.length<=e)return r;for(var t=Math.floor(r.length/e),n=[],i=0;i<r.length;i+=t)n.push(r[i]);return n}function l1(r,e,t){var n=r.getBBox(),i=n.width,a=n.height,s=e/Math.max(i,a);return r.style.transform="scale(".concat(s,")"),s}function XW(r,e){var t=new Map;return r.forEach(function(n){var i=e(n);t.has(i)||t.set(i,[]),t.get(i).push(n)}),t}function KW(r){throw new Error(r)}var ZW=function(){function r(i,a,s,o,u,l,c){i===void 0&&(i=null),a===void 0&&(a=null),s===void 0&&(s=null),o===void 0&&(o=null),u===void 0&&(u=[null,null,null,null,null]),l===void 0&&(l=[]),c===void 0&&(c=[]),e.add(this),this._elements=Array.from(i),this._data=a,this._parent=s,this._document=o,this._enter=u[0],this._update=u[1],this._exit=u[2],this._merge=u[3],this._split=u[4],this._transitions=l,this._facetElements=c}r.prototype.selectAll=function(i){var a=typeof i=="string"?this._parent.querySelectorAll(i):i;return new t(a,null,this._elements[0],this._document)},r.prototype.selectFacetAll=function(i){var a=typeof i=="string"?this._parent.querySelectorAll(i):i;return new t(this._elements,null,this._parent,this._document,void 0,void 0,a)},r.prototype.select=function(i){var a=typeof i=="string"?this._parent.querySelectorAll(i)[0]||null:i;return new t([a],null,a,this._document)},r.prototype.append=function(i){var a=this,s=typeof i=="function"?i:function(){return a.createElement(i)},o=[];if(this._data!==null){for(var u=0;u<this._data.length;u++){var l=this._data[u],c=q(Array.isArray(l)?l:[l,null],2),d=c[0],h=c[1],f=s(d,u);f.__data__=d,h!==null&&(f.__fromElements__=h),this._parent.appendChild(f),o.push(f)}return new t(o,null,this._parent,this._document)}for(var u=0;u<this._elements.length;u++){var g=this._elements[u],d=g.__data__,f=s(d,u);g.appendChild(f),o.push(f)}return new t(o,null,o[0],this._document)},r.prototype.maybeAppend=function(i,a){var s=nh(this,e,"m",n).call(this,i[0]==="#"?i:"#".concat(i),a);return s.attr("id",i),s},r.prototype.maybeAppendByClassName=function(i,a){var s=i.toString(),o=nh(this,e,"m",n).call(this,s[0]==="."?s:".".concat(s),a);return o.attr("className",s),o},r.prototype.maybeAppendByName=function(i,a){var s=nh(this,e,"m",n).call(this,'[name="'.concat(i,'"]'),a);return s.attr("name",i),s},r.prototype.data=function(i,a,s){var o,u;a===void 0&&(a=function(C){return C}),s===void 0&&(s=function(){return null});for(var l=[],c=[],d=new Set(this._elements),h=[],f=new Set,g=new Map(this._elements.map(function(C,P){return[a(C.__data__,P),C]})),v=new Map(this._facetElements.map(function(C,P){return[a(C.__data__,P),C]})),p=XW(this._elements,function(C){return s(C.__data__)}),y=0;y<i.length;y++){var m=i[y],w=a(m,y),M=s(m,y);if(g.has(w)){var S=g.get(w);S.__data__=m,S.__facet__=!1,c.push(S),d.delete(S),g.delete(w)}else if(v.has(w)){var S=v.get(w);S.__data__=m,S.__facet__=!0,c.push(S),v.delete(w)}else if(p.has(w)){var T=p.get(w);h.push([m,T]);try{for(var A=(o=void 0,nu(T)),O=A.next();!O.done;O=A.next()){var S=O.value;d.delete(S)}}catch(C){o={error:C}}finally{try{O&&!O.done&&(u=A.return)&&u.call(A)}finally{if(o)throw o.error}}p.delete(w)}else if(g.has(M)){var S=g.get(M);S.__toData__?S.__toData__.push(m):S.__toData__=[m],f.add(S),d.delete(S)}else l.push(m)}var N=[new t([],l,this._parent,this._document),new t(c,null,this._parent,this._document),new t(d,null,this._parent,this._document),new t([],h,this._parent,this._document),new t(f,null,this._parent,this._document)];return new t(this._elements,null,this._parent,this._document,N)},r.prototype.merge=function(i){var a=ke(ke([],q(this._elements),!1),q(i._elements),!1),s=ke(ke([],q(this._transitions),!1),q(i._transitions),!1);return new t(a,null,this._parent,this._document,void 0,s)},r.prototype.createElement=function(i){if(this._document)return this._document.createElement(i,{});var a=t.registry[i];return a?new a:KW("Unknown node type: ".concat(i))},r.prototype.join=function(i,a,s,o,u){i===void 0&&(i=function(g){return g}),a===void 0&&(a=function(g){return g}),s===void 0&&(s=function(g){return g.remove()}),o===void 0&&(o=function(g){return g}),u===void 0&&(u=function(g){return g.remove()});var l=i(this._enter),c=a(this._update),d=s(this._exit),h=o(this._merge),f=u(this._split);return c.merge(l).merge(d).merge(h).merge(f)},r.prototype.remove=function(){for(var i=function(o){var u=a._elements[o],l=a._transitions[o];l?l.then(function(){return u.remove()}):u.remove()},a=this,s=0;s<this._elements.length;s++)i(s);return new t([],null,this._parent,this._document,void 0,this._transitions)},r.prototype.each=function(i){for(var a=0;a<this._elements.length;a++){var s=this._elements[a],o=s.__data__;i.call(s,o,a)}return this},r.prototype.attr=function(i,a){var s=typeof a!="function"?function(){return a}:a;return this.each(function(o,u){a!==void 0&&(this[i]=s.call(this,o,u))})},r.prototype.style=function(i,a,s){s===void 0&&(s=!0);var o=typeof a!="function"||!s?function(){return a}:a;return this.each(function(u,l){a!==void 0&&(this.style[i]=o.call(this,u,l))})},r.prototype.styles=function(i,a){return i===void 0&&(i={}),a===void 0&&(a=!0),this.each(function(s,o){var u=this;Object.entries(i).forEach(function(l){var c=q(l,2),d=c[0],h=c[1],f=typeof h!="function"||!a?function(){return h}:h;h!==void 0&&u.attr(d,f.call(u,s,o))})})},r.prototype.update=function(i,a){a===void 0&&(a=!0);var s=typeof i!="function"||!a?function(){return i}:i;return this.each(function(o,u){i&&this.update&&this.update(s.call(this,o,u))})},r.prototype.maybeUpdate=function(i,a){a===void 0&&(a=!0);var s=typeof i!="function"||!a?function(){return i}:i;return this.each(function(o,u){i&&this.update&&this.update(s.call(this,o,u))})},r.prototype.transition=function(i){var a=this._transitions;return this.each(function(s,o){a[o]=i.call(this,s,o)})},r.prototype.on=function(i,a){return this.each(function(){this.addEventListener(i,a)}),this},r.prototype.call=function(i){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];return i.call.apply(i,ke([this._parent,this],q(a),!1)),this},r.prototype.node=function(){return this._elements[0]},r.prototype.nodes=function(){return this._elements},r.prototype.transitions=function(){return this._transitions.filter(function(i){return!!i})},r.prototype.parent=function(){return this._parent};var e,t,n;return t=r,e=new WeakSet,n=function(a,s){var o=this._elements[0],u=o.querySelector(a);if(u)return new t([u],null,this._parent,this._document);var l=typeof s=="string"?this.createElement(s):s();return o.appendChild(l),new t([l],null,this._parent,this._document)},r.registry={g:ln,rect:Sn,circle:Ii,path:lr,text:o1,ellipse:lu,image:du,line:Wa,polygon:Ja,polyline:kc,html:cu},r}();function Oe(r){return new ZW([r],null,r,r.ownerDocument)}function QW(r,e,t){return r.querySelector(e)?Oe(r).select(e):Oe(r).append(t)}function _n(r){if(Ee(r))return[r,r,r,r];if(gr(r)){var e=r.length;if(e===1)return[r[0],r[0],r[0],r[0]];if(e===2)return[r[0],r[1],r[0],r[1]];if(e===3)return[r[0],r[1],r[2],r[1]];if(e===4)return r}return[0,0,0,0]}function zS(r){var e=r.getLocalBounds(),t=e.min,n=e.max,i=q([t,n],2),a=q(i[0],2),s=a[0],o=a[1],u=q(i[1],2),l=u[0],c=u[1];return{x:s,y:o,width:l-s,height:c-o,left:s,bottom:c,top:o,right:l}}function JW(r,e){var t=q(r,2),n=t[0],i=t[1],a=q(e,2),s=a[0],o=a[1];return n!==s&&i===o}function e7(r,e){var t,n,i=e.attributes;try{for(var a=nu(Object.entries(i)),s=a.next();!s.done;s=a.next()){var o=q(s.value,2),u=o[0],l=o[1];u!=="id"&&u!=="className"&&r.attr(u,l)}}catch(c){t={error:c}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}function c1(r){return r.toString().charAt(0).toUpperCase()+r.toString().slice(1)}function t7(r){return r.toString().charAt(0).toLowerCase()+r.toString().slice(1)}function n7(r,e){return"".concat(e).concat(c1(r))}function $S(r,e,t){var n;t===void 0&&(t=!0);var i=e||((n=r.match(/^([a-z][a-z0-9]+)/))===null||n===void 0?void 0:n[0])||"",a=r.replace(new RegExp("^(".concat(i,")")),"");return t?t7(a):a}function r7(r,e){Object.entries(e).forEach(function(t){var n=q(t,2),i=n[0],a=n[1];ke([r],q(r.querySelectorAll(i)),!1).filter(function(s){return s.matches(i)}).forEach(function(s){if(s){var o=s;o.style.cssText+=Object.entries(a).reduce(function(u,l){return"".concat(u).concat(l.join(":"),";")},"")}})})}var _l=function(r,e){if(!(r!=null&&r.startsWith(e)))return!1;var t=r[e.length];return t>="A"&&t<="Z"};function Be(r,e,t){t===void 0&&(t=!1);var n={};return Object.entries(r).forEach(function(i){var a=q(i,2),s=a[0],o=a[1];if(!(s==="className"||s==="class")){if(_l(s,"show")&&_l($S(s,"show"),e)!==t)s===n7(e,"show")?n[s]=o:n[s.replace(new RegExp(c1(e)),"")]=o;else if(!_l(s,"show")&&_l(s,e)!==t){var u=$S(s,e);u==="filter"&&typeof o=="function"||(n[u]=o)}}}),n}function Ms(r,e){return Object.entries(r).reduce(function(t,n){var i=q(n,2),a=i[0],s=i[1];return a.startsWith("show")?t["show".concat(e).concat(a.slice(4))]=s:t["".concat(e).concat(c1(a))]=s,t},{})}function Pi(r,e){e===void 0&&(e=["x","y","class","className"]);var t=["transform","transformOrigin","anchor","visibility","pointerEvents","zIndex","cursor","clipPath","clipPathTargets","offsetPath","offsetPathTargets","offsetDistance","draggable","droppable"],n={},i={};return Object.entries(r).forEach(function(a){var s=q(a,2),o=s[0],u=s[1];e.includes(o)||(t.indexOf(o)!==-1?i[o]=u:n[o]=u)}),[n,i]}function Hn(r,e){var t={YYYY:r.getFullYear(),MM:r.getMonth()+1,DD:r.getDate(),HH:r.getHours(),mm:r.getMinutes(),ss:r.getSeconds()},n=e;return Object.keys(t).forEach(function(i){var a=t[i];n=n.replace(i,i==="YYYY"?"".concat(a):"".concat(a).padStart(2,"0"))}),n}function i7(r,e,t){var n=r.getBBox(),i=n.width,a=n.height,s=q([e,t].map(function(l,c){var d;return l.includes("%")?parseFloat(((d=l.match(/[+-]?([0-9]*[.])?[0-9]+/))===null||d===void 0?void 0:d[0])||"0")/100*(c===0?i:a):l}),2),o=s[0],u=s[1];return[o,u]}function AN(r,e){if(e)try{var t=/translate\(([+-]*[\d]+[%]*),[ ]*([+-]*[\d]+[%]*)\)/g,n=e.replace(t,function(i,a,s){return"translate(".concat(i7(r,a,s),")")});r.attr("transform",n)}catch{}}function a7(r){var e;return((e=r[0])===null||e===void 0?void 0:e.map(function(t,n){return r.map(function(i){return i[n]})}))||[]}var qS=function(r,e){if(e==null){r.innerHTML="";return}r.replaceChildren?Array.isArray(e)?r.replaceChildren.apply(r,ke([],q(e),!1)):r.replaceChildren(e):(r.innerHTML="",Array.isArray(e)?e.forEach(function(t){return r.appendChild(t)}):r.appendChild(e))};function s7(){Pd(this,this.attributes.visibility!=="hidden")}var $t=function(r){Ue(e,r);function e(t,n){n===void 0&&(n={});var i=r.call(this,vn({},{style:n},t))||this;return i.initialized=!1,i._defaultOptions=n,i}return Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=wN(this)),this._offscreen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defaultOptions",{get:function(){return this._defaultOptions},enumerable:!1,configurable:!0}),e.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this),this.initialized=!0},e.prototype.disconnectedCallback=function(){var t;(t=this._offscreen)===null||t===void 0||t.destroy()},e.prototype.attributeChangedCallback=function(t){t==="visibility"&&s7.call(this)},e.prototype.update=function(t,n){var i;return this.attr(vn({},this.attributes,t||{})),(i=this.render)===null||i===void 0?void 0:i.call(this,this.attributes,this,n)},e.prototype.clear=function(){this.removeChildren()},e.prototype.bindEvents=function(t,n){},e.prototype.getSubShapeStyle=function(t){t.x,t.y,t.transform,t.transformOrigin,t.class,t.className,t.zIndex;var n=Jt(t,["x","y","transform","transformOrigin","class","className","zIndex"]);return n},e}(ym),kN=function(r,e,t){return[["M",r-t,e],["A",t,t,0,1,0,r+t,e],["A",t,t,0,1,0,r-t,e],["Z"]]},o7=kN,u7=function(r,e,t){return[["M",r-t,e-t],["L",r+t,e-t],["L",r+t,e+t],["L",r-t,e+t],["Z"]]},l7=function(r,e,t){return[["M",r-t,e],["L",r,e-t],["L",r+t,e],["L",r,e+t],["Z"]]},c7=function(r,e,t){var n=t*Math.sin(.3333333333333333*Math.PI);return[["M",r-t,e+n],["L",r,e-n],["L",r+t,e+n],["Z"]]},d7=function(r,e,t){var n=t*Math.sin(.3333333333333333*Math.PI);return[["M",r-t,e-n],["L",r+t,e-n],["L",r,e+n],["Z"]]},h7=function(r,e,t){var n=t/2*Math.sqrt(3);return[["M",r,e-t],["L",r+n,e-t/2],["L",r+n,e+t/2],["L",r,e+t],["L",r-n,e+t/2],["L",r-n,e-t/2],["Z"]]},f7=function(r,e,t){var n=t-1.5;return[["M",r-t,e-n],["L",r+t,e+n],["L",r+t,e-n],["L",r-t,e+n],["Z"]]},NN=function(r,e,t){return[["M",r,e+t],["L",r,e-t]]},g7=function(r,e,t){return[["M",r-t,e-t],["L",r+t,e+t],["M",r+t,e-t],["L",r-t,e+t]]},p7=function(r,e,t){return[["M",r-t/2,e-t],["L",r+t/2,e-t],["M",r,e-t],["L",r,e+t],["M",r-t/2,e+t],["L",r+t/2,e+t]]},v7=function(r,e,t){return[["M",r-t,e],["L",r+t,e],["M",r,e-t],["L",r,e+t]]},y7=function(r,e,t){return[["M",r-t,e],["L",r+t,e]]},CN=function(r,e,t){return[["M",r-t,e],["L",r+t,e]]},m7=CN,b7=function(r,e,t){return[["M",r-t,e],["A",t/2,t/2,0,1,1,r,e],["A",t/2,t/2,0,1,0,r+t,e]]},w7=function(r,e,t){return[["M",r-t-1,e-2.5],["L",r,e-2.5],["L",r,e+2.5],["L",r+t+1,e+2.5]]},x7=function(r,e,t){return[["M",r-t-1,e+2.5],["L",r,e+2.5],["L",r,e-2.5],["L",r+t+1,e-2.5]]},E7=function(r,e,t){return[["M",r-(t+1),e+2.5],["L",r-t/2,e+2.5],["L",r-t/2,e-2.5],["L",r+t/2,e-2.5],["L",r+t/2,e+2.5],["L",r+t+1,e+2.5]]};function M7(r,e){return[["M",r-5,e+2.5],["L",r-5,e],["L",r,e],["L",r,e-3],["L",r,e+3],["L",r+6.5,e+3]]}var S7=function(r,e,t){return[["M",r-t,e-t],["L",r+t,e],["L",r-t,e+t],["Z"]]};function _7(r){var e="default";if(Yt(r)&&r instanceof Image)e="image";else if(Te(r))e="symbol";else if(tt(r)){var t=new RegExp("data:(image|text)");r.match(t)?e="base64":/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(r)?e="url":e="symbol"}return e}function T7(r){var e=_7(r);return["base64","url","image"].includes(e)?"image":r&&e==="symbol"?"path":null}var lt=function(r){Ue(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.render=function(t,n){var i=t.x,a=i===void 0?0:i,s=t.y,o=s===void 0?0:s,u=this.getSubShapeStyle(t),l=u.symbol,c=u.size,d=c===void 0?16:c,h=Jt(u,["symbol","size"]),f=T7(l);fr(!!f,Oe(n),function(g){g.maybeAppendByClassName("marker",f).attr("className","marker ".concat(f,"-marker")).call(function(v){if(f==="image"){var p=d*2;v.styles({img:l,width:p,height:p,x:a-d,y:o-d})}else{var p=d/2,y=Te(l)?l:e.getSymbol(l);v.styles(he({d:y==null?void 0:y(a,o,p)},h))}})})},e.MARKER_SYMBOL_MAP=new Map,e.registerSymbol=function(t,n){e.MARKER_SYMBOL_MAP.set(t,n)},e.getSymbol=function(t){return e.MARKER_SYMBOL_MAP.get(t)},e.getSymbols=function(){return Array.from(e.MARKER_SYMBOL_MAP.keys())},e}($t);lt.registerSymbol("cross",g7);lt.registerSymbol("hyphen",y7);lt.registerSymbol("line",NN);lt.registerSymbol("plus",v7);lt.registerSymbol("tick",p7);lt.registerSymbol("circle",kN);lt.registerSymbol("point",o7);lt.registerSymbol("bowtie",f7);lt.registerSymbol("hexagon",h7);lt.registerSymbol("square",u7);lt.registerSymbol("diamond",l7);lt.registerSymbol("triangle",c7);lt.registerSymbol("triangle-down",d7);lt.registerSymbol("line",NN);lt.registerSymbol("dot",CN);lt.registerSymbol("dash",m7);lt.registerSymbol("smooth",b7);lt.registerSymbol("hv",w7);lt.registerSymbol("vh",x7);lt.registerSymbol("hvh",E7);lt.registerSymbol("vhv",M7);function bc(r,...e){return e.reduce((t,n)=>i=>t(n(i)),r)}function zy(r,e){return e-r?t=>(t-r)/(e-r):t=>.5}function O7(r,e){const t=e<r?e:r,n=r>e?r:e;return i=>Math.min(Math.max(t,i),n)}function A7(r,e,t,n,i){let a=t||0,s=n||r.length;const o=u=>u;for(;a<s;){const u=Math.floor((a+s)/2);o(r[u])>e?s=u:a=u+1}return a}const GS=Math.sqrt(50),WS=Math.sqrt(10),VS=Math.sqrt(2);function Rl(r,e,t){const n=(e-r)/Math.max(0,t),i=Math.floor(Math.log(n)/Math.LN10),a=n/10**i;return i>=0?(a>=GS?10:a>=WS?5:a>=VS?2:1)*10**i:-(10**-i)/(a>=GS?10:a>=WS?5:a>=VS?2:1)}const k7=(r,e,t=5)=>{const n=[r,e];let i=0,a=n.length-1,s=n[i],o=n[a],u;return o<s&&([s,o]=[o,s],[i,a]=[a,i]),u=Rl(s,o,t),u>0?(s=Math.floor(s/u)*u,o=Math.ceil(o/u)*u,u=Rl(s,o,t)):u<0&&(s=Math.ceil(s*u)/u,o=Math.floor(o*u)/u,u=Rl(s,o,t)),u>0?(n[i]=Math.floor(s/u)*u,n[a]=Math.ceil(o/u)*u):u<0&&(n[i]=Math.ceil(s*u)/u,n[a]=Math.floor(o*u)/u),n};function YS(r){return!je(r)&&!qL(r)&&!Number.isNaN(r)}var k0={exports:{}},N0,US;function N7(){return US||(US=1,N0={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),N0}var C0={exports:{}},P0,HS;function C7(){return HS||(HS=1,P0=function(e){return!e||typeof e=="string"?!1:e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!=="String")}),P0}var XS;function P7(){if(XS)return C0.exports;XS=1;var r=C7(),e=Array.prototype.concat,t=Array.prototype.slice,n=C0.exports=function(a){for(var s=[],o=0,u=a.length;o<u;o++){var l=a[o];r(l)?s=e.call(s,t.call(l)):s.push(l)}return s};return n.wrap=function(i){return function(){return i(n(arguments))}},C0.exports}var KS;function L7(){if(KS)return k0.exports;KS=1;var r=N7(),e=P7(),t=Object.hasOwnProperty,n=Object.create(null);for(var i in r)t.call(r,i)&&(n[r[i]]=i);var a=k0.exports={to:{},get:{}};a.get=function(u){var l=u.substring(0,3).toLowerCase(),c,d;switch(l){case"hsl":c=a.get.hsl(u),d="hsl";break;case"hwb":c=a.get.hwb(u),d="hwb";break;default:c=a.get.rgb(u),d="rgb";break}return c?{model:d,value:c}:null},a.get.rgb=function(u){if(!u)return null;var l=/^#([a-f0-9]{3,4})$/i,c=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,d=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,h=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,f=/^(\w+)$/,g=[0,0,0,1],v,p,y;if(v=u.match(c)){for(y=v[2],v=v[1],p=0;p<3;p++){var m=p*2;g[p]=parseInt(v.slice(m,m+2),16)}y&&(g[3]=parseInt(y,16)/255)}else if(v=u.match(l)){for(v=v[1],y=v[3],p=0;p<3;p++)g[p]=parseInt(v[p]+v[p],16);y&&(g[3]=parseInt(y+y,16)/255)}else if(v=u.match(d)){for(p=0;p<3;p++)g[p]=parseInt(v[p+1],0);v[4]&&(v[5]?g[3]=parseFloat(v[4])*.01:g[3]=parseFloat(v[4]))}else if(v=u.match(h)){for(p=0;p<3;p++)g[p]=Math.round(parseFloat(v[p+1])*2.55);v[4]&&(v[5]?g[3]=parseFloat(v[4])*.01:g[3]=parseFloat(v[4]))}else return(v=u.match(f))?v[1]==="transparent"?[0,0,0,0]:t.call(r,v[1])?(g=r[v[1]],g[3]=1,g):null:null;for(p=0;p<3;p++)g[p]=s(g[p],0,255);return g[3]=s(g[3],0,1),g},a.get.hsl=function(u){if(!u)return null;var l=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,c=u.match(l);if(c){var d=parseFloat(c[4]),h=(parseFloat(c[1])%360+360)%360,f=s(parseFloat(c[2]),0,100),g=s(parseFloat(c[3]),0,100),v=s(isNaN(d)?1:d,0,1);return[h,f,g,v]}return null},a.get.hwb=function(u){if(!u)return null;var l=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,c=u.match(l);if(c){var d=parseFloat(c[4]),h=(parseFloat(c[1])%360+360)%360,f=s(parseFloat(c[2]),0,100),g=s(parseFloat(c[3]),0,100),v=s(isNaN(d)?1:d,0,1);return[h,f,g,v]}return null},a.to.hex=function(){var u=e(arguments);return"#"+o(u[0])+o(u[1])+o(u[2])+(u[3]<1?o(Math.round(u[3]*255)):"")},a.to.rgb=function(){var u=e(arguments);return u.length<4||u[3]===1?"rgb("+Math.round(u[0])+", "+Math.round(u[1])+", "+Math.round(u[2])+")":"rgba("+Math.round(u[0])+", "+Math.round(u[1])+", "+Math.round(u[2])+", "+u[3]+")"},a.to.rgb.percent=function(){var u=e(arguments),l=Math.round(u[0]/255*100),c=Math.round(u[1]/255*100),d=Math.round(u[2]/255*100);return u.length<4||u[3]===1?"rgb("+l+"%, "+c+"%, "+d+"%)":"rgba("+l+"%, "+c+"%, "+d+"%, "+u[3]+")"},a.to.hsl=function(){var u=e(arguments);return u.length<4||u[3]===1?"hsl("+u[0]+", "+u[1]+"%, "+u[2]+"%)":"hsla("+u[0]+", "+u[1]+"%, "+u[2]+"%, "+u[3]+")"},a.to.hwb=function(){var u=e(arguments),l="";return u.length>=4&&u[3]!==1&&(l=", "+u[3]),"hwb("+u[0]+", "+u[1]+"%, "+u[2]+"%"+l+")"},a.to.keyword=function(u){return n[u.slice(0,3)]};function s(u,l,c){return Math.min(Math.max(l,u),c)}function o(u){var l=Math.round(u).toString(16).toUpperCase();return l.length<2?"0"+l:l}return k0.exports}var D7=L7();const I7=tu(D7);function L0(r,e,t){let n=t;return n<0&&(n+=1),n>1&&(n-=1),n<1/6?r+(e-r)*6*n:n<1/2?e:n<2/3?r+(e-r)*(2/3-n)*6:r}function R7(r){const e=r[0]/360,t=r[1]/100,n=r[2]/100,i=r[3];if(t===0)return[n*255,n*255,n*255,i];const a=n<.5?n*(1+t):n+t-n*t,s=2*n-a,o=L0(s,a,e+1/3),u=L0(s,a,e),l=L0(s,a,e-1/3);return[o*255,u*255,l*255,i]}function ZS(r){const e=I7.get(r);if(!e)return null;const{model:t,value:n}=e;return t==="rgb"?n:t==="hsl"?R7(n):null}const wc=(r,e)=>t=>r*(1-t)+e*t,j7=(r,e)=>{const t=ZS(r),n=ZS(e);return t===null||n===null?t?()=>r:()=>e:i=>{const a=new Array(4);for(let c=0;c<4;c+=1){const d=t[c],h=n[c];a[c]=d*(1-i)+h*i}const[s,o,u,l]=a;return`rgba(${Math.round(s)}, ${Math.round(o)}, ${Math.round(u)}, ${l})`}},B7=(r,e)=>typeof r=="number"&&typeof e=="number"?wc(r,e):typeof r=="string"&&typeof e=="string"?j7(r,e):()=>r,F7=(r,e)=>{const t=wc(r,e);return n=>Math.round(t(n))};function QS({map:r,initKey:e},t){const n=e(t);return r.has(n)?r.get(n):t}function z7({map:r,initKey:e},t){const n=e(t);return r.has(n)?r.get(n):(r.set(n,t),t)}function $7({map:r,initKey:e},t){const n=e(t);return r.has(n)&&(t=r.get(n),r.delete(n)),t}function q7(r){return typeof r=="object"?r.valueOf():r}class JS extends Map{constructor(e){if(super(),this.map=new Map,this.initKey=q7,e!==null)for(const[t,n]of e)this.set(t,n)}get(e){return super.get(QS({map:this.map,initKey:this.initKey},e))}has(e){return super.has(QS({map:this.map,initKey:this.initKey},e))}set(e,t){return super.set(z7({map:this.map,initKey:this.initKey},e),t)}delete(e){return super.delete($7({map:this.map,initKey:this.initKey},e))}}class PN{constructor(e){this.options=Gn({},this.getDefaultOptions()),this.update(e)}getOptions(){return this.options}update(e={}){this.options=Gn({},this.options,e),this.rescale(e)}rescale(e){}}const d1=Symbol("defaultUnknown");function e_(r,e,t){for(let n=0;n<e.length;n+=1)r.has(e[n])||r.set(t(e[n]),n)}function t_(r){const{value:e,from:t,to:n,mapper:i,notFoundReturn:a}=r;let s=i.get(e);if(s===void 0){if(a!==d1)return a;s=t.push(e)-1,i.set(e,s)}return n[s%n.length]}function n_(r){return r instanceof Date?e=>`${e}`:typeof r=="object"?e=>JSON.stringify(e):e=>e}class h1 extends PN{getDefaultOptions(){return{domain:[],range:[],unknown:d1}}constructor(e){super(e)}map(e){return this.domainIndexMap.size===0&&e_(this.domainIndexMap,this.getDomain(),this.domainKey),t_({value:this.domainKey(e),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(e){return this.rangeIndexMap.size===0&&e_(this.rangeIndexMap,this.getRange(),this.rangeKey),t_({value:this.rangeKey(e),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(e){const[t]=this.options.domain,[n]=this.options.range;if(this.domainKey=n_(t),this.rangeKey=n_(n),!this.rangeIndexMap){this.rangeIndexMap=new Map,this.domainIndexMap=new Map;return}(!e||e.range)&&this.rangeIndexMap.clear(),(!e||e.domain||e.compare)&&(this.domainIndexMap.clear(),this.sortedDomain=void 0)}clone(){return new h1(this.options)}getRange(){return this.options.range}getDomain(){if(this.sortedDomain)return this.sortedDomain;const{domain:e,compare:t}=this.options;return this.sortedDomain=t?[...e].sort(t):e,this.sortedDomain}}function G7(r){const e=Math.min(...r);return r.map(t=>t/e)}function W7(r,e){const t=r.length,n=e-t;return n>0?[...r,...new Array(n).fill(1)]:n<0?r.slice(0,e):r}function V7(r){return Math.round(r*1e12)/1e12}function Y7(r){const{domain:e,range:t,paddingOuter:n,paddingInner:i,flex:a,round:s,align:o}=r,u=e.length,l=W7(a,u),[c,d]=t,h=d-c,f=2/u*n+1-1/u*i,g=h/f,v=g*i/u,p=g-u*v,y=G7(l),m=y.reduce((D,j)=>D+j),w=p/m,M=new JS(e.map((D,j)=>{const G=y[j]*w;return[D,s?Math.floor(G):G]})),S=new JS(e.map((D,j)=>{const V=y[j]*w+v;return[D,s?Math.floor(V):V]})),T=Array.from(S.values()).reduce((D,j)=>D+j),O=(h-(T-T/u*i))*o,N=c+O;let C=s?Math.round(N):N;const P=new Array(u);for(let D=0;D<u;D+=1){P[D]=V7(C);const j=e[D];C+=S.get(j)}return{valueBandWidth:M,valueStep:S,adjustedRange:P}}function U7(r){var e;const{domain:t}=r,n=t.length;if(n===0)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(!!(!((e=r.flex)===null||e===void 0)&&e.length))return Y7(r);const{range:a,paddingOuter:s,paddingInner:o,round:u,align:l}=r;let c,d,h=a[0];const g=a[1]-h,v=s*2,p=n-o;c=g/Math.max(1,v+p),u&&(c=Math.floor(c)),h+=(g-c*(n-o))*l,d=c*(1-o),u&&(h=Math.round(h),d=Math.round(d));const y=new Array(n).fill(0).map((m,w)=>h+w*c);return{valueStep:c,valueBandWidth:d,adjustedRange:y}}class f1 extends h1{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:d1,flex:[]}}constructor(e){super(e)}clone(){return new f1(this.options)}getStep(e){return this.valueStep===void 0?1:typeof this.valueStep=="number"?this.valueStep:e===void 0?Array.from(this.valueStep.values())[0]:this.valueStep.get(e)}getBandWidth(e){return this.valueBandWidth===void 0?1:typeof this.valueBandWidth=="number"?this.valueBandWidth:e===void 0?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(e)}getRange(){return this.adjustedRange}getPaddingInner(){const{padding:e,paddingInner:t}=this.options;return e>0?e:t}getPaddingOuter(){const{padding:e,paddingOuter:t}=this.options;return e>0?e:t}rescale(){super.rescale();const{align:e,domain:t,range:n,round:i,flex:a}=this.options,{adjustedRange:s,valueBandWidth:o,valueStep:u}=U7({align:e,range:n,round:i,flex:a,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:t});this.valueStep=u,this.valueBandWidth=o,this.adjustedRange=s}}const H7=(r,e,t)=>{let n,i,a=r,s=e;if(a===s&&t>0)return[a];let o=Rl(a,s,t);if(o===0||!Number.isFinite(o))return[];if(o>0){a=Math.ceil(a/o),s=Math.floor(s/o),i=new Array(n=Math.ceil(s-a+1));for(let u=0;u<n;u+=1)i[u]=(a+u)*o}else{o=-o,a=Math.ceil(a*o),s=Math.floor(s*o),i=new Array(n=Math.ceil(s-a+1));for(let u=0;u<n;u+=1)i[u]=(a+u)/o}return i},X7=(r,e,t)=>{const[n,i]=r,[a,s]=e;let o,u;return n<i?(o=zy(n,i),u=t(a,s)):(o=zy(i,n),u=t(s,a)),bc(u,o)},K7=(r,e,t)=>{const n=Math.min(r.length,e.length)-1,i=new Array(n),a=new Array(n),s=r[0]>r[n],o=s?[...r].reverse():r,u=s?[...e].reverse():e;for(let l=0;l<n;l+=1)i[l]=zy(o[l],o[l+1]),a[l]=t(u[l],u[l+1]);return l=>{const c=A7(r,l,1,n)-1,d=i[c],h=a[c];return bc(h,d)(l)}},r_=(r,e,t,n)=>(Math.min(r.length,e.length)>2?K7:X7)(r,e,n?F7:t);class Z7 extends PN{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:wc,tickCount:5}}map(e){return YS(e)?this.output(e):this.options.unknown}invert(e){return YS(e)?this.input(e):this.options.unknown}nice(){if(!this.options.nice)return;const[e,t,n,...i]=this.getTickMethodOptions();this.options.domain=this.chooseNice()(e,t,n,...i)}getTicks(){const{tickMethod:e}=this.options,[t,n,i,...a]=this.getTickMethodOptions();return e(t,n,i,...a)}getTickMethodOptions(){const{domain:e,tickCount:t}=this.options,n=e[0],i=e[e.length-1];return[n,i,t]}chooseNice(){return k7}rescale(){this.nice();const[e,t]=this.chooseTransforms();this.composeOutput(e,this.chooseClamp(e)),this.composeInput(e,t,this.chooseClamp(t))}chooseClamp(e){const{clamp:t,range:n}=this.options,i=this.options.domain.map(e),a=Math.min(i.length,n.length);return t?O7(i[0],i[a-1]):K0}composeOutput(e,t){const{domain:n,range:i,round:a,interpolate:s}=this.options,o=r_(n.map(e),i,s,a);this.output=bc(o,t,e)}composeInput(e,t,n){const{domain:i,range:a}=this.options,s=r_(a,i.map(e),wc);this.input=bc(t,n,s)}}class Lo extends Z7{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:B7,tickMethod:H7,tickCount:5}}chooseTransforms(){return[K0,K0]}clone(){return new Lo(this.options)}}var Q7=function(r){Ue(e,r);function e(t){var n=this,i=t.style,a=Jt(t,["style"]);return n=r.call(this,Gn({},{type:"column"},he({style:i},a)))||this,n.columnsGroup=new ln({name:"columns"}),n.appendChild(n.columnsGroup),n.render(),n}return e.prototype.render=function(){var t=this.attributes,n=t.columns,i=t.x,a=t.y;this.columnsGroup.style.transform="translate(".concat(i,", ").concat(a,")"),Oe(this.columnsGroup).selectAll(".column").data(n.flat()).join(function(s){return s.append("rect").attr("className","column").each(function(o){this.attr(o)})},function(s){return s.each(function(o){this.attr(o)})},function(s){return s.remove()})},e.prototype.update=function(t){this.attr(vn({},this.attributes,t)),this.render()},e.prototype.clear=function(){this.removeChildren()},e}(mt),J7=function(r){Ue(e,r);function e(t){var n=this,i=t.style,a=Jt(t,["style"]);return n=r.call(this,Gn({},{type:"lines"},he({style:i},a)))||this,n.linesGroup=n.appendChild(new ln),n.areasGroup=n.appendChild(new ln),n.render(),n}return e.prototype.render=function(){var t=this.attributes,n=t.lines,i=t.areas,a=t.x,s=t.y;this.style.transform="translate(".concat(a,", ").concat(s,")"),n&&this.renderLines(n),i&&this.renderAreas(i)},e.prototype.clear=function(){this.linesGroup.removeChildren(),this.areasGroup.removeChildren()},e.prototype.update=function(t){this.attr(vn({},this.attributes,t)),this.render()},e.prototype.renderLines=function(t){Oe(this.linesGroup).selectAll(".line").data(t).join(function(n){return n.append("path").attr("className","line").each(function(i){this.attr(i)})},function(n){return n.each(function(i){this.attr(i)})},function(n){return n.remove()})},e.prototype.renderAreas=function(t){Oe(this.linesGroup).selectAll(".area").data(t).join(function(n){return n.append("path").attr("className","area").each(function(i){this.attr(i)})},function(n){return n.each(function(i){this.style(i)})},function(n){return n.remove()})},e}(mt);function eV(r,e){var t,n=e.x,i=e.y,a=q(i.getOptions().range||[0,0],2),s=a[0],o=a[1];return o>s&&(t=q([s,o],2),o=t[0],s=t[1]),r.map(function(u){var l=u.map(function(c,d){return[n.map(d),jt(i.map(c),o,s)]});return l})}function Ko(r,e){e===void 0&&(e=!1);var t=e?r.length-1:0,n=r.map(function(i,a){return ke([a===t?"M":"L"],q(i),!1)});return e?n.reverse():n}function xc(r,e){if(e===void 0&&(e=!1),r.length<=2)return Ko(r);for(var t=[],n=r.length,i=0;i<n;i+=1){var a=e?r[n-i-1]:r[i];Bt(a,t.slice(-2))||t.push.apply(t,ke([],q(a),!1))}var s=VW(t);return e?s.unshift(ke(["M"],q(r[n-1]),!1)):s.unshift(ke(["M"],q(r[0]),!1)),s}function g1(r,e,t){var n=la(r);return n.push(["L",e,t],["L",0,t],["Z"]),n}function tV(r,e,t,n){return r.map(function(i){return g1(e?xc(i):Ko(i),t,n)})}function nV(r,e,t){for(var n=[],i=r.length-1;i>=0;i-=1){var a=r[i],s=Ko(a),o=void 0;if(i===0)o=g1(s,e,t);else{var u=r[i-1],l=Ko(u,!0);l[0][0]="L",o=ke(ke(ke([],q(s),!1),q(l),!1),[["Z"]],!1)}n.push(o)}return n}function rV(r,e,t){for(var n=[],i=r.length-1;i>=0;i-=1){var a=r[i],s=xc(a),o=void 0;if(i===0)o=g1(s,e,t);else{var u=r[i-1],l=xc(u,!0),c=a[0];l[0][0]="L",o=ke(ke(ke([],q(s),!1),q(l),!1),[ke(["M"],q(c),!1),["Z"]],!1)}n.push(o)}return n}function i_(r){return r.length===0?[0,0]:[Wl(RL(r,function(e){return Wl(e)||0})),Gl(IL(r,function(e){return Gl(e)||0}))]}function a_(r){for(var e=la(r),t=e[0].length,n=q([Array(t).fill(0),Array(t).fill(0)],2),i=n[0],a=n[1],s=0;s<e.length;s+=1)for(var o=e[s],u=0;u<t;u+=1)o[u]>=0?(o[u]+=i[u],i[u]=o[u]):(o[u]+=a[u],a[u]=o[u]);return e}var iV=function(r){Ue(e,r);function e(t){return r.call(this,t,{type:"line",x:0,y:0,width:200,height:20,isStack:!1,color:["#83daad","#edbf45","#d2cef9","#e290b3","#6f63f4"],smooth:!0,lineLineWidth:1,areaOpacity:0,isGroup:!1,columnLineWidth:1,columnStroke:"#fff",scale:1,spacing:0})||this}return Object.defineProperty(e.prototype,"rawData",{get:function(){var t=this.attributes.data;if(!t||(t==null?void 0:t.length)===0)return[[]];var n=la(t);return Ee(n[0])?[n]:n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.attributes.isStack?a_(this.rawData):this.rawData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scales",{get:function(){return this.createScales(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseline",{get:function(){var t=this.scales.y,n=q(t.getOptions().domain||[0,0],2),i=n[0],a=n[1];return a<0?t.map(a):t.map(i<0?0:i)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"containerShape",{get:function(){var t=this.attributes,n=t.width,i=t.height;return{width:n,height:i}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linesStyle",{get:function(){var t=this,n=this.attributes,i=n.type,a=n.isStack,s=n.smooth;if(i!=="line")throw new Error("linesStyle can only be used in line type");var o=Be(this.attributes,"area"),u=Be(this.attributes,"line"),l=this.containerShape.width,c=this.data;if(c[0].length===0)return{lines:[],areas:[]};var d=this.scales,h=d.x,f=d.y,g=eV(c,{type:"line",x:h,y:f}),v=[];{var p=this.baseline;a?v=s?rV(g,l,p):nV(g,l,p):v=tV(g,s,l,p)}return{lines:g.map(function(y,m){return he({stroke:t.getColor(m),d:s?xc(y):Ko(y)},u)}),areas:v.map(function(y,m){return he({d:y,fill:t.getColor(m)},o)})}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnsStyle",{get:function(){var t=this,n=Be(this.attributes,"column"),i=this.attributes,a=i.isStack,s=i.type,o=i.scale;if(s!=="column")throw new Error("columnsStyle can only be used in column type");var u=this.containerShape.height,l=this.rawData;if(!l)return{columns:[]};a&&(l=a_(l));var c=this.createScales(l),d=c.x,h=c.y,f=q(i_(l),2),g=f[0],v=f[1],p=new Lo({domain:[0,v-(g>0?0:g)],range:[0,u*o]}),y=d.getBandWidth(),m=this.rawData;return{columns:l.map(function(w,M){return w.map(function(S,T){var A=y/l.length,O=function(){return{x:d.map(T)+A*M,y:S>=0?h.map(S):h.map(0),width:A,height:p.map(Math.abs(S))}},N=function(){return{x:d.map(T),y:h.map(S),width:y,height:p.map(m[M][T])}};return he(he({fill:t.getColor(M)},n),a?N():O())})})}},enumerable:!1,configurable:!0}),e.prototype.render=function(t,n){QW(n,".container","rect").attr("className","container").node();var i=t.type,a=t.x,s=t.y,o="spark".concat(i),u=he({x:a,y:s},i==="line"?this.linesStyle:this.columnsStyle);Oe(n).selectAll(".spark").data([i]).join(function(l){return l.append(function(c){return c==="line"?new J7({className:o,style:u}):new Q7({className:o,style:u})}).attr("className","spark ".concat(o))},function(l){return l.update(u)},function(l){return l.remove()})},e.prototype.getColor=function(t){var n=this.attributes.color;return gr(n)?n[t%n.length]:Te(n)?n.call(null,t):n},e.prototype.createScales=function(t){var n,i,a=this.attributes,s=a.type,o=a.scale,u=a.range,l=u===void 0?[]:u,c=a.spacing,d=this.containerShape,h=d.width,f=d.height,g=q(i_(t),2),v=g[0],p=g[1],y=new Lo({domain:[(n=l[0])!==null&&n!==void 0?n:v,(i=l[1])!==null&&i!==void 0?i:p],range:[f,f*(1-o)]});return s==="line"?{type:s,x:new Lo({domain:[0,t[0].length-1],range:[0,h]}),y}:{type:s,x:new f1({domain:t[0].map(function(m,w){return w}),range:[0,h],paddingInner:c,paddingOuter:c/2,align:.5}),y}},e.tag="sparkline",e}($t);function aV(r){return typeof r=="boolean"?!1:"enter"in r&&"update"in r&&"exit"in r}function s_(r){if(!r)return{enter:!1,update:!1,exit:!1};var e=["enter","update","exit"],t=Object.fromEntries(Object.entries(r).filter(function(n){var i=q(n,1),a=i[0];return!e.includes(a)}));return Object.fromEntries(e.map(function(n){return aV(r)?r[n]===!1?[n,!1]:[n,he(he({},r[n]),t)]:[n,t]}))}function Qs(r,e){r?r.finished.then(e):e()}function sV(r,e){r.length===0?e():Promise.all(r.map(function(t){return t==null?void 0:t.finished})).then(e)}function LN(r,e){"update"in r?r.update(e):r.attr(e)}function DN(r,e,t){if(e.length===0)return null;if(!t){var n=e.slice(-1)[0];return LN(r,{style:n}),null}return r.animate(e,t)}function oV(r,e){return!(r.nodeName!=="text"||e.nodeName!=="text"||r.attributes.text!==e.attributes.text)}function uV(r,e,t,n){if(n===void 0&&(n="destroy"),oV(r,e))return r.remove(),[null];var i=function(){n==="destroy"?r.destroy():n==="hide"&&Fr(r),e.isVisible()&&Mu(e)};if(!t)return i(),[null];var a=t.duration,s=a===void 0?0:a,o=t.delay,u=o===void 0?0:o,l=Math.ceil(+s/2),c=+s/4,d=q(r.getGeometryBounds().center,2),h=d[0],f=d[1],g=q(e.getGeometryBounds().center,2),v=g[0],p=g[1],y=q([(h+v)/2-h,(f+p)/2-f],2),m=y[0],w=y[1],M=r.style.opacity,S=M===void 0?1:M,T=e.style.opacity,A=T===void 0?1:T,O=r.style.transform||"",N=e.style.transform||"",C=r.animate([{opacity:S,transform:"translate(0, 0) ".concat(O)},{opacity:0,transform:"translate(".concat(m,", ").concat(w,") ").concat(O)}],he(he({fill:"both"},t),{duration:u+l+c})),P=e.animate([{opacity:0,transform:"translate(".concat(-m,", ").concat(-w,") ").concat(N),offset:.01},{opacity:A,transform:"translate(0, 0) ".concat(N)}],he(he({fill:"both"},t),{duration:l+c,delay:u+l-c}));return Qs(P,i),[C,P]}function zr(r,e,t){var n={},i={};return Object.entries(e).forEach(function(a){var s=q(a,2),o=s[0],u=s[1];if(!Le(u)){var l=r.style[o]||r.parsedStyle[o]||0;l!==u&&(n[o]=l,i[o]=u)}}),t?DN(r,[n,i],he({fill:"both"},t)):(LN(r,i),null)}function Ld(r,e){return r.style.opacity||(r.style.opacity=1),zr(r,{opacity:0},e)}var IN={fill:"#fff",lineWidth:1,radius:2,size:10,stroke:"#bfbfbf",strokeOpacity:1,zIndex:0},RN={fill:"#000",fillOpacity:.45,fontSize:12,textAlign:"center",textBaseline:"middle",zIndex:1},jN={x:0,y:0,orientation:"horizontal",showLabel:!0,type:"start"},Jr=Vr({foreground:"foreground",handle:"handle",selection:"selection",sparkline:"sparkline",sparklineGroup:"sparkline-group",track:"track",brushArea:"brush-area"},"slider"),Hi=Vr({labelGroup:"label-group",label:"label",iconGroup:"icon-group",icon:"icon",iconRect:"icon-rect",iconLine:"icon-line"},"handle"),lV=function(r){Ue(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.render=function(t,n){var i=t.x,a=t.y,s=t.size,o=s===void 0?10:s,u=t.radius,l=u===void 0?o/4:u,c=t.orientation,d=Jt(t,["x","y","size","radius","orientation"]),h=o,f=h*2.4,g=Oe(n).maybeAppendByClassName(Hi.iconRect,"rect").styles(he(he({},d),{width:h,height:f,radius:l,x:i-h/2,y:a-f/2,transformOrigin:"center"})),v=i+1/3*h-h/2,p=i+2/3*h-h/2,y=a+1/4*f-f/2,m=a+3/4*f-f/2;g.maybeAppendByClassName("".concat(Hi.iconLine,"-1"),"line").styles(he({x1:v,x2:v,y1:y,y2:m},d)),g.maybeAppendByClassName("".concat(Hi.iconLine,"-2"),"line").styles(he({x1:p,x2:p,y1:y,y2:m},d)),c==="vertical"&&(g.node().style.transform="rotate(90)")},e}($t),cV=function(r){Ue(e,r);function e(t){return r.call(this,t,jN)||this}return e.prototype.renderLabel=function(t){var n=this,i=this.attributes,a=i.x,s=i.y,o=i.showLabel,u=Be(this.attributes,"label"),l=u.x,c=l===void 0?0:l,d=u.y,h=d===void 0?0:d,f=u.transform,g=u.transformOrigin,v=Jt(u,["x","y","transform","transformOrigin"]),p=q(Pi(v,[]),2),y=p[0],m=p[1],w=Oe(t).maybeAppendByClassName(Hi.labelGroup,"g").styles(m),M=he(he({},RN),y),S=M.text,T=Jt(M,["text"]);fr(!!o,w,function(A){n.label=A.maybeAppendByClassName(Hi.label,"text").styles(he(he({},T),{x:a+c,y:s+h,transform:f,transformOrigin:g,text:"".concat(S)})),n.label.on("mousedown",function(O){O.stopPropagation()}),n.label.on("touchstart",function(O){O.stopPropagation()})})},e.prototype.renderIcon=function(t){var n=this.attributes,i=n.x,a=n.y,s=n.orientation,o=n.type,u=he(he({x:i,y:a,orientation:s},IN),Be(this.attributes,"icon")),l=this.attributes.iconShape,c=l===void 0?function(){return new lV({style:u})}:l,d=Oe(t).maybeAppendByClassName(Hi.iconGroup,"g");d.selectAll(Hi.icon.class).data([c]).join(function(h){return h.append(typeof c=="string"?c:function(){return c(o)}).attr("className",Hi.icon.name)},function(h){return h.update(u)},function(h){return h.remove()})},e.prototype.render=function(t,n){this.renderIcon(n),this.renderLabel(n)},e}($t),dV=function(r){Ue(e,r);function e(t){var n=r.call(this,t,he(he(he({x:0,y:0,animate:{duration:100,fill:"both"},brushable:!0,formatter:function(i){return i.toString()},handleSpacing:2,orientation:"horizontal",padding:0,autoFitLabel:!0,scrollable:!0,selectionFill:"#5B8FF9",selectionFillOpacity:.45,selectionZIndex:2,showHandle:!0,showLabel:!0,slidable:!0,trackFill:"#416180",trackLength:200,trackOpacity:.05,trackSize:20,trackZIndex:-1,values:[0,1],type:"range",selectionType:"select",handleIconOffset:0},Ms(jN,"handle")),Ms(IN,"handleIcon")),Ms(RN,"handleLabel")))||this;return n.range=[0,1],n.onDragStart=function(i){return function(a){a.stopPropagation(),n.target=i,n.prevPos=n.getOrientVal(RS(a));var s=n.availableSpace,o=s.x,u=s.y,l=n.getBBox(),c=l.x,d=l.y;n.selectionStartPos=n.getRatio(n.prevPos-n.getOrientVal([o,u])-n.getOrientVal([+c,+d])),n.selectionWidth=0,document.addEventListener("pointermove",n.onDragging),document.addEventListener("pointerup",n.onDragEnd)}},n.onDragging=function(i){var a=n.attributes,s=a.slidable,o=a.brushable,u=a.type;i.stopPropagation();var l=n.getOrientVal(RS(i)),c=l-n.prevPos;if(c){var d=n.getRatio(c);switch(n.target){case"start":s&&n.setValuesOffset(d);break;case"end":s&&n.setValuesOffset(0,d);break;case"selection":s&&n.setValuesOffset(d,d);break;case"track":if(!o)return;n.selectionWidth+=d,u==="range"?n.innerSetValues([n.selectionStartPos,n.selectionStartPos+n.selectionWidth].sort(),!0):n.innerSetValues([0,n.selectionStartPos+n.selectionWidth],!0);break}n.prevPos=l}},n.onDragEnd=function(){document.removeEventListener("pointermove",n.onDragging),document.removeEventListener("pointermove",n.onDragging),document.removeEventListener("pointerup",n.onDragEnd),n.target="",n.updateHandlesPosition(!1)},n.onValueChange=function(i){var a=n.attributes,s=a.onChange,o=a.type,u=o==="range"?i:i[1],l=o==="range"?n.getValues():n.getValues()[1],c=new Kt("valuechange",{detail:{oldValue:u,value:l}});n.dispatchEvent(c),s==null||s(l)},n.selectionStartPos=0,n.selectionWidth=0,n.prevPos=0,n.target="",n}return Object.defineProperty(e.prototype,"values",{get:function(){return this.attributes.values},set:function(t){this.attributes.values=this.clampValues(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sparklineStyle",{get:function(){var t=this.attributes.orientation;if(t!=="horizontal")return null;var n=Be(this.attributes,"sparkline");return he(he({zIndex:0},this.availableSpace),n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t=this.attributes,n=t.trackLength,i=t.trackSize,a=q(this.getOrientVal([[n,i],[i,n]]),2),s=a[0],o=a[1];return{width:s,height:o}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes;t.x,t.y;var n=t.padding,i=q(_n(n),4),a=i[0],s=i[1],o=i[2],u=i[3],l=this.shape,c=l.width,d=l.height;return{x:u,y:a,width:c-(u+s),height:d-(a+o)}},enumerable:!1,configurable:!0}),e.prototype.getValues=function(){return this.values},e.prototype.setValues=function(t,n){t===void 0&&(t=[0,0]),n===void 0&&(n=!1),this.attributes.values=t;var i=n===!1?!1:this.attributes.animate;this.updateSelectionArea(i),this.updateHandlesPosition(i)},e.prototype.updateSelectionArea=function(t){var n=this.calcSelectionArea();this.foregroundGroup.selectAll(Jr.selection.class).each(function(i,a){zr(this,n[a],t)})},e.prototype.updateHandlesPosition=function(t){this.attributes.showHandle&&(this.startHandle&&zr(this.startHandle,this.getHandleStyle("start"),t),this.endHandle&&zr(this.endHandle,this.getHandleStyle("end"),t))},e.prototype.innerSetValues=function(t,n){t===void 0&&(t=[0,0]),n===void 0&&(n=!1);var i=this.values,a=this.clampValues(t);this.attributes.values=a,this.setValues(a),n&&this.onValueChange(i)},e.prototype.renderTrack=function(t){var n=this.attributes,i=n.x,a=n.y,s=Be(this.attributes,"track");this.trackShape=Oe(t).maybeAppendByClassName(Jr.track,"rect").styles(he(he({x:i,y:a},this.shape),s))},e.prototype.renderBrushArea=function(t){var n=this.attributes,i=n.x,a=n.y,s=n.brushable;this.brushArea=Oe(t).maybeAppendByClassName(Jr.brushArea,"rect").styles(he({x:i,y:a,fill:"transparent",cursor:s?"crosshair":"default"},this.shape))},e.prototype.renderSparkline=function(t){var n=this,i=this.attributes,a=i.x,s=i.y,o=i.orientation,u=Oe(t).maybeAppendByClassName(Jr.sparklineGroup,"g");fr(o==="horizontal",u,function(l){var c=he(he({},n.sparklineStyle),{x:a,y:s});l.maybeAppendByClassName(Jr.sparkline,function(){return new iV({style:c})}).update(c)})},e.prototype.renderHandles=function(){var t=this,n,i=this.attributes,a=i.showHandle,s=i.type,o=s==="range"?["start","end"]:["end"],u=a?o:[],l=this;(n=this.foregroundGroup)===null||n===void 0||n.selectAll(Jr.handle.class).data(u.map(function(c){return{type:c}}),function(c){return c.type}).join(function(c){return c.append(function(d){var h=d.type;return new cV({style:t.getHandleStyle(h)})}).each(function(d){var h=d.type;this.attr("class","".concat(Jr.handle.name," ").concat(h,"-handle"));var f="".concat(h,"Handle");l[f]=this,this.addEventListener("pointerdown",l.onDragStart(h))})},function(c){return c.each(function(d){var h=d.type;this.update(l.getHandleStyle(h))})},function(c){return c.each(function(d){var h=d.type,f="".concat(h,"Handle");l[f]=void 0}).remove()})},e.prototype.renderSelection=function(t){var n=this.attributes,i=n.x,a=n.y,s=n.type,o=n.selectionType;this.foregroundGroup=Oe(t).maybeAppendByClassName(Jr.foreground,"g");var u=Be(this.attributes,"selection"),l=function(d){return d.style("visibility",function(h){return h.show?"visible":"hidden"}).style("cursor",function(h){return o==="select"?"grab":o==="invert"?"crosshair":"default"}).styles(he(he({},u),{transform:"translate(".concat(i,", ").concat(a,")")}))},c=this;this.foregroundGroup.selectAll(Jr.selection.class).data(s==="value"?[]:this.calcSelectionArea().map(function(d,h){return{style:he({},d),index:h,show:o==="select"?h===1:h!==1}}),function(d){return d.index}).join(function(d){return d.append("rect").attr("className",Jr.selection.name).call(l).each(function(h,f){var g=this;f===1?(c.selectionShape=Oe(this),this.on("pointerdown",function(v){g.attr("cursor","grabbing"),c.onDragStart("selection")(v)}),c.dispatchCustomEvent(this,"pointerenter","selectionMouseenter"),c.dispatchCustomEvent(this,"pointerleave","selectionMouseleave"),c.dispatchCustomEvent(this,"click","selectionClick"),this.addEventListener("pointerdown",function(){g.attr("cursor","grabbing")}),this.addEventListener("pointerup",function(){g.attr("cursor","pointer")}),this.addEventListener("pointerover",function(){g.attr("cursor","pointer")})):this.on("pointerdown",c.onDragStart("track"))})},function(d){return d.call(l)},function(d){return d.remove()}),this.updateSelectionArea(!1),this.renderHandles()},e.prototype.render=function(t,n){this.renderTrack(n),this.renderSparkline(n),this.renderBrushArea(n),this.renderSelection(n)},e.prototype.clampValues=function(t,n){var i;n===void 0&&(n=4);var a=q(this.range,2),s=a[0],o=a[1],u=q(this.getValues().map(function(p){return jS(p,n)}),2),l=u[0],c=u[1],d=Array.isArray(t)?t:[l,t??c],h=q((d||[l,c]).map(function(p){return jS(p,n)}),2),f=h[0],g=h[1];if(this.attributes.type==="value")return[0,jt(g,s,o)];f>g&&(i=q([g,f],2),f=i[0],g=i[1]);var v=g-f;return v>o-s?[s,o]:f<s?l===s&&c===g?[s,g]:[s,v+s]:g>o?c===o&&l===f?[f,o]:[o-v,o]:[f,g]},e.prototype.calcSelectionArea=function(t){var n=q(this.clampValues(t),2),i=n[0],a=n[1],s=this.availableSpace,o=s.x,u=s.y,l=s.width,c=s.height;return this.getOrientVal([[{y:u,height:c,x:o,width:i*l},{y:u,height:c,x:i*l+o,width:(a-i)*l},{y:u,height:c,x:a*l,width:(1-a)*l}],[{x:o,width:l,y:u,height:i*c},{x:o,width:l,y:i*c+u,height:(a-i)*c},{x:o,width:l,y:a*c,height:(1-a)*c}]])},e.prototype.calcHandlePosition=function(t){var n=this.attributes.handleIconOffset,i=this.availableSpace,a=i.x,s=i.y,o=i.width,u=i.height,l=q(this.clampValues(),2),c=l[0],d=l[1],h=t==="start"?-n:n,f=(t==="start"?c:d)*this.getOrientVal([o,u])+h;return{x:a+this.getOrientVal([f,o/2]),y:s+this.getOrientVal([u/2,f])}},e.prototype.inferTextStyle=function(t){var n=this.attributes.orientation;return n==="horizontal"?{}:t==="start"?{transformOrigin:"left center",transform:"rotate(90)",textAlign:"start"}:t==="end"?{transformOrigin:"right center",transform:"rotate(90)",textAlign:"end"}:{}},e.prototype.calcHandleText=function(t){var n,i=this.attributes,a=i.type,s=i.orientation,o=i.formatter,u=i.autoFitLabel,l=Be(this.attributes,"handle"),c=Be(l,"label"),d=l.spacing,h=this.getHandleSize(),f=this.clampValues(),g=t==="start"?f[0]:f[1],v=o(g),p=new o1({style:he(he(he({},c),this.inferTextStyle(t)),{text:v})}),y=p.getBBox(),m=y.width,w=y.height;if(p.destroy(),!u){if(a==="value")return{text:v,x:0,y:-w-d};var M=d+h+(s==="horizontal"?m/2:0);return n={text:v},n[s==="horizontal"?"x":"y"]=t==="start"?-M:M,n}var S=0,T=0,A=this.availableSpace,O=A.width,N=A.height,C=this.calcSelectionArea()[1],P=C.x,D=C.y,j=C.width,G=C.height,V=d+h;if(s==="horizontal"){var Y=V+m/2;if(t==="start"){var $=P-V-m;S=$>0?-Y:Y}else{var z=O-P-j-V>m;S=z?Y:-Y}}else{var Z=V,ne=w+V;t==="start"?T=D-h>w?-ne:Z:T=N-(D+G)-h>w?ne:-Z}return{x:S,y:T,text:v}},e.prototype.getHandleLabelStyle=function(t){var n=Be(this.attributes,"handleLabel");return he(he(he({},n),this.calcHandleText(t)),this.inferTextStyle(t))},e.prototype.getHandleIconStyle=function(){var t=this.attributes.handleIconShape,n=Be(this.attributes,"handleIcon"),i=this.getOrientVal(["ew-resize","ns-resize"]),a=this.getHandleSize();return he({cursor:i,shape:t,size:a},n)},e.prototype.getHandleStyle=function(t){var n=this.attributes,i=n.x,a=n.y,s=n.showLabel,o=n.showLabelOnInteraction,u=n.orientation,l=this.calcHandlePosition(t),c=l.x,d=l.y,h=this.calcHandleText(t),f=s;return!s&&o&&(this.target?f=!0:f=!1),he(he(he({},Ms(this.getHandleIconStyle(),"icon")),Ms(he(he({},this.getHandleLabelStyle(t)),h),"label")),{transform:"translate(".concat(c+i,", ").concat(d+a,")"),orientation:u,showLabel:f,type:t,zIndex:3})},e.prototype.getHandleSize=function(){var t=this.attributes,n=t.handleIconSize,i=t.width,a=t.height;return n||Math.floor((this.getOrientVal([+a,+i])+4)/2.4)},e.prototype.getOrientVal=function(t){var n=q(t,2),i=n[0],a=n[1],s=this.attributes.orientation;return s==="horizontal"?i:a},e.prototype.setValuesOffset=function(t,n,i){n===void 0&&(n=0),i===void 0&&(i=!1);var a=this.attributes.type,s=q(this.getValues(),2),o=s[0],u=s[1],l=a==="range"?t:0,c=[o+l,u+n].sort();i?this.setValues(c):this.innerSetValues(c,!0)},e.prototype.getRatio=function(t){var n=this.availableSpace,i=n.width,a=n.height;return t/this.getOrientVal([i,a])},e.prototype.dispatchCustomEvent=function(t,n,i){var a=this;t.on(n,function(s){s.stopPropagation(),a.dispatchEvent(new Kt(i,{detail:s}))})},e.prototype.bindEvents=function(){this.addEventListener("wheel",this.onScroll);var t=this.brushArea;this.dispatchCustomEvent(t,"click","trackClick"),this.dispatchCustomEvent(t,"pointerenter","trackMouseenter"),this.dispatchCustomEvent(t,"pointerleave","trackMouseleave"),t.on("pointerdown",this.onDragStart("track"))},e.prototype.onScroll=function(t){var n=this.attributes.scrollable;if(n){var i=t.deltaX,a=t.deltaY,s=a||i,o=this.getRatio(s);this.setValuesOffset(o,o,!0)}},e.tag="slider",e}($t),p1={data:[],animate:{enter:!1,update:{duration:100,easing:"ease-in-out-sine",fill:"both"},exit:{duration:100,fill:"both"}},showArrow:!0,showGrid:!0,showLabel:!0,showLine:!0,showTick:!0,showTitle:!0,showTrunc:!1,dataThreshold:100,lineLineWidth:1,lineStroke:"black",crossPadding:10,titleFill:"black",titleFontSize:12,titlePosition:"lb",titleSpacing:0,titleTextAlign:"center",titleTextBaseline:"middle",lineArrow:function(){return new lr({style:{d:[["M",10,10],["L",-10,0],["L",10,-10],["L",0,0],["L",10,10],["Z"]],fill:"black",transformOrigin:"center"}})},labelAlign:"parallel",labelDirection:"positive",labelFontSize:12,labelSpacing:0,gridConnect:"line",gridControlAngles:[],gridDirection:"positive",gridLength:0,gridType:"segment",lineArrowOffset:15,lineArrowSize:10,tickDirection:"positive",tickLength:5,tickLineWidth:1,tickStroke:"black",labelOverlap:[]};Gn({},p1,{style:{type:"arc"}});Gn({},p1,{style:{}});var st=Vr({mainGroup:"main-group",gridGroup:"grid-group",grid:"grid",lineGroup:"line-group",line:"line",tickGroup:"tick-group",tick:"tick",tickItem:"tick-item",labelGroup:"label-group",label:"label",labelItem:"label-item",titleGroup:"title-group",title:"title",lineFirst:"line-first",lineSecond:"line-second"},"axis"),Gs=Vr({lineGroup:"line-group",line:"line",regionGroup:"region-group",region:"region"},"grid");function BN(r){return r.reduce(function(e,t,n){return e.push(ke([n===0?"M":"L"],q(t),!1)),e},[])}function hV(r,e,t){var n=e.connect,i=n===void 0?"line":n,a=e.center;if(i==="line")return BN(r);if(!a)return[];var s=Xo(r[0],a),o=t?0:1;return r.reduce(function(u,l,c){return c===0?u.push(ke(["M"],q(l),!1)):u.push(ke(["A",s,s,0,0,o],q(l),!1)),u},[])}function $y(r,e,t){return e.type==="surround"?hV(r,e,t):BN(r)}function fV(r,e,t){var n=t.type,i=t.connect,a=t.center,s=t.closed,o=s?[["Z"]]:[],u=q([$y(r,t),$y(e.slice().reverse(),t,!0)],2),l=u[0],c=u[1],d=q([r[0],e.slice(-1)[0]],2),h=d[0],f=d[1],g=function(m,w){return[l,m,c,w,o].flat()};if(i==="line"||n==="surround")return g([ke(["L"],q(f),!1)],[ke(["L"],q(h),!1)]);if(!a)throw new Error("Arc grid need to specified center");var v=q([Xo(f,a),Xo(h,a)],2),p=v[0],y=v[1];return g([ke(["A",p,p,0,0,1],q(f),!1),ke(["L"],q(f),!1)],[ke(["A",y,y,0,0,0],q(h),!1),ke(["L"],q(h),!1)])}function gV(r,e,t,n){var i=t.animate,a=t.isBillboard,s=e.map(function(o,u){return{id:o.id||"grid-line-".concat(u),d:$y(o.points,t)}});return r.selectAll(Gs.line.class).data(s,function(o){return o.id}).join(function(o){return o.append("path").each(function(u,l){var c=Ar(FS(he({d:u.d},n)),[u,l,s]);this.attr(he({class:Gs.line.name,stroke:"#D9D9D9",lineWidth:1,lineDash:[4,4],isBillboard:a},c))})},function(o){return o.transition(function(u,l){var c=Ar(FS(he({d:u.d},n)),[u,l,s]);return zr(this,c,i.update)})},function(o){return o.transition(function(){var u=this,l=Ld(this,i.exit);return Qs(l,function(){return u.remove()}),l})}).transitions()}function pV(r,e,t){var n=t.animate,i=t.connect,a=t.areaFill;if(e.length<2||!a||!i)return[];for(var s=Array.isArray(a)?a:[a,"transparent"],o=function(g){return s[g%s.length]},u=[],l=0;l<e.length-1;l++){var c=q([e[l].points,e[l+1].points],2),d=c[0],h=c[1],f=fV(d,h,t);u.push({d:f,fill:o(l)})}return r.selectAll(Gs.region.class).data(u,function(g,v){return v}).join(function(g){return g.append("path").each(function(v,p){var y=Ar(v,[v,p,u]);this.attr(y)}).attr("className",Gs.region.name)},function(g){return g.transition(function(v,p){var y=Ar(v,[v,p,u]);return zr(this,y,n.update)})},function(g){return g.transition(function(){var v=this,p=Ld(this,n.exit);return Qs(p,function(){return v.remove()}),p})}).transitions()}function vV(r){var e=r.data,t=e===void 0?[]:e,n=r.closed;return n?t.map(function(i){var a=i.points,s=q(a,1),o=s[0];return he(he({},i),{points:ke(ke([],q(a),!1),[o],!1)})}):t}var yV=function(r){Ue(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.render=function(t,n){t.type,t.center,t.areaFill,t.closed;var i=Jt(t,["type","center","areaFill","closed"]),a=vV(t),s=Oe(n).maybeAppendByClassName(Gs.lineGroup,"g"),o=Oe(n).maybeAppendByClassName(Gs.regionGroup,"g"),u=gV(s,a,t,i),l=pV(o,a,t);return ke(ke([],q(u),!1),q(l),!1)},e}($t);function FN(r,e){return Object.fromEntries(Object.entries(r).map(function(t){var n=q(t,2),i=n[0],a=n[1];return[i,Ar(a,e)]}))}function v1(r,e){return e&&Te(e)?r.filter(e):r}function zN(r,e){var t=e.startAngle,n=e.endAngle;return(n-t)*r+t}function Dd(r,e){if(e.type==="linear"){var t=q(e.startPos,2),n=t[0],i=t[1],a=q(e.endPos,2),s=a[0],o=a[1],u=q([s-n,o-i],2),l=u[0],c=u[1];return ON([l,c])}var d=qs(zN(r,e));return[-Math.sin(d),Math.cos(d)]}function y1(r,e,t){var n=Dd(r,t);return GW(n,e!=="positive")}function Su(r,e){return y1(r,e.labelDirection,e)}function mV(r,e){var t=q(e.startPos,2),n=t[0],i=t[1],a=q(e.endPos,2),s=a[0],o=a[1],u=q([s-n,o-i],2),l=u[0],c=u[1];return[n+l*r,i+c*r]}function bV(r,e){var t=e.radius,n=q(e.center,2),i=n[0],a=n[1],s=qs(zN(r,e));return[i+t*Math.cos(s),a+t*Math.sin(s)]}function Id(r,e){return e.type==="linear"?mV(r,e):bV(r,e)}function $N(r){return Dd(0,r)[1]===0}function qN(r){return Dd(0,r)[0]===0}function GN(r,e){return e-r===360}function o_(r,e,t,n,i){var a=e-r,s=q([i,i],2),o=s[0],u=s[1],l=q([qs(r),qs(e)],2),c=l[0],d=l[1],h=function(N){return[t+i*Math.cos(N),n+i*Math.sin(N)]},f=q(h(c),2),g=f[0],v=f[1],p=q(h(d),2),y=p[0],m=p[1];if(GN(r,e)){var w=(d+c)/2,M=q(h(w),2),S=M[0],T=M[1];return[["M",g,v],["A",o,u,0,1,0,S,T],["A",o,u,0,1,0,y,m]]}var A=a>180?1:0,O=r>e?0:1;return"M".concat(g,",").concat(v,",A").concat(o,",").concat(u,",0,").concat(A,",").concat(O,",").concat(y,",").concat(m)}function wV(r){var e=r.attributes,t=e.startAngle,n=e.endAngle,i=e.center,a=e.radius;return ke(ke([t,n],q(i),!1),[a],!1)}function xV(r,e,t,n){var i=e.startAngle,a=e.endAngle,s=e.center,o=e.radius;return r.selectAll(st.line.class).data([{d:o_.apply(void 0,ke(ke([i,a],q(s),!1),[o],!1))}],function(u,l){return l}).join(function(u){return u.append("path").attr("className",st.line.name).styles(e).styles({d:function(l){return l.d}})},function(u){return u.transition(function(){var l=this,c=qW(this,wV(this),ke(ke([i,a],q(s),!1),[o],!1),n.update);if(c){var d=function(){var h=Fn(l.attributes,"__keyframe_data__");l.style.d=o_.apply(void 0,ke([],q(h),!1))};c.onframe=d,c.onfinish=d}return c}).styles(e)},function(u){return u.remove()}).styles(t).transitions()}function EV(r,e){e.truncRange,e.truncShape,e.lineExtension}function MV(r,e,t){t===void 0&&(t=[0,0]);var n=q([r,e,t],3),i=q(n[0],2),a=i[0],s=i[1],o=q(n[1],2),u=o[0],l=o[1],c=q(n[2],2),d=c[0],h=c[1],f=q([u-a,l-s],2),g=f[0],v=f[1],p=Math.sqrt(Math.pow(g,2)+Math.pow(v,2)),y=q([-d/p,h/p],2),m=y[0],w=y[1];return[m*g,m*v,w*g,w*v]}function u_(r){var e=q(r,2),t=q(e[0],2),n=t[0],i=t[1],a=q(e[1],2),s=a[0],o=a[1];return{x1:n,y1:i,x2:s,y2:o}}function SV(r,e,t,n){var i=e.showTrunc,a=e.startPos,s=e.endPos,o=e.truncRange,u=e.lineExtension,l=q([a,s],2),c=q(l[0],2),d=c[0],h=c[1],f=q(l[1],2),g=f[0],v=f[1],p=q(u?MV(a,s,u):new Array(4).fill(0),4),y=p[0],m=p[1],w=p[2],M=p[3],S=function(z){return r.selectAll(st.line.class).data(z,function(Z,ne){return ne}).join(function(Z){return Z.append("line").attr("className",function(ne){return"".concat(st.line.name," ").concat(ne.className)}).styles(t).transition(function(ne){return zr(this,u_(ne.line),!1)})},function(Z){return Z.styles(t).transition(function(ne){var se=ne.line;return zr(this,u_(se),n.update)})},function(Z){return Z.remove()}).transitions()};if(!i||!o)return S([{line:[[d+y,h+m],[g+w,v+M]],className:st.line.name}]);var T=q(o,2),A=T[0],O=T[1],N=g-d,C=v-h,P=q([d+N*A,h+C*A],2),D=P[0],j=P[1],G=q([d+N*O,h+C*O],2),V=G[0],Y=G[1],$=S([{line:[[d+y,h+m],[D,j]],className:st.lineFirst.name},{line:[[V,Y],[g+w,v+M]],className:st.lineSecond.name}]);return EV(r,e),$}function _V(r,e,t,n){var i=t.showArrow,a=t.showTrunc,s=t.lineArrow,o=t.lineArrowOffset,u=t.lineArrowSize,l;if(e==="arc"?l=r.select(st.line.class):a?l=r.select(st.lineSecond.class):l=r.select(st.line.class),!i||!s||t.type==="arc"&&GN(t.startAngle,t.endAngle)){var c=l.node();c&&(c.style.markerEnd=void 0);return}var d=Ci(s);d.attr(n),l1(d,u),l.style("markerEnd",d).style("markerEndOffset",-o)}function TV(r,e,t){var n=e.type,i,a=Be(e,"line");return n==="linear"?i=SV(r,e,BS(a,"arrow"),t):i=xV(r,e,BS(a,"arrow"),t),_V(r,n,e,a),i}function OV(r,e){return y1(r,e.gridDirection,e)}function WN(r){var e=r.type,t=r.gridCenter;return e==="linear"?t:t||r.center}function AV(r,e){var t=e.gridLength;return r.map(function(n,i){var a=n.value,s=q(Id(a,e),2),o=s[0],u=s[1],l=q(Mi(OV(a,e),t),2),c=l[0],d=l[1];return{id:i,points:[[o,u],[o+c,u+d]]}})}function kV(r,e){var t=e.gridControlAngles,n=WN(e);if(!n)throw new Error("grid center is not provide");if(r.length<2)throw new Error("Invalid grid data");if(!t||t.length===0)throw new Error("Invalid gridControlAngles");var i=q(n,2),a=i[0],s=i[1];return r.map(function(o,u){var l=o.value,c=q(Id(l,e),2),d=c[0],h=c[1],f=q([d-a,h-s],2),g=f[0],v=f[1],p=[];return t.forEach(function(y){var m=qs(y),w=q([Math.cos(m),Math.sin(m)],2),M=w[0],S=w[1],T=g*M-v*S+a,A=g*S+v*M+s;p.push([T,A])}),{points:p,id:u}})}function NV(r,e,t,n){var i=Be(t,"grid"),a=i.type,s=i.areaFill,o=WN(t),u=v1(e,t.gridFilter),l=a==="segment"?AV(u,t):kV(u,t),c=he(he({},i),{center:o,areaFill:Te(s)?u.map(function(d,h){return Ar(s,[d,h,u])}):s,animate:n,data:l});return r.selectAll(st.grid.class).data([1]).join(function(d){return d.append(function(){return new yV({style:c})}).attr("className",st.grid.name)},function(d){return d.transition(function(){return this.update(c)})},function(d){return d.remove()}).transitions()}var qy=function(){function r(e,t,n,i){this.set(e,t,n,i)}return Object.defineProperty(r.prototype,"left",{get:function(){return this.x1},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.y1},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"right",{get:function(){return this.x2},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"bottom",{get:function(){return this.y2},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"width",{get:function(){return this.defined("x2")&&this.defined("x1")?this.x2-this.x1:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this.defined("y2")&&this.defined("y1")?this.y2-this.y1:void 0},enumerable:!1,configurable:!0}),r.prototype.rotatedPoints=function(e,t,n){var i=this,a=i.x1,s=i.y1,o=i.x2,u=i.y2,l=Math.cos(e),c=Math.sin(e),d=t-t*l+n*c,h=n-t*c-n*l,f=[[l*a-c*u+d,c*a+l*u+h],[l*o-c*u+d,c*o+l*u+h],[l*a-c*s+d,c*a+l*s+h],[l*o-c*s+d,c*o+l*s+h]];return f},r.prototype.set=function(e,t,n,i){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},r.prototype.defined=function(e){return this[e]!==Number.MAX_VALUE&&this[e]!==-Number.MAX_VALUE},r}();function Gy(r,e){var t=r.getEulerAngles()||0;r.setEulerAngles(0);var n=r.getBounds(),i=q(n.min,2),a=i[0],s=i[1],o=q(n.max,2),u=o[0],l=o[1],c=r.getBBox(),d=c.width,h=c.height,f=h,g=0,v=0,p=a,y=s,m=_N(r);if(m){f-=1.5;var w=m.style.textAlign,M=m.style.textBaseline;w==="center"?p=(a+u)/2:(w==="right"||w==="end")&&(p=u),M==="middle"?y=(s+l)/2:M==="bottom"&&(y=l)}var S=q(_n(e),4),T=S[0],A=T===void 0?0:T,O=S[1],N=O===void 0?0:O,C=S[2],P=C===void 0?A:C,D=S[3],j=D===void 0?N:D,G=new qy((g+=a)-j,(v+=s)-A,g+d+N,v+f+P);return r.setEulerAngles(t),G.rotatedPoints(qs(t),p,y)}function Mo(r,e){return e[0]<=Math.max(r[0][0],r[1][0])&&e[0]<=Math.min(r[0][0],r[1][0])&&e[1]<=Math.max(r[0][1],r[1][1])&&e[1]<=Math.min(r[0][1],r[1][1])}function So(r,e,t){var n=(e[1]-r[1])*(t[0]-e[0])-(e[0]-r[0])*(t[1]-e[1]);return n===0?0:n<0?2:1}function CV(r,e){var t=So(r[0],r[1],e[0]),n=So(r[0],r[1],e[1]),i=So(e[0],e[1],r[0]),a=So(e[0],e[1],r[1]);return!!(t!==n&&i!==a||t===0&&Mo(r,e[0])||n===0&&Mo(r,e[1])||i===0&&Mo(e,r[0])||a===0&&Mo(e,r[1]))}function PV(r,e){var t=r.length;if(t<3)return!1;var n=[e,[9999,e[1]]],i=0,a=0;do{var s=[r[a],r[(a+1)%t]];if(CV(s,n)){if(So(s[0],e,s[1])===0)return Mo(s,e);i++}a=(a+1)%t}while(a!==0);return!!(i&1)}function LV(r,e){return e.every(function(t){return PV(r,t)})}function DV(r,e,t){var n=r.x1,i=r.x2,a=r.y1,s=r.y2,o=[[n,a],[i,a],[i,s],[n,s]],u=Gy(e,t);return LV(o,u)}function IV(r,e){var t=q(r,4),n=t[0],i=t[1],a=t[2],s=t[3],o=q(e,4),u=o[0],l=o[1],c=o[2],d=o[3],h=a-n,f=s-i,g=c-u,v=d-l,p=h*v-g*f;if(p===0)return!1;var y=p>0,m=n-u,w=i-l,M=h*w-f*m;if(M<0===y)return!1;var S=g*w-v*m;return!(S<0===y||M>p===y||S>p===y)}function RV(r,e){var t=[[r[0],r[1],r[2],r[3]],[r[2],r[3],r[4],r[5]],[r[4],r[5],r[6],r[7]],[r[6],r[7],r[0],r[1]]];return t.some(function(n){return IV(e,n)})}function jV(r,e,t){var n,i,a=Gy(r,t).flat(1),s=Gy(e,t).flat(1),o=[[a[0],a[1],a[2],a[3]],[a[0],a[1],a[4],a[5]],[a[4],a[5],a[6],a[7]],[a[2],a[3],a[6],a[7]]];try{for(var u=nu(o),l=u.next();!l.done;l=u.next()){var c=l.value;if(RV(s,c))return!0}}catch(d){n={error:d}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}return!1}function BV(r,e){var t=r.type,n=r.labelDirection,i=r.crossSize;if(!i)return!1;if(t==="arc"){var a=r.center,s=r.radius,o=q(a,2),u=o[0],l=o[1],c=n==="negative"?0:i,d=-s-c,h=s+c,f=q(_n(e),4),g=f[0],v=f[1],p=f[2],y=f[3];return new qy(u+d-y,l+d-g,u+h+v,l+h+p)}var m=q(r.startPos,2),w=m[0],M=m[1],S=q(r.endPos,2),T=S[0],A=S[1],O=q(qN(r)?[-e,0,e,0]:[0,e,0,-e],4),N=O[0],C=O[1],P=O[2],D=O[3],j=Su(0,r),G=Mi(j,i),V=new qy(w,M,T,A);return V.x1+=D,V.y1+=N,V.x2+=C+G[0],V.y2+=P+G[1],V}function Rd(r,e,t){var n,i,a=e.crossPadding,s=new Set,o=null,u=BV(e,a),l=function(g){return u?DV(u,g):!0},c=function(g,v){return!g||!g.firstChild?!0:!jV(g.firstChild,v.firstChild,_n(t))};try{for(var d=nu(r),h=d.next();!h.done;h=d.next()){var f=h.value;l(f)?!o||c(o,f)?o=f:(s.add(o),s.add(f)):s.add(f)}}catch(g){n={error:g}}finally{try{h&&!h.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}return Array.from(s)}function D0(r,e){return e===void 0&&(e={}),Le(r)?0:typeof r=="number"?r:Math.floor(RW(r,e))}function FV(r,e,t,n){if(!(r.length<=1)){var i=e.suffix,a=i===void 0?"...":i,s=e.minLength,o=e.maxLength,u=o===void 0?1/0:o,l=e.step,c=l===void 0?" ":l,d=e.margin,h=d===void 0?[0,0,0,0]:d,f=SN(n.getTextShape(r[0])),g=D0(c,f),v=s?D0(s,f):g,p=D0(u,f);(Le(p)||p===1/0)&&(p=Math.max.apply(null,r.map(function(T){return T.getBBox().width})));var y=r.slice(),m=q(h,4);m[0],m[1],m[2],m[3];for(var w=function(T){if(y.forEach(function(A){n.ellipsis(n.getTextShape(A),T,a)}),y=Rd(r,t,h),y.length<1)return{value:void 0}},M=p;M>v+g;M-=g){var S=w(M);if(typeof S=="object")return S.value}}}var zV={parity:function(r,e){var t=e.seq,n=t===void 0?2:t;return r.filter(function(i,a){return a%n?(Fr(i),!1):!0})}},$V=function(r){return r.filter(MN)};function qV(r,e,t,n){var i=r.length,a=e.keepHeader,s=e.keepTail;if(!(i<=1||i===2&&a&&s)){var o=zV.parity,u=function(w){return w.forEach(n.show),w},l=2,c=r.slice(),d=r.slice(),h=Math.min.apply(Math,ke([1],q(r.map(function(w){return w.getBBox().width})),!1));if(t.type==="linear"&&($N(t)||qN(t))){var f=zS(r[0]).left,g=zS(r[i-1]).right,v=Math.abs(g-f)||1;l=Math.max(Math.floor(i*h/v),l)}var p,y;for(a&&(p=c.splice(0,1)[0]),s&&(y=c.splice(-1,1)[0],c.reverse()),u(c);l<r.length&&Rd($V(y?ke(ke([y],q(d),!1),[p],!1):ke([p],q(d),!1)),t,e==null?void 0:e.margin).length;){if(y&&!p&&l%2===0){var m=c.splice(0,1);m.forEach(n.hide)}else if(y&&p){var m=c.splice(0,1);m.forEach(n.hide)}d=o(u(c),{seq:l}),l++}}}function GV(r,e,t,n){var i,a,s=e.optionalAngles,o=s===void 0?[0,45,90]:s,u=e.margin,l=e.recoverWhenFailed,c=l===void 0?!0:l,d=r.map(function(y){return y.getLocalEulerAngles()}),h=function(){return Rd(r,t,u).length<1},f=function(y){return r.forEach(function(m,w){var M=Array.isArray(y)?y[w]:y;n.rotate(m,+M)})};try{for(var g=nu(o),v=g.next();!v.done;v=g.next()){var p=v.value;if(f(p),h())return}}catch(y){i={error:y}}finally{try{v&&!v.done&&(a=g.return)&&a.call(g)}finally{if(i)throw i.error}}c&&f(d)}function WV(r){var e=r.type,t=r.labelDirection;return e==="linear"&&$N(r)?t==="negative"?"bottom":"top":"middle"}function VV(r,e,t,n){var i=e.wordWrapWidth,a=i===void 0?50:i,s=e.maxLines,o=s===void 0?3:s,u=e.recoverWhenFailed,l=u===void 0?!0:u,c=e.margin,d=c===void 0?[0,0,0,0]:c,h=r.map(function(m){return m.attr("maxLines")||1}),f=Math.min.apply(Math,ke([],q(h),!1)),g=function(){return Rd(r,t,d).length<1},v=WV(t),p=function(m){return r.forEach(function(w,M){var S=Array.isArray(m)?m[M]:m;n.wrap(w,a,S,v)})};if(!(f>o)){for(var y=f;y<=o;y++)if(p(y),g())return;l&&p(h)}}var YV=new Map([["hide",qV],["rotate",GV],["ellipsis",FV],["wrap",VV]]);function UV(r,e,t){return e.labelOverlap.length<1?!1:t==="hide"?!DW(r[0]):t==="rotate"?!r.some(function(n){var i;return!!(!((i=n.attr("transform"))===null||i===void 0)&&i.includes("rotate"))}):t==="ellipsis"||t==="wrap"?r.filter(function(n){return n.querySelector("text")}).length>1:!0}function HV(r,e,t){var n=e.labelOverlap,i=n===void 0?[]:n;i.length&&i.forEach(function(a){var s=a.type,o=YV.get(s);UV(r,e,s)&&(o==null||o(r,a,e,t))})}function XV(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=function(n){return n==="positive"?-1:1};return r.reduce(function(n,i){return n*t(i)},1)}function l_(r){for(var e=r;e<0;)e+=360;return Math.round(e%360)}function Wy(r,e){var t=q(r,2),n=t[0],i=t[1],a=q(e,2),s=a[0],o=a[1],u=q([n*s+i*o,n*o-i*s],2),l=u[0],c=u[1];return Math.atan2(c,l)}function KV(r){var e=(r+360)%180;return wn(e,-90,90)||(e+=180),e}function ZV(r,e,t){var n,i=t.labelAlign,a=(n=e.style.transform)===null||n===void 0?void 0:n.includes("rotate");if(a)return e.getLocalEulerAngles();var s=0,o=Su(r.value,t),u=Dd(r.value,t);return i==="horizontal"?0:(i==="perpendicular"?s=Wy([1,0],o):s=Wy([u[0]<0?-1:1,0],u),KV(xN(s)))}function VN(r,e,t){var n=t.type,i=t.labelAlign,a=Su(r,t),s=l_(e),o=l_(xN(Wy([1,0],a))),u="center",l="middle";return n==="linear"?[90,270].includes(o)&&s===0?(u="center",l=a[1]===1?"top":"bottom"):!(o%180)&&[90,270].includes(s)?u="center":o===0?(wn(s,0,90,!1,!0)||wn(s,0,90)||wn(s,270,360))&&(u="start"):o===90?wn(s,0,90,!1,!0)?u="start":(wn(s,90,180)||wn(s,270,360))&&(u="end"):o===270?wn(s,0,90,!1,!0)?u="end":(wn(s,90,180)||wn(s,270,360))&&(u="start"):o===180&&(s===90?u="start":(wn(s,0,90)||wn(s,270,360))&&(u="end")):i==="parallel"?wn(o,0,180,!0)?l="top":l="bottom":i==="horizontal"?wn(o,90,270,!1)?u="end":(wn(o,270,360,!1)||wn(o,0,90))&&(u="start"):i==="perpendicular"&&(wn(o,90,270)?u="end":u="start"),{textAlign:u,textBaseline:l}}function QV(r,e,t){e.setLocalEulerAngles(r);var n=e.__data__.value,i=VN(n,r,t),a=e.querySelector(st.labelItem.class);a&&YN(a,i)}function c_(r,e,t){var n=t.showTick,i=t.tickLength,a=t.tickDirection,s=t.labelDirection,o=t.labelSpacing,u=e.indexOf(r),l=Ar(o,[r,u,e]),c=q([Su(r.value,t),XV(s,a)],2),d=c[0],h=c[1],f=h===1?Ar(n?i:0,[r,u,e]):0,g=q(Eo(Mi(d,l+f),Id(r.value,t)),2),v=g[0],p=g[1];return{x:v,y:p}}function JV(r,e,t,n){var i=n.labelFormatter,a=Te(i)?function(){return Ci(Ar(i,[r,e,t,Su(r.value,n)]))}:function(){return Ci(r.label||"")};return a}function YN(r,e){r.nodeName==="text"&&r.attr(e)}function d_(r){HV(this.node().childNodes,r,{hide:Fr,show:Mu,rotate:function(e,t){QV(+t,e,r)},ellipsis:function(e,t,n){e&&Fy(e,t||1/0,n)},wrap:function(e,t,n){e&&jW(e,t,n)},getTextShape:function(e){return e.querySelector("text")}})}function h_(r,e,t,n,i){var a=t.indexOf(e),s=Oe(r).append(JV(e,a,t,i)).attr("className",st.labelItem.name).node(),o=q(Pi(FN(n,[e,a,t])),2),u=o[0],l=o[1],c=l.transform,d=Jt(l,["transform"]);AN(s,c);var h=ZV(e,s,i);return s.getLocalEulerAngles()||s.setLocalEulerAngles(h),YN(s,he(he({},VN(e.value,h,i)),u)),r.attr(d),s}function eY(r,e,t,n){var i=v1(e,t.labelFilter),a=Be(t,"label");return r.selectAll(st.label.class).data(i,function(s,o){return o}).join(function(s){return s.append("g").attr("className",st.label.name).transition(function(o){h_(this,o,e,a,t);var u=c_(o,e,t),l=u.x,c=u.y;return this.style.transform="translate(".concat(l,", ").concat(c,")"),null}).call(function(){d_.call(r,t)})},function(s){return s.transition(function(o){var u=this.querySelector(st.labelItem.class),l=h_(this,o,e,a,t),c=uV(u,l,n.update),d=c_(o,e,t),h=d.x,f=d.y,g=zr(this,{transform:"translate(".concat(h,", ").concat(f,")")},n.update);return ke(ke([],q(c),!1),[g],!1)}).call(function(o){var u=Fn(o,"_transitions").flat().filter(MN);sV(u,function(){d_.call(r,t)})})},function(s){return s.transition(function(){var o=this,u=Ld(this.childNodes[0],n.exit);return Qs(u,function(){return Oe(o).remove()}),u})}).transitions()}function UN(r,e){return y1(r,e.tickDirection,e)}function tY(r,e){var t=q(r,2),n=t[0],i=t[1];return[[0,0],[n*e,i*e]]}function nY(r,e,t,n,i){var a=i.tickLength,s=q(tY(n,Ar(a,[r,e,t])),2),o=q(s[0],2),u=o[0],l=o[1],c=q(s[1],2),d=c[0],h=c[1];return{x1:u,x2:d,y1:l,y2:h}}function rY(r,e,t,n,i){var a=i.tickFormatter,s=UN(e.value,i),o="line";return Te(a)&&(o=function(){return Ar(a,[e,t,n,s])}),r.append(o).attr("className",st.tickItem.name)}function iY(r,e,t,n,i,a,s){var o=UN(r.value,a),u=nY(r,e,t,o,a),l=u.x1,c=u.x2,d=u.y1,h=u.y2,f=q(Pi(FN(s,[r,e,t,o])),2),g=f[0],v=f[1];n.node().nodeName==="line"&&n.styles(he({x1:l,x2:c,y1:d,y2:h},g)),i.attr(v),n.styles(g)}function f_(r,e,t,n,i,a){var s=rY(Oe(this),r,e,t,n);iY(r,e,t,s,this,n,i);var o=q(Id(r.value,n),2),u=o[0],l=o[1];return zr(this,{transform:"translate(".concat(u,", ").concat(l,")")},a)}function aY(r,e,t,n){var i=v1(e,t.tickFilter),a=Be(t,"tick");return r.selectAll(st.tick.class).data(i,function(s){return s.id||s.label}).join(function(s){return s.append("g").attr("className",st.tick.name).transition(function(o,u){return f_.call(this,o,u,i,t,a,!1)})},function(s){return s.transition(function(o,u){return this.removeChildren(),f_.call(this,o,u,i,t,a,n.update)})},function(s){return s.transition(function(){var o=this,u=Ld(this.childNodes[0],n.exit);return Qs(u,function(){return o.remove()}),u})}).transitions()}var g_=Vr({text:"text"},"title");function jd(r){return/\S+-\S+/g.test(r)?r.split("-").map(function(e){return e[0]}):r.length>2?[r[0]]:r.split("")}function sY(r,e){var t=r.attributes,n=t.position,i=t.spacing,a=t.inset,s=t.text,o=r.getBBox(),u=e.getBBox(),l=jd(n),c=q(_n(s?i:0),4),d=c[0],h=c[1],f=c[2],g=c[3],v=q(_n(a),4),p=v[0],y=v[1],m=v[2],w=v[3],M=q([g+h,d+f],2),S=M[0],T=M[1],A=q([w+y,p+m],2),O=A[0],N=A[1];if(l[0]==="l")return new qn(o.x,o.y,u.width+o.width+S+O,Math.max(u.height+N,o.height));if(l[0]==="t")return new qn(o.x,o.y,Math.max(u.width+O,o.width),u.height+o.height+T+N);var C=q([e.attributes.width||u.width,e.attributes.height||u.height],2),P=C[0],D=C[1];return new qn(u.x,u.y,P+o.width+S+O,D+o.height+T+N)}function oY(r,e){var t=Object.entries(e).reduce(function(n,i){var a=q(i,2),s=a[0],o=a[1],u=r.node().attr(s);return u||(n[s]=o),n},{});r.styles(t)}function uY(r){var e,t,n,i,a=r,s=a.width,o=a.height,u=a.position,l=q([+s/2,+o/2],2),c=l[0],d=l[1],h=q([+c,+d,"center","middle"],4),f=h[0],g=h[1],v=h[2],p=h[3],y=jd(u);return y.includes("l")&&(e=q([0,"start"],2),f=e[0],v=e[1]),y.includes("r")&&(t=q([+s,"end"],2),f=t[0],v=t[1]),y.includes("t")&&(n=q([0,"top"],2),g=n[0],p=n[1]),y.includes("b")&&(i=q([+o,"bottom"],2),g=i[0],p=i[1]),{x:f,y:g,textAlign:v,textBaseline:p}}var lY=function(r){Ue(e,r);function e(t){return r.call(this,t,{text:"",width:0,height:0,fill:"#4a505a",fontWeight:"bold",fontSize:12,fontFamily:"sans-serif",inset:0,spacing:0,position:"top-left"})||this}return e.prototype.getAvailableSpace=function(){var t=this,n=this.attributes,i=n.width,a=n.height,s=n.position,o=n.spacing,u=n.inset,l=t.querySelector(g_.text.class);if(!l)return new qn(0,0,+i,+a);var c=l.getBBox(),d=c.width,h=c.height,f=q(_n(o),4),g=f[0],v=f[1],p=f[2],y=f[3],m=q([0,0,+i,+a],4),w=m[0],M=m[1],S=m[2],T=m[3],A=jd(s);if(A.includes("i"))return new qn(w,M,S,T);A.forEach(function(Y,$){var z,Z,ne,se;Y==="t"&&(z=q($===0?[h+p,+a-h-p]:[0,+a],2),M=z[0],T=z[1]),Y==="r"&&(Z=q([+i-d-y],1),S=Z[0]),Y==="b"&&(ne=q([+a-h-g],1),T=ne[0]),Y==="l"&&(se=q($===0?[d+v,+i-d-v]:[0,+i],2),w=se[0],S=se[1])});var O=q(_n(u),4),N=O[0],C=O[1],P=O[2],D=O[3],j=q([D+C,N+P],2),G=j[0],V=j[1];return new qn(w+D,M+N,S-G,T-V)},e.prototype.getBBox=function(){return this.title?this.title.getBBox():new qn(0,0,0,0)},e.prototype.render=function(t,n){var i=this;t.width,t.height,t.position,t.spacing;var a=Jt(t,["width","height","position","spacing"]),s=q(Pi(a),1),o=s[0],u=uY(t),l=u.x,c=u.y,d=u.textAlign,h=u.textBaseline;fr(!!a.text,Oe(n),function(f){i.title=f.maybeAppendByClassName(g_.text,"text").styles(o).call(oY,{x:l,y:c,textAlign:d,textBaseline:h}).node()})},e}($t);function cY(r,e,t){var n=t.titlePosition,i=n===void 0?"lb":n,a=t.titleSpacing,s=jd(i),o=r.node().getLocalBounds(),u=q(o.min,2),l=u[0],c=u[1],d=q(o.halfExtents,2),h=d[0],f=d[1],g=q(e.node().getLocalBounds().halfExtents,2),v=g[0],p=g[1],y=q([l+h,c+f],2),m=y[0],w=y[1],M=q(_n(a),4),S=M[0],T=M[1],A=M[2],O=M[3];if(["start","end"].includes(i)&&t.type==="linear"){var N=t.startPos,C=t.endPos,P=q(i==="start"?[N,C]:[C,N],2),D=P[0],j=P[1],G=ON([-j[0]+D[0],-j[1]+D[1]]),V=q(Mi(G,S),2),Y=V[0],$=V[1];return{x:D[0]+Y,y:D[1]+$}}return s.includes("t")&&(w-=f+p+S),s.includes("r")&&(m+=h+v+T),s.includes("l")&&(m-=h+v+O),s.includes("b")&&(w+=f+p+A),{x:m,y:w}}function dY(r,e,t){var n=r.getGeometryBounds().halfExtents,i=n[1]*2;if(e==="vertical"){if(t==="left")return"rotate(-90) translate(0, ".concat(i/2,")");if(t==="right")return"rotate(-90) translate(0, -".concat(i/2,")")}return""}function p_(r,e,t,n,i){var a=Be(n,"title"),s=q(Pi(a),2),o=s[0],u=s[1],l=u.transform,c=u.transformOrigin,d=Jt(u,["transform","transformOrigin"]);e.styles(d);var h=l||dY(r.node(),o.direction,o.position);r.styles(he(he({},o),{transformOrigin:c})),AN(r.node(),h);var f=cY(Oe(t._offscreen||t.querySelector(st.mainGroup.class)),e,n),g=f.x,v=f.y,p=zr(e.node(),{transform:"translate(".concat(g,", ").concat(v,")")},i);return p}function hY(r,e,t,n){var i=t.titleText;return r.selectAll(st.title.class).data([{title:i}].filter(function(a){return!!a.title}),function(a,s){return a.title}).join(function(a){return a.append(function(){return Ci(i)}).attr("className",st.title.name).transition(function(){return p_(Oe(this),r,e,t,n.enter)})},function(a){return a.transition(function(){return p_(Oe(this),r,e,t,n.update)})},function(a){return a.remove()}).transitions()}function v_(r,e,t,n){var i=r.showLine,a=r.showTick,s=r.showLabel,o=e.maybeAppendByClassName(st.lineGroup,"g"),u=fr(i,o,function(f){return TV(f,r,n)})||[],l=e.maybeAppendByClassName(st.tickGroup,"g"),c=fr(a,l,function(f){return aY(f,t,r,n)})||[],d=e.maybeAppendByClassName(st.labelGroup,"g"),h=fr(s,d,function(f){return eY(f,t,r,n)})||[];return ke(ke(ke([],q(u),!1),q(c),!1),q(h),!1).filter(function(f){return!!f})}var fY=function(r){Ue(e,r);function e(t){return r.call(this,t,p1)||this}return e.prototype.render=function(t,n,i){var a=this,s=t.titleText,o=t.data,u=t.animate,l=t.showTitle,c=t.showGrid,d=t.dataThreshold,h=t.truncRange,f=HW(o,d).filter(function(S){var T=S.value;return!(h&&T>h[0]&&T<h[1])}),g=s_(i===void 0?u:i),v=Oe(n).maybeAppendByClassName(st.gridGroup,"g"),p=fr(c,v,function(S){return NV(S,f,t,g)})||[],y=Oe(n).maybeAppendByClassName(st.mainGroup,"g");s&&(!this.initialized&&g.enter||this.initialized&&g.update)&&v_(t,Oe(this.offscreenGroup),f,s_(!1));var m=v_(t,Oe(y.node()),f,g),w=Oe(n).maybeAppendByClassName(st.titleGroup,"g"),M=fr(l,w,function(S){return hY(S,a,t,g)})||[];return ke(ke(ke([],q(p),!1),q(m),!1),q(M),!1).flat().filter(function(S){return!!S})},e}($t),Mr=Vr({prevBtnGroup:"prev-btn-group",prevBtn:"prev-btn",nextBtnGroup:"next-btn-group",nextBtn:"next-btn",pageInfoGroup:"page-info-group",pageInfo:"page-info",playWindow:"play-window",contentGroup:"content-group",controller:"controller",clipPath:"clip-path"},"navigator"),gY=function(r){Ue(e,r);function e(t){var n=r.call(this,t,{x:0,y:0,animate:{easing:"linear",duration:200,fill:"both"},buttonCursor:"pointer",buttonFill:"black",buttonD:S7(0,0,6),buttonSize:12,controllerPadding:5,controllerSpacing:5,formatter:function(i,a){return"".concat(i,"/").concat(a)},defaultPage:0,loop:!1,orientation:"horizontal",pageNumFill:"black",pageNumFontSize:12,pageNumTextAlign:"start",pageNumTextBaseline:"middle"})||this;return n.playState="idle",n.contentGroup=n.appendChild(new ln({class:Mr.contentGroup.name})),n.playWindow=n.contentGroup.appendChild(new ln({class:Mr.playWindow.name})),n.innerCurrPage=n.defaultPage,n}return Object.defineProperty(e.prototype,"defaultPage",{get:function(){var t=this.attributes.defaultPage;return jt(t,0,Math.max(this.pageViews.length-1,0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.playWindow.children},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controllerShape",{get:function(){return this.totalPages>1?{width:55,height:0}:{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageShape",{get:function(){var t=this.pageViews,n=q(a7(t.map(function(d){var h=d.getBBox(),f=h.width,g=h.height;return[f,g]})).map(function(d){return Math.max.apply(Math,ke([],q(d),!1))}),2),i=n[0],a=n[1],s=this.attributes,o=s.pageWidth,u=o===void 0?i:o,l=s.pageHeight,c=l===void 0?a:l;return{pageWidth:u,pageHeight:c}},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.playWindow},Object.defineProperty(e.prototype,"totalPages",{get:function(){return this.pageViews.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currPage",{get:function(){return this.innerCurrPage},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var t=r.prototype.getBBox.call(this),n=t.x,i=t.y,a=this.controllerShape,s=this.pageShape,o=s.pageWidth,u=s.pageHeight;return new qn(n,i,o+a.width,u)},e.prototype.goTo=function(t){var n=this,i=this.attributes.animate,a=this,s=a.currPage,o=a.playState,u=a.playWindow,l=a.pageViews;if(o!=="idle"||t<0||l.length<=0||t>=l.length)return null;l[s].setLocalPosition(0,0),this.prepareFollowingPage(t);var c=q(this.getFollowingPageDiff(t),2),d=c[0],h=c[1];this.playState="running";var f=DN(u,[{transform:"translate(0, 0)"},{transform:"translate(".concat(-d,", ").concat(-h,")")}],i);return Qs(f,function(){n.innerCurrPage=t,n.playState="idle",n.setVisiblePages([t]),n.updatePageInfo()}),f},e.prototype.prev=function(){var t=this.attributes.loop,n=this.pageViews.length,i=this.currPage;if(!t&&i<=0)return null;var a=t?(i-1+n)%n:jt(i-1,0,n);return this.goTo(a)},e.prototype.next=function(){var t=this.attributes.loop,n=this.pageViews.length,i=this.currPage;if(!t&&i>=n-1)return null;var a=t?(i+1)%n:jt(i+1,0,n);return this.goTo(a)},e.prototype.renderClipPath=function(t){var n=this.pageShape,i=n.pageWidth,a=n.pageHeight;if(!i||!a){this.contentGroup.style.clipPath=void 0;return}this.clipPath=t.maybeAppendByClassName(Mr.clipPath,"rect").styles({width:i,height:a}),this.contentGroup.attr("clipPath",this.clipPath.node())},e.prototype.setVisiblePages=function(t){this.playWindow.children.forEach(function(n,i){t.includes(i)?Mu(n):Fr(n)})},e.prototype.adjustControllerLayout=function(){var t=this,n=t.prevBtnGroup,i=t.nextBtnGroup,a=t.pageInfoGroup,s=this.attributes,o=s.orientation,u=s.controllerPadding,l=a.getBBox(),c=l.width;l.height;var d=q(o==="horizontal"?[-180,0]:[-90,90],2),h=d[0],f=d[1];n.setLocalEulerAngles(h),i.setLocalEulerAngles(f);var g=n.getBBox(),v=g.width,p=g.height,y=i.getBBox(),m=y.width,w=y.height,M=Math.max(v,c,m),S=o==="horizontal"?{offset:[[0,0],[v/2+u,0],[v+c+u*2,0]],textAlign:"start"}:{offset:[[M/2,-p-u],[M/2,0],[M/2,w+u]],textAlign:"center"},T=q(S.offset,3),A=q(T[0],2),O=A[0],N=A[1],C=q(T[1],2),P=C[0],D=C[1],j=q(T[2],2),G=j[0],V=j[1],Y=S.textAlign,$=a.querySelector("text");$&&($.style.textAlign=Y),n.setLocalPosition(O,N),a.setLocalPosition(P,D),i.setLocalPosition(G,V)},e.prototype.updatePageInfo=function(){var t,n=this,i=n.currPage,a=n.pageViews,s=n.attributes.formatter;a.length<2||((t=this.pageInfoGroup.querySelector(Mr.pageInfo.class))===null||t===void 0||t.attr("text",s(i+1,a.length)),this.adjustControllerLayout())},e.prototype.getFollowingPageDiff=function(t){var n=this.currPage;if(n===t)return[0,0];var i=this.attributes.orientation,a=this.pageShape,s=a.pageWidth,o=a.pageHeight,u=t<n?-1:1;return i==="horizontal"?[u*s,0]:[0,u*o]},e.prototype.prepareFollowingPage=function(t){var n=this,i=n.currPage,a=n.pageViews;if(this.setVisiblePages([t,i]),t!==i){var s=q(this.getFollowingPageDiff(t),2),o=s[0],u=s[1];a[t].setLocalPosition(o,u)}},e.prototype.renderController=function(t){var n=this,i=this.attributes.controllerSpacing,a=this.pageShape,s=a.pageWidth,o=a.pageHeight,u=this.pageViews.length>=2,l=t.maybeAppendByClassName(Mr.controller,"g");if(Pd(l.node(),u),!!u){var c=Be(this.attributes,"button"),d=Be(this.attributes,"pageNum"),h=q(Pi(c),2),f=h[0],g=h[1],v=f.size,p=Jt(f,["size"]),y=!l.select(Mr.prevBtnGroup.class).node(),m=l.maybeAppendByClassName(Mr.prevBtnGroup,"g").styles(g);this.prevBtnGroup=m.node();var w=m.maybeAppendByClassName(Mr.prevBtn,"path"),M=l.maybeAppendByClassName(Mr.nextBtnGroup,"g").styles(g);this.nextBtnGroup=M.node();var S=M.maybeAppendByClassName(Mr.nextBtn,"path");[w,S].forEach(function(A){A.styles(he(he({},p),{transformOrigin:"center"})),l1(A.node(),v)});var T=l.maybeAppendByClassName(Mr.pageInfoGroup,"g");this.pageInfoGroup=T.node(),T.maybeAppendByClassName(Mr.pageInfo,"text").styles(d),this.updatePageInfo(),l.node().setLocalPosition(s+i,o/2),y&&(this.prevBtnGroup.addEventListener("click",function(){n.prev()}),this.nextBtnGroup.addEventListener("click",function(){n.next()}))}},e.prototype.render=function(t,n){var i=t.x,a=i===void 0?0:i,s=t.y,o=s===void 0?0:s;this.attr("transform","translate(".concat(a,", ").concat(o,")"));var u=Oe(n);this.renderClipPath(u),this.renderController(u),this.setVisiblePages([this.defaultPage]),this.goTo(this.defaultPage)},e.prototype.bindEvents=function(){var t=this,n=su(function(){return t.render(t.attributes,t)},50);this.playWindow.addEventListener(He.INSERTED,n),this.playWindow.addEventListener(He.REMOVED,n)},e}($t);function pY(r,e,t){var n=1.4,i=n*t;return[["M",r-t,e-i],["L",r+t,e-i],["L",r+t,e+i],["L",r-t,e+i],["Z"]]}var HN=1.4,XN=.4;function vY(r,e,t){var n=t,i=n*HN,a=n/2,s=n/6,o=r+i*XN;return[["M",r,e],["L",o,e+a],["L",r+i,e+a],["L",r+i,e-a],["L",o,e-a],["Z"],["M",o,e+s],["L",r+i-2,e+s],["M",o,e-s],["L",r+i-2,e-s]]}function yY(r,e,t){var n=t,i=n*HN,a=n/2,s=n/6,o=e+i*XN;return[["M",r,e],["L",r-a,o],["L",r-a,e+i],["L",r+a,e+i],["L",r+a,o],["Z"],["M",r-s,o],["L",r-s,e+i-2],["M",r+s,o],["L",r+s,e+i-2]]}lt.registerSymbol("hiddenHandle",pY);lt.registerSymbol("verticalHandle",vY);lt.registerSymbol("horizontalHandle",yY);function Vy(r,e,t){return r===void 0&&(r="horizontal"),r==="horizontal"?e:t}var ar=Vr({layout:"flex",markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label",valueGroup:"value-group",value:"value",backgroundGroup:"background-group",background:"background"},"legend-category-item");function mY(r){var e=r.querySelector(ar.marker.class);return e?e.style:{}}var bY=function(r){Ue(e,r);function e(t){return r.call(this,t,{span:[1,1],marker:function(){return new Ii({style:{r:6}})},markerSize:10,labelFill:"#646464",valueFill:"#646464",labelFontSize:12,valueFontSize:12,labelTextBaseline:"middle",valueTextBaseline:"middle"})||this}return Object.defineProperty(e.prototype,"showValue",{get:function(){var t=this.attributes.valueText;return t?typeof t=="string"||typeof t=="number"?t!=="":typeof t=="function"?!0:t.attr("text")!=="":!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actualSpace",{get:function(){var t=this.labelGroup,n=this.valueGroup,i=this.attributes.markerSize,a=t.node().getBBox(),s=a.width,o=a.height,u=n.node().getBBox(),l=u.width,c=u.height;return{markerWidth:i,labelWidth:s,valueWidth:l,height:Math.max(i,o,c)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"span",{get:function(){var t=this.attributes.span;if(!t)return[1,1];var n=q(_n(t),2),i=n[0],a=n[1],s=this.showValue?a:0,o=i+s;return[i/o,s/o]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t,n=this.attributes,i=n.markerSize,a=n.width,s=this.actualSpace,o=s.markerWidth,u=s.height,l=this.actualSpace,c=l.labelWidth,d=l.valueWidth,h=q(this.spacing,2),f=h[0],g=h[1];if(a){var v=a-i-f-g,p=q(this.span,2),y=p[0],m=p[1];t=q([y*v,m*v],2),c=t[0],d=t[1]}var w=o+c+d+f+g;return{width:w,height:u,markerWidth:o,labelWidth:c,valueWidth:d}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spacing",{get:function(){var t=this.attributes.spacing;if(!t)return[0,0];var n=q(_n(t),2),i=n[0],a=n[1];return this.showValue?[i,a]:[i,0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layout",{get:function(){var t=this.shape,n=t.markerWidth,i=t.labelWidth,a=t.valueWidth,s=t.width,o=t.height,u=q(this.spacing,2),l=u[0],c=u[1];return{height:o,width:s,markerWidth:n,labelWidth:i,valueWidth:a,position:[n/2,n+l,n+i+l+c]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleSize",{get:function(){var t=mY(this.markerGroup.node()),n=this.attributes,i=n.markerSize,a=n.markerStrokeWidth,s=a===void 0?t.strokeWidth:a,o=n.markerLineWidth,u=o===void 0?t.lineWidth:o,l=n.markerStroke,c=l===void 0?t.stroke:l,d=+(s||u||(c?1:0))*Math.sqrt(2),h=this.markerGroup.node().getBBox(),f=h.width,g=h.height;return(1-d/Math.max(f,g))*i},enumerable:!1,configurable:!0}),e.prototype.renderMarker=function(t){var n=this,i=this.attributes.marker,a=Be(this.attributes,"marker");this.markerGroup=t.maybeAppendByClassName(ar.markerGroup,"g").style("zIndex",0),fr(!!i,this.markerGroup,function(){var s,o=n.markerGroup.node(),u=(s=o.childNodes)===null||s===void 0?void 0:s[0],l=typeof i=="string"?new lt({style:{symbol:i},className:ar.marker.name}):i();u?l.nodeName===u.nodeName?u instanceof lt?u.update(he(he({},a),{symbol:i})):(e7(u,l),Oe(u).styles(a)):(u.remove(),Oe(l).attr("className",ar.marker.name).styles(a),o.appendChild(l)):(l instanceof lt||Oe(l).attr("className",ar.marker.name).styles(a),o.appendChild(l)),n.markerGroup.node().scale(1/n.markerGroup.node().getScale()[0]);var c=l1(n.markerGroup.node(),n.scaleSize);n.markerGroup.node().style._transform="scale(".concat(c,")")})},e.prototype.renderLabel=function(t){var n=Be(this.attributes,"label"),i=n.text,a=Jt(n,["text"]);this.labelGroup=t.maybeAppendByClassName(ar.labelGroup,"g").style("zIndex",0),this.labelGroup.maybeAppendByClassName(ar.label,function(){return Ci(i)}).styles(a)},e.prototype.renderValue=function(t){var n=this,i=Be(this.attributes,"value"),a=i.text,s=Jt(i,["text"]);this.valueGroup=t.maybeAppendByClassName(ar.valueGroup,"g").style("zIndex",0),fr(this.showValue,this.valueGroup,function(){n.valueGroup.maybeAppendByClassName(ar.value,function(){return Ci(a)}).styles(s)})},e.prototype.renderBackground=function(t){var n=this.shape,i=n.width,a=n.height,s=Be(this.attributes,"background");this.background=t.maybeAppendByClassName(ar.backgroundGroup,"g").style("zIndex",-1),this.background.maybeAppendByClassName(ar.background,"rect").styles(he({width:i,height:a},s))},e.prototype.adjustLayout=function(){var t=this.layout,n=t.labelWidth,i=t.valueWidth,a=t.height,s=q(t.position,3),o=s[0],u=s[1],l=s[2],c=a/2;this.markerGroup.styles({transform:"translate(".concat(o,", ").concat(c,")").concat(this.markerGroup.node().style._transform)}),this.labelGroup.styles({transform:"translate(".concat(u,", ").concat(c,")")}),Fy(this.labelGroup.select(ar.label.class).node(),Math.ceil(n)),this.showValue&&(this.valueGroup.styles({transform:"translate(".concat(l,", ").concat(c,")")}),Fy(this.valueGroup.select(ar.value.class).node(),Math.ceil(i)))},e.prototype.render=function(t,n){var i=Oe(n),a=t.x,s=a===void 0?0:a,o=t.y,u=o===void 0?0:o;i.styles({transform:"translate(".concat(s,", ").concat(u,")")}),this.renderMarker(i),this.renderLabel(i),this.renderValue(i),this.renderBackground(i),this.adjustLayout()},e}($t),Oa=Vr({page:"item-page",navigator:"navigator",item:"item"},"items"),y_=function(r,e,t){return t===void 0&&(t=!0),r?e(r):t},wY=function(r){Ue(e,r);function e(t){var n=r.call(this,t,{data:[],gridRow:1/0,gridCol:void 0,padding:0,width:1e3,height:100,rowPadding:0,colPadding:0,layout:"flex",orientation:"horizontal",click:lh,mouseenter:lh,mouseleave:lh})||this;return n.navigatorShape=[0,0],n}return Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.navigator.getContainer()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grid",{get:function(){var t=this.attributes,n=t.gridRow,i=t.gridCol,a=t.data;if(!n&&!i)throw new Error("gridRow and gridCol can not be set null at the same time");return n&&i?[n,i]:n?[n,a.length]:[a.length,i]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderData",{get:function(){var t=this.attributes,n=t.data,i=t.layout,a=Be(this.attributes,"item"),s=n.map(function(o,u){var l=o.id,c=l===void 0?u:l,d=o.label,h=o.value;return{id:"".concat(c),index:u,style:he({layout:i,labelText:d,valueText:h},Object.fromEntries(Object.entries(a).map(function(f){var g=q(f,2),v=g[0],p=g[1];return[v,Ar(p,[o,u,n])]})))}});return s},enumerable:!1,configurable:!0}),e.prototype.getGridLayout=function(){var t=this,n=this.attributes,i=n.orientation,a=n.width,s=n.rowPadding,o=n.colPadding,u=q(this.navigatorShape,1),l=u[0],c=q(this.grid,2),d=c[0],h=c[1],f=h*d,g=0;return this.pageViews.children.map(function(v,p){var y,m,w=Math.floor(p/f),M=p%f,S=t.ifHorizontal(h,d),T=[Math.floor(M/S),M%S];i==="vertical"&&T.reverse();var A=q(T,2),O=A[0],N=A[1],C=(a-l-(h-1)*o)/h,P=v.getBBox().height,D=q([0,0],2),j=D[0],G=D[1];return i==="horizontal"?(y=q([g,O*(P+s)],2),j=y[0],G=y[1],g=N===h-1?0:g+C+o):(m=q([N*(C+o),g],2),j=m[0],G=m[1],g=O===d-1?0:g+P+s),{page:w,index:p,row:O,col:N,pageIndex:M,width:C,height:P,x:j,y:G}})},e.prototype.getFlexLayout=function(){var t=this.attributes,n=t.width,i=t.height,a=t.rowPadding,s=t.colPadding,o=q(this.navigatorShape,1),u=o[0],l=q(this.grid,2),c=l[0],d=l[1],h=q([n-u,i],2),f=h[0],g=h[1],v=q([0,0,0,0,0,0,0,0],8),p=v[0],y=v[1],m=v[2],w=v[3],M=v[4],S=v[5],T=v[6],A=v[7];return this.pageViews.children.map(function(O,N){var C,P,D,j,G=O.getBBox(),V=G.width,Y=G.height,$=T===0?0:s,z=T+$+V;if(z<=f&&y_(M,function(ne){return ne<d}))return C=q([T+$,A,z],3),p=C[0],y=C[1],T=C[2],{width:V,height:Y,x:p,y,page:m,index:N,pageIndex:w++,row:S,col:M++};P=q([S+1,0,0,A+Y+a],4),S=P[0],M=P[1],T=P[2],A=P[3];var Z=A+Y;return Z<=g&&y_(S,function(ne){return ne<c})?(D=q([T,A,V],3),p=D[0],y=D[1],T=D[2],{width:V,height:Y,x:p,y,page:m,index:N,pageIndex:w++,row:S,col:M++}):(j=q([0,0,V,0,m+1,0,0,0],8),p=j[0],y=j[1],T=j[2],A=j[3],m=j[4],w=j[5],S=j[6],M=j[7],{width:V,height:Y,x:p,y,page:m,index:N,pageIndex:w++,row:S,col:M++})})},Object.defineProperty(e.prototype,"itemsLayout",{get:function(){this.navigatorShape=[0,0];var t=this.attributes.layout==="grid"?this.getGridLayout:this.getFlexLayout,n=t.call(this);return n.slice(-1)[0].page>0?(this.navigatorShape=[55,0],t.call(this)):n},enumerable:!1,configurable:!0}),e.prototype.ifHorizontal=function(t,n){var i=this.attributes.orientation;return Vy(i,t,n)},e.prototype.flattenPage=function(t){t.querySelectorAll(Oa.item.class).forEach(function(n){t.appendChild(n)}),t.querySelectorAll(Oa.page.class).forEach(function(n){var i=t.removeChild(n);i.destroy()})},e.prototype.renderItems=function(t){var n=this.attributes,i=n.click,a=n.mouseenter,s=n.mouseleave;this.flattenPage(t);var o=this.dispatchCustomEvent.bind(this);Oe(t).selectAll(Oa.item.class).data(this.renderData,function(u){return u.id}).join(function(u){return u.append(function(l){var c=l.style;return new bY({style:c})}).attr("className",Oa.item.name).on("click",function(){i==null||i(this),o("itemClick",{item:this})}).on("pointerenter",function(){a==null||a(this),o("itemMouseenter",{item:this})}).on("pointerleave",function(){s==null||s(this),o("itemMouseleave",{item:this})})},function(u){return u.each(function(l){var c=l.style;this.update(c)})},function(u){return u.remove()})},e.prototype.relayoutNavigator=function(){var t,n=this.attributes,i=n.layout,a=n.width,s=((t=this.pageViews.children[0])===null||t===void 0?void 0:t.getBBox().height)||0,o=q(this.navigatorShape,2),u=o[0],l=o[1];this.navigator.update(i==="grid"?{pageWidth:a-u,pageHeight:s-l}:{})},e.prototype.adjustLayout=function(){var t=this,n=Object.entries(BW(this.itemsLayout,"page")).map(function(a){var s=q(a,2),o=s[0],u=s[1];return{page:o,layouts:u}}),i=ke([],q(this.navigator.getContainer().children),!1);n.forEach(function(a){var s=a.layouts,o=t.pageViews.appendChild(new ln({className:Oa.page.name}));s.forEach(function(u){var l=u.x,c=u.y,d=u.index,h=u.width,f=u.height,g=i[d];o.appendChild(g),jo(g,"__layout__",u),g.update({x:l,y:c,width:h,height:f})})}),this.relayoutNavigator()},e.prototype.renderNavigator=function(t){var n=this.attributes.orientation,i=Be(this.attributes,"nav"),a=vn({orientation:n},i),s=this;return t.selectAll(Oa.navigator.class).data(["nav"]).join(function(o){return o.append(function(){return new gY({style:a})}).attr("className",Oa.navigator.name).each(function(){s.navigator=this})},function(o){return o.each(function(){this.update(a)})},function(o){return o.remove()}),this.navigator},e.prototype.getBBox=function(){return this.navigator.getBBox()},e.prototype.render=function(t,n){var i=this.attributes.data;if(!(!i||i.length===0)){var a=this.renderNavigator(Oe(n));this.renderItems(a.getContainer()),this.adjustLayout()}},e.prototype.dispatchCustomEvent=function(t,n){var i=new Kt(t,{detail:n});this.dispatchEvent(i)},e}($t),uo=Vr({markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label"},"handle"),KN={showLabel:!0,formatter:function(r){return r.toString()},markerSize:25,markerStroke:"#c5c5c5",markerFill:"#fff",markerLineWidth:1,labelFontSize:12,labelFill:"#c5c5c5",labelText:"",orientation:"vertical",spacing:0};(function(r){Ue(e,r);function e(t){return r.call(this,t,KN)||this}return e.prototype.render=function(t,n){var i=Oe(n).maybeAppendByClassName(uo.markerGroup,"g");this.renderMarker(i);var a=Oe(n).maybeAppendByClassName(uo.labelGroup,"g");this.renderLabel(a)},e.prototype.renderMarker=function(t){var n=this,i=this.attributes,a=i.orientation,s=i.markerSymbol,o=s===void 0?Vy(a,"horizontalHandle","verticalHandle"):s;fr(!!o,t,function(u){var l=Be(n.attributes,"marker"),c=he({symbol:o},l);n.marker=u.maybeAppendByClassName(uo.marker,function(){return new lt({style:c})}).update(c)})},e.prototype.renderLabel=function(t){var n=this,i=this.attributes,a=i.showLabel,s=i.orientation,o=i.spacing,u=o===void 0?0:o,l=i.formatter;fr(a,t,function(c){var d,h=Be(n.attributes,"label"),f=h.text,g=Jt(h,["text"]),v=((d=c.select(uo.marker.class))===null||d===void 0?void 0:d.node().getBBox())||{},p=v.width,y=p===void 0?0:p,m=v.height,w=m===void 0?0:m,M=q(Vy(s,[0,w+u,"center","top"],[y+u,0,"start","middle"]),4),S=M[0],T=M[1],A=M[2],O=M[3];c.maybeAppendByClassName(uo.label,"text").styles(he(he({},g),{x:S,y:T,text:l(f).toString(),textAlign:A,textBaseline:O}))})},e})($t);var ZN={showTitle:!0,padding:0,orientation:"horizontal",backgroundFill:"transparent",titleText:"",titleSpacing:4,titlePosition:"top-left",titleFill:"#2C3542",titleFontWeight:"bold",titleFontFamily:"sans-serif",titleFontSize:12},xY=vn({},ZN,{});vn({},ZN,Ms(KN,"handle"),{color:["#d0e3fa","#acc7f6","#8daaf2","#6d8eea","#4d73cd","#325bb1","#5a3e75","#8c3c79","#e23455","#e7655b"],indicatorBackgroundFill:"#262626",indicatorLabelFill:"white",indicatorLabelFontSize:12,indicatorVisibility:"hidden",labelAlign:"value",labelDirection:"positive",labelSpacing:5,showHandle:!0,showIndicator:!0,showLabel:!0,slidable:!0,titleText:"",type:"continuous"});var lo=Vr({title:"title",titleGroup:"title-group",items:"items",itemsGroup:"items-group",contentGroup:"content-group",ribbonGroup:"ribbon-group",ribbon:"ribbon",handlesGroup:"handles-group",handle:"handle",startHandle:"start-handle",endHandle:"end-handle",labelGroup:"label-group",label:"label",indicator:"indicator"},"legend"),EY=function(r){Ue(e,r);function e(t){return r.call(this,t,xY)||this}return e.prototype.renderTitle=function(t,n,i){var a=this.attributes,s=a.showTitle,o=a.titleText,u=Be(this.attributes,"title"),l=q(Pi(u),2),c=l[0],d=l[1];this.titleGroup=t.maybeAppendByClassName(lo.titleGroup,"g").styles(d);var h=he(he({width:n,height:i},c),{text:s?o:""});this.title=this.titleGroup.maybeAppendByClassName(lo.title,function(){return new lY({style:h})}).update(h)},e.prototype.renderItems=function(t,n){var i=n.x,a=n.y,s=n.width,o=n.height,u=Be(this.attributes,"title",!0),l=q(Pi(u),2),c=l[0],d=l[1],h=he(he({},c),{width:s,height:o,x:0,y:0});this.itemsGroup=t.maybeAppendByClassName(lo.itemsGroup,"g").styles(he(he({},d),{transform:"translate(".concat(i,", ").concat(a,")")}));var f=this;this.itemsGroup.selectAll(lo.items.class).data(["items"]).join(function(g){return g.append(function(){return new wY({style:h})}).attr("className",lo.items.name).each(function(){f.items=Oe(this)})},function(g){return g.update(h)},function(g){return g.remove()})},e.prototype.adjustLayout=function(){var t=this.attributes.showTitle;if(t){var n=this.title.node().getAvailableSpace(),i=n.x,a=n.y;this.itemsGroup.node().style.transform="translate(".concat(i,", ").concat(a,")")}},Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes,n=t.showTitle,i=t.width,a=t.height;return n?this.title.node().getAvailableSpace():new qn(0,0,i,a)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var t,n,i=(t=this.title)===null||t===void 0?void 0:t.node(),a=(n=this.items)===null||n===void 0?void 0:n.node();return!i||!a?r.prototype.getBBox.call(this):sY(i,a)},e.prototype.render=function(t,n){var i=this.attributes,a=i.width,s=i.height,o=i.x,u=o===void 0?0:o,l=i.y,c=l===void 0?0:l,d=Oe(n);n.style.transform="translate(".concat(u,", ").concat(c,")"),this.renderTitle(d,a,s),this.renderItems(d,this.availableSpace),this.adjustLayout()},e}($t),MY={backgroundFill:"#262626",backgroundLineCap:"round",backgroundLineWidth:1,backgroundStroke:"#333",backgroundZIndex:-1,formatter:function(r){return r.toString()},labelFill:"#fff",labelFontSize:12,labelTextBaseline:"middle",padding:[2,4],position:"right",radius:0,zIndex:999},I0=Vr({background:"background",labelGroup:"label-group",label:"label"},"indicator"),SY=function(r){Ue(e,r);function e(t){var n=r.call(this,t,MY)||this;return n.point=[0,0],n.group=n.appendChild(new ln({})),n.isMutationObserved=!0,n}return e.prototype.renderBackground=function(){if(this.label){var t=this.attributes,n=t.position,i=t.padding,a=q(_n(i),4),s=a[0],o=a[1],u=a[2],l=a[3],c=this.label.node().getLocalBounds(),d=c.min,h=c.max,f=new qn(d[0]-l,d[1]-s,h[0]+o-d[0]+l,h[1]+u-d[1]+s),g=this.getPath(n,f),v=Be(this.attributes,"background");this.background=Oe(this.group).maybeAppendByClassName(I0.background,"path").styles(he(he({},v),{d:g})),this.group.appendChild(this.label.node())}},e.prototype.renderLabel=function(){var t=this.attributes,n=t.formatter,i=t.labelText,a=Be(this.attributes,"label"),s=q(Pi(a),2),o=s[0],u=s[1];o.text;var l=Jt(o,["text"]);if(this.label=Oe(this.group).maybeAppendByClassName(I0.labelGroup,"g").styles(u),!!i){var c=this.label.maybeAppendByClassName(I0.label,function(){return Ci(n(i))}).style("text",n(i).toString());c.selectAll("text").styles(l)}},e.prototype.adjustLayout=function(){var t=q(this.point,2),n=t[0],i=t[1],a=this.attributes,s=a.x,o=a.y;this.group.attr("transform","translate(".concat(s-n,", ").concat(o-i,")"))},e.prototype.getPath=function(t,n){var i=this.attributes.radius,a=n.x,s=n.y,o=n.width,u=n.height,l=[["M",a+i,s],["L",a+o-i,s],["A",i,i,0,0,1,a+o,s+i],["L",a+o,s+u-i],["A",i,i,0,0,1,a+o-i,s+u],["L",a+i,s+u],["A",i,i,0,0,1,a,s+u-i],["L",a,s+i],["A",i,i,0,0,1,a+i,s],["Z"]],c={top:4,right:6,bottom:0,left:2},d=c[t],h=this.createCorner([l[d].slice(-2),l[d+1].slice(-2)]);return l.splice.apply(l,ke([d+1,1],q(h),!1)),l[0][0]="M",l},e.prototype.createCorner=function(t,n){n===void 0&&(n=10);var i=.8,a=JW.apply(void 0,ke([],q(t),!1)),s=q(t,2),o=q(s[0],2),u=o[0],l=o[1],c=q(s[1],2),d=c[0],h=c[1],f=q(a?[d-u,[u,d]]:[h-l,[l,h]],2),g=f[0],v=q(f[1],2),p=v[0],y=v[1],m=g/2,w=g/Math.abs(g),M=n*w,S=M/2,T=M*Math.sqrt(3)/2*i,A=q([p,p+m-S,p+m,p+m+S,y],5),O=A[0],N=A[1],C=A[2],P=A[3],D=A[4];return a?(this.point=[C,l-T],[["L",O,l],["L",N,l],["L",C,l-T],["L",P,l],["L",D,l]]):(this.point=[u+T,C],[["L",u,O],["L",u,N],["L",u+T,C],["L",u,P],["L",u,D]])},e.prototype.applyVisibility=function(){var t=this.attributes.visibility;t==="hidden"?Fr(this):Mu(this)},e.prototype.bindEvents=function(){this.label.on(He.BOUNDS_CHANGED,this.renderBackground)},e.prototype.render=function(){this.renderLabel(),this.renderBackground(),this.adjustLayout(),this.applyVisibility()},e}($t);function Yy(r){return r===void 0&&(r=""),{CONTAINER:"".concat(r,"tooltip"),TITLE:"".concat(r,"tooltip-title"),LIST:"".concat(r,"tooltip-list"),LIST_ITEM:"".concat(r,"tooltip-list-item"),NAME:"".concat(r,"tooltip-list-item-name"),MARKER:"".concat(r,"tooltip-list-item-marker"),NAME_LABEL:"".concat(r,"tooltip-list-item-name-label"),VALUE:"".concat(r,"tooltip-list-item-value"),CROSSHAIR_X:"".concat(r,"tooltip-crosshair-x"),CROSSHAIR_Y:"".concat(r,"tooltip-crosshair-y")}}var m_={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"};function _Y(r){var e;r===void 0&&(r="");var t=Yy(r);return e={},e[".".concat(t.CONTAINER)]={position:"absolute",visibility:"visible","z-index":8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)","background-color":"rgba(255, 255, 255, 0.96)","box-shadow":"0 6px 12px 0 rgba(0, 0, 0, 0.12)","border-radius":"4px",color:"rgba(0, 0, 0, 0.65)","font-size":"12px","line-height":"20px",padding:"12px","min-width":"120px","max-width":"360px","font-family":"Roboto-Regular"},e[".".concat(t.TITLE)]={color:"rgba(0, 0, 0, 0.45)"},e[".".concat(t.LIST)]={margin:"0px","list-style-type":"none",padding:"0px"},e[".".concat(t.LIST_ITEM)]={"list-style-type":"none",display:"flex","line-height":"2em","align-items":"center","justify-content":"space-between","white-space":"nowrap"},e[".".concat(t.MARKER)]={width:"8px",height:"8px","border-radius":"50%",display:"inline-block","margin-right":"4px"},e[".".concat(t.NAME)]={display:"flex","align-items":"center","max-width":"216px"},e[".".concat(t.NAME_LABEL)]=he({flex:1},m_),e[".".concat(t.VALUE)]=he({display:"inline-block",float:"right",flex:1,"text-align":"right","min-width":"28px","margin-left":"30px",color:"rgba(0, 0, 0, 0.85)"},m_),e[".".concat(t.CROSSHAIR_X)]={position:"absolute",width:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e[".".concat(t.CROSSHAIR_Y)]={position:"absolute",height:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e}var TY=function(r){Ue(e,r);function e(t){var n=this,i,a,s=(a=(i=t.style)===null||i===void 0?void 0:i.template)===null||a===void 0?void 0:a.prefixCls,o=Yy(s);return n=r.call(this,t,{data:[],x:0,y:0,visibility:"visible",title:"",position:"bottom-right",offset:[5,5],enterable:!1,container:{x:0,y:0},bounding:null,template:{prefixCls:"",container:'<div class="'.concat(o.CONTAINER,'"></div>'),title:'<div class="'.concat(o.TITLE,'"></div>'),item:'<li class="'.concat(o.LIST_ITEM,`" data-index={index}>
        <span class="`).concat(o.NAME,`">
          <span class="`).concat(o.MARKER,`" style="background:{color}"></span>
          <span class="`).concat(o.NAME_LABEL,`" title="{name}">{name}</span>
        </span>
        <span class="`).concat(o.VALUE,`" title="{value}">{value}</span>
      </li>`)},style:_Y(s)})||this,n.timestamp=-1,n.prevCustomContentKey=n.attributes.contentKey,n.initShape(),n.render(n.attributes,n),n}return Object.defineProperty(e.prototype,"HTMLTooltipElement",{get:function(){return this.element},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.element},Object.defineProperty(e.prototype,"elementSize",{get:function(){var t=this.element.offsetWidth,n=this.element.offsetHeight;return{width:t,height:n}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HTMLTooltipItemsElements",{get:function(){var t=this.attributes,n=t.data,i=t.template;return n.map(function(a,s){var o=a.name,u=o===void 0?"":o,l=a.color,c=l===void 0?"black":l,d=a.index,h=Jt(a,["name","color","index"]),f=he({name:u,color:c,index:d??s},h);return J0(BL(i.item,f))})},enumerable:!1,configurable:!0}),e.prototype.render=function(t,n){this.renderHTMLTooltipElement(),this.updatePosition()},e.prototype.destroy=function(){var t;(t=this.element)===null||t===void 0||t.remove(),r.prototype.destroy.call(this)},e.prototype.show=function(t,n){var i=this;if(t!==void 0&&n!==void 0){var a=this.element.style.visibility==="hidden",s=function(){i.attributes.x=t??i.attributes.x,i.attributes.y=n??i.attributes.y,i.updatePosition()};a?this.closeTransition(s):s()}this.element.style.visibility="visible"},e.prototype.hide=function(t,n){t===void 0&&(t=0),n===void 0&&(n=0);var i=this.attributes.enterable;i&&this.isCursorEntered(t,n)||(this.element.style.visibility="hidden")},e.prototype.initShape=function(){var t=this.attributes.template;this.element=J0(t.container),this.id&&this.element.setAttribute("id",this.id)},e.prototype.renderCustomContent=function(){if(!(this.prevCustomContentKey!==void 0&&this.prevCustomContentKey===this.attributes.contentKey)){this.prevCustomContentKey=this.attributes.contentKey;var t=this.attributes.content;t&&(typeof t=="string"?this.element.innerHTML=t:qS(this.element,t))}},e.prototype.renderHTMLTooltipElement=function(){var t,n,i=this.attributes,a=i.template,s=i.title,o=i.enterable,u=i.style,l=i.content,c=Yy(a.prefixCls),d=this.element;if(this.element.style.pointerEvents=o?"auto":"none",l)this.renderCustomContent();else{s?(d.innerHTML=a.title,d.getElementsByClassName(c.TITLE)[0].innerHTML=s):(n=(t=d.getElementsByClassName(c.TITLE))===null||t===void 0?void 0:t[0])===null||n===void 0||n.remove();var h=this.HTMLTooltipItemsElements,f=document.createElement("ul");f.className=c.LIST,qS(f,h);var g=this.element.querySelector(".".concat(c.LIST));g?g.replaceWith(f):d.appendChild(f)}r7(d,u)},e.prototype.getRelativeOffsetFromCursor=function(t){var n=this.attributes,i=n.position,a=n.offset,s=t||i,o=s.split("-"),u={left:[-1,0],right:[1,0],top:[0,-1],bottom:[0,1]},l=this.elementSize,c=l.width,d=l.height,h=[-c/2,-d/2];return o.forEach(function(f){var g=q(h,2),v=g[0],p=g[1],y=q(u[f],2),m=y[0],w=y[1];h=[v+(c/2+a[0])*m,p+(d/2+a[1])*w]}),h},e.prototype.setOffsetPosition=function(t){var n=q(t,2),i=n[0],a=n[1],s=this.attributes,o=s.x,u=o===void 0?0:o,l=s.y,c=l===void 0?0:l,d=s.container,h=d.x,f=d.y;this.element.style.left="".concat(+u+h+i,"px"),this.element.style.top="".concat(+c+f+a,"px")},e.prototype.updatePosition=function(){var t=this.attributes.showDelay,n=t===void 0?60:t,i=Date.now();this.timestamp>0&&i-this.timestamp<n||(this.timestamp=i,this.setOffsetPosition(this.autoPosition(this.getRelativeOffsetFromCursor())))},e.prototype.autoPosition=function(t){var n=q(t,2),i=n[0],a=n[1],s=this.attributes,o=s.x,u=s.y,l=s.bounding,c=s.position;if(!l)return[i,a];var d=this.element,h=d.offsetWidth,f=d.offsetHeight,g=q([+o+i,+u+a],2),v=g[0],p=g[1],y={left:"right",right:"left",top:"bottom",bottom:"top"},m=l.x,w=l.y,M=l.width,S=l.height,T={left:v<m,right:v+h>m+M,top:p<w,bottom:p+f>w+S},A=[];c.split("-").forEach(function(N){T[N]?A.push(y[N]):A.push(N)});var O=A.join("-");return this.getRelativeOffsetFromCursor(O)},e.prototype.isCursorEntered=function(t,n){if(this.element){var i=this.element.getBoundingClientRect(),a=i.x,s=i.y,o=i.width,u=i.height;return new qn(a,s,o,u).isPointIn(t,n)}return!1},e.prototype.closeTransition=function(t){var n=this,i=this.element.style.transition;this.element.style.transition="none",t(),setTimeout(function(){n.element.style.transition=i},10)},e.tag="tooltip",e}($t),OY=function(r){Ue(e,r);function e(t){var n=r.call(this,vn({},e.defaultOptions,t))||this;return n.hoverColor="#f5f5f5",n.selectedColor="#e6f7ff",n.background=n.appendChild(new Sn({})),n.label=n.background.appendChild(new ln({})),n}return Object.defineProperty(e.prototype,"padding",{get:function(){return _n(this.style.padding)},enumerable:!1,configurable:!0}),e.prototype.renderLabel=function(){var t=this.style,n=t.label,i=t.value,a=Be(this.attributes,"label");Oe(this.label).maybeAppend(".label",function(){return Ci(n)}).attr("className","label").styles(a),this.label.attr("__data__",i)},e.prototype.renderBackground=function(){var t=this.label.getBBox(),n=q(this.padding,4),i=n[0],a=n[1],s=n[2],o=n[3],u=t.width,l=t.height,c=u+o+a,d=l+i+s,h=Be(this.attributes,"background"),f=this.style,g=f.width,v=g===void 0?0:g,p=f.height,y=p===void 0?0:p,m=f.selected;this.background.attr(he(he({},h),{width:Math.max(c,v),height:Math.max(d,y),fill:m?this.selectedColor:"#fff"})),this.label.attr({transform:"translate(".concat(o,", ").concat((d-l)/2,")")})},e.prototype.render=function(){this.renderLabel(),this.renderBackground()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("pointerenter",function(){t.style.selected||t.background.attr("fill",t.hoverColor)}),this.addEventListener("pointerleave",function(){t.style.selected||t.background.attr("fill",t.style.backgroundFill)});var n=this;this.addEventListener("click",function(){var i=t.style,a=i.label,s=i.value,o=i.onClick;o==null||o(s,{label:a,value:s},n)})},e.defaultOptions={style:{value:"",label:"",cursor:"pointer"}},e}($t),AY=function(r){Ue(e,r);function e(t){var n,i,a=r.call(this,vn({},e.defaultOptions,t))||this;a.currentValue=(n=e.defaultOptions.style)===null||n===void 0?void 0:n.defaultValue,a.isPointerInSelect=!1,a.select=a.appendChild(new Sn({className:"select",style:{cursor:"pointer",width:0,height:0}})),a.dropdown=a.appendChild(new Sn({className:"dropdown"}));var s=a.style.defaultValue;return s&&(!((i=a.style.options)===null||i===void 0)&&i.some(function(o){return o.value===s}))&&(a.currentValue=s),a}return e.prototype.setValue=function(t){this.currentValue=t,this.render()},e.prototype.getValue=function(){return this.currentValue},Object.defineProperty(e.prototype,"dropdownPadding",{get:function(){return _n(this.style.dropdownPadding)},enumerable:!1,configurable:!0}),e.prototype.renderSelect=function(){var t=this,n,i=this.style,a=i.x,s=i.y,o=i.width,u=i.height,l=i.bordered,c=i.showDropdownIcon,d=Be(this.attributes,"select"),h=Be(this.attributes,"placeholder");this.select.attr(he(he({x:a,y:s,width:o,height:u},d),{fill:"#fff",strokeWidth:l?1:0}));var f=this.dropdownPadding,g=10;c&&Oe(this.select).maybeAppend(".dropdown-icon","path").style("d","M-5,-3.5 L0,3.5 L5,-3.5").style("transform","translate(".concat(a+o-g-f[1]-f[3],", ").concat(s+u/2,")")).style("lineWidth",1).style("stroke",this.select.style.stroke);var v=(n=this.style.options)===null||n===void 0?void 0:n.find(function(w){return w.value===t.currentValue}),p=he({x:a+f[3]},h);Oe(this.select).selectAll(".placeholder").data(v?[]:[1]).join(function(w){return w.append("text").attr("className","placeholder").styles(p).style("y",function(){var M=this.getBBox();return s+(u-M.height)/2})},function(w){return w.styles(p)},function(w){return w.remove()});var y=Be(this.attributes,"optionLabel"),m=he({x:a+f[3]},y);Oe(this.select).selectAll(".value").data(v?[v]:[]).join(function(w){return w.append(function(M){return Ci(M.label)}).attr("className","value").styles(m).style("y",function(){var M=this.getBBox();return s+(u-M.height)/2})},function(w){return w.styles(m)},function(w){return w.remove()})},e.prototype.renderDropdown=function(){var t=this,n,i,a=this.style,s=a.x,o=a.y,u=a.width,l=a.height,c=a.options,d=a.onSelect,h=a.open,f=Be(this.attributes,"dropdown"),g=Be(this.attributes,"option"),v=this.dropdownPadding;Oe(this.dropdown).maybeAppend(".dropdown-container","g").attr("className","dropdown-container").selectAll(".dropdown-item").data(c,function(m){return m.value}).join(function(m){return m.append(function(w){return new OY({className:"dropdown-item",style:he(he(he({},w),g),{width:u-v[1]-v[3],selected:w.value===t.currentValue,onClick:function(M,S,T){t.setValue(M),d==null||d(M,S,T),t.dispatchEvent(new Kt("change",{detail:{value:M,option:S,item:T}})),Fr(t.dropdown)}})})}).each(function(w,M){var S,T=(S=this.parentNode)===null||S===void 0?void 0:S.children,A=T.reduce(function(O,N,C){return C<M&&(O+=N.getBBox().height),O},0);this.attr("transform","translate(".concat(v[3],", ").concat(v[0]+A,")"))})},function(m){return m.update(function(w){return{selected:w.value===t.currentValue}})},function(m){return m.remove()});var p=(i=(n=this.dropdown.getElementsByClassName("dropdown-container"))===null||n===void 0?void 0:n[0])===null||i===void 0?void 0:i.getBBox(),y=f.spacing;this.dropdown.attr(he({transform:"translate(".concat(s,", ").concat(o+l+y,")"),width:p.width+v[1]+v[3],height:p.height+v[0]+v[2]},f)),!h&&Fr(this.dropdown)},e.prototype.render=function(){this.renderSelect(),this.renderDropdown()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("click",function(n){n.stopPropagation()}),this.select.addEventListener("click",function(){t.dropdown.style.visibility==="visible"?Fr(t.dropdown):Mu(t.dropdown)}),this.addEventListener("pointerenter",function(){t.isPointerInSelect=!0}),this.addEventListener("pointerleave",function(){t.isPointerInSelect=!1}),document==null||document.addEventListener("click",function(){t.isPointerInSelect||Fr(t.dropdown)})},e.defaultOptions={style:{x:0,y:0,width:140,height:32,options:[],bordered:!0,defaultValue:"",selectRadius:8,selectStroke:"#d9d9d9",showDropdownIcon:!0,placeholderText:"请选择",placeholderFontSize:12,placeholderTextBaseline:"top",placeholderFill:"#c2c2c2",dropdownFill:"#fff",dropdownStroke:"#d9d9d9",dropdownRadius:8,dropdownShadowBlur:4,dropdownShadowColor:"rgba(0, 0, 0, 0.08)",dropdownPadding:8,dropdownSpacing:10,optionPadding:[8,12],optionFontSize:12,optionTextBaseline:"top",optionBackgroundFill:"#fff",optionBackgroundRadius:4,optionLabelFontSize:12,optionLabelTextBaseline:"top"}},e}($t),Yr=function(r){Ue(e,r);function e(t){var n=r.call(this,vn({},{style:{backgroundOpacity:e.backgroundOpacities.default}},e.defaultOptions,t))||this;return n.showBackground=!0,n.background=n.appendChild(new Sn({})),n.icon=n.appendChild(new ln({})),n}return Object.defineProperty(e.prototype,"label",{get:function(){return"BaseIcon"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return Math.log10(this.attributes.size)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return _n(this.attributes.size/5)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iconSize",{get:function(){var t=this.attributes.size,n=q(this.padding,4),i=n[0],a=n[1],s=n[2],o=n[3];return Math.max(t-Math.max(o+a,i+s),this.lineWidth*2+1)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.attributes,n=t.x,i=t.y,a=t.size,s=a/2,o=Be(this.attributes,"background");this.background.attr(he({x:n-s,y:i-s,width:a,height:a},o))},e.prototype.showIndicator=function(){if(this.label){var t=this.attributes.size,n=this.background.getBBox(),i=n.x,a=n.y;this.indicator.update({x:i+t/2,y:a-5,labelText:this.label,visibility:"visible"})}},e.prototype.hideIndicator=function(){this.indicator.update({visibility:"hidden"})},e.prototype.connectedCallback=function(){var t;r.prototype.connectedCallback.call(this);var n=this.attributes.size,i=this.background.getBBox(),a=i.x,s=i.y,o=(t=this.ownerDocument)===null||t===void 0?void 0:t.defaultView;o&&(this.indicator=o.appendChild(new SY({style:{x:a+n/2,y:s-n/2,visibility:"hidden",position:"top",radius:3,zIndex:100}})))},e.prototype.disconnectedCallback=function(){this.indicator.destroy()},e.prototype.render=function(){this.renderIcon(),this.showBackground&&this.renderBackground()},e.prototype.bindEvents=function(){var t=this,n=this.attributes.onClick;if(this.addEventListener("click",function(){n==null||n(t)}),this.showBackground){var i=function(){return t.background.attr({opacity:e.backgroundOpacities.default})},a=function(){return t.background.attr({opacity:e.backgroundOpacities.hover})},s=function(){return t.background.attr({opacity:e.backgroundOpacities.active})};this.addEventListener("pointerenter",function(){a(),t.showIndicator()}),this.addEventListener("pointerleave",function(){i(),t.hideIndicator()}),this.addEventListener("pointerdown",function(){s()}),this.addEventListener("pointerup",function(){i()})}},e.tag="IconBase",e.defaultOptions={style:{x:0,y:0,size:10,color:"#565758",backgroundRadius:4,backgroundFill:"#e2e2e2"}},e.backgroundOpacities={default:0,hover:.8,active:1},e}($t),Zo=function(r,e){return e===void 0&&(e="#565758"),new lr({style:{fill:e,d:"M ".concat(r,",").concat(r," L -").concat(r,",0 L ").concat(r,",-").concat(r," Z"),transformOrigin:"center"}})},kY=function(r){Ue(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.arcPath=function(t,n,i){var a=q([i,i],2),s=a[0],o=a[1],u=function(v){return[t+i*Math.cos(v),n+i*Math.sin(v)]},l=q(u(-5/4*Math.PI),2),c=l[0],d=l[1],h=q(u(1/4*Math.PI),2),f=h[0],g=h[1];return"M".concat(c,",").concat(d,",A").concat(s,",").concat(o,",0,1,1,").concat(f,",").concat(g)},Object.defineProperty(e.prototype,"label",{get:function(){return"重置"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,a=t.color,s=this.iconSize,o=this.lineWidth,u=o+.5;Oe(this.icon).maybeAppend(".reset","path").styles({stroke:a,lineWidth:o,d:this.arcPath(n,i,s/2-o),markerStart:Zo(u,a)})},e}(Yr),NY=function(r){Ue(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"快退"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,a=t.color,s=this.iconSize,o=s/2,u=s/2/Math.pow(3,.5),l=[[n,i],[n,i-u],[n-o,i],[n,i+u],[n,i],[n+o,i-u],[n+o,i+u],[n,i]];Oe(this.icon).maybeAppend(".backward","polygon").styles({points:l,fill:a})},e}(Yr),CY=function(r){Ue(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"快进"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,a=t.color,s=this.iconSize,o=s/2,u=s/2/Math.pow(3,.5),l=[[n,i],[n,i-u],[n+o,i],[n,i+u],[n,i],[n-o,i-u],[n-o,i+u],[n,i]];Oe(this.icon).maybeAppend(".forward","polygon").styles({points:l,fill:a})},e}(Yr),PY=function(r){Ue(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"播放"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,a=t.color,s=this.iconSize,o=s/3*Math.pow(3,.5)*.8,u=[[n+o,i],[n-o/2,i-s/2*.8],[n-o/2,i+s/2*.8],[n+o,i]];Oe(this.icon).maybeAppend(".play","polygon").styles({points:u,fill:a})},e}(Yr),LY=function(r){Ue(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"暂停"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,a=t.color,s=this.iconSize,o=s/3,u=[[n-o,i-s/2],[n-o,i+s/2],[n-o/2,i+s/2],[n-o/2,i-s/2],[n-o,i-s/2],[n+o/2,i-s/2],[n+o/2,i+s/2],[n+o,i+s/2],[n+o,i-s/2]];Oe(this.icon).maybeAppend(".pause","polygon").styles({points:u,fill:a})},e}(Yr),DY=function(r){Ue(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"范围时间"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,a=t.color,s=this,o=s.iconSize,u=s.lineWidth,l=u;Oe(this.icon).maybeAppend(".left-line","line").styles({x1:n-o/2,y1:i-o/2,x2:n-o/2,y2:i+o/2,stroke:a,lineWidth:u}),Oe(this.icon).maybeAppend(".right-line","line").styles({x1:n+o/2,y1:i-o/2,x2:n+o/2,y2:i+o/2,stroke:a,lineWidth:u}),Oe(this.icon).maybeAppend(".left-arrow","line").styles({x1:n,y1:i,x2:n-o/2+l*2,y2:i,stroke:a,lineWidth:u,markerEnd:Zo(u*2,a)}),Oe(this.icon).maybeAppend(".right-arrow","line").styles({x1:n,y1:i,x2:n+o/2-l*2,y2:i,stroke:a,lineWidth:u,markerEnd:Zo(u*2,a)})},e}(Yr),IY=function(r){Ue(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"单一时间"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,a=t.color,s=this,o=s.iconSize,u=s.lineWidth;Oe(this.icon).maybeAppend(".line","line").styles({x1:n,y1:i-o/2,x2:n,y2:i+o/2,stroke:a,lineWidth:u});var l=u;Oe(this.icon).maybeAppend(".left-arrow","line").styles({x1:n-o/2-l*2,y1:i,x2:n-l*2,y2:i,stroke:a,lineWidth:u,markerEnd:Zo(u*2,a)}),Oe(this.icon).maybeAppend(".right-arrow","line").styles({x1:n+o/2+l*2,y1:i,x2:n+l*2,y2:i,stroke:a,lineWidth:u,markerEnd:Zo(u*2,a)})},e}(Yr),QN=function(r){return[[-r/2,-r/2],[-r/2,r/2],[r/2,r/2]]},RY=function(r){Ue(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"折线图"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,a=t.color,s=this,o=s.iconSize,u=s.lineWidth,l=u,c=(o-l*2-u)/4,d=(o-l*2-u)/2,h=q([n-o/2+l,i+o/2-l*2],2),f=h[0],g=h[1];Oe(this.icon).maybeAppend(".coordinate","polyline").styles({points:QN(o).map(function(v){var p=q(v,2),y=p[0],m=p[1];return[y+n,m+i]}),stroke:a,lineWidth:u}),Oe(this.icon).maybeAppend(".line","polyline").styles({points:[[f,g],[f+c,g-d],[f+c*2,g],[f+c*4,g-d*2]],stroke:a,lineWidth:u})},e}(Yr),jY=function(r){Ue(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"条形图"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return[1,4,2,4,3]},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.data,n=this.attributes,i=n.x,a=n.y,s=n.color,o=this,u=o.iconSize,l=o.lineWidth,c=l,d=(u-c)/t.length,h=(u-c*2)/4,f=q([i-u/2+c*2,a+u/2-c],2),g=f[0],v=f[1];Oe(this.icon).maybeAppend(".coordinate","polyline").styles({points:QN(u).map(function(p){var y=q(p,2),m=y[0],w=y[1];return[m+i,w+a]}),stroke:s,lineWidth:l}),Oe(this.icon).maybeAppend(".bars","g").selectAll(".column").data(this.data.map(function(p,y){return{value:p,index:y}})).join(function(p){return p.append("line").attr("className","column").style("x1",function(y){var m=y.index;return g+d*m}).style("y1",v).style("x2",function(y){var m=y.index;return g+d*m}).style("y2",function(y){var m=y.value;return v-h*m}).styles({y1:v,stroke:s,lineWidth:l})})},e}(Yr),BY=function(r){Ue(e,r);function e(t){var n=r.call(this,vn({},{style:{color:"#d8d9d9"}},t))||this;return n.showBackground=!1,n}return e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,a=t.color,s=this,o=s.iconSize,u=s.lineWidth;Oe(this.icon).maybeAppend(".split","line").styles({x1:n,y1:i-o/2,x2:n,y2:i+o/2,stroke:a,lineWidth:u})},e}(Yr),Uy=function(r){Ue(e,r);function e(){var t=r.apply(this,ke([],q(arguments),!1))||this;return t.showBackground=!1,t}return Object.defineProperty(e.prototype,"padding",{get:function(){return _n(0)},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.iconSize,n=this.attributes,i=n.x,a=n.y,s=n.speed,o=s===void 0?1:s,u=om(this.attributes,["x","y","transform","transformOrigin","width","height","size","color","speed"]),l=jt(t,20,1/0),c=20,d=he(he({},u),{x:i-l/2,y:a-c/2,width:l,height:c,defaultValue:o,bordered:!1,showDropdownIcon:!1,selectRadius:2,dropdownPadding:this.padding,dropdownRadius:2,dropdownSpacing:t/5,placeholderFontSize:t/2,optionPadding:0,optionLabelFontSize:t/2,optionBackgroundRadius:1,options:[{label:"1x",value:1},{label:"1.5x",value:1.5},{label:"2x",value:2}]});Oe(this.icon).maybeAppend(".speed",function(){return new AY({style:d})}).attr("className","speed").each(function(){this.update(d)})},e.tag="SpeedSelect",e}(Yr),m1=function(r){Ue(e,r);function e(t){var n=r.call(this,t)||this;return n.icon=n.appendChild(new ln({})),n.currentType=n.attributes.type,n}return e.prototype.getType=function(){return this.currentType},e.prototype.render=function(){var t=this,n=this.attributes;n.onChange;var i=Jt(n,["onChange"]);Oe(this.icon).selectAll(".icon").data([this.currentType]).join(function(a){return a.append(function(s){var o,u=(o=t.toggles.find(function(l){var c=q(l,1),d=c[0];return d===s}))===null||o===void 0?void 0:o[1];if(!u)throw new Error("Invalid type: ".concat(s));return new u({})}).attr("className","icon").styles(i,!1).update({})},function(a){return a.styles({restStyles:i}).update({})},function(a){return a.remove()})},e.prototype.bindEvents=function(){var t=this,n=this.attributes.onChange;this.addEventListener("click",function(i){i.preventDefault(),i.stopPropagation();var a=(t.toggles.findIndex(function(o){var u=q(o,1),l=u[0];return l===t.currentType})+1)%t.toggles.length,s=t.toggles[a][0];n==null||n(t.currentType),t.currentType=s,t.render()})},e.tag="ToggleIcon",e}($t),Hy=function(r){Ue(e,r);function e(t){var n=r.call(this,vn({},{style:{type:"play"}},t))||this;return n.toggles=[["play",PY],["pause",LY]],n}return e}(m1),Xy=function(r){Ue(e,r);function e(t){var n=r.call(this,vn({},{style:{type:"range"}},t))||this;return n.toggles=[["range",DY],["value",IY]],n}return e}(m1),Ky=function(r){Ue(e,r);function e(t){var n=r.call(this,vn({},{style:{type:"column"}},t))||this;return n.toggles=[["line",RY],["column",jY]],n}return e}(m1),FY={reset:kY,speed:Uy,backward:NY,playPause:Hy,forward:CY,selectionType:Xy,chartType:Ky,split:BY},zY=function(r){Ue(e,r);function e(t){var n=r.call(this,vn({},e.defaultOptions,t))||this;return n.background=n.appendChild(new Sn({})),n.functions=n.appendChild(new ln({})),n}return Object.defineProperty(e.prototype,"padding",{get:function(){return _n(this.attributes.padding)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.style,n=t.x,i=t.y,a=t.width,s=t.height,o=Be(this.attributes,"background");this.background.attr(he({x:n,y:i,width:a,height:s},o))},e.prototype.renderFunctions=function(){var t=this,n,i=this.attributes,a=i.functions,s=i.iconSize,o=i.iconSpacing,u=i.x,l=i.y,c=i.width,d=i.height,h=i.align,f=q(this.padding,4),g=f[1],v=f[3],p=a.reduce(function(w,M){return w.length&&M.length?w.concat.apply(w,ke(["split"],q(M),!1)):w.concat.apply(w,ke([],q(M),!1))},[]),y=p.length*(s+o)-o,m={left:v+s/2,center:(c-y)/2+s/2,right:c-y-v-g+s/2}[h]||0;(n=this.speedSelect)===null||n===void 0||n.destroy(),this.functions.removeChildren(),p.forEach(function(w,M){var S,T=FY[w],A={x:u+M*(s+o)+m,y:l+d/2,size:s};if(T===Uy?(A.speed=t.attributes.speed,A.onSelect=function(N){return t.handleFunctionChange(w,{value:N})}):[Hy,Xy,Ky].includes(T)?(A.onChange=function(N){return t.handleFunctionChange(w,{value:N})},T===Hy&&(A.type=t.attributes.state==="play"?"pause":"play"),T===Xy&&(A.type=t.attributes.selectionType==="range"?"value":"range"),T===Ky&&(A.type=t.attributes.chartType==="line"?"column":"line")):A.onClick=function(){return t.handleFunctionChange(w,{value:w})},T===Uy){var O=(S=t.ownerDocument)===null||S===void 0?void 0:S.defaultView;O&&(t.speedSelect=new T({style:he(he({},A),{zIndex:100})}),O.appendChild(t.speedSelect))}else t.functions.appendChild(new T({style:A}))})},e.prototype.disconnectedCallback=function(){var t;r.prototype.disconnectedCallback.call(this),(t=this.speedSelect)===null||t===void 0||t.destroy()},e.prototype.render=function(){this.renderBackground(),this.renderFunctions()},e.prototype.handleFunctionChange=function(t,n){var i=this.attributes.onChange;i==null||i(t,n)},e.defaultOptions={style:{x:0,y:0,width:300,height:40,padding:0,align:"center",iconSize:25,iconSpacing:0,speed:1,state:"pause",chartType:"line",selectionType:"range",backgroundFill:"#fbfdff",backgroundStroke:"#ebedf0",functions:[["reset","speed"],["backward","playPause","forward"],["selectionType","chartType"]]}},e}($t),$Y=function(r){Ue(e,r);function e(t){var n=r.call(this,vn({},e.defaultOptions,t))||this;return n.bindEvents(),n}return e.prototype.bindEvents=function(){var t=this;this.addEventListener("mouseenter",function(){t.attr("lineWidth",Math.ceil(+(t.style.r||0)/2))}),this.addEventListener("mouseleave",function(){t.attr("lineWidth",0)})},e.defaultOptions={style:{r:5,fill:"#3f7cf7",lineWidth:0,stroke:"#3f7cf7",strokeOpacity:.5,cursor:"pointer"}},e}(Ii),qY=function(r){Ue(e,r);function e(t){return r.call(this,vn({},e.defaultOptions,t))||this}return e.prototype.renderBackground=function(){var t=this.attributes,n=t.x,i=t.y,a=t.width,s=t.height,o=Be(this.attributes,"background");Oe(this).maybeAppend("background","rect").attr("className","background").styles(he({x:n-a/2,y:i-s/2,width:a,height:s},o))},e.prototype.renderIcon=function(){var t=this.attributes,n=t.x,i=t.y,a=t.iconSize,s=Be(this.attributes,"icon"),o=1,u=a/2;Oe(this).maybeAppend("icon-left-line","line").attr("className","icon-left-line").styles(he({x1:n-o,y1:i-u,x2:n-o,y2:i+u},s)),Oe(this).maybeAppend("icon-right-line","line").attr("className","icon-right-line").styles(he({x1:n+o,y1:i-u,x2:n+o,y2:i+u},s))},e.prototype.renderBorder=function(){var t=this.attributes,n=t.x,i=t.y,a=t.width,s=t.height,o=t.type,u=Be(this.attributes,"border"),l=o==="start"?+a/2:-a/2;Oe(this).maybeAppend("border","line").attr("className","border").styles(he({x1:l+n,y1:i-s/2,x2:l+n,y2:i+s/2},u))},e.prototype.render=function(){this.renderBackground(),this.renderIcon(),this.renderBorder()},e.defaultOptions={style:{x:0,y:0,width:10,height:50,iconSize:10,type:"start",backgroundFill:"#fff",backgroundFillOpacity:.5,iconStroke:"#9a9a9a",iconLineWidth:1,borderStroke:"#e8e8e8",borderLineWidth:1}},e}($t);function GY(r,e){return typeof r=="number"?JN(r):WY(r,e)}function WY(r,e){var t=new Date(r);switch(e){case"half-hour":case"hour":case"four-hour":return[0,6,12,18].includes(t.getHours())&&t.getMinutes()===0?Hn(t,`HH:mm
YYYY-MM-DD`):Hn(t,"HH:mm");case"half-day":return t.getHours()<12?`AM
`.concat(Hn(t,"YYYY-MM-DD")):"PM";case"day":return[1,10,20].includes(t.getDate())?Hn(t,`DD
YYYY-MM`):Hn(t,"DD");case"week":return t.getDate()<=7?Hn(t,`DD
YYYY-MM`):Hn(t,"DD");case"month":return[0,6].includes(t.getMonth())?Hn(t,`MM月
YYYY`):Hn(t,"MM月");case"season":return[0].includes(t.getMonth())?Hn(t,`MM月
YYYY`):Hn(t,"MM月");case"year":return Hn(t,"YYYY");default:return Hn(t,"YYYY-MM-DD HH:mm")}}function JN(r){var e=String(Math.floor(r/3600)).padStart(2,"0"),t=String(Math.floor(r%3600/60)).padStart(2,"0"),n=String(Math.floor(r%60)).padStart(2,"0");return r<3600?"".concat(t,":").concat(n):"".concat(e,":").concat(t,":").concat(n)}var VY=function(r){Ue(e,r);function e(t){var n=r.call(this,vn({},e.defaultOptions,t))||this;n.axis=n.appendChild(new fY({style:{type:"linear",startPos:[0,0],endPos:[0,0],data:[],showArrow:!1,animate:!1}})),n.timeline=n.appendChild(new dV({style:{onChange:function(d){n.handleSliderChange(d)}}})),n.controller=n.appendChild(new zY({})),n.states={},n.handleSliderChange=function(d){var h=function(){var f=n.states.values;return Array.isArray(f)?ke([],q(f),!1):f}();n.setBySliderValues(d),n.dispatchOnChange(h)};var i=n.attributes,a=i.selectionType,s=i.chartType,o=i.speed,u=i.state,l=i.playMode,c=i.values;return n.states={chartType:s,playMode:l,selectionType:a,speed:o,state:u},n.setByTimebarValues(c),n}return Object.defineProperty(e.prototype,"data",{get:function(){var t=this.attributes.data,n=function(i,a){return i.time<a.time?-1:i.time>a.time?1:0};return t.sort(n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){var t=this.attributes,n=t.x,i=t.y,a=t.width,s=t.height,o=t.type,u=t.controllerHeight,l=jt(+s-u,0,+s),c=new qn(n,i+ +s-u,+a,u),d,h=0;o==="chart"?(h=35,d=new qn(n,i+l-h,+a,h)):d=new qn;var f=o==="time"?10:l,g=new qn(n,i+(o==="time"?l:l-f),+a,f-h);return{axisBBox:d,controllerBBox:c,timelineBBox:g}},enumerable:!1,configurable:!0}),e.prototype.setBySliderValues=function(t){var n,i,a=this.data,s=q(Array.isArray(t)?t:[0,t],2),o=s[0],u=s[1],l=a.length,c=a[Math.floor(o*l)],d=a[Math.ceil(u*l)-(Array.isArray(t)?0:1)];this.states.values=[(n=c==null?void 0:c.time)!==null&&n!==void 0?n:a[0].time,(i=d==null?void 0:d.time)!==null&&i!==void 0?i:1/0]},e.prototype.setByTimebarValues=function(t){var n,i,a,s=this.data,o=q(Array.isArray(t)?t:[void 0,t],2),u=o[0],l=o[1],c=s.find(function(h){var f=h.time;return f===u}),d=s.find(function(h){var f=h.time;return f===l});this.states.values=[(n=c==null?void 0:c.time)!==null&&n!==void 0?n:(i=s[0])===null||i===void 0?void 0:i.time,(a=d==null?void 0:d.time)!==null&&a!==void 0?a:1/0]},e.prototype.setByIndex=function(t){var n,i,a,s,o=this.data,u=q(t,2),l=u[0],c=u[1];this.states.values=[(i=(n=o[l])===null||n===void 0?void 0:n.time)!==null&&i!==void 0?i:o[0].time,(s=(a=this.data[c])===null||a===void 0?void 0:a.time)!==null&&s!==void 0?s:1/0]},Object.defineProperty(e.prototype,"sliderValues",{get:function(){var t=this.states,n=t.values,i=t.selectionType,a=q(Array.isArray(n)?n:[void 0,n],2),s=a[0],o=a[1],u=this.data,l=u.length,c=i==="value",d=function(){var f=u.findIndex(function(g){var v=g.time;return v===s});return c?0:f>-1?f/l:0},h=function(){if(o===1/0)return 1;var f=u.findIndex(function(g){var v=g.time;return v===o});return f>-1?f/l:c?.5:1};return[d(),h()]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){var t=this.states,n=t.values,i=t.selectionType,a=q(Array.isArray(n)?n:[this.data[0].time,n],2),s=a[0],o=a[1];return i==="value"?o:[s,o]},enumerable:!1,configurable:!0}),e.prototype.getDatumByRatio=function(t){var n=this.data,i=n.length,a=Math.floor(t*(i-1));return n[a]},Object.defineProperty(e.prototype,"chartHandleIconShape",{get:function(){var t=this.states.selectionType,n=this.space.timelineBBox.height;return t==="range"?function(i){return new qY({style:{type:i,height:n,iconSize:n/6}})}:function(){return new Wa({style:{x1:0,y1:-n/2,x2:0,y2:n/2,lineWidth:2,stroke:"#c8c8c8"}})}},enumerable:!1,configurable:!0}),e.prototype.getChartStyle=function(t){var n=this,i=t.x,a=t.y,s=t.width,o=t.height,u=this.states,l=u.selectionType,c=u.chartType,d=this.data,h=this.attributes,f=h.type,g=h.labelFormatter,v=Be(this.attributes,"chart");v.type;var p=Jt(v,["type"]),y=l==="range";if(f==="time")return he({handleIconShape:function(){return new $Y({})},selectionFill:"#2e7ff8",selectionFillOpacity:1,showLabelOnInteraction:!0,handleLabelDy:y?-15:0,autoFitLabel:y,handleSpacing:y?-15:0,trackFill:"#edeeef",trackLength:s,trackOpacity:.5,trackRadius:o/2,trackSize:o/2,type:l,values:this.sliderValues,formatter:function(M){if(g)return g(M);var S=n.getDatumByRatio(M).time;return typeof S=="number"?JN(S):Hn(S,"YYYY-MM-DD HH:mm:ss")},transform:"translate(".concat(i,", ").concat(a,")"),zIndex:1},p);var m=l==="range"?5:0,w=d.map(function(M){var S=M.value;return S});return he({handleIconOffset:m,handleIconShape:this.chartHandleIconShape,selectionFill:"#fff",selectionFillOpacity:.5,selectionType:"invert",sparklineSpacing:.1,sparklineColumnLineWidth:0,sparklineColor:"#d4e5fd",sparklineAreaOpacity:1,sparklineAreaLineWidth:0,sparklineData:w,sparklineType:c,sparklineScale:.8,trackLength:s,trackSize:o,type:l,values:this.sliderValues,transform:"translate(".concat(i,", ").concat(a,")"),zIndex:1},p)},e.prototype.renderChart=function(t){t===void 0&&(t=this.space.timelineBBox),this.timeline.update(this.getChartStyle(t))},e.prototype.updateSelection=function(){this.timeline.setValues(this.sliderValues,!0),this.handleSliderChange(this.sliderValues)},e.prototype.getAxisStyle=function(t){var n=this.data,i=this.attributes,a=i.interval,s=i.labelFormatter,o=Be(this.attributes,"axis"),u=t.x,l=t.y,c=t.width,d=ke(ke([],q(n),!1),[{time:0}],!1).map(function(f,g,v){var p=f.time;return{label:"".concat(p),value:g/(v.length-1),time:p}}),h=he({startPos:[u,l],endPos:[u+c,l],data:d,labelFilter:function(f,g){return g<d.length-1},labelFormatter:function(f){var g=f.time;return s?s(g):GY(g,a)}},o);return h},e.prototype.renderAxis=function(t){t===void 0&&(t=this.space.axisBBox);var n=this.attributes.type;n==="chart"&&this.axis.update(this.getAxisStyle(t))},e.prototype.renderController=function(t){t===void 0&&(t=this.space.controllerBBox);var n=this.attributes.type,i=this.states,a=i.state,s=i.speed,o=i.selectionType,u=i.chartType,l=Be(this.attributes,"controller"),c=this,d=he(he(he({},t),{iconSize:20,speed:s,state:a,selectionType:o,chartType:u,onChange:function(h,f){var g=f.value;switch(h){case"reset":c.internalReset();break;case"speed":c.handleSpeedChange(g);break;case"backward":c.internalBackward();break;case"playPause":g==="play"?c.internalPlay():c.internalPause();break;case"forward":c.internalForward();break;case"selectionType":c.handleSelectionTypeChange(g);break;case"chartType":c.handleChartTypeChange(g);break}}}),l);n==="time"&&(d.functions=[["reset","speed"],["backward","playPause","forward"],["selectionType"]]),this.controller.update(d)},e.prototype.dispatchOnChange=function(t){var n=this.data,i=this.attributes.onChange,a=this.states,s=a.values,o=a.selectionType,u=q(s,2),l=u[0],c=u[1],d=c===1/0?n.at(-1).time:c,h=o==="range"?[l,d]:d,f=function(g,v){return Array.isArray(g)?Array.isArray(v)?g[0]===v[0]&&(g[1]===v[1]||g[1]===1/0||v[1]===1/0):!1:Array.isArray(v)?!1:g===v};(!t||!f(t,h))&&(i==null||i(o==="range"?[l,d]:d))},e.prototype.internalReset=function(t){var n,i,a=this.states.selectionType;this.internalPause(),this.setBySliderValues(a==="range"?[0,1]:[0,0]),this.renderController(),this.updateSelection(),t||((i=(n=this.attributes)===null||n===void 0?void 0:n.onReset)===null||i===void 0||i.call(n),this.dispatchOnChange())},e.prototype.reset=function(){this.internalReset()},e.prototype.moveSelection=function(t,n){var i=this.data,a=i.length,s=this.states,o=s.values,u=s.selectionType,l=s.playMode,c=q(o,2),d=c[0],h=c[1],f=i.findIndex(function(w){var M=w.time;return M===d}),g=i.findIndex(function(w){var M=w.time;return M===h});g===-1&&(g=a);var v=t==="backward"?-1:1,p;u==="range"?l==="acc"?(p=[f,g+v],v===-1&&f===g&&(p=[f,a])):p=[f+v,g+v]:p=[f,g+v];var y=function(w){var M=q(w.sort(function(O,N){return O-N}),2),S=M[0],T=M[1],A=function(O){return jt(O,0,a)};return T>a?u==="value"?[0,0]:l==="acc"?[A(S),A(S)]:[0,A(T-S)]:S<0?l==="acc"?[0,A(T)]:[A(S+a-T),a]:[A(S),A(T)]},m=y(p);return this.setByIndex(m),this.updateSelection(),m},e.prototype.internalBackward=function(t){var n,i,a=this.moveSelection("backward",t);return t||((i=(n=this.attributes)===null||n===void 0?void 0:n.onBackward)===null||i===void 0||i.call(n),this.dispatchOnChange()),a},e.prototype.backward=function(){this.internalBackward()},e.prototype.internalPlay=function(t){var n=this,i,a,s=this.data,o=this.attributes.loop,u=this.states.speed,l=u===void 0?1:u;this.playInterval=window.setInterval(function(){var c=n.internalForward();c[1]===s.length&&!o&&(n.internalPause(),n.renderController())},1e3/l),this.states.state="play",!t&&((a=(i=this.attributes)===null||i===void 0?void 0:i.onPlay)===null||a===void 0||a.call(i))},e.prototype.play=function(){this.internalPlay()},e.prototype.internalPause=function(t){var n,i;clearInterval(this.playInterval),this.states.state="pause",!t&&((i=(n=this.attributes)===null||n===void 0?void 0:n.onPause)===null||i===void 0||i.call(n))},e.prototype.pause=function(){this.internalPause()},e.prototype.internalForward=function(t){var n,i,a=this.moveSelection("forward",t);return t||((i=(n=this.attributes)===null||n===void 0?void 0:n.onForward)===null||i===void 0||i.call(n),this.dispatchOnChange()),a},e.prototype.forward=function(){this.internalForward()},e.prototype.handleSpeedChange=function(t){var n,i;this.states.speed=t;var a=this.states.state;a==="play"&&(this.internalPause(!0),this.internalPlay(!0)),(i=(n=this.attributes)===null||n===void 0?void 0:n.onSpeedChange)===null||i===void 0||i.call(n,t)},e.prototype.handleSelectionTypeChange=function(t){var n,i;this.states.selectionType=t,this.renderChart(),(i=(n=this.attributes)===null||n===void 0?void 0:n.onSelectionTypeChange)===null||i===void 0||i.call(n,t)},e.prototype.handleChartTypeChange=function(t){var n,i;this.states.chartType=t,this.renderChart(),(i=(n=this.attributes)===null||n===void 0?void 0:n.onChartTypeChange)===null||i===void 0||i.call(n,t)},e.prototype.render=function(){var t=this.space,n=t.axisBBox,i=t.controllerBBox,a=t.timelineBBox;this.renderController(i),this.renderAxis(n),this.renderChart(a),this.states.state==="play"&&this.internalPlay()},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.internalPause(!0)},e.defaultOptions={style:{x:0,y:0,axisLabelFill:"#6e6e6e",axisLabelTextAlign:"left",axisLabelTextBaseline:"top",axisLabelTransform:"translate(5, -12)",axisLineLineWidth:1,axisLineStroke:"#cacdd1",axisTickLength:15,axisTickLineWidth:1,axisTickStroke:"#cacdd1",chartShowLabel:!1,chartType:"line",controllerAlign:"center",controllerHeight:40,data:[],interval:"day",loop:!1,playMode:"acc",selectionType:"range",type:"time"}},e}($t);function b1(r){const{width:e,height:t,renderer:n}=r,i=YY(r),a=new py({width:e,height:t,container:i,renderer:n||new Bc});return[i,a]}function YY(r){var e;const{container:t,className:n,graphCanvas:i}=r;if(t)return typeof t=="string"?document.getElementById(t):t;const a=Ks(n,!1),{width:s,height:o,containerStyle:u}=r,[l,c]=UY(r);return Object.assign(a.style,Object.assign({position:"absolute",left:l+"px",top:c+"px",width:s+"px",height:o+"px"},u)),(e=i.getContainer())===null||e===void 0||e.appendChild(a),a}function UY(r){const{width:e,height:t,placement:n,graphCanvas:i}=r,[a,s]=i.getSize(),[o,u]=YO(n);return[o*(a-e),u*(s-t)]}var HY=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Bd extends An{constructor(e,t){super(e,Object.assign({},Bd.defaultOptions,t)),this.typePrefix="__data__",this.draw=!1,this.fieldMap={node:new Map,edge:new Map,combo:new Map},this.selectedItems=[],this.bindEvents=()=>{const{graph:n}=this.context;n.on(ve.AFTER_DRAW,this.createElement)},this.changeState=(n,i)=>{const{graph:a}=this.context,{typePrefix:s}=this,o=Fn(n,[s,"id"]),u=Fn(n,[s,"style","labelText"]),[l]=o.split("__"),c=this.fieldMap[l].get(u)||[];a.setElementState(Object.fromEntries(c==null?void 0:c.map(d=>[d,i])))},this.click=n=>{if(this.options.trigger==="hover")return;const i=Fn(n,[this.typePrefix,"id"]);this.selectedItems.includes(i)?(this.selectedItems=this.selectedItems.filter(a=>a!==i),this.changeState(n,[])):(this.selectedItems.push(i),this.changeState(n,"selected"))},this.mouseleave=n=>{this.options.trigger!=="click"&&(this.selectedItems=[],this.changeState(n,[]))},this.mouseenter=n=>{if(this.options.trigger==="click")return;const i=Fn(n,[this.typePrefix,"id"]);this.selectedItems.includes(i)?this.selectedItems=this.selectedItems.filter(a=>a!==i):(this.selectedItems.push(i),this.changeState(n,"active"))},this.setFieldMap=(n,i,a)=>{if(!n)return;const s=this.fieldMap[a];if(s)if(!s.has(n))s.set(n,[i]);else{const o=s.get(n);o&&(o.push(i),s.set(n,o))}},this.getEvents=()=>({mouseenter:this.mouseenter,mouseleave:this.mouseleave,click:this.click}),this.getMarkerData=(n,i)=>{if(!n)return[];const{model:a,element:s}=this.context,{nodes:o,edges:u,combos:l}=a.getData(),c={},d=p=>Te(n)?n(p):n,h={node:"circle",edge:"line",combo:"rect"},f={circle:"circle",ellipse:"circle",image:"bowtie",rect:"square",star:"cross",triangle:"triangle",diamond:"diamond",cubic:"dot",line:"hyphen",polyline:"hyphen",quadratic:"hv","cubic-horizontal":"hyphen","cubic-vertical":"line"},g=(p,y)=>s==null?void 0:s.getElementComputedStyle(p,y),v=(p,y)=>{p.forEach(m=>{const{id:w}=m,M=Fn(m,["data",d(m)]),S=(s==null?void 0:s.getElementType(y,m))||"circle",T=g(y,m),A=(y==="edge"?T==null?void 0:T.stroke:T==null?void 0:T.fill)||"#1783ff";w&&M&&M.replace(/\s+/g,"")&&(this.setFieldMap(M,w,y),c[M]||(c[M]={id:`${y}__${w}`,label:M,marker:f[S]||h[y],elementType:y,lineWidth:1,stroke:A,fill:A}))})};switch(i){case"node":v(o,"node");break;case"edge":v(u,"edge");break;case"combo":v(l,"combo");break;default:return[]}return Object.values(c)},this.createElement=()=>{if(this.draw){this.updateElement();return}const n=this.options,{width:i,height:a,nodeField:s,edgeField:o,comboField:u,trigger:l,position:c,container:d,containerStyle:h,className:f}=n,g=HY(n,["width","height","nodeField","edgeField","comboField","trigger","position","container","containerStyle","className"]),v=this.getMarkerData(s,"node"),p=this.getMarkerData(o,"edge"),y=this.getMarkerData(u,"combo"),m=[...v,...y,...p],w=Object.assign({width:i,height:a,data:m,itemMarkerLineWidth:({lineWidth:T})=>T,itemMarker:({marker:T})=>T,itemMarkerStroke:({stroke:T})=>T,itemMarkerFill:({fill:T})=>T,gridCol:v.length},g,this.getEvents()),M=new EY({className:"legend",style:w});this.category=M,this.upsertCanvas().appendChild(M),this.draw=!0},this.bindEvents()}update(e){super.update(e),this.clear(),this.createElement()}clear(){var e,t;(e=this.canvas)===null||e===void 0||e.destroy(),(t=this.container)===null||t===void 0||t.remove(),this.canvas=void 0,this.container=void 0,this.draw=!1}updateElement(){this.category&&this.category.update({itemMarkerOpacity:({id:e})=>!this.selectedItems.length||this.selectedItems.includes(e)?1:.5,itemLabelOpacity:({id:e})=>!this.selectedItems.length||this.selectedItems.includes(e)?1:.5})}upsertCanvas(){if(this.canvas)return this.canvas;const e=this.context.canvas,[t,n]=e.getSize(),{width:i=t,height:a=n,position:s,container:o,containerStyle:u,className:l}=this.options,[c,d]=b1({width:i,height:a,graphCanvas:e,container:o,containerStyle:u,placement:s,className:"legend"});return this.container=c,l&&c.classList.add(l),this.canvas=d,this.canvas}destroy(){this.clear(),this.context.graph.off(ve.AFTER_DRAW,this.createElement),super.destroy()}}Bd.defaultOptions={position:"bottom",trigger:"hover",orientation:"horizontal",layout:"flex",itemSpacing:4,rowPadding:10,colPadding:10,itemMarkerSize:16,itemLabelFontSize:16,width:240,height:160};class Fd extends An{constructor(e,t){super(e,Object.assign({},Fd.defaultOptions,t)),this.onDraw=n=>{var i;!((i=n==null?void 0:n.data)===null||i===void 0)&&i.render||this.onRender()},this.shapes=new Map,this.landmarkMap=new Map,this.mask=null,this.isMaskDragging=!1,this.onMaskDragStart=n=>{this.mask&&(this.isMaskDragging=!0,this.mask.setPointerCapture(n.pointerId),this.mask.addEventListener("pointermove",this.onMaskDrag),this.mask.addEventListener("pointerup",this.onMaskDragEnd),this.mask.addEventListener("pointercancel",this.onMaskDragEnd))},this.onMaskDrag=n=>{if(!this.mask||!this.isMaskDragging)return;const{size:[i,a]}=this.options,{movementX:s,movementY:o}=n,{left:u,top:l,width:c,height:d}=this.mask.style,[,,h,f]=this.maskBBox;let g=parseInt(u)+s,v=parseInt(l)+o,p=parseInt(c),y=parseInt(d);g<0&&(g=0),v<0&&(v=0),g+p>i&&(g=qi(i-p,0)),v+y>a&&(v=qi(a-y,0)),p<h&&(s>0?(g=qi(g-s,0),p=$i(p+s,i)):s<0&&(p=$i(p-s,i))),y<f&&(o>0?(v=qi(v-o,0),y=$i(y+o,a)):o<0&&(y=$i(y-o,a))),Object.assign(this.mask.style,{left:g+"px",top:v+"px",width:p+"px",height:y+"px"});const m=parseInt(u)-g,w=parseInt(l)-v;if(m===0&&w===0)return;const M=this.context.canvas.getCamera().getZoom(),S=this.canvas.getCamera().getZoom(),T=M/S;this.context.graph.translateBy([m*T,w*T],!1)},this.onMaskDragEnd=n=>{this.mask&&(this.isMaskDragging=!1,this.mask.releasePointerCapture(n.pointerId),this.mask.removeEventListener("pointermove",this.onMaskDrag),this.mask.removeEventListener("pointerup",this.onMaskDragEnd),this.mask.removeEventListener("pointercancel",this.onMaskDragEnd))},this.onTransform=AT(()=>{this.isMaskDragging||(this.updateMask(),this.setCamera())},32,{leading:!0}),this.setOnRender(),this.bindEvents()}update(e){this.unbindEvents(),super.update(e),"delay"in e&&this.setOnRender(),this.bindEvents()}setOnRender(){this.onRender=su(()=>{this.renderMinimap(),this.renderMask()},this.options.delay,!0)}bindEvents(){const{graph:e}=this.context;e.on(ve.AFTER_DRAW,this.onDraw),e.on(ve.AFTER_RENDER,this.onRender),e.on(ve.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){const{graph:e}=this.context;e.off(ve.AFTER_DRAW,this.onDraw),e.off(ve.AFTER_RENDER,this.onRender),e.off(ve.AFTER_TRANSFORM,this.onTransform)}renderMinimap(){const e=this.getElements(),t=this.initCanvas();this.setShapes(t,e)}getElements(){const{filter:e}=this.options,{model:t}=this.context,n=t.getData();if(!e)return n;const{nodes:i,edges:a,combos:s}=n;return{nodes:i.filter(o=>e(Q(o),"node")),edges:a.filter(o=>e(Q(o),"edge")),combos:s.filter(o=>e(Q(o),"combo"))}}setShapes(e,t){const{nodes:n,edges:i,combos:a}=t,{shape:s}=this.options,{element:o}=this.context;if(s==="key"){const l=new Set,c=d=>{const h=Q(d);l.add(h);const f=o.getElement(h);if(!f)return;const g=f.getShape("key"),v=this.shapes.get(h)||g.cloneNode();v.setPosition(g.getPosition()),f.style.zIndex&&(v.style.zIndex=f.style.zIndex),v.id=f.id,this.shapes.has(h)?Object.entries(g.attributes).forEach(([p,y])=>{v.style[p]!==y&&(v.style[p]=y)}):(e.appendChild(v),this.shapes.set(h,v))};i.forEach(c),a.forEach(c),n.forEach(c),this.shapes.forEach((d,h)=>{l.has(h)||(e.removeChild(d),this.shapes.delete(h))});return}const u=(l,c)=>{const h=o.getElement(l).getPosition();return c.setPosition(h),c};e.removeChildren(),i.forEach(l=>e.appendChild(s(Q(l),"edge"))),a.forEach(l=>{e.appendChild(u(Q(l),s(Q(l),"combo")))}),n.forEach(l=>{e.appendChild(u(Q(l),s(Q(l),"node")))})}initCanvas(){const{renderer:e,size:[t,n]}=this.options;if(this.canvas){const{width:i,height:a}=this.canvas.getConfig();(t!==i||n!==a)&&this.canvas.resize(t,n),e&&this.canvas.setRenderer(e)}else{const{className:i,position:a,container:s,containerStyle:o}=this.options,[u,l]=b1({renderer:e,width:t,height:n,placement:a,className:"minimap",container:s,containerStyle:o,graphCanvas:this.context.canvas});i&&u.classList.add(i),this.container=u,this.canvas=l}return this.setCamera(),this.canvas}createLandmark(e,t,n){const i=`${e.join(",")}-${t.join(",")}-${n}`;if(this.landmarkMap.has(i))return this.landmarkMap.get(i);const s=this.canvas.getCamera().createLandmark(i,{position:e,focalPoint:t,zoom:n});return this.landmarkMap.set(i,s),s}setCamera(){var e;const{canvas:t}=this.context,n=(e=this.canvas)===null||e===void 0?void 0:e.getCamera();if(!n)return;const{size:[i,a],padding:s}=this.options,[o,u,l,c]=hi(s),{min:d,max:h,center:f}=t.getBounds("elements"),g=h[0]-d[0],v=h[1]-d[1],p=i-c-u,y=a-o-l,m=p/g,w=y/v,M=Math.min(m,w),S=this.createLandmark(f,f,M);n.gotoLandmark(S,0)}get maskBBox(){const{canvas:e}=this.context,t=e.getSize(),n=e.getCanvasByViewport([0,0]),i=e.getCanvasByViewport(t),a=this.canvas.canvas2Viewport(Br(n)),s=this.canvas.canvas2Viewport(Br(i)),o=s.x-a.x,u=s.y-a.y;return[a.x,a.y,o,u]}calculateMaskBBox(){const{size:[e,t]}=this.options;let[n,i,a,s]=this.maskBBox;return n<0&&(a=$i(a+n,e),n=0),i<0&&(s=$i(s+i,t),i=0),n+a>e&&(a=qi(e-n,0)),i+s>t&&(s=qi(t-i,0)),[$i(n,e),$i(i,t),qi(a,0),qi(s,0)]}renderMask(){const{maskStyle:e}=this.options;this.mask||(this.mask=document.createElement("div"),this.mask.addEventListener("pointerdown",this.onMaskDragStart)),this.container.appendChild(this.mask),Object.assign(this.mask.style,Object.assign(Object.assign({},e),{cursor:"move",position:"absolute",pointerEvents:"auto"})),this.updateMask()}updateMask(){if(!this.mask)return;const[e,t,n,i]=this.calculateMaskBBox();Object.assign(this.mask.style,{top:t+"px",left:e+"px",width:n+"px",height:i+"px"})}destroy(){var e;this.unbindEvents(),this.canvas.destroy(),(e=this.mask)===null||e===void 0||e.remove(),super.destroy()}}Fd.defaultOptions={size:[240,160],shape:"key",padding:10,position:"right-bottom",maskStyle:{border:"1px solid #ddd",background:"rgba(0, 0, 0, 0.1)"},containerStyle:{border:"1px solid #ddd",background:"#fff"},delay:128};const $i=(r,e)=>Math.min(r,e),qi=(r,e)=>Math.max(r,e);var R0=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})};const j0={x1:0,y1:0,x2:0,y2:0,visibility:"hidden"};class zd extends An{constructor(e,t){super(e,Object.assign({},zd.defaultOptions,t)),this.initSnapline=()=>{const n=this.context.canvas.getLayer("transient");this.horizontalLine||(this.horizontalLine=n.appendChild(new Wa({style:Object.assign(Object.assign({},j0),this.options.horizontalLineStyle)}))),this.verticalLine||(this.verticalLine=n.appendChild(new Wa({style:Object.assign(Object.assign({},j0),this.options.verticalLineStyle)})))},this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!0,this.autoSnapToLine=(n,i,a)=>R0(this,void 0,void 0,function*(){const{verticalX:s,horizontalY:o}=a,{tolerance:u}=this.options,{min:[l,c],max:[d,h],center:[f,g]}=i;let v=0,p=0;s!==null&&(Nn(d,s)<u&&(v=s-d),Nn(l,s)<u&&(v=s-l),Nn(f,s)<u&&(v=s-f),v!==0&&(this.isVerticalSticking=!0)),o!==null&&(Nn(h,o)<u&&(p=o-h),Nn(c,o)<u&&(p=o-c),Nn(g,o)<u&&(p=o-g),p!==0&&(this.isHorizontalSticking=!0)),(v!==0||p!==0)&&(yield this.context.graph.translateElementBy({[n]:[v,p]},!1))}),this.enableSnap=n=>{const{target:i}=n,a=.5;if(this.isHorizontalSticking||this.isVerticalSticking){const[s,o]=this.getDelta(n);if(this.isHorizontalSticking&&this.isVerticalSticking&&Math.abs(s)<=a&&Math.abs(o)<=a)return this.context.graph.translateElementBy({[i.id]:[-s,-o]},!1),!1;if(this.isHorizontalSticking&&Math.abs(o)<=a)return this.context.graph.translateElementBy({[i.id]:[0,-o]},!1),!1;if(this.isVerticalSticking&&Math.abs(s)<=a)return this.context.graph.translateElementBy({[i.id]:[-s,0]},!1),!1;this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!1,setTimeout(()=>{this.enableStick=!0},200)}return this.enableStick},this.calcSnaplineMetadata=(n,i)=>{const{tolerance:a,shape:s}=this.options,{min:[o,u],max:[l,c],center:[d,h]}=i;let f=null,g=null,v=null,p=null,y=null,m=null;return this.getNodes().some(w=>{if(Bt(n.id,w.id))return!1;const M=b_(w,s).getRenderBounds(),{min:[S,T],max:[A,O],center:[N,C]}=M;return f===null&&(Nn(N,d)<a?f=N:Nn(S,o)<a||Nn(S,l)<a?f=S:(Nn(A,l)<a||Nn(A,o)<a)&&(f=A),f!==null&&(g=Math.min(T,u),v=Math.max(O,c))),p===null&&(Nn(C,h)<a?p=C:Nn(T,u)<a||Nn(T,c)<a?p=T:(Nn(O,c)<a||Nn(O,u)<a)&&(p=O),p!==null&&(y=Math.min(S,o),m=Math.max(A,l))),f!==null&&p!==null}),{verticalX:f,verticalMinY:g,verticalMaxY:v,horizontalY:p,horizontalMinX:y,horizontalMaxX:m}},this.onDragStart=()=>{this.initSnapline()},this.onDrag=n=>R0(this,void 0,void 0,function*(){const{target:i}=n;if(this.options.autoSnap&&!this.enableSnap(n))return;const a=b_(i,this.options.shape).getRenderBounds(),s=this.calcSnaplineMetadata(i,a);this.hideSnapline(),(s.verticalX!==null||s.horizontalY!==null)&&this.updateSnapline(s),this.options.autoSnap&&(yield this.autoSnapToLine(i.id,a,s))}),this.onDragEnd=()=>{this.hideSnapline()},this.bindEvents()}getNodes(){var e;const{filter:t}=this.options,i=(((e=this.context.element)===null||e===void 0?void 0:e.getNodes())||[]).filter(a=>{var s;return oB(a)&&((s=this.context.viewport)===null||s===void 0?void 0:s.isInViewport(a.getRenderBounds()))});return t?i.filter(a=>t(a)):i}hideSnapline(){this.horizontalLine.style.visibility="hidden",this.verticalLine.style.visibility="hidden"}getLineWidth(e){const{lineWidth:t}=this.options[`${e}LineStyle`];return+(t||j0.lineWidth||1)/this.context.graph.getZoom()}updateSnapline(e){const{verticalX:t,verticalMinY:n,verticalMaxY:i,horizontalY:a,horizontalMinX:s,horizontalMaxX:o}=e,[u,l]=this.context.canvas.getSize(),{offset:c}=this.options;a!==null?Object.assign(this.horizontalLine.style,{x1:c===1/0?0:s-c,y1:a,x2:c===1/0?u:o+c,y2:a,visibility:"visible",lineWidth:this.getLineWidth("horizontal")}):this.horizontalLine.style.visibility="hidden",t!==null?Object.assign(this.verticalLine.style,{x1:t,y1:c===1/0?0:n-c,x2:t,y2:c===1/0?l:i+c,visibility:"visible",lineWidth:this.getLineWidth("vertical")}):this.verticalLine.style.visibility="hidden"}getDelta(e){const t=this.context.graph.getZoom();return qr([e.dx,e.dy],t)}bindEvents(){return R0(this,void 0,void 0,function*(){const{graph:e}=this.context;e.on(Or.DRAG_START,this.onDragStart),e.on(Or.DRAG,this.onDrag),e.on(Or.DRAG_END,this.onDragEnd)})}unbindEvents(){const{graph:e}=this.context;e.off(Or.DRAG_START,this.onDragStart),e.off(Or.DRAG,this.onDrag),e.off(Or.DRAG_END,this.onDragEnd)}destroyElements(){var e,t;(e=this.horizontalLine)===null||e===void 0||e.destroy(),(t=this.verticalLine)===null||t===void 0||t.destroy()}destroy(){this.destroyElements(),this.unbindEvents(),super.destroy()}}zd.defaultOptions={tolerance:5,offset:20,autoSnap:!0,shape:"key",verticalLineStyle:{stroke:"#1783FF"},horizontalLineStyle:{stroke:"#1783FF"},filter:()=>!0};const Nn=(r,e)=>Math.abs(r-e),b_=(r,e)=>typeof e=="function"?e(r):r.getShape(e);var XY=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})},KY=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const ZY=["timestamp","time","date","datetime"];class $d extends An{get padding(){return hi(this.options.padding)}constructor(e,t){super(e,Object.assign({},$d.defaultOptions,t)),this.backup(),this.upsertTimebar()}play(){var e;(e=this.timebar)===null||e===void 0||e.play()}pause(){var e;(e=this.timebar)===null||e===void 0||e.pause()}forward(){var e;(e=this.timebar)===null||e===void 0||e.forward()}backward(){var e;(e=this.timebar)===null||e===void 0||e.backward()}reset(){var e;(e=this.timebar)===null||e===void 0||e.reset()}update(e){super.update(e),this.backup(),this.upsertTimebar()}backup(){this.originalData=w_(this.context.graph.getData())}upsertTimebar(){const{canvas:e}=this.context,t=this.options,{onChange:n,timebarType:i,data:a,x:s,y:o,width:u,height:l,mode:c}=t,d=KY(t,["onChange","timebarType","data","x","y","width","height","mode"]),h=e.getSize(),[f]=this.padding;this.upsertCanvas().ready.then(()=>{var g;const v=Object.assign(Object.assign({x:h[0]/2-u/2,y:f,onChange:p=>{const y=(gr(p)?p:[p,p]).map(m=>$L(m)?m.getTime():m);this.options.mode==="modify"?this.filterElements(y):this.hiddenElements(y),n==null||n(y)}},d),{data:a.map(p=>Ee(p)?{time:p,value:0}:p),width:u,height:l,type:i});this.timebar?this.timebar.update(v):(this.timebar=new VY({style:v}),(g=this.canvas)===null||g===void 0||g.appendChild(this.timebar))})}upsertCanvas(){if(this.canvas)return this.canvas;const{className:e,height:t,position:n}=this.options,i=this.context.canvas,[a]=i.getSize(),[s,,o]=this.padding,[u,l]=b1({width:a,height:t+s+o,graphCanvas:i,className:"timebar",placement:n});return this.container=u,e&&u.classList.add(e),this.canvas=l,this.canvas}filterElements(e){return XY(this,void 0,void 0,function*(){var t;if(!this.originalData)return;const{elementTypes:n,getTime:i}=this.options,{graph:a,element:s}=this.context,o=w_(this.originalData);n.forEach(l=>{const c=`${l}s`;o[c]=(this.originalData[c]||[]).filter(d=>{const h=i(d);return!!x_(h,e)})});const u=[...o.nodes,...o.combos].map(l=>Q(l));o.edges=o.edges.filter(l=>{const c=l.source,d=l.target;return u.includes(c)&&u.includes(d)}),a.setData(o),yield(t=s.draw({animation:!1,silence:!0}))===null||t===void 0?void 0:t.finished})}hiddenElements(e){const{graph:t}=this.context,{elementTypes:n,getTime:i}=this.options,a=[],s=[];n.forEach(o=>{var u;const l=`${o}s`;(((u=this.originalData)===null||u===void 0?void 0:u[l])||[]).forEach(d=>{const h=Q(d),f=i(d);x_(f,e)?s.push(h):a.push(h)})}),t.hideElement(a,!1),t.showElement(s,!1)}destroy(){var e,t,n;const{graph:i}=this.context;this.originalData&&i.setData(Object.assign({},this.originalData)),(e=this.timebar)===null||e===void 0||e.destroy(),(t=this.canvas)===null||t===void 0||t.destroy(),(n=this.container)===null||n===void 0||n.remove(),this.originalData=void 0,this.container=void 0,this.timebar=void 0,this.canvas=void 0,super.destroy()}}$d.defaultOptions={position:"bottom",enable:!0,timebarType:"time",className:"g6-timebar",width:450,height:60,zIndex:3,elementTypes:["node"],padding:10,mode:"modify",getTime:r=>QY(r,ZY,void 0),loop:!1};const w_=r=>{const{nodes:e=[],edges:t=[],combos:n=[]}=r;return{nodes:[...e],edges:[...t],combos:[...n]}},x_=(r,e)=>{if(Ee(e))return r===e;const[t,n]=e;return r>=t&&r<=n},QY=(r,e,t)=>{var n;for(let i=0;i<e.length;i++){const a=e[i],s=(n=r.data)===null||n===void 0?void 0:n[a];if(s)return s}return t};function JY(r){const e={top:"unset",right:"unset",bottom:"unset",left:"unset"};return r.split("-").forEach(n=>{e[n]="8px"}),e.flexDirection=r.startsWith("top")||r.startsWith("bottom")?"row":"column",e}const eU=`
  .g6-toolbar {
    position: absolute;
    z-index: 100;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.1);
    opacity: 0.65;
  }
  .g6-toolbar .g6-toolbar-item {
    display: inline-block;
    width: 16px;
    height: 16px;
    padding: 4px;
    cursor: pointer;
    box-sizing: content-box;
  }

  .g6-toolbar .g6-toolbar-item:hover {
    background-color: #f0f0f0;
  }

  .g6-toolbar .g6-toolbar-item svg {
    display: inline-block;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }
`,tU=`
  <svg>
    <symbol id="zoom-in" viewBox="64 64 896 896">
      <path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="zoom-out" viewBox="64 64 896 896">
      <path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="edit" viewBox="64 64 896 896">
      <path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"></path>
    </symbol>
    <symbol id="delete" viewBox="64 64 896 896">
      <path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"></path>
    </symbol>
    <symbol id="redo" viewBox="64 64 896 896">
      <path d="M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"></path>
    </symbol>
    <symbol id="undo" viewBox="64 64 896 896">
      <path d="M511.4 124C290.5 124.3 112 303 112 523.9c0 128 60.2 242 153.8 315.2l-37.5 48c-4.1 5.3-.3 13 6.3 12.9l167-.8c5.2 0 9-4.9 7.7-9.9L369.8 727a8 8 0 00-14.1-3L315 776.1c-10.2-8-20-16.7-29.3-26a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-7.5 7.5-15.3 14.5-23.4 21.2a7.93 7.93 0 00-1.2 11.1l39.4 50.5c2.8 3.5 7.9 4.1 11.4 1.3C854.5 760.8 912 649.1 912 523.9c0-221.1-179.4-400.2-400.6-399.9z"></path>
    </symbol>
    <symbol id="export" viewBox="64 64 896 896">
      <path d="M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"></path>
    </symbol>
    <symbol id="auto-fit" viewBox="64 64 896 896">
      <path d="M952 474H829.8C812.5 327.6 696.4 211.5 550 194.2V72c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v122.2C327.6 211.5 211.5 327.6 194.2 474H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h122.2C211.5 696.4 327.6 812.5 474 829.8V952c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V829.8C696.4 812.5 812.5 696.4 829.8 550H952c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM512 756c-134.8 0-244-109.2-244-244s109.2-244 244-244 244 109.2 244 244-109.2 244-244 244z"></path>
      <path d="M512 392c-32.1 0-62.1 12.4-84.8 35.2-22.7 22.7-35.2 52.7-35.2 84.8s12.5 62.1 35.2 84.8C449.9 619.4 480 632 512 632s62.1-12.5 84.8-35.2C619.4 574.1 632 544 632 512s-12.5-62.1-35.2-84.8A118.57 118.57 0 00512 392z"></path>
    </symbol>
    <symbol id="reset" viewBox="64 64 896 896">
      <path d="M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"></path>
    </symbol>
    <symbol id="exit-fullscreen" viewBox="0 0 1024 1024">
      <path d="M418.13333333 361.43786666c0 0.2048-0.13653333 0.4096-0.13653334 0.68266667C417.99679999 362.32533333 418.13333333 362.53013333 418.13333333 362.73493333 418.13333333 371.54133333 414.44693333 379.392 408.78079999 385.39946666 408.43946666 385.7408 408.30293333 386.21866666 408.02986666 386.49173333c-1.09226667 1.09226667-2.59413333 1.77493333-3.82293333 2.73066667C398.40426666 393.65973333 391.64586666 396.8 383.93173333 396.8 383.72693333 396.8 383.59039999 396.73173333 383.38559999 396.73173333S382.97599999 396.8 382.77119999 396.8L112.29866666 396.8C92.50133333 396.8 76.79999999 381.50826666 76.79999999 362.66666666 76.66346666 343.89333333 92.63786666 328.53333333 112.16213333 328.53333333l189.44 0L87.44959999 114.51733333C73.59146666 100.59093333 73.25013333 78.5408 86.63039999 65.29706666c13.17546667-13.44853333 35.36213333-12.97066667 49.152 0.88746667l214.08426667 214.08426667L349.86666666 90.89706666C349.79839999 71.23626666 365.22666666 55.46666666 383.99999999 55.46666666 402.77333333 55.33013333 418.13333333 71.30453333 418.13333333 90.8288L418.13333333 361.43786666zM928.90453333 328.53333333l-189.44 0 214.15253333-214.08426667c13.85813333-13.9264 14.19946667-35.90826667 0.88746667-49.22026666-13.17546667-13.44853333-35.36213333-12.97066667-49.152 0.88746666l-214.08426667 214.08426667L691.26826666 90.89706666C691.26826666 71.23626666 675.83999999 55.46666666 657.06666666 55.46666666 638.29333333 55.33013333 622.93333333 71.30453333 622.93333333 90.8288l0 270.60906666c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 362.32533333 622.93333333 362.53013333 622.93333333 362.73493333 622.93333333 371.54133333 626.61973333 379.392 632.28586666 385.39946666c0.34133333 0.34133333 0.47786667 0.8192 0.8192 1.09226667 1.09226667 1.09226667 2.59413333 1.77493333 3.8912 2.73066667C642.66239999 393.65973333 649.42079999 396.8 657.13493333 396.8c0.2048 0 0.34133333-0.06826667 0.54613333-0.06826667S658.09066666 396.8 658.29546666 396.8l270.5408 0C948.56533333 396.8 964.26666666 381.50826666 964.26666666 362.66666666 964.40319999 343.89333333 948.42879999 328.53333333 928.90453333 328.53333333zM418.13333333 635.73333333c0-8.8064-3.6864-16.5888-9.35253334-22.66453333C408.43946666 612.72746666 408.30293333 612.2496 408.02986666 611.90826666 406.86933333 610.88426666 405.43573333 610.2016 404.20693333 609.24586666 398.47253333 604.80853333 391.64586666 601.6 383.93173333 601.6 383.72693333 601.6 383.59039999 601.73653333 383.38559999 601.73653333S382.97599999 601.6 382.77119999 601.6L112.29866666 601.6C92.50133333 601.6 76.79999999 616.96 76.79999999 635.73333333 76.66346666 654.50666666 92.63786666 669.86666666 112.16213333 669.86666666l189.44 0-214.15253334 214.15253334c-13.85813333 13.85813333-14.19946667 35.84-0.88746666 49.22026666 13.17546667 13.44853333 35.36213333 12.9024 49.152-0.95573333l214.08426666-214.08426667 0 189.37173334c0 19.59253333 15.42826667 35.49866667 34.2016 35.36213333C402.77333333 943.2064 418.13333333 927.232 418.13333333 907.5712L418.13333333 637.09866666c0-0.27306667-0.13653333-0.47786667-0.13653334-0.68266666C417.99679999 636.14293333 418.13333333 635.93813333 418.13333333 635.73333333zM739.46453333 669.86666666l189.44 0c19.456 0 35.49866667-15.36 35.36213333-34.13333333C964.26666666 616.96 948.56533333 601.6 928.76799999 601.6L658.29546666 601.6C658.09066666 601.6 657.88586666 601.73653333 657.68106666 601.73653333S657.33973333 601.6 657.13493333 601.6C649.42079999 601.6 642.59413333 604.80853333 636.85973333 609.24586666 635.63093333 610.2016 634.19733333 610.88426666 633.03679999 611.90826666 632.76373333 612.2496 632.62719999 612.72746666 632.28586666 613.0688 626.61973333 619.14453333 622.93333333 626.92693333 622.93333333 635.73333333c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 636.6208 622.93333333 636.8256 622.93333333 637.09866666l0 270.5408C622.93333333 927.232 638.29333333 943.2064 657.06666666 942.93333333c18.77333333 0.13653333 34.2016-15.70133333 34.2016-35.36213333l0-189.37173334 214.08426667 214.08426667c13.78986667 13.85813333 35.90826667 14.40426667 49.152 0.95573333 13.312-13.312 12.97066667-35.36213333-0.88746667-49.22026666L739.46453333 669.86666666z"  ></path></symbol>
    <symbol id="request-fullscreen" viewBox="0 0 1024 1024">
      <path d="M69.818182 87.598545v273.128728a34.909091 34.909091 0 0 0 69.818182 0V163.653818l221.928727 222.021818a33.512727 33.512727 0 0 0 47.383273-47.383272L186.926545 116.363636h197.073455a34.909091 34.909091 0 0 0 0-69.818181H110.871273C85.364364 46.545455 69.818182 59.671273 69.818182 87.598545zM938.542545 46.545455H665.413818a34.909091 34.909091 0 0 0 0 69.818181h197.073455L640.465455 338.292364a33.512727 33.512727 0 0 0 47.383272 47.383272l221.928728-222.021818v197.073455a34.909091 34.909091 0 0 0 69.818181 0V87.598545c0-27.927273-15.453091-41.053091-40.96-41.05309z m-827.671272 907.636363h273.128727a34.909091 34.909091 0 0 0 0-69.818182H186.926545l222.021819-221.928727a33.512727 33.512727 0 0 0-47.383273-47.383273L139.636364 837.073455V640a34.909091 34.909091 0 0 0-69.818182 0v273.128727c0 27.927273 15.546182 41.053091 41.053091 41.053091z m868.724363-41.053091V640a34.909091 34.909091 0 0 0-69.818181 0v197.073455L687.941818 615.051636a33.512727 33.512727 0 0 0-47.383273 47.383273L862.487273 884.363636H665.413818a34.909091 34.909091 0 0 0 0 69.818182h273.128727c25.6 0 41.053091-13.125818 41.053091-41.053091z"  ></path></symbol>
  </svg>
`;var E_=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})};class qd extends An{constructor(e,t){super(e,Object.assign({},qd.defaultOptions,t)),this.$element=Ks("toolbar",!1),this.onToolbarItemClick=i=>{const{onClick:a}=this.options;if(i.target instanceof Element&&i.target.className.includes("g6-toolbar-item")){const s=i.target.getAttribute("value");a==null||a(s,i.target)}};const n=this.context.canvas.getContainer();this.$element.style.display="flex",n.appendChild(this.$element),By("g6-toolbar-css","style",{},eU,document.head),By("g6-toolbar-svgicon","div",{display:"none"},tU),this.$element.addEventListener("click",this.onToolbarItemClick),this.update(t)}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return E_(this,void 0,void 0,function*(){t.update.call(this,e);const{className:n,position:i,style:a}=this.options;this.$element.className=`g6-toolbar ${n||""}`,Object.assign(this.$element.style,a,JY(i)),this.$element.innerHTML=yield this.getDOMContent()})}destroy(){this.$element.removeEventListener("click",this.onToolbarItemClick),this.$element.remove(),super.destroy()}getDOMContent(){return E_(this,void 0,void 0,function*(){return(yield this.options.getItems()).map(t=>`
          <div class="g6-toolbar-item" value="${t.value}">
            <svg aria-hidden="true" focusable="false">
              <use xlink:href="#${t.id}"></use>
            </svg>
          </div>`).join("")})}}qd.defaultOptions={position:"top-left"};var M_=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})};class Gd extends An{constructor(e,t){super(e,Object.assign({},Gd.defaultOptions,t)),this.currentTarget=null,this.tooltipElement=null,this.container=null,this.isEnable=(n,i)=>{const{enable:a}=this.options;return typeof a=="function"?a(n,i):a},this.onClick=n=>{const{target:{id:i}}=n;this.currentTarget===i?this.hide(n):this.show(n)},this.onPointerMove=n=>{const{target:i}=n;!this.currentTarget||i.id===this.currentTarget||this.show(n)},this.onPointerLeave=n=>{this.hide(n)},this.onCanvasMove=n=>{this.hide(n)},this.onPointerEnter=n=>{this.show(n)},this.showById=n=>M_(this,void 0,void 0,function*(){const i={target:{id:n}};yield this.show(i)}),this.getElementData=(n,i)=>{const{model:a}=this.context;switch(i){case"node":return a.getNodeData([n]);case"edge":return a.getEdgeData([n]);case"combo":return a.getComboData([n]);default:return[]}},this.show=n=>M_(this,void 0,void 0,function*(){var i,a;const{client:s,target:{id:o}}=n;if(Yc(n.target))return;const u=this.context.graph.getElementType(o),{getContent:l,title:c}=this.options,d=this.getElementData(o,u);if(!this.tooltipElement||!this.isEnable(n,d))return;let h={};if(l){if(h.content=yield l(n,d),!h.content)return}else{const v=this.context.graph.getElementRenderStyle(o),p=u==="node"?v.fill:v.stroke;h={title:c||u,data:d.map(y=>({name:"ID",value:y.id||`${y.source} -> ${y.target}`,color:p}))}}this.currentTarget=o;let f,g;if(s)f=s.x,g=s.y;else{const v=Fn(d,"0.style",{x:0,y:0});f=v.x,g=v.y}(a=(i=this.options).onOpenChange)===null||a===void 0||a.call(i,!0),this.tooltipElement.update(Object.assign(Object.assign(Object.assign({},this.tooltipStyleProps),{x:f,y:g,style:{".tooltip":{visibility:"visible"}}}),h))}),this.hide=n=>{var i,a,s,o,u;if(!n){(a=(i=this.options).onOpenChange)===null||a===void 0||a.call(i,!1),(s=this.tooltipElement)===null||s===void 0||s.hide(),this.currentTarget=null;return}if(!this.tooltipElement||!this.currentTarget)return;const{client:{x:l,y:c}}=n;(u=(o=this.options).onOpenChange)===null||u===void 0||u.call(o,!1),this.tooltipElement.hide(l,c),this.currentTarget=null},this.initTooltip=()=>{var n;const i=new TY({className:"tooltip",style:this.tooltipStyleProps});return(n=this.container)===null||n===void 0||n.appendChild(i.HTMLTooltipElement),i},this.render(),this.bindEvents()}getEvents(){return this.options.trigger==="click"?{"node:click":this.onClick,"edge:click":this.onClick,"combo:click":this.onClick,"canvas:click":this.onPointerLeave,contextmenu:this.onPointerLeave,drag:this.onPointerLeave}:{"node:pointerenter":this.onPointerEnter,"node:pointermove":this.onPointerMove,"canvas:pointermove":this.onCanvasMove,"edge:pointerenter":this.onPointerEnter,"edge:pointermove":this.onPointerMove,"combo:pointerenter":this.onPointerEnter,"combo:pointermove":this.onPointerMove,contextmenu:this.onPointerLeave,"node:drag":this.onPointerLeave}}update(e){var t;this.unbindEvents(),super.update(e),this.tooltipElement&&((t=this.container)===null||t===void 0||t.removeChild(this.tooltipElement.HTMLTooltipElement)),this.tooltipElement=this.initTooltip(),this.bindEvents()}render(){const{canvas:e}=this.context,t=e.getContainer();t&&(this.container=t,this.tooltipElement=this.initTooltip())}unbindEvents(){const{graph:e}=this.context,t=this.getEvents();Object.keys(t).forEach(n=>{e.off(n,t[n])})}bindEvents(){const{graph:e}=this.context,t=this.getEvents();Object.keys(t).forEach(n=>{e.on(n,t[n])})}get tooltipStyleProps(){const{canvas:e}=this.context,{center:t}=e.getBounds(),n=e.getContainer(),{top:i,left:a}=n.getBoundingClientRect(),{style:s,position:o,enterable:u,container:l={x:-a,y:-i},title:c,offset:d}=this.options,[h,f]=t,[g,v]=e.getSize();return{x:h,y:f,container:l,title:c,bounding:{x:0,y:0,width:g,height:v},position:o,enterable:u,offset:d,style:s}}destroy(){var e;this.unbindEvents(),this.tooltipElement&&((e=this.container)===null||e===void 0||e.removeChild(this.tooltipElement.HTMLTooltipElement)),super.destroy()}}Gd.defaultOptions={trigger:"hover",position:"top-right",enterable:!1,enable:!0,offset:[10,10],style:{".tooltip":{visibility:"hidden"}}};var eC=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})};let vs;function tC(r,e){return vs||(vs=document.createElement("canvas")),vs.width=r,vs.height=e,vs.getContext("2d").clearRect(0,0,r,e),vs}function nU(r,e,t,n){return eC(this,void 0,void 0,function*(){const i=tC(r,e),a=i.getContext("2d"),{rotate:s,opacity:o,textFill:u,textFontSize:l,textFontFamily:c,textFontVariant:d,textFontWeight:h,textAlign:f,textBaseline:g}=n;return a.textAlign=f,a.textBaseline=g,a.translate(r/2,e/2),a.font=`${l}px ${c} ${d} ${h}`,s&&a.rotate(s),o&&(a.globalAlpha=o),u&&(a.fillStyle=u,a.fillText(`${t}`,0,0)),i.toDataURL()})}function rU(r,e,t,n){return eC(this,void 0,void 0,function*(){const i=tC(r,e),a=i.getContext("2d"),{rotate:s,opacity:o}=n;s&&a.rotate(s),o&&(a.globalAlpha=o);const u=new Image;return u.crossOrigin="anonymous",u.src=t,new Promise(l=>{u.onload=function(){const c=r>u.width?(r-u.width)/2:0,d=e>u.height?(e-u.height)/2:0;a.drawImage(u,0,0,u.width,u.height,c,d,r-c*2,e-d*2),l(i.toDataURL())}})})}var iU=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})},aU=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class Wd extends An{constructor(e,t){super(e,Object.assign({},Wd.defaultOptions,t)),this.$element=Ks("watermark"),this.context.canvas.getContainer().appendChild(this.$element),this.update(t)}update(e){const t=Object.create(null,{update:{get:()=>super.update}});return iU(this,void 0,void 0,function*(){t.update.call(this,e);const n=this.options,{width:i,height:a,text:s,imageURL:o}=n,u=aU(n,["width","height","text","imageURL"]);Object.keys(u).forEach(c=>{c.startsWith("background")&&(this.$element.style[c]=e[c])});const l=o?yield rU(i,a,o,u):yield nU(i,a,s,u);this.$element.style.backgroundImage=`url(${l})`})}destroy(){super.destroy(),this.$element.remove()}}Wd.defaultOptions={width:200,height:100,opacity:.2,rotate:Math.PI/12,text:"",textFill:"#000",textFontSize:16,textAlign:"center",textBaseline:"middle",backgroundRepeat:"repeat"};const sU=["#7E92B5","#F4664A","#FFBE3A"],oU={type:"group",color:["#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]},uU={type:"group",color:["#99ADD1","#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]};function nC(r){const{bgColor:e,textColor:t,nodeColor:n,nodeColorDisabled:i,nodeStroke:a,nodeHaloStrokeOpacityActive:s=.15,nodeHaloStrokeOpacitySelected:o=.25,nodeOpacityDisabled:u=.06,nodeIconOpacityInactive:l=.85,nodeOpacityInactive:c=.25,nodeBadgePalette:d=sU,nodePaletteOptions:h=oU,edgeColor:f,edgeColorDisabled:g,edgePaletteOptions:v=uU,comboColor:p,comboColorDisabled:y,comboStroke:m,comboStrokeDisabled:w,edgeColorInactive:M}=r;return{background:e,node:{palette:h,style:{donutOpacity:1,badgeBackgroundOpacity:1,badgeFill:"#fff",badgeFontSize:8,badgePadding:[0,4],badgePalette:d,fill:n,fillOpacity:1,halo:!1,iconFill:"#fff",iconOpacity:1,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelFill:t,labelFillOpacity:.85,labelLineHeight:16,labelPadding:[0,2],labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelOffsetY:2,lineWidth:0,portFill:n,portLineWidth:1,portStroke:a,portStrokeOpacity:.65,size:32,stroke:a,strokeOpacity:1,zIndex:2},state:{selected:{halo:!0,haloLineWidth:24,haloStrokeOpacity:o,labelFontSize:12,labelFontWeight:"bold",lineWidth:4,stroke:a},active:{halo:!0,haloLineWidth:12,haloStrokeOpacity:s},highlight:{labelFontWeight:"bold",lineWidth:4,stroke:a,strokeOpacity:.85},inactive:{badgeBackgroundOpacity:c,donutOpacity:c,fillOpacity:c,iconOpacity:l,labelFill:t,labelFillOpacity:c,strokeOpacity:c},disabled:{badgeBackgroundOpacity:.25,donutOpacity:u,fill:i,fillOpacity:u,iconFill:i,iconOpacity:.25,labelFill:t,labelFillOpacity:.25,strokeOpacity:u}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"node-expand",collapse:"node-collapse",update:[{fields:["x","y","fill","stroke"]}],translate:[{fields:["x","y"]}]}},edge:{palette:v,style:{badgeBackgroundFill:f,badgeFill:"#fff",badgeFontSize:8,badgeOffsetX:10,fillOpacity:1,halo:!1,haloLineWidth:12,haloStrokeOpacity:1,increasedLineWidthForHitTesting:2,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[4,4,4,4],labelFill:t,labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelPlacement:"center",labelTextBaseline:"middle",lineWidth:1,stroke:f,strokeOpacity:1,zIndex:1},state:{selected:{halo:!0,haloStrokeOpacity:.25,labelFontSize:14,labelFontWeight:"bold",lineWidth:3},active:{halo:!0,haloStrokeOpacity:.15},highlight:{labelFontWeight:"bold",lineWidth:3},inactive:{stroke:M,fillOpacity:.08,labelOpacity:.25,strokeOpacity:.08,badgeBackgroundOpacity:.25},disabled:{stroke:g,fillOpacity:.45,strokeOpacity:.45,labelOpacity:.25,badgeBackgroundOpacity:.45}},animation:{enter:"fade",exit:"fade",expand:"path-in",collapse:"path-out",show:"fade",hide:"fade",update:[{fields:["sourceNode","targetNode"]},{fields:["stroke"],shape:"key"}],translate:[{fields:["sourceNode","targetNode"]}]}},combo:{style:{collapsedMarkerFill:e,collapsedMarkerFontSize:12,collapsedMarkerFillOpacity:1,collapsedSize:32,collapsedFillOpacity:1,fill:p,halo:!1,haloLineWidth:12,haloStroke:m,haloStrokeOpacity:.25,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[2,4,2,4],labelFill:t,labelFontSize:12,labelFontWeight:400,labelOpacity:1,lineDash:0,lineWidth:1,fillOpacity:.04,strokeOpacity:1,padding:10,stroke:m},state:{selected:{halo:!0,labelFontSize:14,labelFontWeight:700,lineWidth:4},active:{halo:!0},highlight:{labelFontWeight:700,lineWidth:4},inactive:{fillOpacity:.65,labelOpacity:.25,strokeOpacity:.65},disabled:{fill:y,fillOpacity:.25,labelOpacity:.25,stroke:w,strokeOpacity:.25}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"combo-expand",collapse:"combo-collapse",update:[{fields:["x","y"]},{fields:["fill","stroke","lineWidth"],shape:"key"}],translate:[{fields:["x","y"]}]}}}}const lU={type:"group",color:["#637088","#0F55A6","#008383","#9C5D38","#8B53A6","#4E40A6","#8F6608","#3E801D","#A65383","#175E75","#0F8248"]},cU={bgColor:"#000000",comboColor:"#fdfdfd",comboColorDisabled:"#d0e4ff",comboStroke:"#99add1",comboStrokeDisabled:"#969696",edgeColor:"#637088",edgeColorDisabled:"#637088",edgeColorInactive:"#D0E4FF",edgePaletteOptions:lU,nodeColor:"#1783ff",nodeColorDisabled:"#D0E4FF",nodeHaloStrokeOpacityActive:.25,nodeHaloStrokeOpacitySelected:.45,nodeIconOpacityInactive:.45,nodeOpacityDisabled:.25,nodeOpacityInactive:.45,nodeStroke:"#d0e4ff",textColor:"#ffffff"},dU=nC(cU),hU={bgColor:"#ffffff",comboColor:"#99ADD1",comboColorDisabled:"#f0f0f0",comboStroke:"#99add1",comboStrokeDisabled:"#d9d9d9",edgeColor:"#99add1",edgeColorDisabled:"#d9d9d9",edgeColorInactive:"#1B324F",nodeColor:"#1783ff",nodeColorDisabled:"#1B324F",nodeHaloStrokeOpacityActive:.15,nodeHaloStrokeOpacitySelected:.25,nodeIconOpacityInactive:.85,nodeOpacityDisabled:.06,nodeOpacityInactive:.25,nodeStroke:"#000000",textColor:"#000000"},fU=nC(hU);class xa extends _m{beforeDraw(e,t){return e}afterLayout(e,t){}}class gU extends xa{beforeDraw(e){const{model:t}=this.context,n=e.add.combos,i=a=>{const s=[];return a.forEach((o,u)=>{const c=t.getAncestorsData(u,"combo").map(d=>Q(d)).reverse();s.push([u,o,c.length])}),new Map(s.sort(([,,o],[,,u])=>u-o).map(([o,u])=>[o,u]))};return e.add.combos=i(n),e.update.combos=i(e.update.combos),e}}function dr(r,e,t,n,i){const a=Q(n),s=`${t}s`,o=i?n:r.add[s].get(a)||r.update[s].get(a)||r.remove[s].get(a)||n;Object.entries(r).forEach(([u,l])=>{e===u?l[s].set(a,o):l[s].delete(a)})}function jl(r,e){return Object.keys(r).every(t=>r[t]===e[t])}class pU extends xa{beforeDraw(e,t){if(t.stage==="visibility"||!this.context.model.model.hasTreeStructure(ut))return e;const{model:n}=this.context,{add:i,update:a}=e,s=[...e.update.combos.entries(),...e.add.combos.entries()];for(;s.length;){const[o,u]=s.pop();if(Jn(u)){const l=n.getDescendantsData(o),c=l.map(Q),{internal:d,external:h}=Sy(c,f=>n.getRelatedEdgesData(f));l.forEach(f=>{const g=Q(f),v=s.findIndex(([y])=>y===g);v!==-1&&s.splice(v,1);const p=n.getElementType(g);dr(e,"remove",p,f)}),d.forEach(f=>dr(e,"remove","edge",f)),h.forEach(f=>{var g;const v=Q(f);((g=this.context.element)===null||g===void 0?void 0:g.getElement(v))?a.edges.set(v,f):i.edges.set(v,f)})}else{const l=n.getChildrenData(o),c=l.map(Q),{edges:d}=Sy(c,h=>n.getRelatedEdgesData(h));[...l,...d].forEach(h=>{var f;const g=Q(h),v=n.getElementType(g);((f=this.context.element)===null||f===void 0?void 0:f.getElement(g))?dr(e,"update",v,h):dr(e,"add",v,h),v==="combo"&&s.push([g,h])})}}return e}}const S_=(r,e,t,n)=>{const i=`${t}s`,a=Q(n);!r.add[i].has(a)&&!r.update[i].has(a)&&r[e][i].set(Q(n),n)};class vU extends xa{getElement(e){return this.context.element.getElement(e)}handleExpand(e,t){if(S_(t,"add","node",e),Jn(e))return;const n=Q(e);S_(t,"add","node",e),this.context.model.getRelatedEdgesData(n,"out").forEach(s=>{dr(t,"add","edge",s)}),this.context.model.getChildrenData(n).forEach(s=>{this.handleExpand(s,t)})}beforeDraw(e){const{graph:t,model:n}=this.context;if(!n.model.hasTreeStructure(ur))return e;const{add:{nodes:i,edges:a},update:{nodes:s}}=e,o=new Map,u=new Map;i.forEach((c,d)=>{Jn(c)&&o.set(d,c)}),a.forEach(c=>{if(t.getElementType(c.source)!=="node")return;const d=t.getNodeData(c.source);Jn(d)&&o.set(c.source,d)}),s.forEach((c,d)=>{const h=this.getElement(d);if(!h)return;const f=h.attributes.collapsed;Jn(c)?f||o.set(d,c):f&&u.set(d,c)});const l=new Set;return o.forEach((c,d)=>{n.getDescendantsData(d).forEach(f=>{const g=Q(f);if(l.has(g))return;dr(e,"remove","node",f),n.getRelatedEdgesData(g).forEach(p=>{dr(e,"remove","edge",p)}),l.add(g)})}),u.forEach((c,d)=>{if(n.getAncestorsData(d,ur).some(Jn)){dr(e,"remove","node",c);return}this.handleExpand(c,e)}),e}}function yU(r,e,t,n=!1){const i=vy[r][e];!n&&i?i!==t&&di.warn(`The extension ${e} of ${r} has been registered before.`):Object.assign(vy[r],{[e]:t})}/*!
 * @antv/g-plugin-dragndrop
 * @description A G plugin for Drag n Drop implemented with PointerEvents
 * @version 2.0.31
 * @date 1/17/2025, 2:06:58 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var rC=function(){function r(e){ce(this,r),this.dragndropPluginOptions=e}return de(r,[{key:"apply",value:function(t){var n=this,i=t.renderingService,a=t.renderingContext,s=a.root.ownerDocument,o=s.defaultView,u=function(c){var d=c.target,h=d===s,f=h&&n.dragndropPluginOptions.isDocumentDraggable?s:d.closest&&d.closest("[draggable=true]");if(f){var g=!1,v=c.timeStamp,p=[c.clientX,c.clientY],y=null,m=[c.clientX,c.clientY],w=function(){var S=da(Mn().mark(function T(A){var O,N,C,P,D,j;return Mn().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(g){V.next=8;break}if(O=A.timeStamp-v,N=Kn([A.clientX,A.clientY],p),!(O<=n.dragndropPluginOptions.dragstartTimeThreshold||N<=n.dragndropPluginOptions.dragstartDistanceThreshold)){V.next=5;break}return V.abrupt("return");case 5:A.type="dragstart",f.dispatchEvent(A),g=!0;case 8:if(A.type="drag",A.dx=A.clientX-m[0],A.dy=A.clientY-m[1],f.dispatchEvent(A),m=[A.clientX,A.clientY],h){V.next=21;break}return C=n.dragndropPluginOptions.overlap==="pointer"?[A.canvasX,A.canvasY]:d.getBounds().center,V.next=17,s.elementsFromPoint(C[0],C[1]);case 17:P=V.sent,D=P[P.indexOf(d)+1],j=(D==null?void 0:D.closest("[droppable=true]"))||(n.dragndropPluginOptions.isDocumentDroppable?s:null),y!==j&&(y&&(A.type="dragleave",A.target=y,y.dispatchEvent(A)),j&&(A.type="dragenter",A.target=j,j.dispatchEvent(A)),y=j,y&&(A.type="dragover",A.target=y,y.dispatchEvent(A)));case 21:case"end":return V.stop()}},T)}));return function(A){return S.apply(this,arguments)}}();o.addEventListener("pointermove",w);var M=function(T){if(g){T.detail={preventClick:!0};var A=T.clone();y&&(A.type="drop",A.target=y,y.dispatchEvent(A)),A.type="dragend",f.dispatchEvent(A),g=!1}o.removeEventListener("pointermove",w)};d.addEventListener("pointerup",M,{once:!0}),d.addEventListener("pointerupoutside",M,{once:!0})}};i.hooks.init.tap(r.tag,function(){o.addEventListener("pointerdown",u)}),i.hooks.destroy.tap(r.tag,function(){o.removeEventListener("pointerdown",u)})}}])}();rC.tag="Dragndrop";var mU=function(r){function e(){var t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ce(this,e),t=Ge(this,e),t.name="dragndrop",t.options=n,t}return We(e,r),de(e,[{key:"init",value:function(){this.addRenderingPlugin(new rC(qe({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}},{key:"setOptions",value:function(n){Object.assign(this.plugins[0].dragndropPluginOptions,n)}}])}(ga),__=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})},T_=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};const O_=["main"],A_=["background","main","label","transient"];function bU(r){return r.main}class k_{getConfig(){return this.config}getLayer(e="main"){return this.extends.layers[e]||bU(this.getLayers())}getLayers(){return this.extends.layers}getRenderer(e){return this.extends.renderers[e]}getCamera(e="main"){return this.getLayer(e).getCamera()}getRoot(e="main"){return this.getLayer(e).getRoot()}getContextService(e="main"){return this.getLayer(e).getContextService()}setCursor(e){this.config.cursor=e,this.getLayer().setCursor(e)}get document(){return this.getLayer().document}get context(){return this.getLayer().context}constructor(e){this.config={enableMultiLayer:!0},Object.assign(this.config,e);const t=this.config,{renderer:n,background:i,cursor:a,enableMultiLayer:s}=t,o=T_(t,["renderer","background","cursor","enableMultiLayer"]),u=s?A_:O_,l=N_(n,u),c=Object.fromEntries(u.map(d=>{const h=new py(Object.assign(Object.assign({},o),{supportsMutipleCanvasesInOneContainer:s,renderer:l[d],background:s?d==="background"?i:void 0:i}));return[d,h]}));C_(c),this.extends={config:this.config,renderer:n,renderers:l,layers:c}}get ready(){return Promise.all(Object.entries(this.getLayers()).map(([,e])=>e.ready))}resize(e,t){Object.assign(this.extends.config,{width:e,height:t}),Object.values(this.getLayers()).forEach(n=>{const i=n.getCamera(),a=i.getPosition(),s=i.getFocalPoint();n.resize(e,t),i.setPosition(a),i.setFocalPoint(s)})}getBounds(e){return hu(Object.values(this.getLayers()).map(t=>e?t.getRoot().childNodes.find(i=>i.classList.includes(e)):t.getRoot()).filter(t=>(t==null?void 0:t.childNodes.length)>0).map(t=>t.getBounds()))}getContainer(){const e=this.extends.config.container;return typeof e=="string"?document.getElementById(e):e}getSize(){return[this.extends.config.width||0,this.extends.config.height||0]}appendChild(e,t){var n;const i=((n=e.style)===null||n===void 0?void 0:n.$layer)||"main";return this.getLayer(i).appendChild(e,t)}setRenderer(e){if(e===this.extends.renderer)return;const t=N_(e,this.config.enableMultiLayer?A_:O_);this.extends.renderers=t,Object.entries(t).forEach(([n,i])=>this.getLayer(n).setRenderer(i)),C_(this.getLayers())}getCanvasByViewport(e){return En(this.getLayer().viewport2Canvas(Br(e)))}getViewportByCanvas(e){return En(this.getLayer().canvas2Viewport(Br(e)))}getViewportByClient(e){return En(this.getLayer().client2Viewport(Br(e)))}getClientByViewport(e){return En(this.getLayer().viewport2Client(Br(e)))}getClientByCanvas(e){return this.getClientByViewport(this.getViewportByCanvas(e))}getCanvasByClient(e){const t=this.getLayer(),n=t.client2Viewport(Br(e));return En(t.viewport2Canvas(n))}toDataURL(){return __(this,arguments,void 0,function*(e={}){const t=globalThis.devicePixelRatio||1,{mode:n="viewport"}=e,i=T_(e,["mode"]);let[a,s,o,u]=[0,0,0,0];if(n==="viewport")[o,u]=this.getSize();else if(n==="overall"){const y=this.getBounds(),m=pa(y);[a,s]=y.min,[o,u]=m}const l=J0('<div id="virtual-image"></div>'),c=new py({width:o,height:u,renderer:new Bc,devicePixelRatio:t,container:l,background:this.extends.config.background});yield c.ready,c.appendChild(this.getLayer("background").getRoot().cloneNode(!0)),c.appendChild(this.getRoot().cloneNode(!0));const d=this.getLayer("label").getRoot().cloneNode(!0),h=c.viewport2Canvas({x:0,y:0}),f=this.getCanvasByViewport([0,0]);d.translate([f[0]-h.x,f[1]-h.y]),d.scale(1/this.getCamera().getZoom()),c.appendChild(d),c.appendChild(this.getLayer("transient").getRoot().cloneNode(!0));const g=this.getCamera(),v=c.getCamera();if(n==="viewport")v.setZoom(g.getZoom()),v.setPosition(g.getPosition()),v.setFocalPoint(g.getFocalPoint());else if(n==="overall"){const[y,m,w]=v.getPosition(),[M,S,T]=v.getFocalPoint();v.setPosition([y+a,m+s,w]),v.setFocalPoint([M+a,S+s,T])}const p=c.getContextService();return new Promise(y=>{c.addEventListener(or.RERENDER,()=>__(this,void 0,void 0,function*(){yield new Promise(w=>setTimeout(w,300));const m=yield p.toDataURL(i);y(m)}))})})}destroy(){Object.values(this.getLayers()).forEach(e=>{e.getCamera().cancelLandmarkAnimation(),e.destroy()})}}function N_(r,e){return Object.fromEntries(e.map(t=>{const n=(r==null?void 0:r(t))||new Bc;return t==="main"?n.registerPlugin(new mU({isDocumentDraggable:!0,isDocumentDroppable:!0,dragstartDistanceThreshold:10,dragstartTimeThreshold:100})):n.unregisterPlugin(n.getPlugin("dom-interaction")),[t,n]}))}function C_(r){Object.entries(r).forEach(([e,t])=>{const n=t.getContextService().getDomElement();n!=null&&n.style&&(n.style.gridArea="1 / 1 / 2 / 2",n.style.outline="none",n.tabIndex=1,e!=="main"&&(n.style.pointerEvents="none")),n!=null&&n.parentElement&&(n.parentElement.style.display="grid")})}const ys=r=>r?parseInt(r):0;function wU(r){const e=getComputedStyle(r),t=r.clientWidth||ys(e.width),n=r.clientHeight||ys(e.height),i=ys(e.paddingLeft)+ys(e.paddingRight),a=ys(e.paddingTop)+ys(e.paddingBottom);return[t-i,n-a]}function P_(r){if(!r)return[0,0];let e=640,t=480;const[n,i]=wU(r);e=n||e,t=i||t;const a=1,s=1;return[Math.max(Ee(e)?e:a,a),Math.max(Ee(t)?t:s,s)]}class Vd{constructor(e){this.type=e}}class Zt extends Vd{constructor(e,t){super(e),this.data=t}}class _r extends Vd{constructor(e,t,n,i){super(e),this.animationType=t,this.animation=n,this.data=i}}class ms extends Vd{constructor(e,t,n){super(e),this.elementType=t,this.data=n}}class Tl extends Vd{constructor(e,t){super(e),this.data=t}}function sn(r,e){r.emit(e.type,e)}function xU(r){if(!r)return null;if(r instanceof mO)return{type:"canvas",element:r};let e=r;for(;e;){if(yu(e))return{type:"node",element:e};if(_A(e))return{type:"edge",element:e};if(Im(e))return{type:"combo",element:e};e=e.parentElement}return null}function L_(r){var e;return((e=r==null?void 0:r.style)===null||e===void 0?void 0:e.zIndex)||0}const Do="cachedStyle",w1=r=>`__${r}__`;function EU(r,e){const t=Array.isArray(e)?e:[e];Fn(r,Do)||jo(r,Do,{}),t.forEach(n=>{jo(Fn(r,Do),w1(n),r.attributes[n])})}function D_(r,e){return Fn(r,[Do,w1(e)])}function MU(r,e){return w1(e)in(Fn(r,Do)||{})}class SU{constructor(e){this.tasks=[],this.animations=new Set,this.context=e}getTasks(){const e=[...this.tasks];return this.tasks=[],e}add(e,t){this.tasks.push([e,t])}animate(e,t,n){var i,a,s;(i=t==null?void 0:t.before)===null||i===void 0||i.call(t);const o=this.getTasks().map(([l,c])=>{var d,h,f;const{element:g,elementType:v,stage:p}=l,y=l5(this.context.options,v,p,e);(d=c==null?void 0:c.before)===null||d===void 0||d.call(c);const m=y.length?d5(g,this.inferStyle(l,n),y):null;return m?((h=c==null?void 0:c.beforeAnimate)===null||h===void 0||h.call(c,m),m.finished.then(()=>{var w,M;(w=c==null?void 0:c.afterAnimate)===null||w===void 0||w.call(c,m),(M=c==null?void 0:c.after)===null||M===void 0||M.call(c),this.animations.delete(m)})):(f=c==null?void 0:c.after)===null||f===void 0||f.call(c),m}).filter(Boolean);o.forEach(l=>this.animations.add(l));const u=xm(o);return u?((a=t==null?void 0:t.beforeAnimate)===null||a===void 0||a.call(t,u),u.finished.then(()=>{var l,c;(l=t==null?void 0:t.afterAnimate)===null||l===void 0||l.call(t,u),(c=t==null?void 0:t.after)===null||c===void 0||c.call(t),this.release()})):(s=t==null?void 0:t.after)===null||s===void 0||s.call(t),u}inferStyle(e,t){var n,i;const{element:a,elementType:s,stage:o,originalStyle:u,updatedStyle:l={}}=e;e.modifiedStyle||(e.modifiedStyle=Object.assign(Object.assign({},u),l));const{modifiedStyle:c}=e,d={},h={};if(o==="enter")Object.assign(d,{opacity:0});else if(o==="exit")Object.assign(h,{opacity:0});else if(o==="show")Object.assign(d,{opacity:0}),Object.assign(h,{opacity:(n=D_(a,"opacity"))!==null&&n!==void 0?n:qo("opacity")});else if(o==="hide")Object.assign(d,{opacity:(i=D_(a,"opacity"))!==null&&i!==void 0?i:qo("opacity")}),Object.assign(h,{opacity:0});else if(o==="collapse"){const{collapse:f}=t||{},{target:g,descendants:v,position:p}=f;if(s==="node"){if(v.includes(a.id)){const[y,m,w]=p;Object.assign(h,{x:y,y:m,z:w})}}else if(s==="combo"){if(a.id===g||v.includes(a.id)){const[y,m]=p;Object.assign(h,{x:y,y:m,childrenNode:u.childrenNode})}}else s==="edge"&&Object.assign(h,{sourceNode:c.sourceNode,targetNode:c.targetNode})}else if(o==="expand"){const{expand:f}=t||{},{target:g,descendants:v,position:p}=f;if(s==="node"){if(a.id===g||v.includes(a.id)){const[y,m,w]=p;Object.assign(d,{x:y,y:m,z:w})}}else if(s==="combo"){if(a.id===g||v.includes(a.id)){const[y,m,w]=p;Object.assign(d,{x:y,y:m,z:w,childrenNode:c.childrenNode})}}else s==="edge"&&Object.assign(d,{sourceNode:c.sourceNode,targetNode:c.targetNode})}return[Object.keys(d).length>0?Object.assign({},u,d):u,Object.keys(h).length>0?Object.assign({},c,h):c]}stop(){this.animations.forEach(e=>e.cancel())}clear(){this.tasks=[]}release(){var e,t;const{canvas:n}=this.context,i=(t=(e=n.document)===null||e===void 0?void 0:e.timeline)===null||t===void 0?void 0:t.animationsWithPromises;i&&(n.document.timeline.animationsWithPromises=i.filter(a=>a.playState!=="finished"))}destroy(){this.stop(),this.animations.clear(),this.tasks=[]}}class _U{constructor(e){this.batchCount=0,this.context=e}emit(e){const{graph:t}=this.context;t.emit(e.type,e)}startBatch(e=!0){this.batchCount++,this.batchCount===1&&this.emit(new Zt(ve.BATCH_START,{initiate:e}))}endBatch(){this.batchCount--,this.batchCount===0&&this.emit(new Zt(ve.BATCH_END))}get isBatching(){return this.batchCount>0}destroy(){this.context=null}}class TU extends Sm{constructor(e){super(e),this.currentTarget=null,this.currentTargetType=null,this.category="behavior",this.forwardCanvasEvents=t=>{const{target:n}=t,i=xU(n);if(!i)return;const{graph:a,canvas:s}=this.context,{type:o,element:u}=i;if("destroyed"in u&&(Yc(u)||u.destroyed))return;const{type:l,detail:c,button:d}=t,h=Object.assign(Object.assign({},t),{target:u,targetType:o,originalTarget:n});l===ae.POINTER_MOVE&&(this.currentTarget!==u&&(this.currentTarget&&a.emit(`${this.currentTargetType}:${ae.POINTER_LEAVE}`,Object.assign(Object.assign({},h),{type:ae.POINTER_LEAVE,target:this.currentTarget,targetType:this.currentTargetType})),u&&(Object.assign(h,{type:ae.POINTER_ENTER}),a.emit(`${o}:${ae.POINTER_ENTER}`,h))),this.currentTarget=u,this.currentTargetType=o),l===ae.CLICK&&d===2||(a.emit(`${o}:${l}`,h),a.emit(l,h)),l===ae.CLICK&&c===2&&(Object.assign(h,{type:ae.DBLCLICK}),a.emit(`${o}:${ae.DBLCLICK}`,h),a.emit(ae.DBLCLICK,h)),l===ae.POINTER_DOWN&&d===2&&(Object.assign(h,{type:ae.CONTEXT_MENU,preventDefault:()=>{var f;(f=s.getContainer())===null||f===void 0||f.addEventListener(ae.CONTEXT_MENU,g=>g.preventDefault(),{once:!0})}}),a.emit(`${o}:${ae.CONTEXT_MENU}`,h),a.emit(ae.CONTEXT_MENU,h))},this.forwardContainerEvents=t=>{this.context.graph.emit(t.type,t)},this.forwardEvents(),this.setBehaviors(this.context.options.behaviors||[])}setBehaviors(e){this.setExtensions(e)}forwardEvents(){const e=this.context.canvas.getContainer();e&&[Ss.KEY_DOWN,Ss.KEY_UP].forEach(n=>{e.addEventListener(n,this.forwardContainerEvents)});const t=this.context.canvas.document;t&&[ae.CLICK,ae.DBLCLICK,ae.POINTER_OVER,ae.POINTER_LEAVE,ae.POINTER_ENTER,ae.POINTER_MOVE,ae.POINTER_OUT,ae.POINTER_DOWN,ae.POINTER_UP,ae.CONTEXT_MENU,ae.DRAG_START,ae.DRAG,ae.DRAG_END,ae.DRAG_ENTER,ae.DRAG_OVER,ae.DRAG_LEAVE,ae.DROP,ae.WHEEL].forEach(n=>{t.addEventListener(n,this.forwardCanvasEvents)})}destroy(){const e=this.context.canvas.getContainer();e&&[Ss.KEY_DOWN,Ss.KEY_UP].forEach(t=>{e.removeEventListener(t,this.forwardContainerEvents)}),this.context.canvas.document.removeAllEventListeners(),super.destroy()}}var Qo=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};function Gi(r,e){const{data:t,style:n}=r,i=Qo(r,["data","style"]),{data:a,style:s}=e,o=Qo(e,["data","style"]),u=Object.assign(Object.assign({},i),o);return(t||a)&&Object.assign(u,{data:Object.assign(Object.assign({},t),a)}),(n||s)&&Object.assign(u,{style:Object.assign(Object.assign({},n),s)}),u}function B0(r){const{data:e,style:t}=r,i=Qo(r,["data","style"]);return e&&(i.data=Object.assign({},e)),t&&(i.style=Object.assign({},t)),i}function bs(r={},e={}){const{states:t=[],data:n={},style:i={},children:a=[]}=r,s=Qo(r,["states","data","style","children"]),{states:o=[],data:u={},style:l={},children:c=[]}=e,d=Qo(e,["states","data","style","children"]),h=(g,v)=>g.length!==v.length?!1:g.every((p,y)=>p===v[y]),f=(g,v)=>{const p=Object.keys(g),y=Object.keys(v);return p.length!==y.length?!1:p.every(m=>g[m]===v[m])};return!(!f(s,d)||!h(a,c)||!h(t,o)||!f(n,u)||!f(i,l))}var OU=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};function F0(r){const{id:e=Q(r),style:t,data:n}=r,i=OU(r,["id","style","data"]),a=Object.assign(Object.assign({},r),{style:Object.assign({},t),data:Object.assign({},n)});return y5(r)?Object.assign({id:e,data:a},i):{id:e,data:a}}function hn(r){return r.data}function AU(r){if(r.hasTreeStructure(ur))return;r.attachTreeStructure(ur);const e=r.getAllEdges();for(const t of e){const{source:n,target:i}=t;r.setParent(i,n,ur)}}class kU{constructor(){this.latestRemovedComboIds=new Set,this.comboIds=new Set,this.changes=[],this.batchCount=0,this.isTraceless=!1,this.enableUpdateNodeLikeHierarchy=!0,this.model=new cn}pushChange(e){if(this.isTraceless)return;const{type:t}=e;if(t===Mt.NodeUpdated||t===Mt.EdgeUpdated||t===Mt.ComboUpdated){const{value:n,original:i}=e;this.changes.push({value:B0(n),original:B0(i),type:t})}else this.changes.push({value:B0(e.value),type:t})}getChanges(){return this.changes}clearChanges(){this.changes=[]}batch(e){this.batchCount++,this.model.batch(e),this.batchCount--}isBatching(){return this.batchCount>0}silence(e){this.isTraceless=!0,e(),this.isTraceless=!1}isCombo(e){return this.comboIds.has(e)||this.latestRemovedComboIds.has(e)}getData(){return{nodes:this.getNodeData(),edges:this.getEdgeData(),combos:this.getComboData()}}getNodeData(e){return this.model.getAllNodes().reduce((t,n)=>{const i=hn(n);return this.isCombo(Q(i))||(e===void 0||e.includes(Q(i)))&&t.push(i),t},[])}getEdgeDatum(e){return hn(this.model.getEdge(e))}getEdgeData(e){return this.model.getAllEdges().reduce((t,n)=>{const i=hn(n);return(e===void 0||e.includes(Q(i)))&&t.push(i),t},[])}getComboData(e){return this.model.getAllNodes().reduce((t,n)=>{const i=hn(n);return this.isCombo(Q(i))&&(e===void 0||e.includes(Q(i)))&&t.push(i),t},[])}getRootsData(e=ur){return this.model.getRoots(e).map(hn)}getAncestorsData(e,t){const{model:n}=this;return!n.hasNode(e)||!n.hasTreeStructure(t)?[]:n.getAncestors(e,t).map(hn)}getDescendantsData(e){const t=this.getElementDataById(e),n=[];return Ls(t,i=>{i!==t&&n.push(i)},i=>this.getChildrenData(Q(i)),"TB"),n}getParentData(e,t){const{model:n}=this;if(!t){di.warn("The hierarchy structure key is not specified");return}if(!n.hasNode(e)||!n.hasTreeStructure(t))return;const i=n.getParent(e,t);return i?hn(i):void 0}getChildrenData(e){const t=this.getElementType(e)==="node"?ur:ut,{model:n}=this;return!n.hasNode(e)||!n.hasTreeStructure(t)?[]:n.getChildren(e,t).map(hn)}getElementsDataByType(e){return e==="node"?this.getNodeData():e==="edge"?this.getEdgeData():e==="combo"?this.getComboData():[]}getElementDataById(e){return this.getElementType(e)==="edge"?this.getEdgeDatum(e):this.getNodeLikeDatum(e)}getNodeLikeDatum(e){const t=this.model.getNode(e);return hn(t)}getNodeLikeData(e){return this.model.getAllNodes().reduce((t,n)=>{const i=hn(n);return e?e.includes(Q(i))&&t.push(i):t.push(i),t},[])}getElementDataByState(e,t){return this.getElementsDataByType(e).filter(i=>{var a;return(a=i.states)===null||a===void 0?void 0:a.includes(t)})}getElementState(e){var t;return((t=this.getElementDataById(e))===null||t===void 0?void 0:t.states)||[]}hasNode(e){return this.model.hasNode(e)&&!this.isCombo(e)}hasEdge(e){return this.model.hasEdge(e)}hasCombo(e){return this.model.hasNode(e)&&this.isCombo(e)}getRelatedEdgesData(e,t="both"){return this.model.getRelatedEdges(e,t).map(hn)}getNeighborNodesData(e){return this.model.getNeighbors(e).map(hn)}setData(e){const{nodes:t=[],edges:n=[],combos:i=[]}=e,{nodes:a,edges:s,combos:o}=this.getData(),u=aa(a,t,d=>Q(d),bs),l=aa(s,n,d=>Q(d),bs),c=aa(o,i,d=>Q(d),bs);this.batch(()=>{const d={nodes:u.enter,edges:l.enter,combos:c.enter};this.addData(d),this.computeZIndex(d,"add",!0);const h={nodes:u.update,edges:l.update,combos:c.update};this.updateData(h),this.computeZIndex(h,"update",!0);const f={nodes:u.exit.map(Q),edges:l.exit.map(Q),combos:c.exit.map(Q)};this.removeData(f)})}addData(e){const{nodes:t,edges:n,combos:i}=e;this.batch(()=>{this.addComboData(i),this.addNodeData(t),this.addEdgeData(n)}),this.computeZIndex(e,"add")}addNodeData(e=[]){e.length&&(this.model.addNodes(e.map(t=>(this.pushChange({value:t,type:Mt.NodeAdded}),F0(t)))),this.updateNodeLikeHierarchy(e),this.computeZIndex({nodes:e},"add"))}addEdgeData(e=[]){e.length&&(this.model.addEdges(e.map(t=>(this.pushChange({value:t,type:Mt.EdgeAdded}),F0(t)))),this.computeZIndex({edges:e},"add"))}addComboData(e=[]){if(!e.length)return;const{model:t}=this;t.hasTreeStructure(ut)||t.attachTreeStructure(ut),t.addNodes(e.map(n=>(this.comboIds.add(Q(n)),this.pushChange({value:n,type:Mt.ComboAdded}),F0(n)))),this.updateNodeLikeHierarchy(e),this.computeZIndex({combos:e},"add")}addChildrenData(e,t){const n=this.getNodeLikeDatum(e),i=t.map(Q);this.addNodeData(t),this.updateNodeData([{id:e,children:[...n.children||[],...i]}]),this.addEdgeData(i.map(a=>({source:e,target:a})))}computeZIndex(e,t,n=!1){!n&&this.isBatching()||this.batch(()=>{const{nodes:i=[],edges:a=[],combos:s=[]}=e;s.forEach(o=>{var u,l,c;const d=Q(o);if(t==="add"&&Ee((u=o.style)===null||u===void 0?void 0:u.zIndex)||t==="update"&&!("combo"in o))return;const h=this.getParentData(d,ut),f=h?((c=(l=h.style)===null||l===void 0?void 0:l.zIndex)!==null&&c!==void 0?c:0)+1:0;this.preventUpdateNodeLikeHierarchy(()=>{this.updateComboData([{id:d,style:{zIndex:f}}])})}),i.forEach(o=>{var u,l,c;const d=Q(o);if(t==="add"&&Ee((u=o.style)===null||u===void 0?void 0:u.zIndex)||t==="update"&&!("combo"in o)&&!("children"in o))return;let h=0;const f=this.getParentData(d,ut);if(f)h=(((l=f.style)===null||l===void 0?void 0:l.zIndex)||0)+1;else{const g=this.getParentData(d,ur);g&&(h=((c=g==null?void 0:g.style)===null||c===void 0?void 0:c.zIndex)||0)}this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:d,style:{zIndex:h}}])})}),a.forEach(o=>{var u,l,c,d,h;if(Ee((u=o.style)===null||u===void 0?void 0:u.zIndex))return;let{id:f,source:g,target:v}=o;if(!f)f=Q(o);else{const m=this.getEdgeDatum(f);g=m.source,v=m.target}if(!g||!v)return;const p=((c=(l=this.getNodeLikeDatum(g))===null||l===void 0?void 0:l.style)===null||c===void 0?void 0:c.zIndex)||0,y=((h=(d=this.getNodeLikeDatum(v))===null||d===void 0?void 0:d.style)===null||h===void 0?void 0:h.zIndex)||0;this.updateEdgeData([{id:Q(o),style:{zIndex:Math.max(p,y)-1}}])})})}getFrontZIndex(e){var t;const n=this.getElementType(e),i=this.getElementDataById(e),a=this.getData();if(Object.assign(a,{[`${n}s`]:a[`${n}s`].filter(s=>Q(s)!==e)}),n==="combo"&&!Jn(i)){const s=new Set(this.getAncestorsData(e,ut).map(Q));a.nodes=a.nodes.filter(o=>!s.has(Q(o))),a.combos=a.combos.filter(o=>!s.has(Q(o))),a.edges=a.edges.filter(({source:o,target:u})=>!s.has(o)&&!s.has(u))}return Math.max(((t=i.style)===null||t===void 0?void 0:t.zIndex)||0,0,...Object.values(a).flat().map(s=>{var o;return(((o=s==null?void 0:s.style)===null||o===void 0?void 0:o.zIndex)||0)+1}))}updateNodeLikeHierarchy(e){if(!this.enableUpdateNodeLikeHierarchy)return;const{model:t}=this;e.forEach(n=>{const i=Q(n),a=il(n);a!==void 0&&(t.hasTreeStructure(ut)||t.attachTreeStructure(ut),a===null&&this.refreshComboData(i),this.setParent(i,il(n),ut));const s=n.children||[];if(s.length){t.hasTreeStructure(ur)||t.attachTreeStructure(ur);const o=s.filter(u=>t.hasNode(u));o.forEach(u=>this.setParent(u,i,ur)),o.length!==s.length&&this.updateNodeData([{id:i,children:o}])}})}preventUpdateNodeLikeHierarchy(e){this.enableUpdateNodeLikeHierarchy=!1,e(),this.enableUpdateNodeLikeHierarchy=!0}updateData(e){const{nodes:t,edges:n,combos:i}=e;this.batch(()=>{this.updateNodeData(t),this.updateComboData(i),this.updateEdgeData(n)}),this.computeZIndex(e,"update")}updateNodeData(e=[]){if(!e.length)return;const{model:t}=this;this.batch(()=>{const n=[];e.forEach(i=>{const a=Q(i),s=hn(t.getNode(a));if(bs(s,i))return;const o=Gi(s,i);this.pushChange({value:o,original:s,type:Mt.NodeUpdated}),t.mergeNodeData(a,o),n.push(o)}),this.updateNodeLikeHierarchy(n)}),this.computeZIndex({nodes:e},"update")}refreshData(){const{nodes:e,edges:t,combos:n}=this.getData();e.forEach(i=>{this.pushChange({value:i,original:i,type:Mt.NodeUpdated})}),t.forEach(i=>{this.pushChange({value:i,original:i,type:Mt.EdgeUpdated})}),n.forEach(i=>{this.pushChange({value:i,original:i,type:Mt.ComboUpdated})})}syncNodeLikeDatum(e){const{model:t}=this,n=Q(e);if(!t.hasNode(n))return;const i=hn(t.getNode(n)),a=Gi(i,e);t.mergeNodeData(n,a)}syncEdgeDatum(e){const{model:t}=this,n=Q(e);if(!t.hasEdge(n))return;const i=hn(t.getEdge(n)),a=Gi(i,e);t.mergeEdgeData(n,a)}updateEdgeData(e=[]){if(!e.length)return;const{model:t}=this;this.batch(()=>{e.forEach(n=>{const i=Q(n),a=hn(t.getEdge(i));if(bs(a,n))return;n.source&&a.source!==n.source&&t.updateEdgeSource(i,n.source),n.target&&a.target!==n.target&&t.updateEdgeTarget(i,n.target);const s=Gi(a,n);this.pushChange({value:s,original:a,type:Mt.EdgeUpdated}),t.mergeEdgeData(i,s)})}),this.computeZIndex({edges:e},"update")}updateComboData(e=[]){if(!e.length)return;const{model:t}=this;t.batch(()=>{const n=[];e.forEach(i=>{const a=Q(i),s=hn(t.getNode(a));if(bs(s,i))return;const o=Gi(s,i);this.pushChange({value:o,original:s,type:Mt.ComboUpdated}),t.mergeNodeData(a,o),n.push(o)}),this.updateNodeLikeHierarchy(n)}),this.computeZIndex({combos:e},"update")}setParent(e,t,n,i=!0){if(e===t)return;const a=this.getNodeLikeDatum(e),s=il(a);if(s!==t&&n===ut){const o={id:e,combo:t};this.isCombo(e)?this.syncNodeLikeDatum(o):this.syncNodeLikeDatum(o)}this.model.setParent(e,t,n),i&&n===ut&&PL([s,t]).forEach(o=>{o!==void 0&&this.refreshComboData(o)})}refreshComboData(e){const t=this.getComboData([e])[0],n=this.getAncestorsData(e,ut);t&&this.pushChange({value:t,original:t,type:Mt.ComboUpdated}),n.forEach(i=>{this.pushChange({value:i,original:i,type:Mt.ComboUpdated})})}getElementPosition(e){const t=this.getElementDataById(e);return on(t)}translateNodeLikeBy(e,t){this.isCombo(e)?this.translateComboBy(e,t):this.translateNodeBy(e,t)}translateNodeLikeTo(e,t){this.isCombo(e)?this.translateComboTo(e,t):this.translateNodeTo(e,t)}translateNodeBy(e,t){const n=this.getElementPosition(e),i=$e(n,[...t,0].slice(0,3));this.translateNodeTo(e,i)}translateNodeTo(e,t){const[n=0,i=0,a=0]=t;this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:e,style:{x:n,y:i,z:a}}])})}translateComboBy(e,t){const[n=0,i=0,a=0]=t;if([n,i,a].some(isNaN)||[n,i,a].every(u=>u===0))return;const s=this.getComboData([e])[0];if(!s)return;const o=new Set;Ls(s,u=>{const l=Q(u);if(o.has(l))return;o.add(l);const[c,d,h]=on(u),f=Gi(u,{style:{x:c+n,y:d+i,z:h+a}});this.pushChange({value:f,original:u,type:this.isCombo(l)?Mt.ComboUpdated:Mt.NodeUpdated}),this.model.mergeNodeData(l,f)},u=>this.getChildrenData(Q(u)),"BT")}translateComboTo(e,t){var n;if(t.some(isNaN))return;const[i=0,a=0,s=0]=t,o=(n=this.getComboData([e]))===null||n===void 0?void 0:n[0];if(!o)return;const[u,l,c]=on(o),d=i-u,h=a-l,f=s-c;Ls(o,g=>{const v=Q(g),[p,y,m]=on(g),w=Gi(g,{style:{x:p+d,y:y+h,z:m+f}});this.pushChange({value:w,original:g,type:this.isCombo(v)?Mt.ComboUpdated:Mt.NodeUpdated}),this.model.mergeNodeData(v,w)},g=>this.getChildrenData(Q(g)),"BT")}removeData(e){const{nodes:t,edges:n,combos:i}=e;this.batch(()=>{this.removeEdgeData(n),this.removeNodeData(t),this.removeComboData(i),this.latestRemovedComboIds=new Set(i)})}removeNodeData(e=[]){e.length&&this.batch(()=>{e.forEach(t=>{this.removeEdgeData(this.getRelatedEdgesData(t).map(Q)),this.pushChange({value:this.getNodeData([t])[0],type:Mt.NodeRemoved}),this.removeNodeLikeHierarchy(t)}),this.model.removeNodes(e)})}removeEdgeData(e=[]){e.length&&(e.forEach(t=>this.pushChange({value:this.getEdgeData([t])[0],type:Mt.EdgeRemoved})),this.model.removeEdges(e))}removeComboData(e=[]){e.length&&this.batch(()=>{e.forEach(t=>{this.pushChange({value:this.getComboData([t])[0],type:Mt.ComboRemoved}),this.removeNodeLikeHierarchy(t),this.comboIds.delete(t)}),this.model.removeNodes(e)})}removeNodeLikeHierarchy(e){if(this.model.hasTreeStructure(ut)){const t=il(this.getNodeLikeDatum(e));this.setParent(e,void 0,ut,!1),this.model.getChildren(e,ut).forEach(n=>{const i=hn(n),a=Q(i);this.setParent(Q(i),t,ut,!1);const s=Gi(i,{id:Q(i),combo:t});this.pushChange({value:s,original:i,type:this.isCombo(a)?Mt.ComboUpdated:Mt.NodeUpdated}),this.model.mergeNodeData(Q(i),s)}),Le(t)||this.refreshComboData(t)}}getElementType(e){if(this.model.hasNode(e))return this.isCombo(e)?"combo":"node";if(this.model.hasEdge(e))return"edge";throw new Error(_i(`Unknown element type of id: ${e}`))}destroy(){const{model:e}=this,t=e.getAllNodes(),n=e.getAllEdges();e.removeEdges(n.map(i=>i.id)),e.removeNodes(t.map(i=>i.id)),this.context={}}}var co=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})};class NU{constructor(e){this.elementMap={},this.shapeTypeMap={},this.paletteStyle={},this.defaultStyle={},this.stateStyle={},this.visibilityCache=new WeakMap,this.context=e}init(){this.initContainer()}initContainer(){if(!this.container||this.container.destroyed){const{canvas:e}=this.context;this.container=e.appendChild(new ln({className:"elements"}))}}emit(e,t){t.silence||sn(this.context.graph,e)}forEachElementData(e){Ua.forEach(t=>{const n=this.context.model.getElementsDataByType(t);e(t,n)})}getElementType(e,t){var n;const{options:i,graph:a}=this.context,s=((n=i[e])===null||n===void 0?void 0:n.type)||t.type;return s?typeof s=="string"?s:s.call(a,t):e==="edge"?"line":"circle"}getTheme(e){return NO(this.context.options)[e]||{}}getThemeStyle(e){return this.getTheme(e).style||{}}getThemeStateStyle(e,t){const{state:n={}}=this.getTheme(e);return Object.assign({},...t.map(i=>n[i]||{}))}computePaletteStyle(){const{options:e}=this.context;this.paletteStyle={},this.forEachElementData((t,n)=>{var i,a;const s=Object.assign({},Fb((i=this.getTheme(t))===null||i===void 0?void 0:i.palette),Fb((a=e[t])===null||a===void 0?void 0:a.palette));s!=null&&s.field&&Object.assign(this.paletteStyle,h6(n,s))})}getPaletteStyle(e,t){const n=this.paletteStyle[t];return n?e==="edge"?{stroke:n}:{fill:n}:{}}computeElementDefaultStyle(e,t){var n;const{options:i}=this.context,a=((n=i[e])===null||n===void 0?void 0:n.style)||{};"transform"in a&&Array.isArray(a.transform)&&(a.transform=[...a.transform]),this.defaultStyle[Q(t.datum)]=Bb(a,t)}computeElementsDefaultStyle(e){const{graph:t}=this.context;this.forEachElementData((n,i)=>{const a=i.length;for(let s=0;s<a;s++){const o=i[s];(e===void 0||e.includes(Q(o)))&&this.computeElementDefaultStyle(n,{datum:o,graph:t})}})}getDefaultStyle(e){return this.defaultStyle[e]||{}}getElementState(e){try{const{model:t}=this.context;return t.getElementState(e)}catch{return[]}}getElementStateStyle(e,t,n){var i,a;const{options:s}=this.context,o=((a=(i=s[e])===null||i===void 0?void 0:i.state)===null||a===void 0?void 0:a[t])||{};return Bb(o,n)}computeElementStatesStyle(e,t,n){this.stateStyle[Q(n.datum)]=Object.assign({},...t.map(i=>this.getElementStateStyle(e,i,n)))}computeElementsStatesStyle(e){const{graph:t}=this.context;this.forEachElementData((n,i)=>{const a=i.length;for(let s=0;s<a;s++){const o=i[s];if(e===void 0||e.includes(Q(o))){const u=this.getElementState(Q(o));this.computeElementStatesStyle(n,u,{datum:o,graph:t})}}})}getStateStyle(e){return this.stateStyle[e]||{}}computeStyle(e,t){e&&["translate","zIndex"].includes(e)||(this.computePaletteStyle(),this.computeElementsDefaultStyle(t),this.computeElementsStatesStyle(t))}getElement(e){return this.elementMap[e]}getNodes(){return this.context.model.getNodeData().map(({id:e})=>this.elementMap[e])}getEdges(){return this.context.model.getEdgeData().map(e=>this.elementMap[Q(e)])}getCombos(){return this.context.model.getComboData().map(({id:e})=>this.elementMap[e])}getElementComputedStyle(e,t){const n=Q(t),i=this.getThemeStyle(e),a=this.getPaletteStyle(e,n),s=t.style||{},o=this.getDefaultStyle(n),u=this.getThemeStateStyle(e,this.getElementState(n)),l=this.getStateStyle(n),c=Object.assign({},i,a,s,o,u,l);if(e==="combo"){const d=this.context.model.getChildrenData(n),f=!!c.collapsed?[]:d.map(Q).filter(g=>this.getElement(g));Object.assign(c,{childrenNode:f,childrenData:d})}return c}getDrawData(e){this.init();const t=this.computeChangesAndDrawData(e);if(!t)return null;const{type:n="draw",stage:i=n}=e;return this.markDestroyElement(t.drawData),this.computeStyle(i),{type:n,stage:i,data:t}}draw(e={animation:!0}){const t=this.getDrawData(e);if(!t)return;const{data:{drawData:{add:n,update:i,remove:a}}}=t;return this.destroyElements(a,e),this.createElements(n,e),this.updateElements(i,e),this.setAnimationTask(e,t)}preLayoutDraw(){return co(this,arguments,void 0,function*(e={animation:!0}){var t,n;const i=this.getDrawData(e);if(!i)return;const{data:{drawData:a}}=i;yield(n=(t=this.context.layout)===null||t===void 0?void 0:t.preLayout)===null||n===void 0?void 0:n.call(t,a);const{add:s,update:o,remove:u}=a;return this.destroyElements(u,e),this.createElements(s,e),this.updateElements(o,e),this.setAnimationTask(e,i)})}setAnimationTask(e,t){const{animation:n,silence:i}=e,{data:{dataChanges:a,drawData:s},stage:o,type:u}=t;return this.context.animation.animate(n,i?{}:{before:()=>this.emit(new Zt(ve.BEFORE_DRAW,{dataChanges:a,animation:n,stage:o,render:u==="render"}),e),beforeAnimate:l=>this.emit(new _r(ve.BEFORE_ANIMATE,Xn.DRAW,l,s),e),afterAnimate:l=>this.emit(new _r(ve.AFTER_ANIMATE,Xn.DRAW,l,s),e),after:()=>this.emit(new Zt(ve.AFTER_DRAW,{dataChanges:a,animation:n,stage:o,render:u==="render",firstRender:this.context.graph.rendered===!1}),e)})}computeChangesAndDrawData(e){const{model:t}=this.context,n=t.getChanges(),i=s1(n);if(i.length===0)return null;const{NodeAdded:a=[],NodeUpdated:s=[],NodeRemoved:o=[],EdgeAdded:u=[],EdgeUpdated:l=[],EdgeRemoved:c=[],ComboAdded:d=[],ComboUpdated:h=[],ComboRemoved:f=[]}=_c(i,y=>y.type),g=y=>new Map(y.map(m=>{const w=m.value;return[Q(w),w]})),v={add:{nodes:g(a),edges:g(u),combos:g(d)},update:{nodes:g(s),edges:g(l),combos:g(h)},remove:{nodes:g(o),edges:g(c),combos:g(f)}},p=this.transformData(v,e);return t.clearChanges(),{dataChanges:n,drawData:p}}transformData(e,t){const n=this.context.transform.getTransformInstance();return Object.values(n).reduce((i,a)=>a.beforeDraw(i,t),e)}createElement(e,t,n){var i;const a=Q(t);if(this.getElement(a))return;const o=this.getElementType(e,t),u=this.getElementComputedStyle(e,t),l=ki(e,o);if(!l)return di.warn(`The element ${o} of ${e} is not registered.`);this.emit(new ms(ve.BEFORE_ELEMENT_CREATE,e,t),n);const c=this.container.appendChild(new l({id:a,context:this.context,style:u}));this.shapeTypeMap[a]=o,this.elementMap[a]=c;const{stage:d="enter"}=n;(i=this.context.animation)===null||i===void 0||i.add({element:c,elementType:e,stage:d,originalStyle:Object.assign({},c.attributes),updatedStyle:u},{after:()=>{var h;this.emit(new ms(ve.AFTER_ELEMENT_CREATE,e,t),n),(h=c.onCreate)===null||h===void 0||h.call(c)}})}createElements(e,t){const{nodes:n,edges:i,combos:a}=e;[["node",n],["combo",a],["edge",i]].forEach(([o,u])=>{u.forEach(l=>this.createElement(o,l,t))})}getUpdateStageStyle(e,t,n){const{stage:i="update"}=n;if(i==="translate")if(e==="node"||e==="combo"){const{style:{x:a=0,y:s=0,z:o=0}={}}=t;return{x:a,y:s,z:o}}else return{};return this.getElementComputedStyle(e,t)}updateElement(e,t,n){var i;const a=Q(t),{stage:s="update"}=n,o=this.getElement(a);if(!o)return()=>null;this.emit(new ms(ve.BEFORE_ELEMENT_UPDATE,e,t),n);const u=this.getElementType(e,t),l=this.getUpdateStageStyle(e,t,n);this.shapeTypeMap[a]!==u&&(o.destroy(),delete this.shapeTypeMap[a],delete this.elementMap[a],this.createElement(e,t,{animation:!1,silence:!0}));const c=s!=="visibility"?s:l.visibility==="hidden"?"hide":"show";c==="hide"&&delete l.visibility,(i=this.context.animation)===null||i===void 0||i.add({element:o,elementType:e,stage:c,originalStyle:Object.assign({},o.attributes),updatedStyle:l},{before:()=>{const d=this.elementMap[a];s!=="collapse"&&Ty(d,l),s==="visibility"&&(MU(d,"opacity")||EU(d,"opacity"),this.visibilityCache.set(d,c==="show"?"visible":"hidden"),c==="show"&&Va(d,"visible"))},after:()=>{var d;const h=this.elementMap[a];s==="collapse"&&Ty(h,l),c==="hide"&&Va(h,this.visibilityCache.get(h)),this.emit(new ms(ve.AFTER_ELEMENT_UPDATE,e,t),n),(d=h.onUpdate)===null||d===void 0||d.call(h)}})}updateElements(e,t){const{nodes:n,edges:i,combos:a}=e;[["node",n],["combo",a],["edge",i]].forEach(([o,u])=>{u.forEach(l=>this.updateElement(o,l,t))})}markDestroyElement(e){Object.values(e.remove).forEach(t=>{t.forEach(n=>{const i=Q(n),a=this.getElement(i);a&&cB(a)})})}destroyElement(e,t,n){var i;const{stage:a="exit"}=n,s=Q(t),o=this.elementMap[s];if(!o)return()=>null;this.emit(new ms(ve.BEFORE_ELEMENT_DESTROY,e,t),n),(i=this.context.animation)===null||i===void 0||i.add({element:o,elementType:e,stage:a,originalStyle:Object.assign({},o.attributes),updatedStyle:{}},{after:()=>{var u;this.clearElement(s),o.destroy(),(u=o.onDestroy)===null||u===void 0||u.call(o),this.emit(new ms(ve.AFTER_ELEMENT_DESTROY,e,t),n)}})}destroyElements(e,t){const{nodes:n,edges:i,combos:a}=e;[["combo",a],["edge",i],["node",n]].forEach(([o,u])=>{u.forEach(l=>this.destroyElement(o,l,t))})}clearElement(e){delete this.paletteStyle[e],delete this.defaultStyle[e],delete this.stateStyle[e],delete this.elementMap[e],delete this.shapeTypeMap[e]}alignLayoutResultToElement(e,t){var n,i;const a=(n=e.nodes)===null||n===void 0?void 0:n.find(s=>Q(s)===t);if(a){const s=on(this.context.model.getNodeLikeDatum(t)),o=on(a),u=ot(s,o);(i=e.nodes)===null||i===void 0||i.forEach(l=>{var c,d,h;!((c=l.style)===null||c===void 0)&&c.x&&(l.style.x+=u[0]),!((d=l.style)===null||d===void 0)&&d.y&&(l.style.y+=u[1]),!((h=l.style)===null||h===void 0)&&h.z&&(l.style.z+=u[2]||0)})}}collapseNode(e,t){return co(this,void 0,void 0,function*(){var n;const{animation:i,align:a}=t,{model:s,layout:o}=this.context,u=this.computeChangesAndDrawData({stage:"collapse",animation:i});if(!u)return;this.markDestroyElement(u.drawData);const l=yield o.simulate();a&&this.alignLayoutResultToElement(l,e),s.updateData(l);const c=this.computeChangesAndDrawData({stage:"collapse",animation:i});if(!c)return;const{drawData:d}=c,{add:h,remove:f,update:g}=d;this.markDestroyElement(d);const v={animation:i,stage:"collapse",data:d};this.destroyElements(f,v),this.createElements(h,v),this.updateElements(g,v),yield(n=this.context.animation.animate(i,{beforeAnimate:p=>this.emit(new _r(ve.BEFORE_ANIMATE,Xn.COLLAPSE,p,d),v),afterAnimate:p=>this.emit(new _r(ve.AFTER_ANIMATE,Xn.COLLAPSE,p,d),v)},{collapse:{target:e,descendants:Array.from(f.nodes).map(([,p])=>Q(p)),position:on(g.nodes.get(e))}}))===null||n===void 0?void 0:n.finished})}expandNode(e,t){return co(this,void 0,void 0,function*(){var n;const{model:i,layout:a}=this.context,{animation:s,align:o}=t,u=on(i.getNodeData([e])[0]),l=this.computeChangesAndDrawData({stage:"expand",animation:s});if(!l)return;const{drawData:{add:c}}=l;this.createElements(c,{animation:!1,stage:"expand",target:e}),this.context.animation.clear();const d=yield a.simulate();o&&this.alignLayoutResultToElement(d,e),i.updateData(d),this.computeStyle("expand");const h=this.computeChangesAndDrawData({stage:"collapse",animation:s});if(!h)return;const{drawData:f}=h,{update:g}=f,v={animation:s,stage:"expand",data:f};c.edges.forEach(p=>g.edges.set(Q(p),p)),c.nodes.forEach(p=>g.nodes.set(Q(p),p)),this.updateElements(g,v),yield(n=this.context.animation.animate(s,{beforeAnimate:p=>this.emit(new _r(ve.BEFORE_ANIMATE,Xn.EXPAND,p,f),v),afterAnimate:p=>this.emit(new _r(ve.AFTER_ANIMATE,Xn.EXPAND,p,f),v)},{expand:{target:e,descendants:Array.from(c.nodes).map(([,p])=>Q(p)),position:u}}))===null||n===void 0?void 0:n.finished})}collapseCombo(e,t){return co(this,void 0,void 0,function*(){var n;const{model:i,element:a}=this.context;if(i.getAncestorsData(e,ut).some(v=>Jn(v)))return;const s=a.getElement(e),o=s.getComboPosition(Object.assign(Object.assign({},s.attributes),{collapsed:!0})),u=this.computeChangesAndDrawData({stage:"collapse",animation:t});if(!u)return;const{dataChanges:l,drawData:c}=u;this.markDestroyElement(c);const{update:d,remove:h}=c,f={animation:t,stage:"collapse",data:c};this.destroyElements(h,f),this.updateElements(d,f);const g=v=>Array.from(v).map(([,p])=>Q(p));yield(n=this.context.animation.animate(t,{before:()=>this.emit(new Zt(ve.BEFORE_DRAW,{dataChanges:l,animation:t}),f),beforeAnimate:v=>this.emit(new _r(ve.BEFORE_ANIMATE,Xn.COLLAPSE,v,c),f),afterAnimate:v=>this.emit(new _r(ve.AFTER_ANIMATE,Xn.COLLAPSE,v,c),f),after:()=>this.emit(new Zt(ve.AFTER_DRAW,{dataChanges:l,animation:t}),f)},{collapse:{target:e,descendants:[...g(h.nodes),...g(h.combos)],position:o}}))===null||n===void 0?void 0:n.finished})}expandCombo(e,t){return co(this,void 0,void 0,function*(){var n;const{model:i}=this.context,a=on(i.getComboData([e])[0]);this.computeStyle("expand");const s=this.computeChangesAndDrawData({stage:"expand",animation:t});if(!s)return;const{dataChanges:o,drawData:u}=s,{add:l,update:c}=u,d={animation:t,stage:"expand",data:u,target:e};this.createElements(l,d),this.updateElements(c,d);const h=f=>Array.from(f).map(([,g])=>Q(g));yield(n=this.context.animation.animate(t,{before:()=>this.emit(new Zt(ve.BEFORE_DRAW,{dataChanges:o,animation:t}),d),beforeAnimate:f=>this.emit(new _r(ve.BEFORE_ANIMATE,Xn.EXPAND,f,u),d),afterAnimate:f=>this.emit(new _r(ve.AFTER_ANIMATE,Xn.EXPAND,f,u),d),after:()=>this.emit(new Zt(ve.AFTER_DRAW,{dataChanges:o,animation:t}),d)},{expand:{target:e,descendants:[...h(l.nodes),...h(l.combos)],position:a}}))===null||n===void 0?void 0:n.finished})}clear(){this.container.destroy(),this.initContainer(),this.elementMap={},this.shapeTypeMap={},this.defaultStyle={},this.stateStyle={},this.paletteStyle={}}destroy(){this.clear(),this.container.destroy(),this.context={}}}var ws=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})},CU=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t};class PU{get presetOptions(){return{animation:!!CO(this.context.options,!0)}}get options(){const{options:e}=this.context;return e.layout}constructor(e){this.instances=[],this.context=e}getLayoutInstance(){return this.instances}preLayout(e){return ws(this,void 0,void 0,function*(){var t,n,i,a;const{graph:s,model:o}=this.context,{add:u}=e;sn(s,new Zt(ve.BEFORE_LAYOUT,{type:"pre"}));const l=yield(t=this.context.layout)===null||t===void 0?void 0:t.simulate();(n=l==null?void 0:l.nodes)===null||n===void 0||n.forEach(c=>{const d=Q(c),h=u.nodes.get(d);o.syncNodeLikeDatum(c),h&&Object.assign(h.style,c.style)}),(i=l==null?void 0:l.edges)===null||i===void 0||i.forEach(c=>{const d=Q(c),h=u.edges.get(d);o.syncEdgeDatum(c),h&&Object.assign(h.style,c.style)}),(a=l==null?void 0:l.combos)===null||a===void 0||a.forEach(c=>{const d=Q(c),h=u.combos.get(d);o.syncNodeLikeDatum(c),h&&Object.assign(h.style,c.style)}),sn(s,new Zt(ve.AFTER_LAYOUT,{type:"pre"})),this.transformDataAfterLayout("pre",e)})}postLayout(){return ws(this,void 0,void 0,function*(){if(!this.options)return;const e=Array.isArray(this.options)?this.options:[this.options],{graph:t}=this.context;sn(t,new Zt(ve.BEFORE_LAYOUT,{type:"post"}));for(const n of e){const i=e.indexOf(n),a=this.getLayoutData(n),s=Object.assign(Object.assign({},this.presetOptions),n);sn(t,new Zt(ve.BEFORE_STAGE_LAYOUT,{options:s,index:i}));const o=yield this.stepLayout(a,s,i);sn(t,new Zt(ve.AFTER_STAGE_LAYOUT,{options:s,index:i})),n.animation||this.updateElementPosition(o,!1)}sn(t,new Zt(ve.AFTER_LAYOUT,{type:"post"})),this.transformDataAfterLayout("post")})}transformDataAfterLayout(e,t){const n=this.context.transform.getTransformInstance();Object.values(n).forEach(i=>i.afterLayout(e,t))}simulate(){return ws(this,void 0,void 0,function*(){if(!this.options)return{};const e=Array.isArray(this.options)?this.options:[this.options];let t={};for(const n of e){const i=e.indexOf(n),a=this.getLayoutData(n);t=yield this.stepLayout(a,Object.assign(Object.assign(Object.assign({},this.presetOptions),n),{animation:!1}),i)}return t})}stepLayout(e,t,n){return ws(this,void 0,void 0,function*(){return yB(t)?yield this.treeLayout(e,t,n):yield this.graphLayout(e,t,n)})}graphLayout(e,t,n){return ws(this,void 0,void 0,function*(){const{animation:i,enableWorker:a,iterations:s=300}=t,o=this.initGraphLayout(t);if(!o)return{};if(this.instances[n]=o,this.instance=o,a){const l=o;return this.supervisor=new OG(l.graphData2LayoutModel(e),l.instance,{iterations:s}),Pl(yield this.supervisor.execute())}if(Ly(o))return i?yield o.execute(e,{onTick:l=>{this.updateElementPosition(l,!1)}}):(o.execute(e),o.stop(),o.tick(s));const u=yield o.execute(e);if(i){const l=this.updateElementPosition(u,i);yield l==null?void 0:l.finished}return u})}treeLayout(e,t,n){return ws(this,void 0,void 0,function*(){const{type:i,animation:a}=t,s=ki("layout",i);if(!s)return{};const{nodes:o=[],edges:u=[]}=e,l=new cn({nodes:o.map(g=>({id:Q(g),data:g.data||{}})),edges:u.map(g=>({id:Q(g),source:g.source,target:g.target,data:g.data||{}}))});AU(l);const c={nodes:[],edges:[]},d={nodes:[],edges:[]};l.getRoots(ur).forEach(g=>{Ls(g,w=>{w.children=l.getSuccessors(w.id)},w=>l.getSuccessors(w.id),"TB");const v=s(g,t),{x:p,y,z:m=0}=v;Ls(v,w=>{const{id:M,x:S,y:T,z:A=0}=w;c.nodes.push({id:M,style:{x:p,y,z:m}}),d.nodes.push({id:M,style:{x:S,y:T,z:A}})},w=>w.children,"TB")});const f=this.inferTreeLayoutOffset(d);if(I_(d,f),a){I_(c,f),this.updateElementPosition(c,!1);const g=this.updateElementPosition(d,a);yield g==null?void 0:g.finished}return d})}inferTreeLayoutOffset(e){var t;let[n,i]=[1/0,-1/0],[a,s]=[1/0,-1/0];(t=e.nodes)===null||t===void 0||t.forEach(v=>{const{x:p=0,y=0}=v.style||{};n=Math.min(n,p),i=Math.max(i,p),a=Math.min(a,y),s=Math.max(s,y)});const{canvas:o}=this.context,u=o.getSize(),[l,c]=o.getCanvasByViewport([0,0]),[d,h]=o.getCanvasByViewport(u);if(n>=l&&i<=d&&a>=c&&s<=h)return[0,0];const f=(l+d)/2,g=(c+h)/2;return[f-(n+i)/2,g-(a+s)/2]}stopLayout(){this.instance&&Ly(this.instance)&&(this.instance.stop(),this.instance=void 0),this.supervisor&&(this.supervisor.stop(),this.supervisor=void 0),this.animationResult&&(this.animationResult.finish(),this.animationResult=void 0)}getLayoutData(e){const{nodeFilter:t=()=>!0,preLayout:n=!1,isLayoutInvisibleNodes:i=!1}=e,{nodes:a,edges:s,combos:o}=this.context.model.getData(),{element:u,model:l}=this.context,c=v=>u.getElement(v),d=n?v=>{var p;return!i&&(((p=v.style)===null||p===void 0?void 0:p.visibility)==="hidden"||l.getAncestorsData(v.id,ur).some(Jn)||l.getAncestorsData(v.id,ut).some(Jn))?!1:t(v)}:v=>{const p=Q(v),y=c(p);return!y||Yc(y)?!1:t(v)},h=a.filter(d),f=new Map(h.map(v=>[Q(v),v]));o.forEach(v=>f.set(Q(v),v));const g=s.filter(({source:v,target:p})=>f.has(v)&&f.has(p));return{nodes:h,edges:g,combos:o}}initGraphLayout(e){var t;const{element:n,viewport:i}=this.context,{type:a,enableWorker:s,animation:o,iterations:u}=e,l=CU(e,["type","enableWorker","animation","iterations"]),[c,d]=i.getCanvasSize(),h=[c/2,d/2],f=(t=e==null?void 0:e.nodeSize)!==null&&t!==void 0?t:m=>{const w=n==null?void 0:n.getElement(m.id);return w?w.attributes.size:n==null?void 0:n.getElementComputedStyle("node",m).size},g=ki("layout",a);if(!g)return di.warn(`The layout of ${a} is not registered.`);const v=Object.getPrototypeOf(g.prototype)===Zc.prototype?g:bB(g,this.context),p=new v(this.context),y={nodeSize:f,width:c,height:d,center:h};switch(p.id){case"d3-force":case"d3-force-3d":Object.assign(y,{center:{x:c/2,y:d/2,z:0}});break}return Gn(p.options,y,l),p}updateElementPosition(e,t){const{model:n,element:i}=this.context;return i?(n.updateData(e),i.draw({animation:t,silence:!0})):null}destroy(){var e;this.stopLayout(),this.context={},(e=this.supervisor)===null||e===void 0||e.kill(),this.supervisor=void 0,this.instance=void 0,this.instances=[],this.animationResult=void 0}}const I_=(r,e)=>{var t;const[n,i]=e;(t=r.nodes)===null||t===void 0||t.forEach(a=>{if(a.style){const{x:s=0,y:o=0}=a.style;a.style.x=s+n,a.style.y=o+i}else a.style={x:n,y:i}})};function LU(r){return[DU].reduce((t,n)=>n(t),r)}function DU(r){return!r.layout||Array.isArray(r.layout)||"preLayout"in r.layout||["antv-dagre","combo-combined","compact-box","circular","concentric","dagre","fishbone","grid","indented","mds","radial","random","snake","dendrogram","mindmap"].includes(r.layout.type)&&(r.layout.preLayout=!0),r}class IU extends Sm{constructor(e){super(e),this.category="plugin",this.setPlugins(this.context.options.plugins||[])}setPlugins(e){this.setExtensions(e)}getPluginInstance(e){const t=this.extensionMap[e];if(t)return t;di.warn(`Cannot find the plugin ${e}, will try to find it by type.`);const n=this.extensions.find(i=>i.type===e);if(n)return this.extensionMap[n.key]}}const Ol=["update-related-edges","collapse-expand-node","collapse-expand-combo","get-edge-actual-ends","arrange-draw-order"];class RU extends Sm{constructor(e){super(e),this.category="transform",this.setTransforms(this.context.options.transforms||[])}getTransforms(){}setTransforms(e){this.setExtensions([...Ol.slice(0,Ol.length-1),...e,Ol[Ol.length-1]])}getTransformInstance(e){return e?this.extensionMap[e]:this.extensionMap}}var ho=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})};class jU{get padding(){return hi(this.context.options.padding)}get paddingOffset(){const[e,t,n,i]=this.padding,[a,s,o]=[(i-t)/2,(e-n)/2,0];return[a,s,o]}constructor(e){this.landmarkCounter=0,this.context=e;const[t,n]=this.paddingOffset,{zoom:i,rotation:a,x:s=t,y:o=n}=e.options;this.transform({mode:"absolute",scale:i,translate:[s,o],rotate:a},!1)}get camera(){const{canvas:e}=this.context;return new Proxy(e.getCamera(),{get:(t,n)=>{const a=Object.entries(e.getLayers()).filter(([o])=>!["main"].includes(o)).map(([,o])=>o.getCamera()),s=t[n];if(typeof s=="function")return(...o)=>{const u=s.apply(t,o);return a.forEach(l=>{l[n].apply(l,o)}),u}}})}createLandmark(e){return this.camera.createLandmark(`landmark-${this.landmarkCounter++}`,e)}getAnimation(e){const t=CO(this.context.options,e);return t?$a(Object.assign({},t),["easing","duration"]):!1}getCanvasSize(){const{canvas:e}=this.context,{width:t=0,height:n=0}=e.getConfig();return[t,n]}getCanvasCenter(){const{canvas:e}=this.context,{width:t=0,height:n=0}=e.getConfig();return[t/2,n/2,0]}getViewportCenter(){const[e,t]=this.camera.getPosition();return[e,t,0]}getGraphCenter(){return this.context.graph.getViewportByCanvas(this.getCanvasCenter())}getZoom(){return this.camera.getZoom()}getRotation(){return this.camera.getRoll()}getTranslateOptions(e){const{camera:t}=this,{mode:n,translate:i=[]}=e,a=this.getZoom(),s=t.getPosition(),o=t.getFocalPoint(),[u,l]=this.getCanvasCenter(),[c=0,d=0,h=0]=i,f=qr([-c,-d,-h],a);return n==="relative"?{position:$e(s,f),focalPoint:$e(o,f)}:{position:$e([u,l,s[2]],f),focalPoint:$e([u,l,o[2]],f)}}getRotateOptions(e){const{mode:t,rotate:n=0}=e;return{roll:t==="relative"?this.camera.getRoll()+n:n}}getZoomOptions(e){const{zoomRange:t}=this.context.options,n=this.camera.getZoom(),{mode:i,scale:a=1}=e;return jt(i==="relative"?n*a:a,...t)}transform(e,t){return ho(this,void 0,void 0,function*(){const{graph:n}=this.context,{translate:i,rotate:a,scale:s,origin:o}=e;this.cancelAnimation();const u=this.getAnimation(t);if(sn(n,new Tl(ve.BEFORE_TRANSFORM,e)),!a&&s&&!i&&o&&!u){this.camera.setZoomByViewportPoint(this.getZoomOptions(e),o),sn(n,new Tl(ve.AFTER_TRANSFORM,e));return}const l={};if(i&&Object.assign(l,this.getTranslateOptions(e)),Ee(a)&&Object.assign(l,this.getRotateOptions(e)),Ee(s)&&Object.assign(l,{zoom:this.getZoomOptions(e)}),u)return sn(n,new _r(ve.BEFORE_ANIMATE,Xn.TRANSFORM,null,e)),new Promise(c=>{this.transformResolver=c,this.camera.gotoLandmark(this.createLandmark(l),Object.assign(Object.assign({},u),{onfinish:()=>{sn(n,new _r(ve.AFTER_ANIMATE,Xn.TRANSFORM,null,e)),sn(n,new Tl(ve.AFTER_TRANSFORM,e)),this.transformResolver=void 0,c()}}))});this.camera.gotoLandmark(this.createLandmark(l),{duration:0}),sn(n,new Tl(ve.AFTER_TRANSFORM,e))})}fitView(e,t){return ho(this,void 0,void 0,function*(){const[n,i,a,s]=this.padding,{when:o="always",direction:u="both"}=e||{},[l,c]=this.context.canvas.getSize(),d=l-s-i,h=c-n-a,f=this.context.canvas.getBounds(),g=this.getBBoxInViewport(f),[v,p]=pa(g),y=u==="x"&&v>=d||u==="y"&&p>=h||u==="both"&&v>=d&&p>=h;if(o==="overflow"&&!y)return yield this.fitCenter({animation:t});const m=d/v,w=h/p,M=u==="x"?m:u==="y"?w:Math.min(m,w),S=this.getAnimation(t);yield this.transform({mode:"relative",scale:M,translate:$e(ot(this.getCanvasCenter(),this.getBBoxInViewport(f).center),qr(this.paddingOffset,M))},S)})}fitCenter(e){return ho(this,void 0,void 0,function*(){const t=this.context.canvas.getBounds();yield this.focus(t,e)})}focusElements(e){return ho(this,arguments,void 0,function*(t,n={}){const{element:i}=this.context;if(!i)return;const a=o=>n.shapes?o.getShape(n.shapes).getRenderBounds():o.getRenderBounds(),s=hu(t.map(o=>a(i.getElement(o))));yield this.focus(s,n)})}focus(e,t){return ho(this,void 0,void 0,function*(){const n=this.context.graph.getViewportByCanvas(e.center),i=t.position||this.getCanvasCenter(),a=ot(i,n);yield this.transform({mode:"relative",translate:$e(a,this.paddingOffset)},t.animation)})}getBBoxInViewport(e){const{min:t,max:n}=e,{graph:i}=this.context,[a,s]=i.getViewportByCanvas(t),[o,u]=i.getViewportByCanvas(n),l=new ft;return l.setMinMax([a,s,0],[o,u,0]),l}isInViewport(e,t=!1,n=0){const{graph:i}=this.context,a=this.getCanvasSize(),[s,o]=i.getCanvasByViewport([0,0]),[u,l]=i.getCanvasByViewport(a);let c=new ft;return c.setMinMax([s,o,0],[u,l,0]),n&&(c=va(c,n)),zs(e)?$r(e,c):t?w5(e,c):c.intersects(e)}cancelAnimation(){var e,t;!((e=this.camera.landmarks)===null||e===void 0)&&e.length&&this.camera.cancelLandmarkAnimation(),(t=this.transformResolver)===null||t===void 0||t.call(this)}}var dt=function(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function o(c){try{l(n.next(c))}catch(d){s(d)}}function u(c){try{l(n.throw(c))}catch(d){s(d)}}function l(c){c.done?a(c.value):i(c.value).then(o,u)}l((n=n.apply(r,e||[])).next())})};class Yd extends Kc{constructor(e){var t;super(),this.options={},this.rendered=!1,this.destroyed=!1,this.context={model:new kU},this.isCollapsingExpanding=!1,this.onResize=su(()=>{this.resize()},300),this._setOptions(Object.assign({},Yd.defaultOptions,e),!0),this.context.graph=this,this.options.autoResize&&((t=globalThis.addEventListener)===null||t===void 0||t.call(globalThis,"resize",this.onResize))}getOptions(){return this.options}setOptions(e){this._setOptions(e,!1)}_setOptions(e,t){if(this.updateCanvas(e),Object.assign(this.options,LU(e)),t){const{data:h}=e;h&&this.addData(h);return}const{behaviors:n,combo:i,data:a,edge:s,layout:o,node:u,plugins:l,theme:c,transforms:d}=e;n&&this.setBehaviors(n),a&&this.setData(a),u&&this.setNode(u),s&&this.setEdge(s),i&&this.setCombo(i),o&&this.setLayout(o),c&&this.setTheme(c),l&&this.setPlugins(l),d&&this.setTransforms(d)}getSize(){return this.context.canvas?this.context.canvas.getSize():[this.options.width||0,this.options.height||0]}setSize(e,t){e&&(this.options.width=e),t&&(this.options.height=t),this.resize(e,t)}setZoomRange(e){this.options.zoomRange=e}getZoomRange(){return this.options.zoomRange}setNode(e){this.options.node=e,this.context.model.refreshData()}setEdge(e){this.options.edge=e,this.context.model.refreshData()}setCombo(e){this.options.combo=e,this.context.model.refreshData()}getTheme(){return this.options.theme}setTheme(e){this.options.theme=Te(e)?e(this.getTheme()):e}setLayout(e){this.options.layout=Te(e)?e(this.getLayout()):e}getLayout(){return this.options.layout}setBehaviors(e){var t;this.options.behaviors=Te(e)?e(this.getBehaviors()):e,(t=this.context.behavior)===null||t===void 0||t.setBehaviors(this.options.behaviors)}updateBehavior(e){this.setBehaviors(t=>t.map(n=>typeof n=="object"&&n.key===e.key?Object.assign(Object.assign({},n),e):n))}getBehaviors(){return this.options.behaviors||[]}setPlugins(e){var t;this.options.plugins=Te(e)?e(this.getPlugins()):e,(t=this.context.plugin)===null||t===void 0||t.setPlugins(this.options.plugins)}updatePlugin(e){this.setPlugins(t=>t.map(n=>typeof n=="object"&&n.key===e.key?Object.assign(Object.assign({},n),e):n))}getPlugins(){return this.options.plugins||[]}getPluginInstance(e){return this.context.plugin.getPluginInstance(e)}setTransforms(e){var t;this.options.transforms=Te(e)?e(this.getTransforms()):e,(t=this.context.transform)===null||t===void 0||t.setTransforms(this.options.transforms)}updateTransform(e){this.setTransforms(t=>t.map(n=>typeof n=="object"&&n.key===e.key?Object.assign(Object.assign({},n),e):n)),this.context.model.refreshData()}getTransforms(){return this.options.transforms||[]}getData(){return this.context.model.getData()}getElementData(e){return Array.isArray(e)?e.map(t=>this.context.model.getElementDataById(t)):this.context.model.getElementDataById(e)}getNodeData(e){var t;return e===void 0?this.context.model.getNodeData():Array.isArray(e)?this.context.model.getNodeData(e):(t=this.context.model.getNodeData([e]))===null||t===void 0?void 0:t[0]}getEdgeData(e){var t;return e===void 0?this.context.model.getEdgeData():Array.isArray(e)?this.context.model.getEdgeData(e):(t=this.context.model.getEdgeData([e]))===null||t===void 0?void 0:t[0]}getComboData(e){var t;return e===void 0?this.context.model.getComboData():Array.isArray(e)?this.context.model.getComboData(e):(t=this.context.model.getComboData([e]))===null||t===void 0?void 0:t[0]}setData(e){this.context.model.setData(Te(e)?e(this.getData()):e)}addData(e){this.context.model.addData(Te(e)?e(this.getData()):e)}addNodeData(e){this.context.model.addNodeData(Te(e)?e(this.getNodeData()):e)}addEdgeData(e){this.context.model.addEdgeData(Te(e)?e(this.getEdgeData()):e)}addComboData(e){this.context.model.addComboData(Te(e)?e(this.getComboData()):e)}addChildrenData(e,t){this.context.model.addChildrenData(e,t)}updateData(e){this.context.model.updateData(Te(e)?e(this.getData()):e)}updateNodeData(e){this.context.model.updateNodeData(Te(e)?e(this.getNodeData()):e)}updateEdgeData(e){this.context.model.updateEdgeData(Te(e)?e(this.getEdgeData()):e)}updateComboData(e){this.context.model.updateComboData(Te(e)?e(this.getComboData()):e)}removeData(e){this.context.model.removeData(Te(e)?e(this.getData()):e)}removeNodeData(e){this.context.model.removeNodeData(Te(e)?e(this.getNodeData()):e)}removeEdgeData(e){this.context.model.removeEdgeData(Te(e)?e(this.getEdgeData()):e)}removeComboData(e){this.context.model.removeComboData(Te(e)?e(this.getComboData()):e)}getElementType(e){return this.context.model.getElementType(e)}getRelatedEdgesData(e,t="both"){return this.context.model.getRelatedEdgesData(e,t)}getNeighborNodesData(e){return this.context.model.getNeighborNodesData(e)}getAncestorsData(e,t){return this.context.model.getAncestorsData(e,t)}getParentData(e,t){return this.context.model.getParentData(e,t)}getChildrenData(e){return this.context.model.getChildrenData(e)}getDescendantsData(e){return this.context.model.getDescendantsData(e)}getElementDataByState(e,t){return this.context.model.getElementDataByState(e,t)}initCanvas(){return dt(this,void 0,void 0,function*(){var e;if(this.context.canvas)return yield this.context.canvas.ready;const{container:t="container",width:n,height:i,renderer:a,cursor:s,background:o,canvas:u,devicePixelRatio:l=(e=globalThis.devicePixelRatio)!==null&&e!==void 0?e:1}=this.options;if(t instanceof k_)this.context.canvas=t,s&&t.setCursor(s),a&&t.setRenderer(a),yield t.ready;else{const c=tt(t)?document.getElementById(t):t,d=P_(c);this.emit(ve.BEFORE_CANVAS_INIT,{container:c,width:n,height:i});const h=Object.assign(Object.assign({},u),{container:c,width:n||d[0],height:i||d[1],background:o,renderer:a,cursor:s,devicePixelRatio:l}),f=new k_(h);this.context.canvas=f,yield f.ready,this.emit(ve.AFTER_CANVAS_INIT,{canvas:f})}})}updateCanvas(e){var t,n;const{renderer:i,cursor:a,height:s,width:o}=e,u=this.context.canvas;u&&(i&&(this.emit(ve.BEFORE_RENDERER_CHANGE,{renderer:this.options.renderer}),u.setRenderer(i),this.emit(ve.AFTER_RENDERER_CHANGE,{renderer:i})),a&&u.setCursor(a),(Ee(o)||Ee(s))&&this.setSize((t=o??this.options.width)!==null&&t!==void 0?t:0,(n=s??this.options.height)!==null&&n!==void 0?n:0))}initRuntime(){this.context.options=this.options,this.context.batch||(this.context.batch=new _U(this.context)),this.context.plugin||(this.context.plugin=new IU(this.context)),this.context.viewport||(this.context.viewport=new jU(this.context)),this.context.transform||(this.context.transform=new RU(this.context)),this.context.element||(this.context.element=new NU(this.context)),this.context.animation||(this.context.animation=new SU(this.context)),this.context.layout||(this.context.layout=new PU(this.context)),this.context.behavior||(this.context.behavior=new TU(this.context))}prepare(){return dt(this,void 0,void 0,function*(){if(yield Promise.resolve(),this.destroyed)throw new Error(_i("The graph instance has been destroyed"));yield this.initCanvas(),this.initRuntime()})}render(){return dt(this,void 0,void 0,function*(){if(yield this.prepare(),sn(this,new Zt(ve.BEFORE_RENDER)),this.options.layout)if(!this.rendered&&mB(this.options.layout)){const e=yield this.context.element.preLayoutDraw({type:"render"});yield Promise.all([e==null?void 0:e.finished,this.autoFit()])}else{const e=this.context.element.draw({type:"render"});yield Promise.all([e==null?void 0:e.finished,this.context.layout.postLayout()]),yield this.autoFit()}else{const e=this.context.element.draw({type:"render"});yield Promise.all([e==null?void 0:e.finished,this.autoFit()])}this.rendered=!0,sn(this,new Zt(ve.AFTER_RENDER))})}draw(){return dt(this,void 0,void 0,function*(){var e;yield this.prepare(),yield(e=this.context.element.draw())===null||e===void 0?void 0:e.finished})}layout(){return dt(this,void 0,void 0,function*(){yield this.context.layout.postLayout()})}stopLayout(){this.context.layout.stopLayout()}clear(){return dt(this,void 0,void 0,function*(){const{model:e,element:t}=this.context;e.setData({}),e.clearChanges(),t==null||t.clear()})}destroy(){var e;sn(this,new Zt(ve.BEFORE_DESTROY));const{layout:t,animation:n,element:i,model:a,canvas:s,behavior:o,plugin:u}=this.context;u==null||u.destroy(),o==null||o.destroy(),t==null||t.destroy(),n==null||n.destroy(),i==null||i.destroy(),a.destroy(),s==null||s.destroy(),this.options={},this.context={},this.off(),(e=globalThis.removeEventListener)===null||e===void 0||e.call(globalThis,"resize",this.onResize),this.destroyed=!0,sn(this,new Zt(ve.AFTER_DESTROY))}getCanvas(){return this.context.canvas}resize(e,t){var n;const i=P_((n=this.context.canvas)===null||n===void 0?void 0:n.getContainer()),a=[e||i[0],t||i[1]];if(!this.context.canvas)return;const s=this.context.canvas.getSize();Bt(a,s)||(sn(this,new Zt(ve.BEFORE_SIZE_CHANGE,{size:a})),this.context.canvas.resize(...a),sn(this,new Zt(ve.AFTER_SIZE_CHANGE,{size:a})))}fitView(e,t){return dt(this,void 0,void 0,function*(){var n;yield(n=this.context.viewport)===null||n===void 0?void 0:n.fitView(e,t)})}fitCenter(e){return dt(this,void 0,void 0,function*(){var t;yield(t=this.context.viewport)===null||t===void 0?void 0:t.fitCenter({animation:e})})}autoFit(){return dt(this,void 0,void 0,function*(){const{autoFit:e}=this.context.options;if(e)if(tt(e))e==="view"?yield this.fitView():e==="center"&&(yield this.fitCenter());else{const{type:t,animation:n}=e;t==="view"?yield this.fitView(e.options,n):t==="center"&&(yield this.fitCenter(n))}})}focusElement(e,t){return dt(this,void 0,void 0,function*(){var n;yield(n=this.context.viewport)===null||n===void 0?void 0:n.focusElements(Array.isArray(e)?e:[e],{animation:t})})}zoomBy(e,t,n){return dt(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",scale:e,origin:n},t)})}zoomTo(e,t,n){return dt(this,void 0,void 0,function*(){this.context.viewport.transform({mode:"absolute",scale:e,origin:n},t)})}getZoom(){return this.context.viewport.getZoom()}rotateBy(e,t,n){return dt(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",rotate:e,origin:n},t)})}rotateTo(e,t,n){return dt(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",rotate:e,origin:n},t)})}getRotation(){return this.context.viewport.getRotation()}translateBy(e,t){return dt(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",translate:e},t)})}translateTo(e,t){return dt(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",translate:e},t)})}getPosition(){return ot([0,0],this.getCanvasByViewport([0,0]))}translateElementBy(e,t){return dt(this,arguments,void 0,function*(n,i,a=!0){var s,o;const[u,l]=Yt(n)?[n,(s=i)!==null&&s!==void 0?s:!0]:[{[n]:i},a];Object.entries(u).forEach(([c,d])=>this.context.model.translateNodeLikeBy(c,d)),yield(o=this.context.element.draw({animation:l,stage:"translate"}))===null||o===void 0?void 0:o.finished})}translateElementTo(e,t){return dt(this,arguments,void 0,function*(n,i,a=!0){var s,o;const[u,l]=Yt(n)?[n,(s=i)!==null&&s!==void 0?s:!0]:[{[n]:i},a];Object.entries(u).forEach(([c,d])=>this.context.model.translateNodeLikeTo(c,d)),yield(o=this.context.element.draw({animation:l,stage:"translate"}))===null||o===void 0?void 0:o.finished})}getElementPosition(e){return this.context.model.getElementPosition(e)}getElementRenderStyle(e){return om(this.context.element.getElement(e).attributes,["context"])}setElementVisibility(e,t){return dt(this,arguments,void 0,function*(n,i,a=!0){var s,o;const[u,l]=Yt(n)?[n,(s=i)!==null&&s!==void 0?s:!0]:[{[n]:i},a],c={nodes:[],edges:[],combos:[]};Object.entries(u).forEach(([f,g])=>{const v=this.getElementType(f);c[`${v}s`].push({id:f,style:{visibility:g}})});const{model:d,element:h}=this.context;d.preventUpdateNodeLikeHierarchy(()=>{d.updateData(c)}),yield(o=h.draw({animation:l,stage:"visibility"}))===null||o===void 0?void 0:o.finished})}showElement(e,t){return dt(this,void 0,void 0,function*(){const n=Array.isArray(e)?e:[e];yield this.setElementVisibility(Object.fromEntries(n.map(i=>[i,"visible"])),t)})}hideElement(e,t){return dt(this,void 0,void 0,function*(){const n=Array.isArray(e)?e:[e];yield this.setElementVisibility(Object.fromEntries(n.map(i=>[i,"hidden"])),t)})}getElementVisibility(e){var t,n;const i=this.context.element.getElement(e);return(n=(t=i==null?void 0:i.style)===null||t===void 0?void 0:t.visibility)!==null&&n!==void 0?n:"visible"}setElementZIndex(e,t){return dt(this,void 0,void 0,function*(){var n;const i={nodes:[],edges:[],combos:[]},a=Yt(e)?e:{[e]:t};Object.entries(a).forEach(([u,l])=>{const c=this.getElementType(u);i[`${c}s`].push({id:u,style:{zIndex:l}})});const{model:s,element:o}=this.context;s.preventUpdateNodeLikeHierarchy(()=>s.updateData(i)),yield(n=o.draw({animation:!1,stage:"zIndex"}))===null||n===void 0?void 0:n.finished})}frontElement(e){return dt(this,void 0,void 0,function*(){const t=Array.isArray(e)?e:[e],{model:n}=this.context,i={};t.map(a=>{const s=n.getFrontZIndex(a);if(n.getElementType(a)==="combo"){const u=n.getAncestorsData(a,ut).at(-1)||this.getComboData(a),l=[u,...n.getDescendantsData(Q(u))],c=s-L_(u);l.forEach(h=>{i[Q(h)]=this.getElementZIndex(Q(h))+c});const{internal:d}=Sy(l.map(Q),h=>n.getRelatedEdgesData(h));d.forEach(h=>{const f=Q(h);i[f]=this.getElementZIndex(f)+c})}else i[a]=s}),yield this.setElementZIndex(i)})}getElementZIndex(e){return L_(this.context.model.getElementDataById(e))}setElementState(e,t){return dt(this,arguments,void 0,function*(n,i,a=!0){var s,o;const[u,l]=Yt(n)?[n,(s=i)!==null&&s!==void 0?s:!0]:[{[n]:i},a],c=h=>h?Array.isArray(h)?h:[h]:[],d={nodes:[],edges:[],combos:[]};Object.entries(u).forEach(([h,f])=>{const g=this.getElementType(h);d[`${g}s`].push({id:h,states:c(f)})}),this.updateData(d),yield(o=this.context.element.draw({animation:l,stage:"state"}))===null||o===void 0?void 0:o.finished})}getElementState(e){return this.context.model.getElementState(e)}getElementRenderBounds(e){return this.context.element.getElement(e).getRenderBounds()}collapseElement(e){return dt(this,arguments,void 0,function*(t,n=!0){const{model:i,element:a}=this.context;if(Jn(i.getNodeLikeData([t])[0])||this.isCollapsingExpanding)return;typeof n=="boolean"&&(n={animation:n,align:!0});const s=i.getElementType(t);yield this.frontElement(t),this.isCollapsingExpanding=!0,this.setElementCollapsibility(t,!0),s==="node"?yield a.collapseNode(t,n):s==="combo"&&(yield a.collapseCombo(t,!!n.animation)),this.isCollapsingExpanding=!1})}expandElement(e){return dt(this,arguments,void 0,function*(t,n=!0){const{model:i,element:a}=this.context;if(!Jn(i.getNodeLikeData([t])[0])||this.isCollapsingExpanding)return;typeof n=="boolean"&&(n={animation:n,align:!0});const s=i.getElementType(t);this.isCollapsingExpanding=!0,this.setElementCollapsibility(t,!1),s==="node"?yield a.expandNode(t,n):s==="combo"&&(yield a.expandCombo(t,!!n.animation)),this.isCollapsingExpanding=!1})}setElementCollapsibility(e,t){const n=this.getElementType(e);n==="node"?this.updateNodeData([{id:e,style:{collapsed:t}}]):n==="combo"&&this.updateComboData([{id:e,style:{collapsed:t}}])}toDataURL(){return dt(this,arguments,void 0,function*(e={}){return this.context.canvas.toDataURL(e)})}getCanvasByViewport(e){return this.context.canvas.getCanvasByViewport(e)}getViewportByCanvas(e){return this.context.canvas.getViewportByCanvas(e)}getClientByCanvas(e){return this.context.canvas.getClientByCanvas(e)}getCanvasByClient(e){return this.context.canvas.getCanvasByClient(e)}getViewportCenter(){return this.context.viewport.getViewportCenter()}getCanvasCenter(){return this.context.viewport.getCanvasCenter()}on(e,t,n){return super.on(e,t,n)}once(e,t){return super.once(e,t)}off(e,t){return super.off(e,t)}}Yd.defaultOptions={autoResize:!1,theme:"light",rotation:0,zoom:1,zoomRange:[.01,10]};class BU extends xa{beforeDraw(e){const{add:t,update:n}=e,{model:i}=this.context;return[...t.edges.entries(),...n.edges.entries()].forEach(([,a])=>{iC(i,a)}),e}}const iC=(r,e)=>{const{source:t,target:n}=e,i=r.getElementDataById(t),a=r.getElementDataById(n),s=Zb(i,d=>r.getParentData(d,ut)),o=Zb(a,d=>r.getParentData(d,ut)),u=Q(s),l=Q(o),c={sourceNode:u,targetNode:l};return e.style?Object.assign(e.style,c):e.style=c,e},FU=(r,e,t)=>{const[n,i]=e,[a,s]=t;if(i===n)return a;const o=(r-n)/(i-n);return a+o*(s-a)},zU=(r,e,t)=>{const[n,i]=e,[a,s]=t,o=Math.log(r-n+1)/Math.log(i-n+1);return a+o*(s-a)},$U=(r,e,t,n=2)=>{const[i,a]=e,[s,o]=t,u=Math.pow((r-i)/(a-i),n);return s+u*(o-s)},qU=(r,e,t)=>{const[n,i]=e,[a,s]=t,o=Math.sqrt((r-n)/(i-n));return a+o*(s-a)};class Ud extends xa{constructor(e,t){super(e,Gn({},Ud.defaultOptions,t)),this.assignSizeByCentrality=(n,i,a,s,o,u)=>{const l=[i,a],c=[s[0],o[0]],d=[s[1],o[1]],h=[s[2],o[2]],f=(g,v)=>{if(typeof u=="function")return u(g,l,v);switch(u){case"linear":return FU(g,l,v);case"log":return zU(g,l,v);case"pow":return $U(g,l,v,2);case"sqrt":return qU(g,l,v);default:return v[0]}};return[f(n,c),f(n,d),f(n,h)]}}beforeDraw(e){const{model:t}=this.context,n=t.getNodeData(),i=hr(this.options.maxSize),a=hr(this.options.minSize),s=this.getCentralities(this.options.centrality),o=s.size>0?Math.max(...s.values()):0,u=s.size>0?Math.min(...s.values()):0;return n.forEach(l=>{var c;const d=this.assignSizeByCentrality(s.get(Q(l))||0,u,o,a,i,this.options.scale),h=(c=this.context.element)===null||c===void 0?void 0:c.getElement(Q(l)),f={size:d};this.assignLabelStyle(f,d,l,h),(!h||!jl(f,h.attributes))&&dr(e,h?"update":"add","node",Gn(l,{style:f}),!0)}),e}assignLabelStyle(e,t,n,i){var a;const s=i?i.config.style:(a=this.context.element)===null||a===void 0?void 0:a.getElementComputedStyle("node",n);if(Object.assign(e,$a(s,["labelFontSize","labelLineHeight"])),this.options.mapLabelSize){const o=this.getLabelSizeByNodeSize(t,1/0,Number(e.labelFontSize));Object.assign(e,{labelFontSize:o,labelLineHeight:o+b5(e.labelPadding)})}return e}getLabelSizeByNodeSize(e,t,n){const i=Math.min(...e)/2,[a,s]=Array.isArray(this.options.mapLabelSize)?this.options.mapLabelSize:[n,t];return Math.min(s,Math.max(i,a))}getCentralities(e){const{model:t}=this.context,n=t.getData();if(typeof e=="function")return e(n);const i=t.getRelatedEdgesData.bind(t);return qO(n,i,e)}}Ud.defaultOptions={centrality:{type:"degree"},maxSize:80,minSize:20,scale:"linear",mapLabelSize:!1};class Hd extends xa{constructor(e,t){super(e,Object.assign({},Hd.defaultOptions,t))}get ref(){return this.context.model.getRootsData()[0]}afterLayout(){var e;const t=on(this.ref),{graph:n,model:i}=this.context;(e=i.getData().nodes)===null||e===void 0||e.forEach(s=>{var o;if(Q(s)===Q(this.ref))return;const u=WO(ot(on(s),t)),l=Math.abs(u)>Math.PI/2,c=!s.children||s.children.length===0,d=Q(s),h=(o=this.context.element)===null||o===void 0?void 0:o.getElement(d);if(!h||!h.isVisible())return;const f=hr(n.getElementRenderStyle(d).size)[0]/2,g=(c?1:-1)*(f+this.options.offset),v=[["translate",g*Math.cos(u),g*Math.sin(u)],["rotate",l?Zn(u)+180:Zn(u)]];i.updateNodeData([{id:Q(s),style:{labelTextAlign:l===c?"right":"left",labelTextBaseline:"middle",labelTransform:v}}])}),n.draw()}}Hd.defaultOptions={offset:5};const GU="quadratic",R_=["top","top-right","right","right-bottom","bottom","bottom-left","left","left-top"];class Xd extends xa{constructor(e,t){super(e,Object.assign({},Xd.defaultOptions,t)),this.cacheMergeStyle=new Map,this.getAffectedParallelEdges=n=>{const{add:{edges:i},update:{nodes:a,edges:s,combos:o},remove:{edges:u}}=n,{model:l}=this.context,c=new Map,d=(g,v)=>{l.getRelatedEdgesData(v).forEach(y=>!c.has(Q(y))&&c.set(Q(y),y))};a.forEach(d),o.forEach(d);const h=g=>{const v=l.getEdgeData().map(y=>iC(l,y));WU(g,v).forEach(y=>!c.has(Q(y))&&c.set(Q(y),y))};if(u.size&&u.forEach(h),i.size&&i.forEach(h),s.size){const g=yN(s1(l.getChanges())).update.edges;s.forEach(v=>{var p;h(v);const y=(p=g.find(m=>Q(m.value)===Q(v)))===null||p===void 0?void 0:p.original;y&&!x1(v,y)&&h(y)})}ti(this.options.edges)||c.forEach((g,v)=>!this.options.edges.includes(v)&&c.delete(v));const f=l.getEdgeData().map(Q);return new Map([...c].sort((g,v)=>f.indexOf(g[0])-f.indexOf(v[0])))},this.applyBundlingStyle=(n,i,a)=>{const{edgeMap:s,reverses:o}=j_(i);s.forEach(u=>{u.forEach((l,c,d)=>{var h;const f=d.length,g=l.style||{};if(l.source===l.target){const y=R_.length;g.loopPlacement=R_[c%y],g.loopDist=Math.floor(c/y)*a+50}else if(f===1)g.curveOffset=0;else{const y=(c%2===0?1:-1)*(o[`${l.source}|${l.target}|${c}`]?-1:1);g.curveOffset=f%2===1?y*Math.ceil(c/2)*a*2:y*(Math.floor(c/2)*a*2+a)}const v=Object.assign(l,{type:GU,style:g}),p=(h=this.context.element)===null||h===void 0?void 0:h.getElement(Q(l));(!p||!jl(v.style,p.attributes))&&dr(n,p?"update":"add","edge",v,!0)})})},this.resetEdgeStyle=n=>{const i=n.style||{},a=this.cacheMergeStyle.get(Q(n))||{};return Object.keys(a).forEach(s=>{Bt(i[s],a[s])&&(n[s]?i[s]=n[s]:delete i[s])}),Object.assign(n,{style:i})},this.applyMergingStyle=(n,i)=>{const{edgeMap:a,reverses:s}=j_(i);a.forEach(o=>{var u;if(o.length===1){const c=o[0],d=(u=this.context.element)===null||u===void 0?void 0:u.getElement(Q(c)),h=this.resetEdgeStyle(c);(!d||!jl(h,d.attributes))&&dr(n,d?"update":"add","edge",h);return}const l=o.map(({source:c,target:d,style:h={}},f)=>{const{startArrow:g,endArrow:v}=h,p={},[y,m]=s[`${c}|${d}|${f}`]?["endArrow","startArrow"]:["startArrow","endArrow"];return Yl(g)&&(p[y]=g),Yl(v)&&(p[m]=v),p}).reduce((c,d)=>Object.assign(Object.assign({},c),d),{});o.forEach((c,d,h)=>{var f;if(d!==0){dr(n,"remove","edge",c);return}const g=Object.assign({},Te(this.options.style)?this.options.style(h):this.options.style,{childrenData:h});this.cacheMergeStyle.set(Q(c),g);const v=Object.assign(Object.assign({},c),{type:"line",style:Object.assign(Object.assign(Object.assign({},c.style),l),g)}),p=(f=this.context.element)===null||f===void 0?void 0:f.getElement(Q(c));(!p||!jl(v.style,p.attributes))&&dr(n,p?"update":"add","edge",v,!0)})})}}beforeDraw(e){const t=this.getAffectedParallelEdges(e);return t.size===0||(this.options.mode==="bundle"?this.applyBundlingStyle(e,t,this.options.distance):this.applyMergingStyle(e,t)),e}}Xd.defaultOptions={mode:"bundle",distance:15};const j_=r=>{const e=new Map,t=new Set,n={};for(const[i,a]of r){if(t.has(i))continue;const{source:s,target:o}=a,u=`${s}-${o}`;e.has(u)||e.set(u,[]),e.get(u).push(a),t.add(i);for(const[l,c]of r)t.has(l)||x1(a,c)&&(e.get(u).push(c),t.add(l),s===c.target&&o===c.source&&(n[`${c.source}|${c.target}|${e.get(u).length-1}`]=!0))}return{edgeMap:e,reverses:n}},WU=(r,e,t)=>e.filter(n=>x1(n,r)),x1=(r,e)=>{const{sourceNode:t,targetNode:n}=r.style||{},{sourceNode:i,targetNode:a}=e.style||{};return t===i&&n===a||t===a&&n===i};class VU extends xa{beforeDraw(e,t){const{stage:n}=t;if(n==="visibility")return e;const{model:i}=this.context,{update:{nodes:a,edges:s,combos:o}}=e,u=(l,c)=>{i.getRelatedEdgesData(c).forEach(h=>!s.has(Q(h))&&s.set(Q(h),h))};return a.forEach(u),o.forEach(u),e}}const YU={animation:{"combo-collapse":IO,"combo-expand":v5,"node-collapse":LO,"node-expand":g5,"path-in":DO,"path-out":p5,fade:h5,translate:f5},behavior:{"brush-select":fu,"click-select":Dc,"collapse-expand":Uc,"create-edge":Hc,"drag-canvas":Xc,"drag-element-force":xB,"drag-element":mu,"fix-element-size":Qc,"focus-element":Jc,"hover-activate":ed,"lasso-select":MB,"auto-adapt-label":Cc,"optimize-viewport-transform":td,"scroll-canvas":nd,"zoom-canvas":rd},combo:{circle:wj,rect:xj},edge:{cubic:ts,line:EA,polyline:Wc,quadratic:Vc,"cubic-horizontal":$c,"cubic-radial":qc,"cubic-vertical":Gc},layout:{"antv-dagre":_z,"combo-combined":R8,"compact-box":pl.compactBox,"d3-force":u9,"force-atlas2":Hq,circular:Az,concentric:Cy,dagre:md,dendrogram:pl.dendrogram,fishbone:bd,force:KA,fruchterman:Zq,grid:Jq,indented:pl.indented,mds:QA,mindmap:pl.mindmap,radial:uG,random:pG,snake:wd},node:{circle:vu,diamond:M6,ellipse:jc,hexagon:A6,html:Fc,image:pA,rect:mj,star:bj,donut:Rc,triangle:zc},palette:{spectral:CG,tableau:PG,oranges:LG,greens:DG,blues:IG},theme:{dark:dU,light:fU},plugin:{"bubble-sets":Md,"edge-bundling":_d,"edge-filter-lens":Td,"grid-line":kd,background:xd,contextmenu:Sd,fisheye:Od,fullscreen:Ad,history:Nd,hull:Cd,legend:Bd,minimap:Fd,snapline:zd,timebar:$d,toolbar:qd,tooltip:Gd,watermark:Wd},transform:{"arrange-draw-order":gU,"collapse-expand-combo":pU,"collapse-expand-node":vU,"get-edge-actual-ends":BU,"map-node-size":Ud,"place-radial-labels":Hd,"process-parallel-edges":Xd,"update-related-edges":VU},shape:{circle:Ii,ellipse:lu,group:ln,html:cu,image:km,line:Wa,path:lr,polygon:Ja,polyline:kc,rect:Sn,text:es,label:ya,badge:Vs}};function UU(){Object.entries(YU).forEach(([r,e])=>{Object.entries(e).forEach(([t,n])=>{yU(r,t,n)})})}UU();const E1={MILESTONE:{type:"里程碑",color:"#5b5b5b",textColor:"",base64:"",flag64:""},NOT_STARTED:{type:"未开始",color:"#CCCDD0",textColor:"#5b5b5b",base64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiNDQ0NERDAiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjgyOCAyMy45MDYtMjMuOTA2YzAtMTMuMDU1LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45NDUgNC4wOTUgMjhjMCAxMy4wNzggMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2Ii8+PC9zdmc+",flag64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiNDQ0NERDAiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjg1MSAyMy45MDYtMjMuOTA2YzAtMTMuMDc4LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45MjIgNC4wOTUgMjhjMCAxMy4wNTUgMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2bS05LjA3LTExLjExYy0uNTg2IDAtMS4xMDItLjUxNS0xLjEwMi0xLjA3N1YxOS44MmMwLTEuMDA4LjQ5Mi0xLjc1OCAxLjQ1My0yLjE4Yy44NDQtLjM3NCAxLjU3LS41ODUgMy4zNzUtLjU4NWM0LjI0MiAwIDYuODkgMi4wODYgMTAuODc1IDIuMDg2YzEuOTIyIDAgMi45My0uNDkzIDMuNTQtLjQ5M2MuNzk2IDAgMS40MDYuNDkzIDEuNDA2IDEuMTcydjExLjU1NWMwIDEuMDU1LS40NDYgMS43MzQtMS40NTQgMi4xOGMtLjg2Ny4zOTgtMS42MTcuNjA5LTMuMzc1LjYwOWMtNC4wNzggMC02LjY4LTIuMDYyLTEwLjg3NS0yLjA2MmMtMS40MyAwLTIuMzY3LjI4LTIuNzg5LjQ2OHY3LjE0OWMwIC41ODYtLjQ0NSAxLjA3OC0xLjA1NCAxLjA3OCIvPjwvc3ZnPg=="},DELAYED:{type:"已延期",color:"#B81111",textColor:"#dccbcb",base64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiNCODExMTEiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjgyOCAyMy45MDYtMjMuOTA2YzAtMTMuMDU1LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45NDUgNC4wOTUgMjhjMCAxMy4wNzggMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2Ii8+PC9zdmc+",flag64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiNCODExMTEiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjg1MSAyMy45MDYtMjMuOTA2YzAtMTMuMDc4LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45MjIgNC4wOTUgMjhjMCAxMy4wNTUgMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2bS05LjA3LTExLjExYy0uNTg2IDAtMS4xMDItLjUxNS0xLjEwMi0xLjA3N1YxOS44MmMwLTEuMDA4LjQ5Mi0xLjc1OCAxLjQ1My0yLjE4Yy44NDQtLjM3NCAxLjU3LS41ODUgMy4zNzUtLjU4NWM0LjI0MiAwIDYuODkgMi4wODYgMTAuODc1IDIuMDg2YzEuOTIyIDAgMi45My0uNDkzIDMuNTQtLjQ5M2MuNzk2IDAgMS40MDYuNDkzIDEuNDA2IDEuMTcydjExLjU1NWMwIDEuMDU1LS40NDYgMS43MzQtMS40NTQgMi4xOGMtLjg2Ny4zOTgtMS42MTcuNjA5LTMuMzc1LjYwOWMtNC4wNzggMC02LjY4LTIuMDYyLTEwLjg3NS0yLjA2MmMtMS40MyAwLTIuMzY3LjI4LTIuNzg5LjQ2OHY3LjE0OWMwIC41ODYtLjQ0NSAxLjA3OC0xLjA1NCAxLjA3OCIvPjwvc3ZnPg=="},PAUSED:{type:"已暂停",color:"#0E42D2",textColor:"#dae0f0",base64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiMwRTQyRDIiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjgyOCAyMy45MDYtMjMuOTA2YzAtMTMuMDU1LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45NDUgNC4wOTUgMjhjMCAxMy4wNzggMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2Ii8+PC9zdmc+",flag64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiMwRTQyRDIiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjg1MSAyMy45MDYtMjMuOTA2YzAtMTMuMDc4LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45MjIgNC4wOTUgMjhjMCAxMy4wNTUgMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2bS05LjA3LTExLjExYy0uNTg2IDAtMS4xMDItLjUxNS0xLjEwMi0xLjA3N1YxOS44MmMwLTEuMDA4LjQ5Mi0xLjc1OCAxLjQ1My0yLjE4Yy44NDQtLjM3NCAxLjU3LS41ODUgMy4zNzUtLjU4NWM0LjI0MiAwIDYuODkgMi4wODYgMTAuODc1IDIuMDg2YzEuOTIyIDAgMi45My0uNDkzIDMuNTQtLjQ5M2MuNzk2IDAgMS40MDYuNDkzIDEuNDA2IDEuMTcydjExLjU1NWMwIDEuMDU1LS40NDYgMS43MzQtMS40NTQgMi4xOGMtLjg2Ny4zOTgtMS42MTcuNjA5LTMuMzc1LjYwOWMtNC4wNzggMC02LjY4LTIuMDYyLTEwLjg3NS0yLjA2MmMtMS40MyAwLTIuMzY3LjI4LTIuNzg5LjQ2OHY3LjE0OWMwIC41ODYtLjQ0NSAxLjA3OC0xLjA1NCAxLjA3OCIvPjwvc3ZnPg=="},IN_PROGRESS:{type:"进行中",color:"#E1BE0D",textColor:"#4f4304",base64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiNFMUJFMEQiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjgyOCAyMy45MDYtMjMuOTA2YzAtMTMuMDU1LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45NDUgNC4wOTUgMjhjMCAxMy4wNzggMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2Ii8+PC9zdmc+",flag64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiNFMUJFMEQiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjg1MSAyMy45MDYtMjMuOTA2YzAtMTMuMDc4LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45MjIgNC4wOTUgMjhjMCAxMy4wNTUgMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2bS05LjA3LTExLjExYy0uNTg2IDAtMS4xMDItLjUxNS0xLjEwMi0xLjA3N1YxOS44MmMwLTEuMDA4LjQ5Mi0xLjc1OCAxLjQ1My0yLjE4Yy44NDQtLjM3NCAxLjU3LS41ODUgMy4zNzUtLjU4NWM0LjI0MiAwIDYuODkgMi4wODYgMTAuODc1IDIuMDg2YzEuOTIyIDAgMi45My0uNDkzIDMuNTQtLjQ5M2MuNzk2IDAgMS40MDYuNDkzIDEuNDA2IDEuMTcydjExLjU1NWMwIDEuMDU1LS40NDYgMS43MzQtMS40NTQgMi4xOGMtLjg2Ny4zOTgtMS42MTcuNjA5LTMuMzc1LjYwOWMtNC4wNzggMC02LjY4LTIuMDYyLTEwLjg3NS0yLjA2MmMtMS40MyAwLTIuMzY3LjI4LTIuNzg5LjQ2OHY3LjE0OWMwIC41ODYtLjQ0NSAxLjA3OC0xLjA1NCAxLjA3OCIvPjwvc3ZnPg=="},COMPLETED:{type:"已完成",color:"#33C73D",textColor:"#084e0c",base64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiMzM0M3M0QiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjgyOCAyMy45MDYtMjMuOTA2YzAtMTMuMDU1LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45NDUgNC4wOTUgMjhjMCAxMy4wNzggMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2Ii8+PC9zdmc+",flag64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiMzM0M3M0QiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjg1MSAyMy45MDYtMjMuOTA2YzAtMTMuMDc4LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45MjIgNC4wOTUgMjhjMCAxMy4wNTUgMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2bS05LjA3LTExLjExYy0uNTg2IDAtMS4xMDItLjUxNS0xLjEwMi0xLjA3N1YxOS44MmMwLTEuMDA4LjQ5Mi0xLjc1OCAxLjQ1My0yLjE4Yy44NDQtLjM3NCAxLjU3LS41ODUgMy4zNzUtLjU4NWM0LjI0MiAwIDYuODkgMi4wODYgMTAuODc1IDIuMDg2YzEuOTIyIDAgMi45My0uNDkzIDMuNTQtLjQ5M2MuNzk2IDAgMS40MDYuNDkzIDEuNDA2IDEuMTcydjExLjU1NWMwIDEuMDU1LS40NDYgMS43MzQtMS40NTQgMi4xOGMtLjg2Ny4zOTgtMS42MTcuNjA5LTMuMzc1LjYwOWMtNC4wNzggMC02LjY4LTIuMDYyLTEwLjg3NS0yLjA2MmMtMS40MyAwLTIuMzY3LjI4LTIuNzg5LjQ2OHY3LjE0OWMwIC41ODYtLjQ0NSAxLjA3OC0xLjA1NCAxLjA3OCIvPjwvc3ZnPg=="},COMPLETED_EARLY:{type:"提前完成",color:"#CCFF99",textColor:"#42681d",base64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiNDQ0ZGOTkiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjgyOCAyMy45MDYtMjMuOTA2YzAtMTMuMDU1LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45NDUgNC4wOTUgMjhjMCAxMy4wNzggMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2Ii8+PC9zdmc+",flag64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiNDQ0ZGOTkiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjg1MSAyMy45MDYtMjMuOTA2YzAtMTMuMDc4LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45MjIgNC4wOTUgMjhjMCAxMy4wNTUgMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2bS05LjA3LTExLjExYy0uNTg2IDAtMS4xMDItLjUxNS0xLjEwMi0xLjA3N1YxOS44MmMwLTEuMDA4LjQ5Mi0xLjc1OCAxLjQ1My0yLjE4Yy44NDQtLjM3NCAxLjU3LS41ODUgMy4zNzUtLjU4NWM0LjI0MiAwIDYuODkgMi4wODYgMTAuODc1IDIuMDg2YzEuOTIyIDAgMi45My0uNDkzIDMuNTQtLjQ5M2MuNzk2IDAgMS40MDYuNDkzIDEuNDA2IDEuMTcydjExLjU1NWMwIDEuMDU1LS40NDYgMS43MzQtMS40NTQgMi4xOGMtLjg2Ny4zOTgtMS42MTcuNjA5LTMuMzc1LjYwOWMtNC4wNzggMC02LjY4LTIuMDYyLTEwLjg3NS0yLjA2MmMtMS40MyAwLTIuMzY3LjI4LTIuNzg5LjQ2OHY3LjE0OWMwIC41ODYtLjQ0NSAxLjA3OC0xLjA1NCAxLjA3OCIvPjwvc3ZnPg=="},COMPLETED_LATE:{type:"延期完成",color:"#CC6699",textColor:"#4b092a",base64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiNDQzY2OTkiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjgyOCAyMy45MDYtMjMuOTA2YzAtMTMuMDU1LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45NDUgNC4wOTUgMjhjMCAxMy4wNzggMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2Ii8+PC9zdmc+",flag64:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxZW0iIGhlaWdodD0iMWVtIiB2aWV3Qm94PSIwIDAgNTYgNTYiPjxwYXRoIGZpbGw9IiNDQzY2OTkiIGQ9Ik0yOCA1MS45MDZjMTMuMDU1IDAgMjMuOTA2LTEwLjg1MSAyMy45MDYtMjMuOTA2YzAtMTMuMDc4LTEwLjg3NS0yMy45MDYtMjMuOTMtMjMuOTA2QzE0Ljg5OSA0LjA5NCA0LjA5NSAxNC45MjIgNC4wOTUgMjhjMCAxMy4wNTUgMTAuODI4IDIzLjkwNiAyMy45MDYgMjMuOTA2bS05LjA3LTExLjExYy0uNTg2IDAtMS4xMDItLjUxNS0xLjEwMi0xLjA3N1YxOS44MmMwLTEuMDA4LjQ5Mi0xLjc1OCAxLjQ1My0yLjE4Yy44NDQtLjM3NCAxLjU3LS41ODUgMy4zNzUtLjU4NWM0LjI0MiAwIDYuODkgMi4wODYgMTAuODc1IDIuMDg2YzEuOTIyIDAgMi45My0uNDkzIDMuNTQtLjQ5M2MuNzk2IDAgMS40MDYuNDkzIDEuNDA2IDEuMTcydjExLjU1NWMwIDEuMDU1LS40NDYgMS43MzQtMS40NTQgMi4xOGMtLjg2Ny4zOTgtMS42MTcuNjA5LTMuMzc1LjYwOWMtNC4wNzggMC02LjY4LTIuMDYyLTEwLjg3NS0yLjA2MmMtMS40MyAwLTIuMzY3LjI4LTIuNzg5LjQ2OHY3LjE0OWMwIC41ODYtLjQ0NSAxLjA3OC0xLjA1NCAxLjA3OCIvPjwvc3ZnPg=="}};function B_(r){if(!r.status)return"";const e=r.milestone?"flag64":"base64";return E1[r.status][e]}function HU(r){const e=PC(),t="rgb(158 163 171)",{container:n,autoFit:i="center",data:a,behaviors:s=[]}=r,o=new Yd({container:n,animation:!1,padding:16,theme:"light",autoFit:i,data:a,node:{type:"rect",style:u=>{const l=B_(u);let c="#000000";return u.taskState==="NOT_STARTED"&&(c="#787878"),{labelText:u.name,size:[120,26],radius:99,fill:"#FFFFFF",stroke:u.isDeleted?e.otherColor.error:t,lineDash:u.isDeleted?4:0,lineWidth:1,labelFill:c,labelX:2,labelY:2,labelTextBaseline:"middle",labelTextAlign:"center",labelLineHeight:13,labelWordWrap:!0,labelMaxWidth:72,iconSrc:l,iconWidth:16,iconHeight:16,iconX:-45,labelFontSize:12,labelPlacement:"center",badgeLineWidth:6,badgeFontSize:8,badges:[{text:"延期",placement:"top",offsetY:-11,visibility:u.isDelayed?"visible":"hidden"},{text:"已删除",placement:"bottom",offsetY:11,visibility:u.isDeleted?"visible":"hidden"}],badgePalette:[e.otherColor.error,e.otherColor.error],ports:[{placement:"left"},{placement:"right"}]}},state:{selected:{lineWidth:2,stroke:e.themeColor,labelFill:e.themeColor,halo:!0,haloStroke:e.themeColor,haloLineWidth:6},active:u=>({halo:!0,haloStroke:u.isDeleted?e.otherColor.error:e.themeColor,haloLineWidth:6,zIndex:2})}},edge:{type:"cubic-horizontal",style:u=>({curveOffset:10,curvePosition:.5,stroke:u.isDeleted?e.otherColor.error:t,lineDash:u.isDeleted?4:0}),state:{active:u=>({lineWidth:2,stroke:u.isDeleted?e.otherColor.error:e.themeColor,halo:!0,haloStroke:u.isDeleted?e.otherColor.error:e.themeColor,haloLineWidth:6,zIndex:2})}},layout:{type:"antv-dagre",rankdir:"LR",ranksep:20,nodesep:-20,controlPoints:!0},behaviors:[{key:"hover-activate",type:"hover-activate",degree:1,direction:"both"},"drag-canvas",...s],plugins:[{type:"tooltip",enable:u=>u.targetType==="node",getContent:(u,l)=>{let c='<div style="display: flex; flex-direction: column; gap: 8px;">';return l==null||l.forEach(d=>{c+=`<h3 style="display: flex; align-items: center; gap: 8px;">${d.name}</h3>`,c+=`<div style="display: flex;"><b>状态：</b><div style="display: flex; gap: 4px;"><img src="${B_(d)}" /><span style="font-weight: 400 !important;">${E1[d.status].type}</span></div></div>`,c+='<div style="display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); column-gap: 32px; row-gap: 4px;">',c+=`<div style="display: flex; flex-direction: column;"><div style="color: rgb(156 163 175);">预计开始</div><div style="font-weight: 700;">${d.startDate||"-"}</div></div>`,c+=`<div style="display: flex; flex-direction: column;"><div style="color: rgb(156 163 175);">预计结束</div><div style="font-weight: 700;">${d.endDate||"-"}</div></div>`,c+=`<div style="display: flex; flex-direction: column;"><div style="color: rgb(156 163 175);">实际开始</div><div style="font-weight: 700;">${d.actualStartDate||"-"}</div></div>`,c+=`<div style="display: flex; flex-direction: column;"><div style="color: rgb(156 163 175);">实际结束</div><div style="font-weight: 700;">${d.actualEndDate||"-"}</div></div>`,c+="</div>"}),c+="</div>",c}}]});return o.render(),{graph:o}}const XU={class:"relative"},KU={class:"absolute left-0 right-0 z-1 flex items-center items-stretch justify-between"},ZU={class:"flex-center gap-12px"},QU={class:"flex-col gap-8px"},JU=Ec({name:"AntvFLow",__name:"antv-flow",props:{behaviors:{},data:{},selected:{},height:{},autoFit:{}},setup(r,{expose:e}){const t=r,n=V_("containerRef"),i=LC(null),a=DC(()=>{i.value&&i.value.resize()},5);async function s(){i.value&&i.value.destroy();const{graph:h}=HU({container:"antv-flow",data:t.data,behaviors:t.behaviors,autoFit:t.autoFit});i.value=h,await o()}async function o(){if(t.selected&&i.value)try{await i.value.setElementState(t.selected,"selected")}catch{}}function u(){var h;(h=i.value)==null||h.zoomBy(.9)}function l(){var h;(h=i.value)==null||h.zoomBy(1.1)}function c(){var h,f;(h=i.value)==null||h.zoomTo(1),(f=i.value)==null||f.fitCenter()}function d(){var h,f;(h=i.value)==null||h.fitView(),(f=i.value)==null||f.fitCenter()}return eu([()=>t.data,()=>t.selected],()=>{s()},{deep:!0}),e({selectNode:o,graph:i}),(h,f)=>{const g=_P,v=Y_,p=EP,y=bP,m=vP,w=eP,M=fP,S=cP,T=oP,A=zC,O=KC,N=XC,C=BC;return Bn(),ui("div",XU,[Vt("div",KU,[Xt(w,{size:"small",class:"bg-white!"},{default:fn(()=>[Xt(v,{onClick:u},{default:fn(()=>[Xt(g)]),_:1}),Xt(v,{onClick:l},{default:fn(()=>[Xt(p)]),_:1}),Xt(v,{onClick:c},{default:fn(()=>[Xt(y)]),_:1}),Xt(v,{onClick:d},{default:fn(()=>[Xt(m)]),_:1})]),_:1}),Vt("div",ZU,[Xt(C,{placement:"bottom-end",animated:!1},{trigger:fn(()=>[Xt(v,{size:"small",class:"bg-white!"},{default:fn(()=>[Xt(M)]),_:1})]),default:fn(()=>[Vt("div",QU,[f[1]||(f[1]=Vt("div",{span:"2",class:"text-12px font-bold"},"节点图例",-1)),Xt(N,{cols:2,"y-gap":8,class:"w-180px!"},{default:fn(()=>[(Bn(!0),ui(IC,null,RC(eh(E1),(P,D)=>(Bn(),To(O,{key:D,class:"flex-center"},{default:fn(()=>[Xt(A,{size:"small",round:"",bordered:!1},{icon:fn(()=>[D==="MILESTONE"?(Bn(),To(S,{key:0,style:th({color:P.color})},null,8,["style"])):(Bn(),To(T,{key:1,style:th({color:P.color})},null,8,["style"]))]),default:fn(()=>[fo(" "+FC(P.type),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})])]),_:1})])]),jC(Vt("div",{id:"antv-flow",ref_key:"containerRef",ref:n,class:"w-full",style:th({height:t.height||"300px"}),onContextmenu:f[0]||(f[0]=P=>P.preventDefault())},null,36),[[eh(kP),eh(a)]])])}}});function eH(){return{nodes:[{id:"NS",name:"Start",status:"COMPLETED",startDate:"2024-10-01",endDate:"2024-10-07",actualStartDate:"2024-10-01",actualEndDate:"2024-10-07"},{id:"N1",name:"Node1",status:"COMPLETED_EARLY",startDate:"2024-10-08",endDate:"2024-10-10",actualStartDate:"2024-10-08",actualEndDate:"2024-10-09",milestone:!0},{id:"N2",name:"Node2",status:"COMPLETED_EARLY",startDate:"2024-10-11",endDate:"2024-10-13",actualStartDate:"2024-10-11",actualEndDate:"2024-10-12"},{id:"N3",name:"Node3",status:"IN_PROGRESS",isDeleted:!0},{id:"N4",name:"Node4",status:"COMPLETED_LATE"},{id:"N5",name:"Node5",status:"DELAYED",isDelayed:!0,milestone:!0},{id:"N6",name:"Node6",status:"PAUSED"},{id:"N7",name:"Node7",status:"NOT_STARTED"},{id:"N8",name:"Node8",status:"NOT_STARTED"},{id:"N9",name:"End",status:"NOT_STARTED"},{id:"NX",name:"NodeX",status:"NOT_STARTED",isDeleted:!0}],edges:[{id:"E1",source:"NS",target:"N1"},{id:"E2",source:"N1",target:"N2"},{id:"E3",source:"N1",target:"N3",isDeleted:!0},{id:"E4",source:"N1",target:"N4"},{id:"E5",source:"N2",target:"N5"},{id:"E6",source:"N3",target:"N5",isDeleted:!0},{id:"E7",source:"N4",target:"N5"},{id:"E8",source:"N5",target:"N6"},{id:"E9",source:"N6",target:"N7"},{id:"E10",source:"N6",target:"N8"},{id:"E11",source:"N7",target:"N9"},{id:"EX",source:"N8",target:"N9"},{id:"EO",source:"N5",target:"NX",isDeleted:!0}]}}const tH={class:"h-full"},fH=Ec({name:"plugin_charts_antv",__name:"index",setup(r){const e=V_("antvFlowRef"),t=Io({nodes:[],edges:[]}),n=Io("N2"),i=[{type:"click-select",enable:u=>u.targetType==="node",onClick:u=>{var d;const l=u.target,c=t.value.nodes.find(h=>h.id===l.id);n.value=c==null?void 0:c.id,(d=window.$message)==null||d.success(`选中节点：[${l.id}]${c==null?void 0:c.name}`)}}],a=Jo(()=>t.value.nodes.some(u=>u.id==="NN"));function s(){const{nodes:u,edges:l}=t.value;u.push({id:"NN",name:"New node",status:"NOT_STARTED"}),l.push({id:"EN",source:"N5",target:"NN"}),t.value={nodes:u,edges:l}}function o(u){const{nodes:l,edges:c}=t.value;t.value={nodes:l.filter(d=>d.id!==u),edges:c.filter(d=>d.source!==u&&d.target!==u)}}return G_(()=>{t.value=eH()}),(u,l)=>{const c=$C,d=Y_,h=iP,f=qC;return Bn(),ui("div",tH,[Xt(f,{title:"AntV G6 Next",bordered:!1,class:"h-full card-wrapper"},{default:fn(()=>[Xt(JU,{ref_key:"antvFlowRef",ref:e,data:t.value,selected:n.value,behaviors:i},null,8,["data","selected"]),Xt(c),Xt(h,null,{default:fn(()=>[Xt(d,{onClick:l[0]||(l[0]=g=>n.value="N5")},{default:fn(()=>l[3]||(l[3]=[fo("选中节点N5(需要自行处理选中事件，不会触发元素点击)")])),_:1}),a.value?(Bn(),To(d,{key:1,onClick:l[1]||(l[1]=()=>o("NN"))},{default:fn(()=>l[5]||(l[5]=[fo("删除新添加的节点")])),_:1})):(Bn(),To(d,{key:0,onClick:s},{default:fn(()=>l[4]||(l[4]=[fo("添加节点并与Node5连线")])),_:1})),Xt(d,{onClick:l[2]||(l[2]=()=>o("NX"))},{default:fn(()=>l[6]||(l[6]=[fo("删除NodeX")])),_:1})]),_:1})]),_:1})])}}});export{fH as default};
