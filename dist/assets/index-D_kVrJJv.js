import{_ as ft,a as ht,b as gt,c as mt,d as vt,N as bt,e as yt}from"./round-refresh-B7VpfLgK.js";import{u as pt,a as kt,b as dn,w as xt,_ as wt}from"./table-Gm6yRvUm.js";import{b as _t,u as Nt,c as Rt,d as Ct,e as St,f as Dt,g as Kt,h as Tt}from"./sys-W0-bi7XJ.js";import{d as he,X as w,aG as Ln,aO as Oe,r as q,v as Lt,bt as sn,b3 as Et,as as Bt,ai as At,a as H,aD as Ot,b1 as J,i as Pt,bl as Ft,bu as We,ap as En,ah as It,a2 as z,a6 as fe,a4 as j,a5 as xn,a3 as Le,aI as Ee,a_ as $t,a7 as Ut,a9 as Mt,a8 as Bn,bv as zt,bw as wn,ar as Ie,aJ as P,b8 as Ge,O as Be,bb as Xe,bx as $e,by as _n,bz as jt,ba as ne,aX as Ht,aa as cn,ac as Vt,af as Nn,bA as qt,bB as Rn,bC as Cn,M as Ye,N as hn,$ as F,bD as Sn,o as we,c as Ae,w as S,f as k,g as me,t as _e,h as D,B as xe,bE as Wt,au as Gt,U as Ue,P as fn,s as An,R as Xt,S as Yt,J as On,z as Jt,b as Qt,W as Zt}from"./index-D6W6_zXP.js";import{u as el}from"./auth-DdtuPNda.js";import{u as nl,_ as tl,b as Pn}from"./form-a8uLA4Rd.js";import{_ as Je}from"./Space-zKntJrGG.js";import{_ as ll}from"./DatePicker-CeSQ1aZs.js";import{_ as al}from"./Grid-Cxuy6_wU.js";import{_ as ol}from"./DataTable-BesTDHU0.js";import"./get-slot-Bk_rJcZu.js";import"./Pagination-BQ2WJ-Rm.js";function Fn(e){return typeof e=="string"?`s-${e}`:`n-${e}`}const il=he({name:"Switcher",render(){return w("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},w("path",{d:"M12 8l10 8l-10 8z"}))}}),In=Ln("n-tree-select");function Dn({position:e,offsetLevel:t,indent:o,el:r}){const d={position:"absolute",boxSizing:"border-box",right:0};if(e==="inside")d.left=0,d.top=0,d.bottom=0,d.borderRadius="inherit",d.boxShadow="inset 0 0 0 2px var(--n-drop-mark-color)";else{const i=e==="before"?"top":"bottom";d[i]=0,d.left=`${r.offsetLeft+6-t*o}px`,d.height="2px",d.backgroundColor="var(--n-drop-mark-color)",d.transformOrigin=i,d.borderRadius="1px",d.transform=e==="before"?"translateY(-4px)":"translateY(4px)"}return w("div",{style:d})}function rl({dropPosition:e,node:t}){return t.isLeaf===!1||t.children?!0:e!=="inside"}const Me=Ln("n-tree");function dl({props:e,fNodesRef:t,mergedExpandedKeysRef:o,mergedSelectedKeysRef:r,mergedCheckedKeysRef:d,handleCheck:i,handleSelect:y,handleSwitcherClick:b}){const{value:f}=r,x=Oe(In,null),m=x?x.pendingNodeKeyRef:q(f.length?f[f.length-1]:null);function p(g){var K;if(!e.keyboard)return{enterBehavior:null};const{value:N}=m;let R=null;if(N===null){if((g.key==="ArrowDown"||g.key==="ArrowUp")&&g.preventDefault(),["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(g.key)&&N===null){const{value:v}=t;let s=0;for(;s<v.length;){if(!v[s].disabled){m.value=v[s].key;break}s+=1}}}else{const{value:v}=t;let s=v.findIndex(C=>C.key===N);if(!~s)return{enterBehavior:null};if(g.key==="Enter"){const C=v[s];switch(R=((K=e.overrideDefaultNodeClickBehavior)===null||K===void 0?void 0:K.call(e,{option:C.rawNode}))||null,R){case"toggleCheck":i(C,!d.value.includes(C.key));break;case"toggleSelect":y(C);break;case"toggleExpand":b(C);break;case"none":break;case"default":default:R="default",y(C)}}else if(g.key==="ArrowDown")for(g.preventDefault(),s+=1;s<v.length;){if(!v[s].disabled){m.value=v[s].key;break}s+=1}else if(g.key==="ArrowUp")for(g.preventDefault(),s-=1;s>=0;){if(!v[s].disabled){m.value=v[s].key;break}s-=1}else if(g.key==="ArrowLeft"){const C=v[s];if(C.isLeaf||!o.value.includes(N)){const _=C.getParent();_&&(m.value=_.key)}else b(C)}else if(g.key==="ArrowRight"){const C=v[s];if(C.isLeaf)return{enterBehavior:null};if(!o.value.includes(N))b(C);else for(s+=1;s<v.length;){if(!v[s].disabled){m.value=v[s].key;break}s+=1}}}return{enterBehavior:R}}return{pendingNodeKeyRef:m,handleKeydown:p}}const sl=he({name:"NTreeNodeCheckbox",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},right:Boolean,focusable:Boolean,disabled:Boolean,checked:Boolean,indeterminate:Boolean,onCheck:Function},setup(e){const t=Oe(Me);function o(d){const{onCheck:i}=e;i&&i(d)}function r(d){o(d)}return{handleUpdateValue:r,mergedTheme:t.mergedThemeRef}},render(){const{clsPrefix:e,mergedTheme:t,checked:o,indeterminate:r,disabled:d,focusable:i,indent:y,handleUpdateValue:b}=this;return w("span",{class:[`${e}-tree-node-checkbox`,this.right&&`${e}-tree-node-checkbox--right`],style:{width:`${y}px`},"data-checkbox":!0},w(Lt,{focusable:i,disabled:d,theme:t.peers.Checkbox,themeOverrides:t.peerOverrides.Checkbox,checked:o,indeterminate:r,onUpdateChecked:b}))}}),cl=he({name:"TreeNodeContent",props:{clsPrefix:{type:String,required:!0},disabled:Boolean,checked:Boolean,selected:Boolean,onClick:Function,onDragstart:Function,tmNode:{type:Object,required:!0},nodeProps:Object},setup(e){const{renderLabelRef:t,renderPrefixRef:o,renderSuffixRef:r,labelFieldRef:d}=Oe(Me),i=q(null);function y(f){const{onClick:x}=e;x&&x(f)}function b(f){y(f)}return{selfRef:i,renderLabel:t,renderPrefix:o,renderSuffix:r,labelField:d,handleClick:b}},render(){const{clsPrefix:e,labelField:t,nodeProps:o,checked:r=!1,selected:d=!1,renderLabel:i,renderPrefix:y,renderSuffix:b,handleClick:f,onDragstart:x,tmNode:{rawNode:m,rawNode:{prefix:p,suffix:g,[t]:K}}}=this;return w("span",Object.assign({},o,{ref:"selfRef",class:[`${e}-tree-node-content`,o==null?void 0:o.class],onClick:f,draggable:x===void 0?void 0:!0,onDragstart:x}),y||p?w("div",{class:`${e}-tree-node-content__prefix`},y?y({option:m,selected:d,checked:r}):sn(p)):null,w("div",{class:`${e}-tree-node-content__text`},i?i({option:m,selected:d,checked:r}):sn(K)),b||g?w("div",{class:`${e}-tree-node-content__suffix`},b?b({option:m,selected:d,checked:r}):sn(g)):null)}}),ul=he({name:"NTreeSwitcher",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},expanded:Boolean,selected:Boolean,hide:Boolean,loading:Boolean,onClick:Function,tmNode:{type:Object,required:!0}},setup(e){const{renderSwitcherIconRef:t}=Oe(Me,null);return()=>{const{clsPrefix:o,expanded:r,hide:d,indent:i,onClick:y}=e;return w("span",{"data-switcher":!0,class:[`${o}-tree-node-switcher`,r&&`${o}-tree-node-switcher--expanded`,d&&`${o}-tree-node-switcher--hide`],style:{width:`${i}px`},onClick:y},w("div",{class:`${o}-tree-node-switcher__icon`},w(Et,null,{default:()=>{if(e.loading)return w(Bt,{clsPrefix:o,key:"loading",radius:85,strokeWidth:20});const{value:b}=t;return b?b({expanded:e.expanded,selected:e.selected,option:e.tmNode.rawNode}):w(At,{clsPrefix:o,key:"switcher"},{default:()=>w(il,null)})}})))}}});function fl(e){return H(()=>e.leafOnly?"child":e.checkStrategy)}function ye(e,t){return!!e.rawNode[t]}function $n(e,t,o,r){e==null||e.forEach(d=>{o(d),$n(d[t],t,o,r),r(d)})}function hl(e,t,o,r,d){const i=new Set,y=new Set,b=[];return $n(e,r,f=>{if(b.push(f),d(t,f)){y.add(f[o]);for(let x=b.length-2;x>=0;--x)if(!i.has(b[x][o]))i.add(b[x][o]);else return}},()=>{b.pop()}),{expandedKeys:Array.from(i),highlightKeySet:y}}if(Ot&&Image){const e=new Image;e.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}function gl(e,t,o,r,d){const i=new Set,y=new Set,b=new Set,f=[],x=[],m=[];function p(K){K.forEach(N=>{if(m.push(N),t(o,N)){i.add(N[r]),b.add(N[r]);for(let v=m.length-2;v>=0;--v){const s=m[v][r];if(!y.has(s))y.add(s),i.has(s)&&i.delete(s);else break}}const R=N[d];R&&p(R),m.pop()})}p(e);function g(K,N){K.forEach(R=>{const v=R[r],s=i.has(v),C=y.has(v);if(!s&&!C)return;const _=R[d];if(_)if(s)N.push(R);else{f.push(v);const $=Object.assign(Object.assign({},R),{[d]:[]});N.push($),g(_,$[d])}else N.push(R)})}return g(e,x),{filteredTree:x,highlightKeySet:b,expandedKeys:f}}const Un=he({name:"TreeNode",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(e){const t=Oe(Me),{droppingNodeParentRef:o,droppingMouseNodeRef:r,draggingNodeRef:d,droppingPositionRef:i,droppingOffsetLevelRef:y,nodePropsRef:b,indentRef:f,blockLineRef:x,checkboxPlacementRef:m,checkOnClickRef:p,disabledFieldRef:g,showLineRef:K,renderSwitcherIconRef:N,overrideDefaultNodeClickBehaviorRef:R}=t,v=J(()=>!!e.tmNode.rawNode.checkboxDisabled),s=J(()=>ye(e.tmNode,g.value)),C=J(()=>t.disabledRef.value||s.value),_=H(()=>{const{value:c}=b;if(c)return c({option:e.tmNode.rawNode})}),$=q(null),U={value:null};Pt(()=>{U.value=$.value.$el});function Q(){const c=()=>{const{tmNode:E}=e;if(!E.isLeaf&&!E.shallowLoaded){if(!t.loadingKeysRef.value.has(E.key))t.loadingKeysRef.value.add(E.key);else return;const{onLoadRef:{value:I}}=t;I&&I(E.rawNode).then(V=>{V!==!1&&t.handleSwitcherClick(E)}).finally(()=>{t.loadingKeysRef.value.delete(E.key)})}else t.handleSwitcherClick(E)};N.value?setTimeout(c,0):c()}const te=J(()=>!s.value&&t.selectableRef.value&&(t.internalTreeSelect?t.mergedCheckStrategyRef.value!=="child"||t.multipleRef.value&&t.cascadeRef.value||e.tmNode.isLeaf:!0)),le=J(()=>t.checkableRef.value&&(t.cascadeRef.value||t.mergedCheckStrategyRef.value!=="child"||e.tmNode.isLeaf)),ge=J(()=>t.displayedCheckedKeysRef.value.includes(e.tmNode.key)),ce=J(()=>{const{value:c}=le;if(!c)return!1;const{value:E}=p,{tmNode:I}=e;return typeof E=="boolean"?!I.disabled&&E:E(e.tmNode.rawNode)});function T(c){const{value:E}=t.expandOnClickRef,{value:I}=te,{value:V}=ce;if(!I&&!E&&!V||We(c,"checkbox")||We(c,"switcher"))return;const{tmNode:Y}=e;I&&t.handleSelect(Y),E&&!Y.isLeaf&&Q(),V&&Z(!ge.value)}function B(c){var E,I;if(!(We(c,"checkbox")||We(c,"switcher"))){if(!C.value){const V=R.value;let Y=!1;if(V)switch(V({option:e.tmNode.rawNode})){case"toggleCheck":Y=!0,Z(!ge.value);break;case"toggleSelect":Y=!0,t.handleSelect(e.tmNode);break;case"toggleExpand":Y=!0,Q(),Y=!0;break;case"none":Y=!0,Y=!0;return}Y||T(c)}(I=(E=_.value)===null||E===void 0?void 0:E.onClick)===null||I===void 0||I.call(E,c)}}function G(c){x.value||B(c)}function W(c){x.value&&B(c)}function Z(c){t.handleCheck(e.tmNode,c)}function ae(c){t.handleDragStart({event:c,node:e.tmNode})}function ve(c){c.currentTarget===c.target&&t.handleDragEnter({event:c,node:e.tmNode})}function L(c){c.preventDefault(),t.handleDragOver({event:c,node:e.tmNode})}function re(c){t.handleDragEnd({event:c,node:e.tmNode})}function pe(c){c.currentTarget===c.target&&t.handleDragLeave({event:c,node:e.tmNode})}function Qe(c){c.preventDefault(),i.value!==null&&t.handleDrop({event:c,node:e.tmNode,dropPosition:i.value})}const Ze=H(()=>{const{clsPrefix:c}=e,{value:E}=f;if(K.value){const I=[];let V=e.tmNode.parent;for(;V;)V.isLastChild?I.push(w("div",{class:`${c}-tree-node-indent`},w("div",{style:{width:`${E}px`}}))):I.push(w("div",{class:[`${c}-tree-node-indent`,`${c}-tree-node-indent--show-line`]},w("div",{style:{width:`${E}px`}}))),V=V.parent;return I.reverse()}else return Ft(e.tmNode.level,w("div",{class:`${e.clsPrefix}-tree-node-indent`},w("div",{style:{width:`${E}px`}})))});return{showDropMark:J(()=>{const{value:c}=d;if(!c)return;const{value:E}=i;if(!E)return;const{value:I}=r;if(!I)return;const{tmNode:V}=e;return V.key===I.key}),showDropMarkAsParent:J(()=>{const{value:c}=o;if(!c)return!1;const{tmNode:E}=e,{value:I}=i;return I==="before"||I==="after"?c.key===E.key:!1}),pending:J(()=>t.pendingNodeKeyRef.value===e.tmNode.key),loading:J(()=>t.loadingKeysRef.value.has(e.tmNode.key)),highlight:J(()=>{var c;return(c=t.highlightKeySetRef.value)===null||c===void 0?void 0:c.has(e.tmNode.key)}),checked:ge,indeterminate:J(()=>t.displayedIndeterminateKeysRef.value.includes(e.tmNode.key)),selected:J(()=>t.mergedSelectedKeysRef.value.includes(e.tmNode.key)),expanded:J(()=>t.mergedExpandedKeysRef.value.includes(e.tmNode.key)),disabled:C,checkable:le,mergedCheckOnClick:ce,checkboxDisabled:v,selectable:te,expandOnClick:t.expandOnClickRef,internalScrollable:t.internalScrollableRef,draggable:t.draggableRef,blockLine:x,nodeProps:_,checkboxFocusable:t.internalCheckboxFocusableRef,droppingPosition:i,droppingOffsetLevel:y,indent:f,checkboxPlacement:m,showLine:K,contentInstRef:$,contentElRef:U,indentNodes:Ze,handleCheck:Z,handleDrop:Qe,handleDragStart:ae,handleDragEnter:ve,handleDragOver:L,handleDragEnd:re,handleDragLeave:pe,handleLineClick:W,handleContentClick:G,handleSwitcherClick:Q}},render(){const{tmNode:e,clsPrefix:t,checkable:o,expandOnClick:r,selectable:d,selected:i,checked:y,highlight:b,draggable:f,blockLine:x,indent:m,indentNodes:p,disabled:g,pending:K,internalScrollable:N,nodeProps:R,checkboxPlacement:v}=this,s=f&&!g?{onDragenter:this.handleDragEnter,onDragleave:this.handleDragLeave,onDragend:this.handleDragEnd,onDrop:this.handleDrop,onDragover:this.handleDragOver}:void 0,C=N?Fn(e.key):void 0,_=v==="right",$=o?w(sl,{indent:m,right:_,focusable:this.checkboxFocusable,disabled:g||this.checkboxDisabled,clsPrefix:t,checked:this.checked,indeterminate:this.indeterminate,onCheck:this.handleCheck}):null;return w("div",Object.assign({class:`${t}-tree-node-wrapper`},s),w("div",Object.assign({},x?R:void 0,{class:[`${t}-tree-node`,{[`${t}-tree-node--selected`]:i,[`${t}-tree-node--checkable`]:o,[`${t}-tree-node--highlight`]:b,[`${t}-tree-node--pending`]:K,[`${t}-tree-node--disabled`]:g,[`${t}-tree-node--selectable`]:d,[`${t}-tree-node--clickable`]:d||r||this.mergedCheckOnClick},R==null?void 0:R.class],"data-key":C,draggable:f&&x,onClick:this.handleLineClick,onDragstart:f&&x&&!g?this.handleDragStart:void 0}),p,e.isLeaf&&this.showLine?w("div",{class:[`${t}-tree-node-indent`,`${t}-tree-node-indent--show-line`,e.isLeaf&&`${t}-tree-node-indent--is-leaf`,e.isLastChild&&`${t}-tree-node-indent--last-child`]},w("div",{style:{width:`${m}px`}})):w(ul,{clsPrefix:t,expanded:this.expanded,selected:i,loading:this.loading,hide:e.isLeaf,tmNode:this.tmNode,indent:m,onClick:this.handleSwitcherClick}),_?null:$,w(cl,{ref:"contentInstRef",clsPrefix:t,checked:y,selected:i,onClick:this.handleContentClick,nodeProps:x?void 0:R,onDragstart:f&&!x&&!g?this.handleDragStart:void 0,tmNode:e}),f?this.showDropMark?Dn({el:this.contentElRef.value,position:this.droppingPosition,offsetLevel:this.droppingOffsetLevel,indent:m}):this.showDropMarkAsParent?Dn({el:this.contentElRef.value,position:"inside",offsetLevel:this.droppingOffsetLevel,indent:m}):null:null,_?$:null))}}),ml=he({name:"TreeMotionWrapper",props:{clsPrefix:{type:String,required:!0},height:Number,nodes:{type:Array,required:!0},mode:{type:String,required:!0},onAfterEnter:{type:Function,required:!0}},render(){const{clsPrefix:e}=this;return w(It,{onAfterEnter:this.onAfterEnter,appear:!0,reverse:this.mode==="collapse"},{default:()=>w("div",{class:[`${e}-tree-motion-wrapper`,`${e}-tree-motion-wrapper--${this.mode}`],style:{height:En(this.height)}},this.nodes.map(t=>w(Un,{clsPrefix:e,tmNode:t})))})}}),un=$t(),vl=z("tree",`
 font-size: var(--n-font-size);
 outline: none;
`,[fe("ul, li",`
 margin: 0;
 padding: 0;
 list-style: none;
 `),fe(">",[z("tree-node",[fe("&:first-child","margin-top: 0;")])]),z("tree-motion-wrapper",[j("expand",[xn({duration:"0.2s"})]),j("collapse",[xn({duration:"0.2s",reverse:!0})])]),z("tree-node-wrapper",`
 box-sizing: border-box;
 padding: var(--n-node-wrapper-padding);
 `),z("tree-node",`
 transform: translate3d(0,0,0);
 position: relative;
 display: flex;
 border-radius: var(--n-node-border-radius);
 transition: background-color .3s var(--n-bezier);
 `,[j("highlight",[z("tree-node-content",[Le("text","border-bottom-color: var(--n-node-text-color-disabled);")])]),j("disabled",[z("tree-node-content",`
 color: var(--n-node-text-color-disabled);
 cursor: not-allowed;
 `)]),Ee("disabled",[j("clickable",[z("tree-node-content",`
 cursor: pointer;
 `)])])]),j("block-node",[z("tree-node-content",`
 flex: 1;
 min-width: 0;
 `)]),Ee("block-line",[z("tree-node",[Ee("disabled",[z("tree-node-content",[fe("&:hover","background: var(--n-node-color-hover);")]),j("selectable",[z("tree-node-content",[fe("&:active","background: var(--n-node-color-pressed);")])]),j("pending",[z("tree-node-content",`
 background: var(--n-node-color-hover);
 `)]),j("selected",[z("tree-node-content","background: var(--n-node-color-active);")])]),j("selected",[z("tree-node-content","background: var(--n-node-color-active);")])])]),j("block-line",[z("tree-node",[Ee("disabled",[fe("&:hover","background: var(--n-node-color-hover);"),j("pending",`
 background: var(--n-node-color-hover);
 `),j("selectable",[Ee("selected",[fe("&:active","background: var(--n-node-color-pressed);")])]),j("selected","background: var(--n-node-color-active);")]),j("selected","background: var(--n-node-color-active);"),j("disabled",`
 cursor: not-allowed;
 `)])]),z("tree-node-indent",`
 flex-grow: 0;
 flex-shrink: 0;
 `,[j("show-line","position: relative",[fe("&::before",`
 position: absolute;
 left: 50%;
 border-left: 1px solid var(--n-line-color);
 transition: border-color .3s var(--n-bezier);
 transform: translate(-50%);
 content: "";
 top: var(--n-line-offset-top);
 bottom: var(--n-line-offset-bottom);
 `),j("last-child",[fe("&::before",`
 bottom: 50%;
 `)]),j("is-leaf",[fe("&::after",`
 position: absolute;
 content: "";
 left: calc(50% + 0.5px);
 right: 0;
 bottom: 50%;
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-line-color);
 `)])]),Ee("show-line","height: 0;")]),z("tree-node-switcher",`
 cursor: pointer;
 display: inline-flex;
 flex-shrink: 0;
 height: var(--n-node-content-height);
 align-items: center;
 justify-content: center;
 transition: transform .15s var(--n-bezier);
 vertical-align: bottom;
 `,[Le("icon",`
 position: relative;
 height: 14px;
 width: 14px;
 display: flex;
 color: var(--n-arrow-color);
 transition: color .3s var(--n-bezier);
 font-size: 14px;
 `,[z("icon",[un]),z("base-loading",`
 color: var(--n-loading-color);
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 `,[un]),z("base-icon",[un])]),j("hide","visibility: hidden;"),j("expanded","transform: rotate(90deg);")]),z("tree-node-checkbox",`
 display: inline-flex;
 height: var(--n-node-content-height);
 vertical-align: bottom;
 align-items: center;
 justify-content: center;
 `),z("tree-node-content",`
 user-select: none;
 position: relative;
 display: inline-flex;
 align-items: center;
 min-height: var(--n-node-content-height);
 box-sizing: border-box;
 line-height: var(--n-line-height);
 vertical-align: bottom;
 padding: 0 6px 0 4px;
 cursor: default;
 border-radius: var(--n-node-border-radius);
 color: var(--n-node-text-color);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[fe("&:last-child","margin-bottom: 0;"),Le("prefix",`
 display: inline-flex;
 margin-right: 8px;
 `),Le("text",`
 border-bottom: 1px solid #0000;
 transition: border-color .3s var(--n-bezier);
 flex-grow: 1;
 max-width: 100%;
 `),Le("suffix",`
 display: inline-flex;
 `)]),Le("empty","margin: auto;")]);var bl=function(e,t,o,r){function d(i){return i instanceof o?i:new o(function(y){y(i)})}return new(o||(o=Promise))(function(i,y){function b(m){try{x(r.next(m))}catch(p){y(p)}}function f(m){try{x(r.throw(m))}catch(p){y(p)}}function x(m){m.done?i(m.value):d(m.value).then(b,f)}x((r=r.apply(e,[])).next())})};function Kn(e,t,o,r){return{getIsGroup(){return!1},getKey(i){return i[e]},getChildren:r||(i=>i[t]),getDisabled(i){return!!(i[o]||i.checkboxDisabled)}}}const yl={allowCheckingNotLoaded:Boolean,filter:Function,defaultExpandAll:Boolean,expandedKeys:Array,keyField:{type:String,default:"key"},labelField:{type:String,default:"label"},childrenField:{type:String,default:"children"},disabledField:{type:String,default:"disabled"},defaultExpandedKeys:{type:Array,default:()=>[]},indeterminateKeys:Array,renderSwitcherIcon:Function,onUpdateIndeterminateKeys:[Function,Array],"onUpdate:indeterminateKeys":[Function,Array],onUpdateExpandedKeys:[Function,Array],"onUpdate:expandedKeys":[Function,Array],overrideDefaultNodeClickBehavior:Function},pl=Object.assign(Object.assign(Object.assign(Object.assign({},Bn.props),{accordion:Boolean,showIrrelevantNodes:{type:Boolean,default:!0},data:{type:Array,default:()=>[]},expandOnDragenter:{type:Boolean,default:!0},expandOnClick:Boolean,checkOnClick:{type:[Boolean,Function],default:!1},cancelable:{type:Boolean,default:!0},checkable:Boolean,draggable:Boolean,blockNode:Boolean,blockLine:Boolean,showLine:Boolean,disabled:Boolean,checkedKeys:Array,defaultCheckedKeys:{type:Array,default:()=>[]},selectedKeys:Array,defaultSelectedKeys:{type:Array,default:()=>[]},multiple:Boolean,pattern:{type:String,default:""},onLoad:Function,cascade:Boolean,selectable:{type:Boolean,default:!0},scrollbarProps:Object,indent:{type:Number,default:24},allowDrop:{type:Function,default:rl},animated:{type:Boolean,default:!0},checkboxPlacement:{type:String,default:"left"},virtualScroll:Boolean,watchProps:Array,renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,keyboard:{type:Boolean,default:!0},getChildren:Function,onDragenter:[Function,Array],onDragleave:[Function,Array],onDragend:[Function,Array],onDragstart:[Function,Array],onDragover:[Function,Array],onDrop:[Function,Array],onUpdateCheckedKeys:[Function,Array],"onUpdate:checkedKeys":[Function,Array],onUpdateSelectedKeys:[Function,Array],"onUpdate:selectedKeys":[Function,Array]}),yl),{internalTreeSelect:Boolean,internalScrollable:Boolean,internalScrollablePadding:String,internalRenderEmpty:Function,internalHighlightKeySet:Object,internalUnifySelectCheck:Boolean,internalCheckboxFocusable:{type:Boolean,default:!0},internalFocusable:{type:Boolean,default:!0},checkStrategy:{type:String,default:"all"},leafOnly:Boolean}),kl=he({name:"Tree",props:pl,slots:Object,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:o,mergedRtlRef:r}=Ut(e),d=Mt("Tree",r,t),i=Bn("Tree","-tree",vl,zt,e,t),y=q(null),b=q(null),f=q(null);function x(){var n;return(n=f.value)===null||n===void 0?void 0:n.listElRef}function m(){var n;return(n=f.value)===null||n===void 0?void 0:n.itemsElRef}const p=H(()=>{const{filter:n}=e;if(n)return n;const{labelField:l}=e;return(a,u)=>{if(!a.length)return!0;const h=u[l];return typeof h=="string"?h.toLowerCase().includes(a.toLowerCase()):!1}}),g=H(()=>{const{pattern:n}=e;return n?!n.length||!p.value?{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}:gl(e.data,p.value,n,e.keyField,e.childrenField):{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}}),K=H(()=>wn(e.showIrrelevantNodes?e.data:g.value.filteredTree,Kn(e.keyField,e.childrenField,e.disabledField,e.getChildren))),N=Oe(In,null),R=e.internalTreeSelect?N.dataTreeMate:H(()=>e.showIrrelevantNodes?K.value:wn(e.data,Kn(e.keyField,e.childrenField,e.disabledField,e.getChildren))),{watchProps:v}=e,s=q([]);v!=null&&v.includes("defaultCheckedKeys")?Ie(()=>{s.value=e.defaultCheckedKeys}):s.value=e.defaultCheckedKeys;const C=P(e,"checkedKeys"),_=Ge(C,s),$=H(()=>R.value.getCheckedKeys(_.value,{cascade:e.cascade,allowNotLoaded:e.allowCheckingNotLoaded})),U=fl(e),Q=H(()=>$.value.checkedKeys),te=H(()=>{const{indeterminateKeys:n}=e;return n!==void 0?n:$.value.indeterminateKeys}),le=q([]);v!=null&&v.includes("defaultSelectedKeys")?Ie(()=>{le.value=e.defaultSelectedKeys}):le.value=e.defaultSelectedKeys;const ge=P(e,"selectedKeys"),ce=Ge(ge,le),T=q([]),B=n=>{T.value=e.defaultExpandAll?R.value.getNonLeafKeys():n===void 0?e.defaultExpandedKeys:n};v!=null&&v.includes("defaultExpandedKeys")?Ie(()=>{B(void 0)}):Ie(()=>{B(e.defaultExpandedKeys)});const G=P(e,"expandedKeys"),W=Ge(G,T),Z=H(()=>K.value.getFlattenedNodes(W.value)),{pendingNodeKeyRef:ae,handleKeydown:ve}=dl({props:e,mergedCheckedKeysRef:_,mergedSelectedKeysRef:ce,fNodesRef:Z,mergedExpandedKeysRef:W,handleCheck:an,handleSelect:on,handleSwitcherClick:vn});let L=null,re=null;const pe=q(new Set),Qe=H(()=>e.internalHighlightKeySet||g.value.highlightKeySet),Ze=Ge(Qe,pe),c=q(new Set),E=H(()=>W.value.filter(n=>!c.value.has(n)));let I=0;const V=q(null),Y=q(null),ze=q(null),je=q(null),He=q(0),Mn=H(()=>{const{value:n}=Y;return n?n.parent:null});let en=!1;Be(P(e,"data"),()=>{en=!0,Xe(()=>{en=!1}),c.value.clear(),ae.value=null,Fe()},{deep:!1});let nn=!1;const tn=()=>{nn=!0,Xe(()=>{nn=!1})};let Pe;Be(P(e,"pattern"),(n,l)=>{if(e.showIrrelevantNodes)if(Pe=void 0,n){const{expandedKeys:a,highlightKeySet:u}=hl(e.data,e.pattern,e.keyField,e.childrenField,p.value);pe.value=u,tn(),Re(a,oe(a),{node:null,action:"filter"})}else pe.value=new Set;else if(!n.length)Pe!==void 0&&(tn(),Re(Pe,oe(Pe),{node:null,action:"filter"}));else{l.length||(Pe=W.value);const{expandedKeys:a}=g.value;a!==void 0&&(tn(),Re(a,oe(a),{node:null,action:"filter"}))}});function gn(n){return bl(this,void 0,void 0,function*(){const{onLoad:l}=e;if(!l){yield Promise.resolve();return}const{value:a}=c;if(!a.has(n.key)){a.add(n.key);try{(yield l(n.rawNode))===!1&&Ce()}catch(u){console.error(u),Ce()}a.delete(n.key)}})}Ie(()=>{var n;const{value:l}=K;if(!l)return;const{getNode:a}=l;(n=W.value)===null||n===void 0||n.forEach(u=>{const h=a(u);h&&!h.shallowLoaded&&gn(h)})});const Ne=q(!1),be=q([]);Be(E,(n,l)=>{if(!e.animated||nn){Xe(Ve);return}if(en)return;const a=$e(i.value.self.nodeHeight),u=new Set(l);let h=null,M=null;for(const O of n)if(!u.has(O)){if(h!==null)return;h=O}const ee=new Set(n);for(const O of l)if(!ee.has(O)){if(M!==null)return;M=O}if(h===null&&M===null)return;const{virtualScroll:ie}=e,De=(ie?f.value.listElRef:y.value).offsetHeight,Ke=Math.ceil(De/a)+1;let de;if(h!==null&&(de=l),M!==null&&(de===void 0?de=n:de=de.filter(O=>O!==M)),Ne.value=!0,be.value=K.value.getFlattenedNodes(de),h!==null){const O=be.value.findIndex(se=>se.key===h);if(~O){const se=be.value[O].children;if(se){const ue=_n(se,n);be.value.splice(O+1,0,{__motion:!0,mode:"expand",height:ie?ue.length*a:void 0,nodes:ie?ue.slice(0,Ke):ue})}}}if(M!==null){const O=be.value.findIndex(se=>se.key===M);if(~O){const se=be.value[O].children;if(!se)return;Ne.value=!0;const ue=_n(se,n);be.value.splice(O+1,0,{__motion:!0,mode:"collapse",height:ie?ue.length*a:void 0,nodes:ie?ue.slice(0,Ke):ue})}}});const zn=H(()=>jt(Z.value)),jn=H(()=>Ne.value?be.value:Z.value);function Ve(){const{value:n}=b;n&&n.sync()}function Hn(){Ne.value=!1,e.virtualScroll&&Xe(Ve)}function oe(n){const{getNode:l}=R.value;return n.map(a=>{var u;return((u=l(a))===null||u===void 0?void 0:u.rawNode)||null})}function Re(n,l,a){const{"onUpdate:expandedKeys":u,onUpdateExpandedKeys:h}=e;T.value=n,u&&ne(u,n,l,a),h&&ne(h,n,l,a)}function mn(n,l,a){const{"onUpdate:checkedKeys":u,onUpdateCheckedKeys:h}=e;s.value=n,h&&ne(h,n,l,a),u&&ne(u,n,l,a)}function Vn(n,l){const{"onUpdate:indeterminateKeys":a,onUpdateIndeterminateKeys:u}=e;a&&ne(a,n,l),u&&ne(u,n,l)}function ln(n,l,a){const{"onUpdate:selectedKeys":u,onUpdateSelectedKeys:h}=e;le.value=n,h&&ne(h,n,l,a),u&&ne(u,n,l,a)}function qn(n){const{onDragenter:l}=e;l&&ne(l,n)}function Wn(n){const{onDragleave:l}=e;l&&ne(l,n)}function Gn(n){const{onDragend:l}=e;l&&ne(l,n)}function Xn(n){const{onDragstart:l}=e;l&&ne(l,n)}function Yn(n){const{onDragover:l}=e;l&&ne(l,n)}function Jn(n){const{onDrop:l}=e;l&&ne(l,n)}function Fe(){Qn(),ke()}function Qn(){V.value=null}function ke(){He.value=0,Y.value=null,ze.value=null,je.value=null,Ce()}function Ce(){L&&(window.clearTimeout(L),L=null),re=null}function an(n,l){if(e.disabled||ye(n,e.disabledField))return;if(e.internalUnifySelectCheck&&!e.multiple){on(n);return}const a=l?"check":"uncheck",{checkedKeys:u,indeterminateKeys:h}=R.value[a](n.key,Q.value,{cascade:e.cascade,checkStrategy:U.value,allowNotLoaded:e.allowCheckingNotLoaded});mn(u,oe(u),{node:n.rawNode,action:a}),Vn(h,oe(h))}function Zn(n){if(e.disabled)return;const{key:l}=n,{value:a}=W,u=a.findIndex(h=>h===l);if(~u){const h=Array.from(a);h.splice(u,1),Re(h,oe(h),{node:n.rawNode,action:"collapse"})}else{const h=K.value.getNode(l);if(!h||h.isLeaf)return;let M;if(e.accordion){const ee=new Set(n.siblings.map(({key:ie})=>ie));M=a.filter(ie=>!ee.has(ie)),M.push(l)}else M=a.concat(l);Re(M,oe(M),{node:n.rawNode,action:"expand"})}}function vn(n){e.disabled||Ne.value||Zn(n)}function on(n){if(!(e.disabled||!e.selectable)){if(ae.value=n.key,e.internalUnifySelectCheck){const{value:{checkedKeys:l,indeterminateKeys:a}}=$;e.multiple?an(n,!(l.includes(n.key)||a.includes(n.key))):mn([n.key],oe([n.key]),{node:n.rawNode,action:"check"})}if(e.multiple){const l=Array.from(ce.value),a=l.findIndex(u=>u===n.key);~a?e.cancelable&&l.splice(a,1):~a||l.push(n.key),ln(l,oe(l),{node:n.rawNode,action:~a?"unselect":"select"})}else ce.value.includes(n.key)?e.cancelable&&ln([],[],{node:n.rawNode,action:"unselect"}):ln([n.key],oe([n.key]),{node:n.rawNode,action:"select"})}}function et(n){if(L&&(window.clearTimeout(L),L=null),n.isLeaf)return;re=n.key;const l=()=>{if(re!==n.key)return;const{value:a}=ze;if(a&&a.key===n.key&&!W.value.includes(n.key)){const u=W.value.concat(n.key);Re(u,oe(u),{node:n.rawNode,action:"expand"})}L=null,re=null};n.shallowLoaded?L=window.setTimeout(()=>{l()},1e3):L=window.setTimeout(()=>{gn(n).then(()=>{l()})},1e3)}function nt({event:n,node:l}){!e.draggable||e.disabled||ye(l,e.disabledField)||(bn({event:n,node:l},!1),qn({event:n,node:l.rawNode}))}function tt({event:n,node:l}){!e.draggable||e.disabled||ye(l,e.disabledField)||Wn({event:n,node:l.rawNode})}function lt(n){n.target===n.currentTarget&&ke()}function at({event:n,node:l}){Fe(),!(!e.draggable||e.disabled||ye(l,e.disabledField))&&Gn({event:n,node:l.rawNode})}function ot({event:n,node:l}){!e.draggable||e.disabled||ye(l,e.disabledField)||(I=n.clientX,V.value=l,Xn({event:n,node:l.rawNode}))}function bn({event:n,node:l},a=!0){var u;if(!e.draggable||e.disabled||ye(l,e.disabledField))return;const{value:h}=V;if(!h)return;const{allowDrop:M,indent:ee}=e;a&&Yn({event:n,node:l.rawNode});const ie=n.currentTarget,{height:De,top:Ke}=ie.getBoundingClientRect(),de=n.clientY-Ke;let O;M({node:l.rawNode,dropPosition:"inside",phase:"drag"})?de<=8?O="before":de>=De-8?O="after":O="inside":de<=De/2?O="before":O="after";const{value:ue}=zn;let A,X;const Te=ue(l.key);if(Te===null){ke();return}let qe=!1;O==="inside"?(A=l,X="inside"):O==="before"?l.isFirstChild?(A=l,X="before"):(A=Z.value[Te-1],X="after"):(A=l,X="after"),!A.isLeaf&&W.value.includes(A.key)&&(qe=!0,X==="after"&&(A=Z.value[Te+1],A?X="before":(A=l,X="inside")));const pn=A;if(ze.value=pn,!qe&&h.isLastChild&&h.key===A.key&&(X="after"),X==="after"){let kn=I-n.clientX,rn=0;for(;kn>=ee/2&&A.parent!==null&&A.isLastChild&&rn<1;)kn-=ee,rn+=1,A=A.parent;He.value=rn}else He.value=0;if((h.contains(A)||X==="inside"&&((u=h.parent)===null||u===void 0?void 0:u.key)===A.key)&&!(h.key===pn.key&&h.key===A.key)){ke();return}if(!M({node:A.rawNode,dropPosition:X,phase:"drag"})){ke();return}if(h.key===A.key)Ce();else if(re!==A.key)if(X==="inside"){if(e.expandOnDragenter){if(et(A),!A.shallowLoaded&&re!==A.key){Fe();return}}else if(!A.shallowLoaded){Fe();return}}else Ce();else X!=="inside"&&Ce();je.value=X,Y.value=A}function it({event:n,node:l,dropPosition:a}){if(!e.draggable||e.disabled||ye(l,e.disabledField))return;const{value:u}=V,{value:h}=Y,{value:M}=je;if(!(!u||!h||!M)&&e.allowDrop({node:h.rawNode,dropPosition:M,phase:"drag"})&&u.key!==h.key){if(M==="before"){const ee=u.getNext({includeDisabled:!0});if(ee&&ee.key===h.key){ke();return}}if(M==="after"){const ee=u.getPrev({includeDisabled:!0});if(ee&&ee.key===h.key){ke();return}}Jn({event:n,node:h.rawNode,dragNode:u.rawNode,dropPosition:a}),Fe()}}function rt(){Ve()}function dt(){Ve()}function st(n){var l;if(e.virtualScroll||e.internalScrollable){const{value:a}=b;if(!((l=a==null?void 0:a.containerRef)===null||l===void 0)&&l.contains(n.relatedTarget))return;ae.value=null}else{const{value:a}=y;if(a!=null&&a.contains(n.relatedTarget))return;ae.value=null}}Be(ae,n=>{var l,a;if(n!==null){if(e.virtualScroll)(l=f.value)===null||l===void 0||l.scrollTo({key:n});else if(e.internalScrollable){const{value:u}=b;if(u===null)return;const h=(a=u.contentRef)===null||a===void 0?void 0:a.querySelector(`[data-key="${Fn(n)}"]`);if(!h)return;u.scrollTo({el:h})}}}),Ht(Me,{loadingKeysRef:c,highlightKeySetRef:Ze,displayedCheckedKeysRef:Q,displayedIndeterminateKeysRef:te,mergedSelectedKeysRef:ce,mergedExpandedKeysRef:W,mergedThemeRef:i,mergedCheckStrategyRef:U,nodePropsRef:P(e,"nodeProps"),disabledRef:P(e,"disabled"),checkableRef:P(e,"checkable"),selectableRef:P(e,"selectable"),expandOnClickRef:P(e,"expandOnClick"),onLoadRef:P(e,"onLoad"),draggableRef:P(e,"draggable"),blockLineRef:P(e,"blockLine"),indentRef:P(e,"indent"),cascadeRef:P(e,"cascade"),checkOnClickRef:P(e,"checkOnClick"),checkboxPlacementRef:e.checkboxPlacement,droppingMouseNodeRef:ze,droppingNodeParentRef:Mn,draggingNodeRef:V,droppingPositionRef:je,droppingOffsetLevelRef:He,fNodesRef:Z,pendingNodeKeyRef:ae,showLineRef:P(e,"showLine"),disabledFieldRef:P(e,"disabledField"),internalScrollableRef:P(e,"internalScrollable"),internalCheckboxFocusableRef:P(e,"internalCheckboxFocusable"),internalTreeSelect:e.internalTreeSelect,renderLabelRef:P(e,"renderLabel"),renderPrefixRef:P(e,"renderPrefix"),renderSuffixRef:P(e,"renderSuffix"),renderSwitcherIconRef:P(e,"renderSwitcherIcon"),labelFieldRef:P(e,"labelField"),multipleRef:P(e,"multiple"),overrideDefaultNodeClickBehaviorRef:P(e,"overrideDefaultNodeClickBehavior"),handleSwitcherClick:vn,handleDragEnd:at,handleDragEnter:nt,handleDragLeave:tt,handleDragStart:ot,handleDrop:it,handleDragOver:bn,handleSelect:on,handleCheck:an});function ct(n,l){var a,u;typeof n=="number"?(a=f.value)===null||a===void 0||a.scrollTo(n,l||0):(u=f.value)===null||u===void 0||u.scrollTo(n)}const ut={handleKeydown:ve,scrollTo:ct,getCheckedData:()=>{if(!e.checkable)return{keys:[],options:[]};const{checkedKeys:n}=$.value;return{keys:n,options:oe(n)}},getIndeterminateData:()=>{if(!e.checkable)return{keys:[],options:[]};const{indeterminateKeys:n}=$.value;return{keys:n,options:oe(n)}}},yn=H(()=>{const{common:{cubicBezierEaseInOut:n},self:{fontSize:l,nodeBorderRadius:a,nodeColorHover:u,nodeColorPressed:h,nodeColorActive:M,arrowColor:ee,loadingColor:ie,nodeTextColor:De,nodeTextColorDisabled:Ke,dropMarkColor:de,nodeWrapperPadding:O,nodeHeight:se,lineHeight:ue,lineColor:A}}=i.value,X=cn(O,"top"),Te=cn(O,"bottom"),qe=En($e(se)-$e(X)-$e(Te));return{"--n-arrow-color":ee,"--n-loading-color":ie,"--n-bezier":n,"--n-font-size":l,"--n-node-border-radius":a,"--n-node-color-active":M,"--n-node-color-hover":u,"--n-node-color-pressed":h,"--n-node-text-color":De,"--n-node-text-color-disabled":Ke,"--n-drop-mark-color":de,"--n-node-wrapper-padding":O,"--n-line-offset-top":`-${X}`,"--n-line-offset-bottom":`-${Te}`,"--n-node-content-height":qe,"--n-line-height":ue,"--n-line-color":A}}),Se=o?Vt("tree",void 0,yn,e):void 0;return Object.assign(Object.assign({},ut),{mergedClsPrefix:t,mergedTheme:i,rtlEnabled:d,fNodes:jn,aip:Ne,selfElRef:y,virtualListInstRef:f,scrollbarInstRef:b,handleFocusout:st,handleDragLeaveTree:lt,handleScroll:rt,getScrollContainer:x,getScrollContent:m,handleAfterEnter:Hn,handleResize:dt,cssVars:o?void 0:yn,themeClass:Se==null?void 0:Se.themeClass,onRender:Se==null?void 0:Se.onRender})},render(){var e;const{fNodes:t,internalRenderEmpty:o}=this;if(!t.length&&o)return o();const{mergedClsPrefix:r,blockNode:d,blockLine:i,draggable:y,disabled:b,internalFocusable:f,checkable:x,handleKeydown:m,rtlEnabled:p,handleFocusout:g,scrollbarProps:K}=this,N=f&&!b,R=N?"0":void 0,v=[`${r}-tree`,p&&`${r}-tree--rtl`,x&&`${r}-tree--checkable`,(i||d)&&`${r}-tree--block-node`,i&&`${r}-tree--block-line`],s=_=>"__motion"in _?w(ml,{height:_.height,nodes:_.nodes,clsPrefix:r,mode:_.mode,onAfterEnter:this.handleAfterEnter}):w(Un,{key:_.key,tmNode:_,clsPrefix:r});if(this.virtualScroll){const{mergedTheme:_,internalScrollablePadding:$}=this,U=cn($||"0");return w(Rn,Object.assign({},K,{ref:"scrollbarInstRef",onDragleave:y?this.handleDragLeaveTree:void 0,container:this.getScrollContainer,content:this.getScrollContent,class:v,theme:_.peers.Scrollbar,themeOverrides:_.peerOverrides.Scrollbar,tabindex:R,onKeydown:N?m:void 0,onFocusout:N?g:void 0}),{default:()=>{var Q;return(Q=this.onRender)===null||Q===void 0||Q.call(this),t.length?w(qt,{ref:"virtualListInstRef",items:this.fNodes,itemSize:$e(_.self.nodeHeight),ignoreItemResize:this.aip,paddingTop:U.top,paddingBottom:U.bottom,class:this.themeClass,style:[this.cssVars,{paddingLeft:U.left,paddingRight:U.right}],onScroll:this.handleScroll,onResize:this.handleResize,showScrollbar:!1,itemResizable:!0},{default:({item:te})=>s(te)}):Nn(this.$slots.empty,()=>[w(Cn,{class:`${r}-tree__empty`,theme:this.mergedTheme.peers.Empty,themeOverrides:this.mergedTheme.peerOverrides.Empty})])}})}const{internalScrollable:C}=this;return v.push(this.themeClass),(e=this.onRender)===null||e===void 0||e.call(this),C?w(Rn,Object.assign({},K,{class:v,tabindex:R,onKeydown:N?m:void 0,onFocusout:N?g:void 0,style:this.cssVars,contentStyle:{padding:this.internalScrollablePadding}}),{default:()=>w("div",{onDragleave:y?this.handleDragLeaveTree:void 0,ref:"selfElRef"},this.fNodes.map(s))}):w("div",{class:v,tabindex:R,ref:"selfElRef",style:this.cssVars,onKeydown:N?m:void 0,onFocusout:N?g:void 0,onDragleave:y?this.handleDragLeaveTree:void 0},t.length?t.map(s):Nn(this.$slots.empty,()=>[w(Cn,{class:`${r}-tree__empty`,theme:this.mergedTheme.peers.Empty,themeOverrides:this.mergedTheme.peerOverrides.Empty})]))}}),xl=he({name:"ButtonAuthModal",__name:"button-auth-modal",props:Ye({roleId:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:["update:visible"],setup(e){const t=e,o=hn(e,"visible");function r(){o.value=!1}const d=H(()=>F("common.edit")+F("page.manage.role.buttonAuth")),i=Sn([]);async function y(){const{data:p}=await Rt();p.forEach(g=>{i.value.push({id:g.id,label:g.description,code:g.permCode})})}const b=Sn([]);async function f(){console.log(t.roleId);const{data:p}=await _t(t.roleId);b.value=p}async function x(){var p,g;console.log(b.value,t.roleId),await Nt(t.roleId,b.value),(g=(p=window.$message)==null?void 0:p.success)==null||g.call(p,F("common.modifySuccess")),r()}function m(){y()}return m(),Be(o,()=>{o.value&&f()}),(p,g)=>{const K=kl,N=xe,R=Je,v=Wt;return we(),Ae(v,{show:o.value,"onUpdate:show":g[1]||(g[1]=s=>o.value=s),title:d.value,preset:"card",class:"w-480px"},{footer:S(()=>[k(R,{justify:"end"},{default:S(()=>[k(N,{size:"small",class:"mt-16px",onClick:r},{default:S(()=>[me(_e(D(F)("common.cancel")),1)]),_:1}),k(N,{type:"primary",size:"small",class:"mt-16px",onClick:x},{default:S(()=>[me(_e(D(F)("common.confirm")),1)]),_:1})]),_:1})]),default:S(()=>[k(K,{"checked-keys":b.value,"onUpdate:checkedKeys":g[0]||(g[0]=s=>b.value=s),data:i.value,"key-field":"id","block-line":"",checkable:"","expand-on-click":"","virtual-scroll":"",class:"h-280px"},null,8,["checked-keys","data"])]),_:1},8,["show","title"])}}}),wl=he({name:"RoleOperateDrawer",__name:"role-operate-drawer",props:Ye({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:Ye(["submitted"],["update:visible"]),setup(e,{emit:t}){const o=e,r=t,d=hn(e,"visible"),{formRef:i,validate:y,restoreValidation:b}=nl(),{bool:f,setTrue:x}=Gt(),m=H(()=>({add:F("page.manage.role.addRole"),edit:F("page.manage.role.editRole")})[o.operateType]),p=q(g());function g(){return{roleName:"",description:""}}const K=H(()=>{var C;return((C=o.rowData)==null?void 0:C.id)||-1}),N=H(()=>o.operateType==="edit");function R(){p.value=g(),o.operateType==="edit"&&o.rowData&&Object.assign(p.value,o.rowData)}function v(){d.value=!1}async function s(){var C;await y(),await Ct(p.value),(C=window.$message)==null||C.success(F("common.updateSuccess")),v(),r("submitted")}return Be(d,()=>{d.value&&(R(),b())}),(C,_)=>{const $=An,U=tl,Q=Pn,te=xe,le=Je,ge=Xt,ce=Yt;return we(),Ae(ce,{show:d.value,"onUpdate:show":_[3]||(_[3]=T=>d.value=T),"display-directive":"show",width:360},{default:S(()=>[k(ge,{title:m.value,"native-scrollbar":!1,closable:""},{footer:S(()=>[k(le,{size:16},{default:S(()=>[k(te,{onClick:v},{default:S(()=>[me(_e(D(F)("common.cancel")),1)]),_:1}),k(te,{type:"primary",onClick:s},{default:S(()=>[me(_e(D(F)("common.confirm")),1)]),_:1})]),_:1})]),default:S(()=>[k(Q,{ref_key:"formRef",ref:i,model:p.value},{default:S(()=>[k(U,{label:D(F)("page.manage.role.roleName"),path:"roleName"},{default:S(()=>[k($,{value:p.value.roleName,"onUpdate:value":_[0]||(_[0]=T=>p.value.roleName=T),placeholder:D(F)("page.manage.role.form.roleName")},null,8,["value","placeholder"])]),_:1},8,["label"]),k(U,{label:"角色描述",path:"roleCode"},{default:S(()=>[k($,{value:p.value.description,"onUpdate:value":_[1]||(_[1]=T=>p.value.description=T),placeholder:"角色描述"},null,8,["value"])]),_:1})]),_:1},8,["model"]),N.value?(we(),Ae(le,{key:0},{default:S(()=>[k(te,{onClick:D(x)},{default:S(()=>[me(_e(D(F)("page.manage.role.buttonAuth")),1)]),_:1},8,["onClick"]),k(xl,{visible:D(f),"onUpdate:visible":_[2]||(_[2]=T=>Ue(f)?f.value=T:null),"role-id":K.value},null,8,["visible","role-id"])]),_:1})):fn("",!0)]),_:1},8,["title"])]),_:1},8,["show"])}}}),_l=he({name:"RoleSearch",__name:"role-search",props:{model:{required:!0},modelModifiers:{}},emits:Ye(["reset","search"],["update:model"]),setup(e,{emit:t}){const o=t,r=hn(e,"model"),d=q([118313526e4,Date.now()]);function i(){d.value=[118313526e4,Date.now()],o("reset")}function y(){o("search")}return(b,f)=>{const x=An,m=ft,p=ll,g=ht,K=xe,N=gt,R=Je,v=al,s=Pn,C=mt,_=vt,$=On;return we(),Ae($,{bordered:!1,size:"small",class:"card-wrapper"},{default:S(()=>[k(_,{"default-expanded-names":["role-search"]},{default:S(()=>[k(C,{title:D(F)("common.search"),name:"role-search"},{default:S(()=>[k(s,{model:r.value,"label-placement":"left","label-width":80},{default:S(()=>[k(v,{responsive:"screen","item-responsive":""},{default:S(()=>[k(m,{span:"24 s:12 m:6",label:D(F)("page.manage.role.roleName"),path:"roleName",class:"pr-24px"},{default:S(()=>[k(x,{value:r.value.roleName,"onUpdate:value":f[0]||(f[0]=U=>r.value.roleName=U),placeholder:D(F)("page.manage.role.form.roleName")},null,8,["value","placeholder"])]),_:1},8,["label"]),k(m,{span:"24 s:12 m:6",label:"角色描述",path:"roleCode",class:"pr-24px"},{default:S(()=>[k(x,{value:r.value.description,"onUpdate:value":f[1]||(f[1]=U=>r.value.description=U),placeholder:"角色描述"},null,8,["value"])]),_:1}),k(m,{span:"24 s:12 m:6",label:"创建时间开始",path:"status",class:"pr-24px"},{default:S(()=>[k(p,{value:r.value.createTimeStart,"onUpdate:value":f[2]||(f[2]=U=>r.value.createTimeStart=U),type:"datetime",clearable:""},null,8,["value"])]),_:1}),k(m,{span:"24 s:12 m:6",label:"创建时间结束",path:"status",class:"pr-24px"},{default:S(()=>[k(p,{value:r.value.createTimeEnd,"onUpdate:value":f[3]||(f[3]=U=>r.value.createTimeEnd=U),type:"datetime",clearable:""},null,8,["value"])]),_:1}),k(m,{span:"24 s:12 m:6"},{default:S(()=>[k(R,{class:"w-full",justify:"end"},{default:S(()=>[k(K,{onClick:i},{icon:S(()=>[k(g,{class:"text-icon"})]),default:S(()=>[me(" "+_e(D(F)("common.reset")),1)]),_:1}),k(K,{type:"primary",ghost:"",onClick:y},{icon:S(()=>[k(N,{class:"text-icon"})]),default:S(()=>[me(" "+_e(D(F)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1})]),_:1})}}}),Nl={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function Tn(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Zt(e)}const Fl=he({name:"manage_role",__name:"index",setup(e){const{hasAuth:t}=el(),o=Jt(),{columns:r,columnChecks:d,data:i,loading:y,getData:b,getDataByPage:f,mobilePagination:x,searchParams:m,resetSearchParams:p}=pt({apiFn:St,apiParams:{current:1,size:10,createTime:null,updateTime:null,roleName:null,description:null},columns:()=>[{type:"selection",align:"center",width:48},{key:"index",title:F("common.index"),width:64,align:"center"},{key:"roleName",title:F("page.manage.role.roleName"),align:"center",minWidth:120},{key:"description",title:F("page.manage.role.roleDesc"),minWidth:120},{key:"createTime",title:"创建时间",align:"center",minWidth:120},{key:"operate",title:F("common.operate"),align:"center",width:130,render:T=>{let B;return k("div",{class:"flex-center gap-8px"},[t("BUTTON_EDIT_ROLE")?k(xe,{type:"primary",ghost:!0,size:"small",onClick:()=>Q(T.id)},Tn(B=F("common.edit"))?B:{default:()=>[B]}):null,t("BUTTON_DELETE_ROLE")&&k(bt,{onPositiveClick:()=>U(T.id)},{default:()=>F("common.confirmDelete"),trigger:()=>{let G;return k(xe,{type:"error",ghost:!0,size:"small"},Tn(G=F("common.delete"))?G:{default:()=>[G]})}})])}}]}),{drawerVisible:g,operateType:K,editingData:N,handleAdd:R,handleEdit:v,checkedRowKeys:s,onBatchDeleted:C,onDeleted:_}=kt(i,b);async function $(){console.log(s.value),await Dt(s.value),C()}async function U(T){console.log(T),await Kt(T),_()}function Q(T){v(T)}async function te(T,B){const G=r.value.slice(2);let W=[];T?W=(await Tt()).data.map(re=>G.map(pe=>le(pe,re))):W=i.value.map(L=>G.map(re=>le(re,L)));const Z=G.map(L=>ce(L)&&L.title||null);W.unshift(Z);const ae=dn.book_new(),ve=dn.aoa_to_sheet(W);ve["!cols"]=G.map(L=>({width:Math.round(Number(L.width)/10||20)})),dn.book_append_sheet(ae,ve,"角色列表"),xt(ae,"角色数据.xlsx")}function le(T,B){if(!ge(T))return null;const{key:G}=T;return G==="operate"?null:B[G]}function ge(T){return!!T.key}function ce(T){return!!T.title}return(T,B)=>{const G=wt,W=yt,Z=Je,ae=ol,ve=On;return we(),Qt("div",Nl,[k(_l,{model:D(m),"onUpdate:model":B[0]||(B[0]=L=>Ue(m)?m.value=L:null),onReset:D(p),onSearch:D(f)},null,8,["model","onReset","onSearch"]),k(ve,{title:D(F)("page.manage.role.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper"},{"header-extra":S(()=>[k(Z,{align:"end",wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:S(()=>[D(t)("BUTTON_EXCEL_ROLE")?(we(),Ae(D(xe),{key:0,size:"small",ghost:"",type:"primary",onClick:B[1]||(B[1]=L=>te(!1))},{icon:S(()=>[k(G,{class:"text-icon"})]),default:S(()=>[B[6]||(B[6]=me(" 导出excel "))]),_:1})):fn("",!0),D(t)("BUTTON_EXCEL_ROLE_ALL")?(we(),Ae(D(xe),{key:1,size:"small",ghost:"",type:"primary",onClick:B[2]||(B[2]=L=>te(!0))},{icon:S(()=>[k(G,{class:"text-icon"})]),default:S(()=>[B[7]||(B[7]=me(" 导出全部 "))]),_:1})):fn("",!0),k(W,{columns:D(d),"onUpdate:columns":B[3]||(B[3]=L=>Ue(d)?d.value=L:null),"disabled-delete":D(s).length===0,loading:D(y),"show-add-button-str":"BUTTON_ADD_ROLE","show-batch-delete-button-str":"BUTTON_BATCH_DELETE_ROLE",onAdd:D(R),onDelete:$,onRefresh:D(b)},null,8,["columns","disabled-delete","loading","onAdd","onRefresh"])]),_:1})]),default:S(()=>[k(ae,{"checked-row-keys":D(s),"onUpdate:checkedRowKeys":B[4]||(B[4]=L=>Ue(s)?s.value=L:null),columns:D(r),data:D(i),size:"small","flex-height":!D(o).isMobile,"scroll-x":702,loading:D(y),remote:"","row-key":L=>L.id,pagination:D(x),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),k(wl,{visible:D(g),"onUpdate:visible":B[5]||(B[5]=L=>Ue(g)?g.value=L:null),"operate-type":D(K),"row-data":D(N),onSubmitted:D(f)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1},8,["title"])])}}});export{Fl as default};
