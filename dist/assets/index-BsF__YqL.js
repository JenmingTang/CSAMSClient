import{r as Z,a as C,k as j,l as H,d as $,m as O,o as N,b as R,e as u,n as J,u as F,p as M,$ as r,c as E,w as l,f as o,h as t,g as k,t as b,q as U,s as B,v as Q,B as T,x as X,y as q,z as Y,A as ee,C as oe,T as te,D as ne,E as se,F as L,G as ae,H as le,I as re,J as ie}from"./index-D6W6_zXP.js";import{u as I,a as K,_ as A,b as G,R as ce}from"./form-a8uLA4Rd.js";import{_ as D}from"./Space-zKntJrGG.js";import"./get-slot-Bk_rJcZu.js";function de(w){const m=Z(0),f=C(()=>Math.ceil(m.value/60)),d=C(()=>m.value>0),{pause:a,resume:v}=j(()=>{m.value>0?m.value-=1:a()},{immediate:!1});function x(y=w){m.value=60*y,v()}function i(){m.value=0,a()}return H(()=>{a()}),{count:f,isCounting:d,start:x,stop:i}}const pe={class:"absolute-lt z-1 size-full overflow-hidden"},ue={class:"absolute -right-300px -top-900px lt-sm:-right-100px lt-sm:-top-1170px"},me={height:"1337",width:"1337"},fe={id:"linearGradient-2",x1:"0.79",y1:"0.62",x2:"0.21",y2:"0.86"},ge=["stop-color"],_e=["stop-color"],he={class:"absolute -bottom-400px -left-200px lt-sm:-bottom-760px lt-sm:-left-100px"},we={height:"896",width:"967.8852157128662"},ve={id:"linearGradient-3",x1:"0.5",y1:"0",x2:"0.5",y2:"1"},ye=["stop-color"],Ce=["stop-color"],xe=$({name:"WaveBg",__name:"wave-bg",props:{themeColor:{}},setup(w){const g=w,m=C(()=>O(g.themeColor,200)),f=C(()=>O(g.themeColor,500));return(d,a)=>(N(),R("div",pe,[u("div",ue,[(N(),R("svg",me,[u("defs",null,[a[0]||(a[0]=u("path",{id:"path-1",opacity:"1","fill-rule":"evenodd",d:"M1337,668.5 C1337,1037.455193874239 1037.455193874239,1337 668.5,1337 C523.6725684305388,1337 337,1236 370.50000000000006,1094 C434.03835568300906,824.6732385973953 6.906089672974592e-14,892.6277623047779 0,668.5000000000001 C0,299.5448061257611 299.5448061257609,1.1368683772161603e-13 668.4999999999999,0 C1037.455193874239,0 1337,299.544806125761 1337,668.5Z"},null,-1)),u("linearGradient",fe,[u("stop",{offset:"0","stop-color":m.value,"stop-opacity":"1"},null,8,ge),u("stop",{offset:"1","stop-color":f.value,"stop-opacity":"1"},null,8,_e)])]),a[1]||(a[1]=u("g",{opacity:"1"},[u("use",{"xlink:href":"#path-1",fill:"url(#linearGradient-2)","fill-opacity":"1"})],-1))]))]),u("div",he,[(N(),R("svg",we,[u("defs",null,[a[2]||(a[2]=u("path",{id:"path-2",opacity:"1","fill-rule":"evenodd",d:"M896,448 C1142.6325445712241,465.5747656464056 695.2579309733121,896 448,896 C200.74206902668806,896 5.684341886080802e-14,695.2579309733121 0,448.0000000000001 C0,200.74206902668806 200.74206902668791,5.684341886080802e-14 447.99999999999994,0 C695.2579309733121,0 475,418 896,448Z"},null,-1)),u("linearGradient",ve,[u("stop",{offset:"0","stop-color":f.value,"stop-opacity":"1"},null,8,ye),u("stop",{offset:"1","stop-color":m.value,"stop-opacity":"1"},null,8,Ce)])]),a[3]||(a[3]=u("g",{opacity:"1"},[u("use",{"xlink:href":"#path-2",fill:"url(#linearGradient-3)","fill-opacity":"1"})],-1))]))])]))}}),be={class:"flex-y-center justify-between"},ke=$({name:"PwdLogin",__name:"pwd-login",setup(w){const g=J(),{toggleLoginModule:m}=F(),{formRef:f,validate:d}=I(),a=M({userName:"12345678",password:"Pwd#1234"});C(()=>{const{formRules:e}=K();return{userName:e.userName,password:e.pwd}});const v=Z(!1),x=e=>/^\d{8}$|^\d{15}$/.test(e)?"":"用户名必须是8位或15位的纯数字",i=e=>{const n=/[a-zA-Z]/.test(e),c=/[0-9]/.test(e),h=/[^a-zA-Z0-9]/.test(e),P=(n?1:0)+(c?1:0)+(h?1:0);return e.length<8?"密码必须至少8位":P<3?"密码必须包含字母、数字和特殊字符中的至少三种类型":""},y=C(()=>x(a.userName)),_=C(()=>i(a.password));async function s(){var n;if(!(!y.value&&!_.value)){(n=window.$message)==null||n.error("学工号（纯数字8/15位）或密码错误（8位且包含字母、数字、特殊字符）！");return}const e=setTimeout(async()=>{var c;(c=window.$message)==null||c.error("网络错误，请再次尝试！"),await g.resetStore()},5e3);await g.login(a.userName,a.password,v.value),clearTimeout(e)}return C(()=>[{key:"super",label:r("page.login.pwdLogin.superAdmin"),userName:"Super",password:"123456"},{key:"admin",label:r("page.login.pwdLogin.admin"),userName:"Admin",password:"123456"},{key:"user",label:r("page.login.pwdLogin.user"),userName:"User",password:"123456"}]),(e,n)=>{const c=B,h=A,P=Q,S=T,p=D,W=G;return N(),E(W,{ref_key:"formRef",ref:f,model:a,size:"large","show-label":!1,onKeyup:U(s,["enter"])},{default:l(()=>[o(h,{path:"userName"},{default:l(()=>[o(c,{value:a.userName,"onUpdate:value":n[0]||(n[0]=z=>a.userName=z),placeholder:t(r)("page.login.common.userNamePlaceholder")},null,8,["value","placeholder"])]),_:1}),o(h,{path:"password"},{default:l(()=>[o(c,{value:a.password,"onUpdate:value":n[1]||(n[1]=z=>a.password=z),type:"password","show-password-on":"click",placeholder:t(r)("page.login.common.passwordPlaceholder")},null,8,["value","placeholder"])]),_:1}),o(p,{vertical:"",size:24},{default:l(()=>[u("div",be,[o(P,{checked:v.value,"onUpdate:checked":n[2]||(n[2]=z=>v.value=z)},{default:l(()=>[k(b(t(r)("page.login.pwdLogin.rememberMe")),1)]),_:1},8,["checked"]),o(S,{quaternary:"",onClick:n[3]||(n[3]=z=>t(m)("reset-pwd"))},{default:l(()=>[k(b(t(r)("page.login.pwdLogin.forgetPassword")),1)]),_:1})]),o(S,{type:"primary",size:"large",round:"",block:"",loading:t(g).loginLoading,onClick:s},{default:l(()=>[k(b(t(r)("common.confirm")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])}}});function V(){const{loading:w,startLoading:g,endLoading:m}=X(),{count:f,start:d,stop:a,isCounting:v}=de(10),x=C(()=>{let _=r("page.login.codeLogin.getCode");const s=r("page.login.codeLogin.reGetCode",{time:f.value});return w.value&&(_=""),v.value&&(_=s),_});function i(_){var s,e,n,c;return _.trim()===""?((e=(s=window.$message)==null?void 0:s.error)==null||e.call(s,r("form.phone.required")),!1):ce.test(_)?!0:((c=(n=window.$message)==null?void 0:n.error)==null||c.call(n,r("form.phone.invalid")),!1)}async function y(_){var e,n;!i(_)||w.value||(g(),await new Promise(c=>{setTimeout(c,500)}),(n=(e=window.$message)==null?void 0:e.success)==null||n.call(e,r("page.login.codeLogin.sendCodeSuccess")),d(),m())}return{label:x,start:d,stop:a,isCounting:v,loading:w,getCaptcha:y}}const Ne={class:"w-full flex-y-center gap-16px"},Pe=$({name:"CodeLogin",__name:"code-login",setup(w){const{toggleLoginModule:g}=F(),{formRef:m,validate:f}=I(),{label:d,isCounting:a,loading:v,getCaptcha:x}=V(),i=M({phone:"",code:""}),y=C(()=>{const{formRules:s}=K();return{phone:s.phone,code:s.code}});async function _(){var s;await f(),(s=window.$message)==null||s.success(r("page.login.common.validateSuccess"))}return(s,e)=>{const n=B,c=A,h=T,P=D,S=G;return N(),E(S,{ref_key:"formRef",ref:m,model:i,rules:y.value,size:"large","show-label":!1,onKeyup:U(_,["enter"])},{default:l(()=>[o(c,{path:"phone"},{default:l(()=>[o(n,{value:i.phone,"onUpdate:value":e[0]||(e[0]=p=>i.phone=p),placeholder:t(r)("page.login.common.phonePlaceholder")},null,8,["value","placeholder"])]),_:1}),o(c,{path:"code"},{default:l(()=>[u("div",Ne,[o(n,{value:i.code,"onUpdate:value":e[1]||(e[1]=p=>i.code=p),placeholder:t(r)("page.login.common.codePlaceholder")},null,8,["value","placeholder"]),o(h,{size:"large",disabled:t(a),loading:t(v),onClick:e[2]||(e[2]=p=>t(x)(i.phone))},{default:l(()=>[k(b(t(d)),1)]),_:1},8,["disabled","loading"])])]),_:1}),o(P,{vertical:"",size:18,class:"w-full"},{default:l(()=>[o(h,{type:"primary",size:"large",round:"",block:"",onClick:_},{default:l(()=>[k(b(t(r)("common.confirm")),1)]),_:1}),o(h,{size:"large",round:"",block:"",onClick:e[3]||(e[3]=p=>t(g)("pwd-login"))},{default:l(()=>[k(b(t(r)("page.login.common.back")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])}}}),Se={class:"w-full flex-y-center gap-16px"},$e=$({name:"Register",__name:"register",setup(w){const{toggleLoginModule:g}=F(),{formRef:m,validate:f}=I(),{label:d,isCounting:a,loading:v,getCaptcha:x}=V(),i=M({phone:"",code:"",password:"",confirmPassword:""}),y=C(()=>{const{formRules:s,createConfirmPwdRule:e}=K();return{phone:s.phone,code:s.code,password:s.pwd,confirmPassword:e(i.password)}});async function _(){var s;await f(),(s=window.$message)==null||s.success(r("page.login.common.validateSuccess"))}return(s,e)=>{const n=B,c=A,h=T,P=D,S=G;return N(),E(S,{ref_key:"formRef",ref:m,model:i,rules:y.value,size:"large","show-label":!1,onKeyup:U(_,["enter"])},{default:l(()=>[o(c,{path:"phone"},{default:l(()=>[o(n,{value:i.phone,"onUpdate:value":e[0]||(e[0]=p=>i.phone=p),placeholder:t(r)("page.login.common.phonePlaceholder")},null,8,["value","placeholder"])]),_:1}),o(c,{path:"code"},{default:l(()=>[u("div",Se,[o(n,{value:i.code,"onUpdate:value":e[1]||(e[1]=p=>i.code=p),placeholder:t(r)("page.login.common.codePlaceholder")},null,8,["value","placeholder"]),o(h,{size:"large",disabled:t(a),loading:t(v),onClick:e[2]||(e[2]=p=>t(x)(i.phone))},{default:l(()=>[k(b(t(d)),1)]),_:1},8,["disabled","loading"])])]),_:1}),o(c,{path:"password"},{default:l(()=>[o(n,{value:i.password,"onUpdate:value":e[3]||(e[3]=p=>i.password=p),type:"password","show-password-on":"click",placeholder:t(r)("page.login.common.passwordPlaceholder")},null,8,["value","placeholder"])]),_:1}),o(c,{path:"confirmPassword"},{default:l(()=>[o(n,{value:i.confirmPassword,"onUpdate:value":e[4]||(e[4]=p=>i.confirmPassword=p),type:"password","show-password-on":"click",placeholder:t(r)("page.login.common.confirmPasswordPlaceholder")},null,8,["value","placeholder"])]),_:1}),o(P,{vertical:"",size:18,class:"w-full"},{default:l(()=>[o(h,{type:"primary",size:"large",round:"",block:"",onClick:_},{default:l(()=>[k(b(t(r)("common.confirm")),1)]),_:1}),o(h,{size:"large",round:"",block:"",onClick:e[5]||(e[5]=p=>t(g)("pwd-login"))},{default:l(()=>[k(b(t(r)("page.login.common.back")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])}}});function ze(w){return q({url:"/password/send-email",method:"get",params:{email:w}})}function Le(w){return q({url:"/password/reset",method:"post",data:JSON.stringify(w),headers:{"Content-Type":"application/json"}})}const Re=$({name:"ResetPwd",__name:"reset-pwd",setup(w){const{toggleLoginModule:g}=F(),{formRef:m,validate:f}=I(),d=M({email:"",code:"",password:"",confirmPassword:""}),a=s=>{const e=/[a-zA-Z]/.test(s),n=/[0-9]/.test(s),c=/[^a-zA-Z0-9]/.test(s),h=(e?1:0)+(n?1:0)+(c?1:0);return s.length<8?"密码必须至少8位":h<3?"密码必须包含字母、数字和特殊字符中的至少三种类型":""},v=C(()=>a(d.confirmPassword)),x=C(()=>a(d.password));async function i(){var s,e;if(!(!v.value&&!x.value)){(s=window.$message)==null||s.error("学工号（纯数字8/15位）或密码错误（8位且包含字母、数字、特殊字符）！");return}await f(),await Le(d),(e=window.$message)==null||e.success(r("page.login.common.validateSuccess"))}const y=Z(!1);async function _(){y.value=!0,setTimeout(()=>{y.value=!1},6e4),await ze(d.email)}return(s,e)=>{const n=B,c=T,h=A,P=D,S=G;return N(),E(S,{ref_key:"formRef",ref:m,model:d,size:"large","show-label":!1,onKeyup:U(i,["enter"])},{default:l(()=>[o(h,{path:"email"},{default:l(()=>[o(n,{value:d.email,"onUpdate:value":e[0]||(e[0]=p=>d.email=p),placeholder:"请输入邮箱"},null,8,["value"]),o(c,{loading:y.value,onClick:_},{default:l(()=>e[5]||(e[5]=[k("发送")])),_:1},8,["loading"])]),_:1}),o(h,{path:"code"},{default:l(()=>[o(n,{value:d.code,"onUpdate:value":e[1]||(e[1]=p=>d.code=p),placeholder:t(r)("page.login.common.codePlaceholder")},null,8,["value","placeholder"])]),_:1}),o(h,{path:"password"},{default:l(()=>[o(n,{value:d.password,"onUpdate:value":e[2]||(e[2]=p=>d.password=p),type:"password","show-password-on":"click",placeholder:t(r)("page.login.common.passwordPlaceholder")},null,8,["value","placeholder"])]),_:1}),o(h,{path:"confirmPassword"},{default:l(()=>[o(n,{value:d.confirmPassword,"onUpdate:value":e[3]||(e[3]=p=>d.confirmPassword=p),type:"password","show-password-on":"click",placeholder:t(r)("page.login.common.confirmPasswordPlaceholder")},null,8,["value","placeholder"])]),_:1}),o(P,{vertical:"",size:18,class:"w-full"},{default:l(()=>[o(c,{type:"primary",size:"large",round:"",block:"",onClick:i},{default:l(()=>[k(b(t(r)("common.confirm")),1)]),_:1}),o(c,{size:"large",round:"",block:"",onClick:e[4]||(e[4]=p=>t(g)("pwd-login"))},{default:l(()=>[k(b(t(r)("page.login.common.back")),1)]),_:1})]),_:1})]),_:1},8,["model"])}}}),Ee=$({name:"BindWechat",__name:"bind-wechat",setup(w){return(g,m)=>(N(),R("div"))}}),Fe={class:"w-400px lt-sm:w-300px"},Me={class:"flex-y-center justify-between"},Ue={class:"text-28px text-primary font-500 lt-sm:text-22px"},Be={class:"i-flex-col"},Te={class:"pt-24px"},Ie={class:"text-18px text-primary font-medium"},Ae={class:"pt-24px"},Ke=$({name:"login",__name:"index",props:{module:{}},setup(w){const g=w,m=Y(),f=ee(),d={"pwd-login":{label:L["pwd-login"],component:ke},"code-login":{label:L["code-login"],component:Pe},register:{label:L.register,component:$e},"reset-pwd":{label:L["reset-pwd"],component:Re},"bind-wechat":{label:L["bind-wechat"],component:Ee}},a=C(()=>d[g.module||"pwd-login"]),v=C(()=>f.darkMode?O(f.themeColor,600):f.themeColor),x=C(()=>{const i="#ffffff",y=f.darkMode?.5:.2;return oe(i,f.themeColor,y)});return(i,y)=>{const _=xe,s=ae,e=le,n=re,c=ie;return N(),R("div",{class:"relative size-full flex-center overflow-hidden",style:se({backgroundColor:x.value})},[o(_,{"theme-color":v.value},null,8,["theme-color"]),o(c,{bordered:!1,class:"relative z-4 w-auto rd-12px"},{default:l(()=>[u("div",Fe,[u("header",Me,[o(s,{class:"text-64px text-primary lt-sm:text-48px"}),u("h3",Ue,b(t(r)("system.title")),1),u("div",Be,[o(e,{"theme-schema":t(f).themeScheme,"show-tooltip":!1,class:"text-20px lt-sm:text-18px",onSwitch:t(f).toggleThemeScheme},null,8,["theme-schema","onSwitch"]),o(n,{lang:t(m).locale,"lang-options":t(m).localeOptions,"show-tooltip":!1,onChangeLang:t(m).changeLocale},null,8,["lang","lang-options","onChangeLang"])])]),u("main",Te,[u("h3",Ie,b(t(r)(a.value.label)),1),u("div",Ae,[o(te,{name:t(f).page.animateMode,mode:"out-in",appear:""},{default:l(()=>[(N(),E(ne(a.value.component)))]),_:1},8,["name"])])])])]),_:1})],4)}}});export{Ke as default};
